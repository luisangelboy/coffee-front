(this.webpackJsonpsistemapos_cafi_frontend=this.webpackJsonpsistemapos_cafi_frontend||[]).push([[0],{685:function(e,t){},687:function(e,t){},698:function(e,t){},700:function(e,t){},726:function(e,t){},728:function(e,t){},729:function(e,t){},734:function(e,t){},736:function(e,t){},742:function(e,t){},744:function(e,t){},763:function(e,t){},775:function(e,t){},778:function(e,t){},838:function(e,t,a){},839:function(e,t,a){"use strict";a.r(t);var n,c,r,i,o,s,l,d,j=a(2),u=a.n(j),b=a(57),p=a.n(b),m=a(4),O=a(988),x=a(985),h=a(987),_=a(132),f=a(52),g=a(7),v=a(6),C=a(13),y=a(3),A=a(895),S=a(896),F=a(899),I=a(900),k=a(892),w=a(894),N=a(16),P=a(171),E=Object(P.d)(n||(n=Object(N.a)(["\n  mutation verifyUserName($username: String) {\n    verifyUserName(username: $username) {\n      message\n    }\n  }\n"]))),D=Object(P.d)(c||(c=Object(N.a)(["\n  mutation crearUsuario($input: CrearUsuarioInput) {\n    crearUsuario(input: $input) {\n      _id\n      numero_usuario\n      nombre\n      telefono\n      celular\n      email\n      turno_en_caja_activo\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      imagen\n      estado_usuario\n      empresa {\n        _id\n        nombre_empresa\n        correo_empresa\n        nombre_dueno\n        telefono_dueno\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n        descripcion\n      }\n      accesos {\n        mi_empresa {\n          datos_empresa {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          informacion_fiscal {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        compras {\n          abrir_compra {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          compras_realizadas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          compras_espera {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        tesoreria {\n          cuentas_empresa {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          egresos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          abonos_proveedores {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          abonos_clientes {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          caja_principal {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        reportes {\n          reporte_historial_cajas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_turnos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_compras {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_ventas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          rerporte_almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_corte_caja {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_tesoreria {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        ventas {\n          cancelar_venta {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          precios_productos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          pre_corte {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          cotizaciones {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          administrador {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          eliminar_ventas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          producto_rapido {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        facturacion {\n          generar_cdfi {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          cdfi_realizados {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          registro_series_cdfi {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        almacenes {\n          almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          traspasos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          inventario_almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        catalogos {\n          clientes {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          usuarios {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          productos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          marcas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          contabilidad {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          provedores {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          cajas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          departamentos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          centro_costos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          conceptos_almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          categorias {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          colores {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          colores {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          tallas_numeros {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n      }\n    }\n  }\n"]))),z=Object(P.d)(r||(r=Object(N.a)(["\n  query obtenerUsuarios(\n    $empresa: String!\n    $sucursal: String\n    $filtro: String\n    $eliminado: Boolean\n  ) {\n    obtenerUsuarios(empresa: $empresa, sucursal: $sucursal, filtro: $filtro, eliminado: $eliminado) {\n      _id\n      numero_usuario\n      nombre\n      telefono\n      celular\n      turno_en_caja_activo\n      email\n      username_login\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      imagen\n      estado_usuario\n      empresa {\n        _id\n        nombre_empresa\n        correo_empresa\n        nombre_dueno\n        telefono_dueno\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n        descripcion\n      }\n      accesos {\n        mi_empresa {\n          datos_empresa {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          informacion_fiscal {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        compras {\n          abrir_compra {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          compras_realizadas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          compras_espera {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        tesoreria {\n          cuentas_empresa {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          egresos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          abonos_proveedores {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          abonos_clientes {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          caja_principal {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        reportes {\n          reporte_historial_cajas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_turnos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_compras {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_ventas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          rerporte_almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_corte_caja {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          reporte_tesoreria {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        ventas {\n          cancelar_venta {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          precios_productos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          pre_corte {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          cotizaciones {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          administrador {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          eliminar_ventas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          producto_rapido {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        almacenes {\n          almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          traspasos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          inventario_almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        facturacion {\n          generar_cdfi {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          cdfi_realizados {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          registro_series_cdfi {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n        catalogos {\n          clientes {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          usuarios {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          productos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          marcas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          contabilidad {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          provedores {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          cajas {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          departamentos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          centro_costos {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          conceptos_almacen {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          categorias {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          colores {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n          tallas_numeros {\n            ver\n            agregar\n            editar\n            eliminar\n          }\n        }\n      }\n    }\n  }\n"]))),T=Object(P.d)(i||(i=Object(N.a)(["\n  mutation actualizarUsuario( $id: ID!, $input: ActualizarUsuarioInput, $empresa: ID!, $sucursal: ID!) {\n    actualizarUsuario(id: $id, input: $input, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),$=Object(P.d)(o||(o=Object(N.a)(["\n  mutation logearUsuario($input: LogearUsuarioInput) {\n    logearUsuario(input: $input) {\n      token\n    }\n  }\n"]))),W=Object(P.d)(s||(s=Object(N.a)(["\n  query ObtenerAccesoPermiso($input: ObtenerAccesoPermisosInput) {\n    obtenerAccesoPermiso(input: $input) {\n      permiso_concedido\n      departamento\n      subDepartamento\n    }\n  }\n"]))),R=(Object(P.d)(l||(l=Object(N.a)(["\n  mutation asignarAccesosUsuario($input: CrearArregloDeAccesosInput, $id: ID!) {\n    asignarAccesosUsuario(id: $id, input: $input) {\n      message\n    }\n  }\n"]))),Object(P.d)(d||(d=Object(N.a)(["\n  mutation actualizarBDLocal($empresa: ID!, $sucursal: ID!) {\n    actualizarBDLocal(empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"])))),V=a(840),M=a(996),L=a(101),B=a(461),U=a.n(B),q=a(462),J=a.n(q),H=a(0),G=Object(k.a)((function(e){return{snack:{zIndex:"".concat(99999,"!important")}}}));function Y(e){var t=e.alert,a=e.setAlert,n=G();return Object(H.jsx)(V.a,{children:Object(H.jsx)(M.a,{className:n.snack,anchorOrigin:{vertical:"top",horizontal:"center"},open:t.open,onClose:function(){a({open:!1,status:t.status,message:""})},autoHideDuration:3e3,message:Object(H.jsxs)(O.a,{display:"flex",children:["success"===t.status?Object(H.jsx)(U.a,{style:{color:"#22bb33"}}):Object(H.jsx)(J.a,{style:{color:"red"}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(L.a,{children:t.message})]})})})}var Q,K,X,Z=a(463),ee=a(846),te=a(856),ae=a(855),ne=a(898),ce=a(498),re=a(159),ie=a.n(re),oe=a(160),se=a.n(oe),le=a.p+"static/media/Cafi.d1da222a.svg",de=Object(P.d)(Q||(Q=Object(N.a)(["\n  mutation crearRegistroDeTurno(\n    $input: AbrirCerrarTurnoInput\n    $activa: Boolean\n  ) {\n    crearRegistroDeTurno(input: $input, activa: $activa) {\n      _id\n      horario_en_turno\n      token_turno_user\n      concepto\n      numero_caja\n      id_caja\n      comentarios\n      hora_entrada {\n        hora\n        minutos\n        segundos\n      }\n      hora_salida {\n        hora\n        minutos\n        segundos\n      }\n      fecha_entrada {\n        year\n        mes\n        dia\n        no_semana_year\n        no_dia_year\n      }\n      fecha_salida {\n        year\n        mes\n        dia\n        no_semana_year\n        no_dia_year\n      }\n      fecha_movimiento\n      montos_en_caja {\n        monto_efectivo {\n          monto\n        }\n        monto_tarjeta_credito {\n          monto\n        }\n        monto_tarjeta_debito {\n          monto\n        }\n        monto_creditos {\n          monto\n        }\n        monto_monedero {\n          monto\n        }\n        monto_transferencia {\n          monto\n        }\n        monto_cheques {\n          monto\n        }\n        monto_vales_despensa {\n          monto\n        }\n      }\n      usuario_en_turno {\n        numero_usuario\n        nombre\n      }\n      id_usuario\n      empresa\n      sucursal\n    }\n  }\n"]))),je=Object(P.d)(K||(K=Object(N.a)(["\n  mutation subirTurnoCloud(\n    $input: AbrirCerrarTurnoInput\n    $activa: Boolean,\n    $isOnline: Boolean\n  ) {\n    subirTurnoCloud(input: $input, activa: $activa, isOnline: $isOnline) {\n      message\n      done\n    }\n  }\n"]))),ue=Object(P.d)(X||(X=Object(N.a)(["\n  query obtenerFiltroTurnos(\n    $input: HistorialTurnosInput\n    $empresa: ID!\n    $sucursal: ID!\n\t$limit: Int\n\t$offset: Int\n  ) {\n    obtenerFiltroTurnos(input: $input, empresa: $empresa, sucursal: $sucursal, limit: $limit, offset: $offset) {\n      docs {\n        horario_en_turno\n        concepto\n        numero_caja\n        id_caja\n        comentarios\n        hora_entrada {\n          hora\n          minutos\n          segundos\n          completa\n        }\n        hora_salida {\n          hora\n          minutos\n          segundos\n          completa\n        }\n        fecha_entrada {\n          year\n          mes\n          dia\n          no_semana_year\n          no_dia_year\n          completa\n        }\n        fecha_salida {\n          year\n          mes\n          dia\n          no_semana_year\n          no_dia_year\n          completa\n        }\n        fecha_movimiento\n        montos_en_caja {\n          monto_efectivo {\n            monto\n          }\n          monto_tarjeta_credito {\n            monto\n          }\n          monto_tarjeta_debito {\n            monto\n          }\n          monto_creditos {\n            monto\n          }\n          monto_monedero {\n            monto\n          }\n          monto_transferencia {\n            monto\n          }\n          monto_cheques {\n            monto\n          }\n          monto_vales_despensa {\n            monto\n          }\n        }\n        usuario_en_turno {\n          numero_usuario\n          nombre\n        }\n        empresa\n        sucursal\n      }\n      totalDocs\n    }\n  }\n"]))),be=Object(j.createContext)(),pe=function(e){var t,a=e.children,n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)([]),s=Object(y.a)(o,2),l=s[0],d=s[1],b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],O=p[1],x=Object(j.useState)({departamento:"",subDepartamento:"",tipo_acceso:""}),h=Object(y.a)(x,2),_=h[0],f=h[1],A=Object(j.useState)(!1),S=Object(y.a)(A,2),F=S[0],I=S[1],k=Object(j.useState)(!1),N=Object(y.a)(k,2),P=N[0],E=N[1],D=Object(j.useState)(!1),z=Object(y.a)(D,2),T=z[0],$=z[1],W=Object(j.useState)(!1),R=Object(y.a)(W,2),V=R[0],M=R[1],L=Object(j.useState)(!1),B=Object(y.a)(L,2),U=B[0],q=B[1],J=Object(j.useState)(!1),G=Object(y.a)(J,2),Y=G[0],Q=G[1],K=Object(j.useState)(!1),X=Object(y.a)(K,2),Z=X[0],ee=X[1],te=u.a.useState(!1),ae=Object(y.a)(te,2),ne=ae[0],ce=ae[1],re=Object(w.a)(je),ie=Object(y.a)(re,1)[0];Object(j.useEffect)((function(){var e=JSON.parse(localStorage.getItem("ventasToCloud"));d(e||[])}),[]),Object(j.useEffect)((function(){if(void 0!==r&&!0===r){var e=JSON.parse(localStorage.getItem("turnoEnCurso"));e&&(e.OnCloud||oe(e,r))}}),[r]);var oe=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t,a){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.onCloud){e.next=8;break}return e.next=4,ie({variables:{activa:!0,input:t,isOnline:a}});case 4:n=e.sent,t.onCloud=n.data.subirTurnoCloud.done,localStorage.removeItem("turnoEnCurso"),localStorage.setItem("turnoEnCurso",JSON.stringify(t));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}();return Object(H.jsx)(be.Provider,{value:(t={departamentos:_,setDepartamentos:f,reloadProductoRapido:P,setReloadProductoRapido:E,reloadAdministrador:F,setReloadAdministrador:I,abrirPanelAcceso:m,setAbrirPanelAcceso:O,reloadCancelarVenta:T,setReloadCancelarVenta:$,reloadVerPrecios:V,setReloadVerPrecios:M,reloadVerPreCorte:U,setReloadVerPreCorte:q,reloadEliminarVentaEspera:Y,setReloadEliminarVentaEspera:Q,reloadCrearCotizacion:Z,setReloadCrearCotizacion:ee},Object(g.a)(t,"setReloadCrearCotizacion",ee),Object(g.a)(t,"isOnline",r),Object(g.a)(t,"setIsOnline",i),Object(g.a)(t,"ventasToCloud",l),Object(g.a)(t,"saveVentasToCloud",(function(e){try{var t=JSON.parse(localStorage.getItem("ventasToCloud"))?JSON.parse(localStorage.getItem("ventasToCloud")):[];t.push(e),localStorage.setItem("ventasToCloud",JSON.stringify(t)),d(t)}catch(a){console.log(a)}})),Object(g.a)(t,"removeStorageVentas",(function(e){try{localStorage.removeItem("ventasToCloud"),d([])}catch(t){console.log(t)}})),Object(g.a)(t,"saveVentasToCloudFail",(function(e){try{localStorage.removeItem("ventasToCloud"),d(e),localStorage.setItem("ventasToCloud",JSON.stringify(e))}catch(t){console.log(t)}})),Object(g.a)(t,"loadingPage",ne),Object(g.a)(t,"setLoadingPage",ce),t),children:a})},me=Object(k.a)((function(e){return{margin:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},containerImagen:{maxWidth:"100%",maxHeight:250,display:"flex",alignContent:"center",justifyContent:"center"},imagen:{maxWidth:"100%",maxHeight:"100%"}}}));var Oe={receta_farmacia:!1,clave_producto_sat:{Name:"",Value:""}},xe={monedero:!1,monedero_electronico:0,iva_activo:!0,ieps_activo:!1,ieps:0,iva:16,granel:!1,inventario:{inventario_minimo:0,inventario_maximo:0,unidad_de_inventario:"Pz",codigo_unidad:"H87"},precio_de_compra:{precio_con_impuesto:0,precio_sin_impuesto:0,iva:0,ieps:0},unidad_de_compra:{unidad:"Pz",codigo_unidad:"H87",cantidad:1,precio_unitario_sin_impuesto:0,precio_unitario_con_impuesto:0}},he={codigo_barras:"",unidad:"Pz",codigo_unidad:"H87",cantidad:1,precio:0,descuento_activo:null,precio_unidad:{numero_precio:0,precio_neto:0,precio_venta:0,unidad_mayoreo:0,iva_precio:0,ieps_precio:0,utilidad:0,precio_general:0,cantidad_unidad:0,unidad_maxima:!1},unidad_principal:!0,default:!0},_e={codigo_barras:"",unidad:"Caja",codigo_unidad:"XBX",cantidad:1,precio:0,descuento_activo:null,precio_unidad:{numero_precio:0,precio_neto:0,precio_venta:0,unidad_mayoreo:0,iva_precio:0,ieps_precio:0,utilidad:0,precio_general:0,cantidad_unidad:0,unidad_maxima:!1},unidad_principal:!1,default:!1},fe=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}],ge=[],ve={id_almacen:"",almacen:"",cantidad:0,fecha_de_expiracion:""},Ce={},ye={precio_piezas:[],precio_cajas:[],precio_costales:[]},Ae=[],Se=[],Fe=[],Ie={index:"",image:""},ke={error:!1,message:""},we=[],Ne=[],Pe=Object(j.createContext)(),Ee=function(e){var t=e.children,a=Object(j.useState)(Oe),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(xe),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(he),b=Object(y.a)(d,2),p=b[0],m=b[1],O=Object(j.useState)(_e),x=Object(y.a)(O,2),h=x[0],_=x[1],f=Object(j.useState)(fe),g=Object(y.a)(f,2),v=g[0],C=g[1],A=Object(j.useState)(ge),S=Object(y.a)(A,2),F=S[0],I=S[1],k=Object(j.useState)(ve),w=Object(y.a)(k,2),N=w[0],P=w[1],E=Object(j.useState)(Ce),D=Object(y.a)(E,2),z=D[0],T=D[1],$=Object(j.useState)(ye),W=Object(y.a)($,2),R=W[0],V=W[1],M=Object(j.useState)(Ae),L=Object(y.a)(M,2),B=L[0],U=L[1],q=Object(j.useState)(Se),J=Object(y.a)(q,2),G=J[0],Y=J[1],Q=Object(j.useState)(Fe),K=Object(y.a)(Q,2),X=K[0],Z=K[1],ee=Object(j.useState)(Ie),te=Object(y.a)(ee,2),ae=te[0],ne=te[1],ce=Object(j.useState)(ke),re=Object(y.a)(ce,2),ie=re[0],oe=re[1],se=Object(j.useState)(we),le=Object(y.a)(se,2),de=le[0],je=le[1],ue=Object(j.useState)(null),be=Object(y.a)(ue,2),pe=be[0],me=be[1],Ee=Object(j.useState)(!1),De=Object(y.a)(Ee,2),ze=De[0],Te=De[1],$e=Object(j.useState)(Ne),We=Object(y.a)($e,2),Re=We[0],Ve=We[1],Me=Object(j.useState)([]),Le=Object(y.a)(Me,2),Be=Le[0],Ue=Le[1],qe=u.a.useState(!1),Je=Object(y.a)(qe,2),He=Je[0],Ge=Je[1],Ye=Object(j.useState)({message:"",status:"",open:!1}),Qe=Object(y.a)(Ye,2),Ke=Qe[0],Xe=Qe[1],Ze=Object(j.useState)([]),et=Object(y.a)(Ze,2),tt=et[0],at=et[1],nt=Object(j.useState)([]),ct=Object(y.a)(nt,2),rt=ct[0],it=ct[1],ot=Object(j.useState)([]),st=Object(y.a)(ot,2),lt=st[0],dt=st[1],jt=Object(j.useState)([]),ut=Object(y.a)(jt,2),bt=ut[0],pt=ut[1],mt=Object(j.useState)(!1),Ot=Object(y.a)(mt,2),xt=Ot[0],ht=Ot[1];return Object(H.jsx)(Pe.Provider,{value:{datos_generales:c,setDatosGenerales:r,precios:s,setPrecios:l,almacen_inicial:N,setAlmacenInicial:P,imagenes:G,setImagenes:Y,imagenes_eliminadas:X,setImagenesEliminadas:Z,onPreview:ae,setOnPreview:ne,validacion:ie,setValidacion:oe,preciosP:v,setPreciosP:C,preciosPlazos:R,setPreciosPlazos:V,unidadesVenta:F,setUnidadesVenta:I,centro_de_costos:z,setCentroDeCostos:T,unidadVentaXDefecto:p,setUnidadVentaXDefecto:m,subcategorias:B,setSubcategorias:U,subcostos:de,setSubcostos:je,selectedDate:pe,setSelectedDate:me,update:ze,setUpdate:Te,presentaciones:Re,setPresentaciones:Ve,presentaciones_eliminadas:Be,setPresentacionesEliminadas:Ue,actualizarLista:He,setActualizarLista:Ge,alert:Ke,setAlert:Xe,datosPreciosProducto:tt,setDatosPreciosProducto:at,preciosDescuentos:rt,setPreciosDescuentos:it,preciosProductos:lt,setPreciosProductos:dt,datosEnDescuentos:bt,setDatosEnDescuentos:pt,almacen_existente:xt,setAlmacenExistente:ht,unidadVentaSecundaria:h,setUnidadVentaSecundaria:_},children:t})},De=a(9),ze=a(464),Te=a.n(ze),$e=a(70),We=a(29),Re=a(920),Ve=a(990),Me=a(922),Le=Object(j.createContext)(),Be=function(e){var t=e.children,a=Object(j.useState)({nombre_empresa:"",nombre_dueno:"",telefono_dueno:"",celular:"",correo_empresa:"",nombre_fiscal:"",rfc:"",regimen_fiscal:"",curp:"",info_adicio:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""},imagen:null}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)({error:!1,message:""}),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1];return Object(H.jsx)(Le.Provider,{value:{empresa:c,setEmpresa:r,toUpdate:s,setToUpdate:l,error:b,setError:p,update:x,setUpdate:h},children:t})},Ue=a(919),qe=a(907),Je=a(921),He=a(909),Ge=a(19),Ye=a.n(Ge),Qe=a(902),Ke=a(997),Xe=a(903),Ze=a(993),et=a(904),tt=a(905),at=a(182),nt=a(261),ct=a.n(nt),rt=a(495),it=a(848),ot=Object(k.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff",backgroundColor:"rgba(0, 0, 0, 0.3)"}}}));function st(e){var t=e.loading,a=(e.setLoading,ot());return Object(H.jsx)("div",{children:Object(H.jsx)(it.a,{className:a.backdrop,open:t,children:Object(H.jsx)(I.a,{color:"inherit"})})})}var lt,dt,jt=a(465),ut=a.n(jt);function bt(e){e.error;var t=e.altura;return t||(t=400),Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:t,children:[Object(H.jsx)(ut.a,{style:{fontSize:100,color:"rgba(17,85,204, 0.7)"}}),Object(H.jsx)(L.a,{align:"center",style:{fontSize:18,color:"rgba(17,85,204)"},children:"Hubo un problema"})]})}var pt=Object(P.d)(lt||(lt=Object(N.a)(["\n  query obtenerEmpresa($id: ID!) {\n    obtenerEmpresa(id: $id) {\n      _id\n      nombre_empresa\n      nombre_dueno\n      telefono_dueno\n      celular\n      correo_empresa\n      limite_timbres\n      timbres_usados\n      sello_sat\n      nombre_cer\n      nombre_key\n      fecha_registro_sello_sat\n      imagen\n      nombre_fiscal\n      rfc\n      regimen_fiscal\n      curp\n      info_adicio\n      valor_puntos\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      direccionFiscal {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      datosBancarios {\n        cuenta\n        sucursal\n        clave_banco\n      }\n      vender_sin_inventario\n    }\n  }\n"]))),mt=Object(P.d)(dt||(dt=Object(N.a)(["\n  mutation actualizarEmpresa($id: ID!, $input: EditarEmpresa) {\n    actualizarEmpresa(id: $id, input: $input) {\n      _id\n      nombre_empresa\n      nombre_dueno\n      telefono_dueno\n      celular\n      correo_empresa\n      limite_timbres\n      timbres_usados\n      sello_sat\n      nombre_cer\n      nombre_key\n      imagen\n      nombre_fiscal\n      rfc\n      regimen_fiscal\n      curp\n      info_adicio\n      valor_puntos\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      direccionFiscal {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      datosBancarios {\n        cuenta\n        sucursal\n        clave_banco\n      }\n    }\n  }\n"]))),Ot=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& .requerido":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"150px",height:"150px",border:"dashed 2px black",borderRadius:"100%"},avatar:{width:"90%",height:"90%","& > .icon":{fontSize:100}}}}));function xt(e){var t=JSON.parse(localStorage.getItem("sesionCafi")),a=Ot(),n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(!1===t.accesos.mi_empresa.datos_empresa.editar),s=Object(y.a)(o,1)[0],l=Object(j.useState)(""),d=Object(y.a)(l,2),b=d[0],p=d[1],x=u.a.useState(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],I=u.a.useState(!1),k=Object(y.a)(I,2),N=k[0],P=k[1],E=Object(j.useState)({message:"",status:"",open:!1}),D=Object(y.a)(E,2),z=D[0],T=D[1],$=Object(j.useContext)(Le),W=$.empresa,R=$.update,V=$.setEmpresa,M=$.setUpdate,B=Object(w.a)(mt),U=Object(y.a)(B,1)[0],q=Object(rt.b)(pt,{variables:{id:t.empresa._id}}),J=q.loading,G=q.data,Q=q.refetch,K=q.error,X=Object(j.useState)({nombre_empresa:"",nombre_dueno:"",telefono_dueno:"",celular:"",correo_empresa:"",valor_puntos:"",nombre_fiscal:"",rfc:"",regimen_fiscal:"",curp:"",info_adicio:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""},imagen:null,vender_sin_inventario:!1}),Z=Object(y.a)(X,2),ee=Z[0],te=Z[1];Object(j.useEffect)((function(){try{Q()}catch(e){}}),[R,Q]),Object(j.useEffect)((function(){try{i(J)}catch(e){}}),[J]),Object(j.useEffect)((function(){try{void 0!==G&&V(G.obtenerEmpresa)}catch(e){}}),[G,V]),Object(j.useEffect)((function(){try{f(K)}catch(e){}}),[K]),Object(j.useEffect)((function(){try{te({nombre_empresa:W.nombre_empresa,nombre_dueno:W.nombre_dueno,telefono_dueno:W.telefono_dueno,celular:W.celular,valor_puntos:W.valor_puntos,correo_empresa:W.correo_empresa,direccion:W.direccion,imagen:W.imagen,vender_sin_inventario:W.vender_sin_inventario})}catch(e){}}),[W]);var ae=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var a,n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ee.nombre_empresa&&ee.nombre_dueno){e.next=4;break}return P(!0),e.abrupt("return");case 4:return i(!0),e.next=7,U({variables:{id:t.empresa._id,input:ee}});case 7:a=Object(m.a)(Object(m.a)({},t.empresa),ee),(n=Object(m.a)({},t)).empresa=a,localStorage.setItem("sesionCafi",JSON.stringify(n)),M(!0),i(!1),T({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),P(!1),e.next=23;break;case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors),T({message:"Hubo un error",status:"error",open:!0}),i(!1);case 23:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}(),ne=function(e){try{var t=e.target.value;"valor_puntos"===e.target.name&&(t=parseFloat(t)),te(Object(m.a)(Object(m.a)({},ee),{},Object(g.a)({},e.target.name,t)))}catch(K){}},ce=function(e){te(Object(m.a)(Object(m.a)({},ee),{},{direccion:Object(m.a)(Object(m.a)({},ee.direccion),{},Object(g.a)({},e.target.name,e.target.value))}))},re=Object(j.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;p(e)},te(Object(m.a)(Object(m.a)({},ee),{},{imagen:e[0]}))}),[ee,te]),ie=Object(at.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:re}),oe=ie.getRootProps,se=ie.getInputProps;return Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:z,setAlert:T}),Object(H.jsx)(st,{loading:r,setLoading:i}),_?Object(H.jsx)(bt,{error:_}):Object(H.jsxs)(A.a,{style:{marginTop:8},children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:3,className:a.require,children:[Object(H.jsx)(Qe.a,{item:!0,md:2,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(O.a,Object(m.a)(Object(m.a)({className:a.avatarContainer},oe()),{},{children:[Object(H.jsx)("input",Object(m.a)({},se())),b?Object(H.jsx)(Ke.a,{className:a.avatar,src:"".concat(b)}):Object(H.jsx)(Ke.a,{className:a.avatar,src:"".concat(ee.imagen)})]})),Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{color:"secondary",size:"medium",onClick:function(){te(Object(m.a)(Object(m.a)({},ee),{},{imagen:""})),p("")},startIcon:Object(H.jsx)(ct.a,{}),children:"Remover imagen"})})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:5,xs:12,className:a.require,children:[Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:[Object(H.jsx)("span",{className:"requerido",children:"* "}),"Nombre de empresa"]})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:s,type:"text",size:"small",error:N&&!ee.nombre_empresa,name:"nombre_empresa",variant:"outlined",value:ee.nombre_empresa?ee.nombre_empresa:"",helperText:N?"El campo nombre es obligatorio":"",onChange:ne})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:[Object(H.jsx)("span",{className:"requerido",children:"* "}),"Nombre due\xf1o"]})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:s,type:"text",size:"small",error:N&&!ee.nombre_dueno,name:"nombre_dueno",variant:"outlined",value:ee.nombre_dueno?ee.nombre_dueno:"",helperText:N?"El campo nombre es obligatorio":"",onChange:ne})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Tel\xe9fono"})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:s,size:"small",name:"telefono_dueno",variant:"outlined",value:ee.telefono_dueno?ee.telefono_dueno:"",onChange:ne})]})]}),Object(H.jsxs)(Qe.a,{item:!0,md:5,xs:12,children:[Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Celular"})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:s,size:"small",name:"celular",variant:"outlined",value:ee.celular?ee.celular:"",onChange:ne})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"E-mail"})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:s,size:"small",name:"correo_empresa",variant:"outlined",value:ee.correo_empresa?ee.correo_empresa:"",onChange:ne})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Valor de puntos"})}),Object(H.jsx)(S.a,{inputMode:"numeric",type:"number",disabled:s,size:"small",name:"valor_puntos",variant:"outlined",value:ee.valor_puntos?ee.valor_puntos:"",onChange:ne})]}),Object(H.jsx)(Qe.a,{item:!0,md:8,style:{display:"flex",alignItems:"center"},children:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{disabled:s,checked:ee.vender_sin_inventario,onChange:function(e){te(Object(m.a)(Object(m.a)({},ee),{},{vender_sin_inventario:e.target.checked}))},name:"checkedA"}),label:"Vender productos sin inventario"})})]})})]})]}),Object(H.jsxs)(O.a,{mt:3,mb:2,children:[Object(H.jsx)(L.a,{className:a.subtitle,children:Object(H.jsx)("b",{children:"Domicilio empresa"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:3,className:a.require,children:[Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Calle"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:s,value:ee.direccion.calle?ee.direccion.calle:"",onChange:ce})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Num. Ext"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:s,value:ee.direccion.no_ext?ee.direccion.no_ext:"",onChange:ce})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Num. Int"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:s,value:ee.direccion.no_int?ee.direccion.no_int:"",onChange:ce})]})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"C.P."})," "]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:s,value:ee.direccion.codigo_postal?ee.direccion.codigo_postal:"",onChange:ce})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Colonia"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:s,value:ee.direccion.colonia?ee.direccion.colonia:"",onChange:ce})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Municipio"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:s,value:ee.direccion.municipio?ee.direccion.municipio:"",onChange:ce})]})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Localidad"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:s,value:ee.direccion.localidad?ee.direccion.localidad:"",onChange:ce})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Estado"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:s,value:ee.direccion.estado?ee.direccion.estado:"",onChange:ce})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Pais"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:s,value:ee.direccion.pais?ee.direccion.pais:"",onChange:ce})]})]})]}),!1===t.accesos.mi_empresa.datos_empresa.editar?null:Object(H.jsxs)(tt.a,{style:{marginTop:15,width:"100%",justifyContent:"center"},children:[Object(H.jsx)(F.a,{onClick:function(){e.setOpen(!1)},color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return ae()},color:"primary",variant:"contained",children:"Guardar"})]})]})]})}var ht,_t,ft,gt,vt,Ct,yt,At,St,Ft,It,kt,wt,Nt=a(853),Pt=a(917),Et=a(11),Dt=a.n(Et),zt=[{Value:"G01",Name:"Adquisici\xf3n de mercanc\xedas"},{Value:"G02",Name:"Devoluciones, descuentos o bonificaciones"},{Value:"G03",Name:"Gastos en general"},{Value:"I01",Name:"Construcciones"},{Value:"I02",Name:"Mobiliario y equipo de oficina por inversiones"},{Value:"I03",Name:"Equipo de transporte"},{Value:"I04",Name:"Equipo de c\xf3mputo y accesorios"},{Value:"I05",Name:"Dados, troqueles, moldes, matrices y herramental"},{Value:"I06",Name:"Comunicaciones telef\xf3nicas"},{Value:"I07",Name:"Comunicaciones satelitales"},{Value:"I08",Name:"Otra maquinaria y equipo"},{Value:"D01",Name:"Honorarios m\xe9dicos, dentales y gastos hospitalarios"},{Value:"D02",Name:"Gastos m\xe9dicos por incapacidad o discapacidad"},{Value:"D03",Name:"Gastos funerales."},{Value:"D04",Name:"Donativos"},{Value:"D05",Name:"Intereses reales efectivamente pagados por cr\xe9ditos hipotecarios (casa habitaci\xf3n)."},{Value:"D06",Name:"Aportaciones voluntarias al SAR."},{Value:"D07",Name:"Primas por seguros de gastos m\xe9dicos."},{Value:"D08",Name:"Gastos de transportaci\xf3n escolar obligatoria."},{Value:"D09",Name:"Dep\xf3sitos en cuentas para el ahorro, primas que tengan como base planes de pensiones."},{Value:"D10",Name:"Pagos por servicios educativos (colegiaturas)"},{Value:"P01",Name:"Por definir"}],Tt=[{NameId:1,Name:"Factura",Value:"I"},{NameId:2,Name:"Nota de Cr\xe9dito",Value:"E"},{NameId:14,Name:"Complemento de pago",Value:"P"}],$t=[{Value:"MXN",Name:"Peso Mexicano"},{Value:"EUR",Name:"Euro"},{Value:"USD",Name:"Dolar Americano"}],Wt=[{Name:"Efectivo",Value:"01"},{Name:"Cheque nominativo",Value:"02"},{Name:"Transferencia electr\xf3nica de fondos",Value:"03"},{Name:"Tarjeta de cr\xe9dito",Value:"04"},{Name:"Monedero electr\xf3nico",Value:"05"},{Name:"Dinero electr\xf3nico",Value:"06"},{Name:"Vales de despensa",Value:"08"},{Name:"Tarjeta de d\xe9bito",Value:"28"},{Name:"Aplicaci\xf3n de anticipos",Value:"30"},{Name:"Por definir",Value:"99"}],Rt=[{Value:"PPD",Name:"Pago en parcialidades \xf3 diferido"},{Value:"PUE",Name:"Pago en una sola exhibici\xf3n"}],Vt=[{Natural:!1,Moral:!0,Name:"General de Ley Personas Morales",Value:"601"},{Natural:!1,Moral:!0,Name:"Personas Morales con Fines no Lucrativos",Value:"603"},{Natural:!0,Moral:!1,Name:"Sueldos y Salarios e Ingresos Asimilados a Salarios",Value:"605"},{Natural:!0,Moral:!1,Name:"Arrendamiento",Value:"606"},{Natural:!1,Moral:!0,Name:"R\xe9gimen de Enajenaci\xf3n o Adquisici\xf3n de Bienes",Value:"607"},{Natural:!0,Moral:!1,Name:"Dem\xe1s ingresos",Value:"608"},{Natural:!0,Moral:!0,Name:"Residentes en el Extranjero sin Establecimiento Permanente en M\xe9xico",Value:"610"},{Natural:!0,Moral:!1,Name:"Ingresos por Dividendos (socios y accionistas)",Value:"611"},{Natural:!0,Moral:!1,Name:"Personas F\xedsicas con Actividades Empresariales y Profesionales",Value:"612"},{Natural:!0,Moral:!1,Name:"Ingresos por intereses",Value:"614"},{Natural:!0,Moral:!1,Name:"R\xe9gimen de los ingresos por obtenci\xf3n de premios",Value:"615"},{Natural:!0,Moral:!1,Name:"Sin obligaciones fiscales",Value:"616"},{Natural:!1,Moral:!0,Name:"Sociedades Cooperativas de Producci\xf3n que optan por diferir sus ingresos",Value:"620"},{Natural:!0,Moral:!1,Name:"Incorporaci\xf3n Fiscal",Value:"621"},{Natural:!0,Moral:!0,Name:"Actividades Agr\xedcolas, Ganaderas, Silv\xedcolas y Pesqueras",Value:"622"},{Natural:!1,Moral:!0,Name:"Opcional para Grupos de Sociedades",Value:"623"},{Natural:!1,Moral:!0,Name:"Coordinados",Value:"624"},{Natural:!0,Moral:!1,Name:"R\xe9gimen de las Actividades Empresariales con ingresos a trav\xe9s de Plataformas Tecnol\xf3gicas",Value:"625"},{Natural:!1,Moral:!0,Name:"Hidrocarburos",Value:"628"},{Natural:!0,Moral:!1,Name:"De los Reg\xedmenes Fiscales Preferentes y de las Empresas Multinacionales",Value:"629"},{Natural:!0,Moral:!1,Name:"Enajenaci\xf3n de acciones en bolsa de valores",Value:"630"}],Mt=a(992),Lt=a(918),Bt=a(908),Ut=a(906),qt=a(910),Jt=a(911),Ht=a(912),Gt=a(913),Yt=a(914),Qt=Object(P.d)(ht||(ht=Object(N.a)(["\n  mutation crearFactura($input: CrearFacturaInput) {\n    crearFactura(input: $input) {\n      message\n      success\n      pdf\n      xml\n    }\n  }\n"]))),Kt=Object(P.d)(_t||(_t=Object(N.a)(["\n  mutation crearSerieCFDI($input: CrearSerieCfdiInput!) {\n    crearSerieCFDI(input: $input) {\n      message\n      success\n    }\n  }\n"]))),Xt=Object(P.d)(ft||(ft=Object(N.a)(["\n  mutation modificarDefaultSerie($id: ID!, $empresa: ID!, $sucursal: ID!) {\n    modificarDefaultSerie(id: $id, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),Zt=Object(P.d)(gt||(gt=Object(N.a)(["\n  mutation eliminarSerie($id: ID!) {\n    eliminarSerie(id: $id) {\n      message\n    }\n  }\n"]))),ea=Object(P.d)(vt||(vt=Object(N.a)(["\n  query obtenerSeriesCdfi($empresa: ID!, $sucursal: ID!) {\n    obtenerSeriesCdfi(empresa: $empresa, sucursal: $sucursal) {\n      message\n      success\n      seriesCfdi {\n        _id\n        serie\n        folio\n        default\n      }\n    }\n  }\n"]))),ta=Object(P.d)(Ct||(Ct=Object(N.a)(["\n  mutation crearCSDS($input: CrearCSDSInput!) {\n    crearCSDS(input: $input) {\n      message\n      success\n    }\n  }\n"]))),aa=Object(P.d)(yt||(yt=Object(N.a)(["\n  mutation eliminarCSD($rfc: String, $empresa: ID!) {\n    eliminarCSD(rfc: $rfc, empresa: $empresa) {\n      message\n    }\n  }\n"]))),na=(Object(P.d)(At||(At=Object(N.a)(["\n  query obtenerCatalogosSAT($input: CrearFacturaInput!) {\n    obtenerCatalogosSAT(input: $input) {\n      message\n      currencies {\n        Decimals\n        PrecisionRate\n        Name\n        Value\n      }\n      paymentForms {\n        Name\n        Value\n      }\n      paymentMethods {\n        Name\n        Value\n      }\n      fiscalRegimens {\n        Natural\n        Moral\n        Name\n        Value\n      }\n      cfdiTypes {\n        NameId\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(P.d)(St||(St=Object(N.a)(["\n  query obtenerProductosOServicios($input: CrearFacturaInput!) {\n    obtenerProductosOServicios(input: $input) {\n      message\n      productosOServicios {\n        DangerousMaterial\n        Complement\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(P.d)(Ft||(Ft=Object(N.a)(["\n  query obtenerCodigoPostal($input: CrearFacturaInput!) {\n    obtenerCodigoPostal(input: $input) {\n      message\n      codigoPostal {\n        StateCode\n        MunicipalityCode\n        LocationCode\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(P.d)(It||(It=Object(N.a)(["\n  query obtenerCfdiUses($input: CrearFacturaInput!) {\n    obtenerCfdiUses(input: $input) {\n      message\n      cfdiUses {\n        message\n        Natural\n        Moral\n        Name\n        Value\n      }\n    }\n  }\n"]))),Object(P.d)(kt||(kt=Object(N.a)(["\n  query obtenerFacturas(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtros: filtrosFactura\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerFacturas(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtros: $filtros\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        id_cfdi\n        serie\n        currency\n        expedition_place\n        folio\n        cfdi_type\n        payment_form\n        payment_method\n        logo_url\n        date\n        issuer {\n          FiscalRegime\n          Rfc\n          TaxName\n        }\n        receiver {\n          Rfc\n          Name\n          CfdiUse\n        }\n        items {\n          ProductCode\n          IdentificationNumber\n          Description\n          Unit\n          UnitCode\n          UnitPrice\n          Quantity\n          Subtotal\n          Discount\n          Total\n        }\n        taxes {\n          Total\n          Name\n          Rate\n          Type\n        }\n        complement {\n          TaxStamp {\n            Uuid\n            Date\n            CdfiSign\n            SatCertNumber\n            SatSign\n            RfcProvCertif\n          }\n        }\n        original_string\n        sub_total\n        total\n        discount\n        fecha_registro\n        id_venta\n        folio_venta\n        complementos {\n          id_cfdi\n          serie\n          currency\n          expedition_place\n          folio\n          cfdi_type\n          payment_form\n          payment_method\n          logo_url\n          date\n          issuer {\n            FiscalRegime\n            Rfc\n            TaxName\n          }\n          receiver {\n            Rfc\n            Name\n            CfdiUse\n          }\n          items {\n            ProductCode\n            IdentificationNumber\n            Description\n            Unit\n            UnitCode\n            UnitPrice\n            Quantity\n            Subtotal\n            Discount\n            Total\n          }\n          taxes {\n            Total\n            Name\n            Rate\n            Type\n          }\n          complement {\n            TaxStamp {\n              Uuid\n              Date\n              CdfiSign\n              SatCertNumber\n              SatSign\n              RfcProvCertif\n            }\n            Payments {\n              _id\n              RelatedDocuments {\n                _id\n                Uuid\n                Folio\n                Currency\n                PaymentMethod\n                PartialityNumber\n                PreviousBalanceAmount\n                AmountPaid\n                ImpSaldoInsoluto\n              }\n              Date\n              PaymentForm\n              Currency\n              Amount\n              ExpectedPaid\n            }\n          }\n          original_string\n          sub_total\n          total\n          discount\n          fecha_registro\n          id_venta\n          folio_venta\n        }\n        id_nota\n        tipo\n      }\n      totalDocs\n    }\n  }\n"])))),ca=Object(P.d)(wt||(wt=Object(N.a)(["\n  query obtenerDocumentCfdi($id: String!) {\n    obtenerDocumentCfdi(id: $id) {\n      htmlBase64\n      pdfBase64\n      xmlBase64\n    }\n  }\n"])));function ra(e){var t=e.datosEmpresa,a=e.firma_disabled,n=e.refetch,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)({certificate:"",private_key:"",private_key_password:"",rfc:c&&t.rfc?t.rfc:"",empresa:c&&c.empresa._id?c.empresa._id:"",sucursal:c&&c.sucursal._id?c.sucursal._id:""}),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useState)(!1),x=Object(y.a)(p,2),h=x[0],_=x[1],f=Object(j.useState)(!1),A=Object(y.a)(f,2),k=A[0],N=A[1],P=Object(j.useState)({message:"",status:"",open:!1}),E=Object(y.a)(P,2),D=E[0],z=E[1],T=function(){s(!1),b({certificate:"",private_key:"",private_key_password:"",rfc:c&&t.rfc?t.rfc:"",empresa:c&&c.empresa._id?c.empresa._id:"",sucursal:c&&c.sucursal._id?c.sucursal._id:""})},$=Object(w.a)(ta),W=Object(y.a)($,1)[0],R=function(e){var t=e.target,a=t.name,n=t.files;b(Object(m.a)(Object(m.a)({},u),{},Object(g.a)({},a,n[0])))},V=function(e){return new Promise((function(t){var a="",n=new FileReader;n.readAsDataURL(e),n.onload=function(){a=n.result,t(a)}}))},M=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a,c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.certificate&&u.private_key&&u.private_key_password&&u.rfc){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t=Object(m.a)({},u),a=t.certificate,c=t.private_key,e.next=8,V(a).then((function(e){var n=e.split(",");t.certificate=n[1],t.nombre_cer=a.name})).catch((function(e){console.log(e)}));case 8:return e.next=10,V(c).then((function(e){var a=e.split(",");t.private_key=a[1],t.nombre_key=c.name})).catch((function(e){console.log(e)}));case 10:return N(!0),e.next=13,W({variables:{input:{certificate:t.certificate,private_key:t.private_key,private_key_password:t.private_key_password,rfc:t.rfc,empresa:t.empresa,sucursal:t.sucursal,nombre_cer:t.nombre_cer,nombre_key:t.nombre_key}}});case 13:r=e.sent,z({message:"\xa1Listo! ".concat(r.data.crearCSDS.message),status:"success",open:!0}),N(!1),T(),n(),e.next=26;break;case 20:e.prev=20,e.t0=e.catch(2),N(!1),z({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 26:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:D,setAlert:z}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{onClick:function(){return s(!0)},color:"inherit",startIcon:Object(H.jsx)(Ut.a,{}),disabled:a,children:"Agregar CSD"})}),Object(H.jsxs)(qe.a,{maxWidth:"xs",fullWidth:!0,open:o,onClose:function(){return T()},children:[Object(H.jsx)(Bt.a,{children:"Registrar firma digital"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{mb:2,children:t.rfc?Object(H.jsx)(L.a,{children:"RFC: ".concat(t.rfc)}):Object(H.jsx)(L.a,{color:"error",children:"*No tienes registrado un RFC"})}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsxs)(L.a,{children:["Archivo *.cer ",Object(H.jsx)("b",{children:"Certificado de la firma Digital"})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(S.a,{fullWidth:!0,value:u.certificate?u.certificate.name:"",size:"small",variant:"outlined",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)("label",{htmlFor:"archivo-cer-sello-digital",children:Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(qt.a,{}),color:"primary",component:"span",disableElevation:!0,children:"Upload"})})}),readOnly:!0}}),Object(H.jsx)("input",{accept:".cer",style:{display:"none"},id:"archivo-cer-sello-digital",multiple:!0,type:"file",name:"certificate",onChange:R})]})]}),Object(H.jsxs)(O.a,{width:"100%",mt:2,children:[Object(H.jsxs)(L.a,{children:["Archivo *.key ",Object(H.jsx)("b",{children:"Llave Privada de la Firma Digital"})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(S.a,{fullWidth:!0,value:u.private_key?u.private_key.name:"",size:"small",variant:"outlined",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)("label",{htmlFor:"archivo-key-llave_privada",children:Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(qt.a,{}),color:"primary",component:"span",disableElevation:!0,children:"Upload"})})}),readOnly:!0}}),Object(H.jsx)("input",{accept:".key",style:{display:"none"},id:"archivo-key-llave_privada",multiple:!0,type:"file",name:"private_key",onChange:R})]})]}),Object(H.jsxs)(O.a,{width:"100%",my:2,children:[Object(H.jsxs)(L.a,{children:["Contrase\xf1a de la llave ",Object(H.jsx)("b",{children:"Privada de la Firma Digital"})]}),Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsx)(S.a,{fullWidth:!0,type:h?"text":"password",size:"small",variant:"outlined",name:"private_key_password",onChange:function(e){b(Object(m.a)(Object(m.a)({},u),{},{private_key_password:e.target.value}))},InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{onClick:function(){return _(!h)},onMouseDown:function(e){return e.preventDefault()},edge:"end",children:h?Object(H.jsx)(Jt.a,{}):Object(H.jsx)(Ht.a,{})})})}})})]})]}),Object(H.jsxs)(tt.a,{style:{justifyContent:"center"},children:[Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(Gt.a,{}),size:"large",onClick:function(){return T()},children:"Cancelar"}),Object(H.jsx)(F.a,{startIcon:k?Object(H.jsx)(I.a,{size:20}):Object(H.jsx)(Yt.a,{}),color:"primary",size:"large",onClick:function(){return M()},disabled:k||!u.rfc,children:"Guardar"})]})]})]})}var ia=a(916),oa=a(915);function sa(e){var t=e.datosEmpresa,a=e.refetch,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)({rfc:t&&t.rfc?t.rfc:"",empresa:n&&n.empresa._id?n.empresa._id:""}),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],x=p[1],h=Object(j.useState)({message:"",status:"",open:!1}),_=Object(y.a)(h,2),f=_[0],g=_[1],A=function(){o(!1),u({rfc:n&&t.rfc?t.rfc:"",empresa:n&&n.empresa._id?n.empresa._id:""})},S=Object(w.a)(aa),k=Object(y.a)(S,1)[0],N=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.rfc){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,x(!0),e.next=6,k({variables:{rfc:d.rfc,empresa:d.empresa}});case 6:t=e.sent,g({message:"\xa1Listo! ".concat(t.data.eliminarCSD.message),status:"success",open:!0}),x(!1),A(),a(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(2),x(!1),g({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:f,setAlert:g}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{onClick:function(){return o(!0)},color:"inherit",startIcon:Object(H.jsx)(oa.a,{}),children:"Remover CSD"})}),Object(H.jsxs)(qe.a,{maxWidth:"xs",fullWidth:!0,open:i,onClose:function(){return A()},children:[Object(H.jsx)(Bt.a,{children:"Eliminar Firma Digital"}),Object(H.jsx)(He.a,{children:Object(H.jsx)(ia.a,{children:"Se eliminara el CSD registrado con el RFC ".concat(t.rfc)})}),Object(H.jsxs)(tt.a,{style:{justifyContent:"center"},children:[Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(Gt.a,{}),size:"large",onClick:function(){return A()},children:"Cancelar"}),Object(H.jsx)(F.a,{startIcon:m?Object(H.jsx)(I.a,{size:20}):Object(H.jsx)(oa.a,{}),color:"secondary",size:"large",onClick:function(){return N()},disabled:m||!d.rfc,children:"Eliminar"})]})]})]})}var la=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}}}}));function da(e){var t=la(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=u.a.useState(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=u.a.useState(Object(j.useState)({error:!1,message:""})),b=Object(y.a)(d,2),p=b[0],x=b[1],h=Object(j.useState)({message:"",status:"",open:!1}),_=Object(y.a)(h,2),f=_[0],I=_[1],k=JSON.parse(localStorage.getItem("sesionCafi")),N=Object(j.useState)(!1===k.accesos.mi_empresa.informacion_fiscal.editar),P=Object(y.a)(N,1)[0],E=Object(j.useContext)(Le),D=E.empresa,z=E.setEmpresa,T=Object(w.a)(mt),$=Object(y.a)(T,1)[0],W=Object(j.useState)(!1),R=Object(y.a)(W,2),V=R[0],M=R[1],B=Object(j.useState)({nombre_fiscal:"",rfc:"",curp:"",info_adicio:"",regimen_fiscal:"",direccionFiscal:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},datosBancarios:{cuenta:"",sucursal:"",clave_banco:""}}),U=Object(y.a)(B,2),q=U[0],J=U[1],G=Object(rt.b)(pt,{variables:{id:k.empresa._id}}),Q=G.loading,K=G.data,X=G.refetch,Z=G.error;Object(j.useEffect)((function(){try{l(Z)}catch(e){}}),[Z]),Object(j.useEffect)((function(){try{if(void 0!==K){z(K.obtenerEmpresa);var e=k;e.empresa=K.obtenerEmpresa,localStorage.setItem("sesionCafi",JSON.stringify(e)),K.obtenerEmpresa.rfc?M(!1):M(!0)}}catch(t){}}),[K,z,k]),Object(j.useEffect)((function(){try{l(Z)}catch(e){}}),[Z]),Object(j.useEffect)((function(){try{r(Q)}catch(e){}}),[Q]),Object(j.useEffect)((function(){try{J({nombre_fiscal:D.nombre_fiscal,rfc:D.rfc,curp:D.curp,fecha_registro_sello_sat:D.fecha_registro_sello_sat?Dt()(D.fecha_registro_sello_sat).format("DD/MM/YYYY"):"",info_adicio:D.info_adicio,regimen_fiscal:D.regimen_fiscal,sello_sat:D.sello_sat,nombre_cer:D.nombre_cer,nombre_key:D.nombre_key,limite_timbres:D.limite_timbres,timbres_usados:D.timbres_usados,direccionFiscal:{calle:D.direccionFiscal.calle,no_ext:D.direccionFiscal.no_ext,no_int:D.direccionFiscal.no_int,codigo_postal:D.direccionFiscal.codigo_postal,colonia:D.direccionFiscal.colonia,municipio:D.direccionFiscal.municipio,localidad:D.direccionFiscal.localidad,estado:D.direccionFiscal.estado,pais:D.direccionFiscal.pais},datosBancarios:{cuenta:D.datosBancarios.cuenta,sucursal:D.datosBancarios.sucursal,clave_banco:D.datosBancarios.clave_banco}})}catch(e){}}),[D]);var te=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),delete q.fecha_registro_sello_sat,e.next=5,$({variables:{id:k.empresa._id,input:q}});case 5:r(!1),I({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),x(!1),X(),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(0),r(!1),I({message:"Hubo un error",status:"error",open:!0}),console.log(e.t0),e.t0.response?console.log(e.t0.response):e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 17:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),ae=function(e){J(Object(m.a)(Object(m.a)({},q),{},Object(g.a)({},e.target.name,e.target.value)))},ne=function(e){J(Object(m.a)(Object(m.a)({},q),{},{direccionFiscal:Object(m.a)(Object(m.a)({},q.direccionFiscal),{},Object(g.a)({},e.target.name,e.target.value))}))},ce=function(e){J(Object(m.a)(Object(m.a)({},q),{},{datosBancarios:Object(m.a)(Object(m.a)({},q.datosBancarios),{},Object(g.a)({},e.target.name,e.target.value))}))};return Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:f,setAlert:I}),Object(H.jsx)(st,{loading:c,setLoading:r}),s?Object(H.jsx)(bt,{error:s}):Object(H.jsxs)(A.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:1,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,className:t.require,children:[Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:[" ",Object(H.jsx)("span",{children:"* "}),"Nombre fiscal"]})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:P,type:"text",size:"small",error:p.error&&!q.nombre_fiscal,name:"nombre_fiscal",variant:"outlined",value:q.nombre_fiscal?q.nombre_fiscal:"",helperText:p.error&&"El campo nombre es obligatorio"!==p.message?p.message:"",onChange:ae})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"RFC"})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:P,size:"small",name:"rfc",variant:"outlined",value:q.rfc?q.rfc:"",onChange:ae})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:"R\xe9gimen fiscal"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"regimen_fiscal",children:Object(H.jsxs)(Nt.a,{value:q.regimen_fiscal?q.regimen_fiscal:"",name:"regimen_fiscal",onChange:ae,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Vt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"CURP"})}),Object(H.jsx)(S.a,{disabled:P,fullWidth:!0,size:"small",name:"curp",variant:"outlined",value:q.curp?q.curp:"",onChange:ae})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Info. Adicional"})}),Object(H.jsx)(S.a,{disabled:P,fullWidth:!0,size:"small",name:"info_adicio",variant:"outlined",value:q.info_adicio?q.info_adicio:"",onChange:ae,multiline:!0})]})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:t.subtitle,children:Object(H.jsx)("b",{children:"Firma digital"})}),Object(H.jsx)(et.a,{}),Object(H.jsx)(O.a,{m:1,children:!0===q.sello_sat?Object(H.jsx)(Mt.a,{severity:"success",action:Object(H.jsx)(sa,{firma_disabled:V,datosEmpresa:q,refetch:X}),children:Object(H.jsx)(Lt.a,{children:"Firma Digital Activa"})}):Object(H.jsxs)(Mt.a,{severity:"info",action:Object(H.jsx)(ra,{firma_disabled:V,datosEmpresa:q,refetch:X}),children:[Object(H.jsx)(Lt.a,{children:"Sin Firma Digital"}),"Sin esta firma no prodr\xe1s realizar facturas",V?Object(H.jsx)("li",{children:"Necesitas tener un RFC registrado"}):null]})}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Archivo *.cer"})}),Object(H.jsx)(S.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined",value:q.nombre_cer?q.nombre_cer:""})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Archivo *.key"})}),Object(H.jsx)(S.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined",value:q.nombre_key?q.nombre_key:""})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Fecha de registro"})}),Object(H.jsx)(S.a,{disabled:!0,fullWidth:!0,size:"small",variant:"outlined",value:q.fecha_registro_sello_sat})]})]})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{className:t.subtitle,children:Object(H.jsx)("b",{children:"Domicilio"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,xs:12,sm:4,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Calle"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:P,value:q.direccionFiscal.calle?q.direccionFiscal.calle:"",onChange:ne})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Num. Ext"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:P,value:q.direccionFiscal.no_ext?q.direccionFiscal.no_ext:"",onChange:ne})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Num. Int"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:P,value:q.direccionFiscal.no_int?q.direccionFiscal.no_int:"",onChange:ne})]})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,sm:4,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"C.P."})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:P,value:q.direccionFiscal.codigo_postal?q.direccionFiscal.codigo_postal:"",onChange:ne})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Colonia"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:P,value:q.direccionFiscal.colonia?q.direccionFiscal.colonia:"",onChange:ne})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Municipio"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:P,value:q.direccionFiscal.municipio?q.direccionFiscal.municipio:"",onChange:ne})]})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,sm:4,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Localidad"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:P,value:q.direccionFiscal.localidad?q.direccionFiscal.localidad:"",onChange:ne})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Estado"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:P,value:q.direccionFiscal.estado?q.direccionFiscal.estado:"",onChange:ne})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Pais"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:P,value:q.direccionFiscal.pais?q.direccionFiscal.pais:"",onChange:ne})]})]})]}),Object(H.jsxs)(O.a,{mt:1,children:[Object(H.jsx)(L.a,{className:t.subtitle,children:Object(H.jsx)("b",{children:"Datos bancarios"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Cuenta"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"cuenta",variant:"outlined",disabled:P,value:q.datosBancarios.cuenta?q.datosBancarios.cuenta:"",onChange:ce})]})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Sucursal"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"sucursal",variant:"outlined",disabled:P,value:q.datosBancarios.sucursal?q.datosBancarios.sucursal:"",onChange:ce})]})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Clave de banco"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"clave_banco",variant:"outlined",disabled:P,value:q.datosBancarios.clave_banco?q.datosBancarios.clave_banco:"",onChange:ce})]})})]}),!1===k.accesos.mi_empresa.informacion_fiscal.editar?null:Object(H.jsxs)(tt.a,{m:2,style:{marginTop:10,width:"100%",justifyContent:"center"},children:[Object(H.jsx)(F.a,{onClick:function(){e.setOpen(!1)},color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return te()},color:"primary",variant:"contained",children:"Guardar"})]})]})]})}var ja,ua,ba,pa,ma,Oa=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",border:"dashed 2px black",borderRadius:"100%"},avatar:{width:"90%",height:"90%","& > .icon":{fontSize:100}}}})),xa=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function ha(){var e=Oa(),t=Object(j.useState)(0),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=function(){s(!1)},d=function(){return 1===n?Object(H.jsx)(da,{setOpen:s}):Object(H.jsx)(xt,{setOpen:s})};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){s(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.k,{className:e.icon})}),"Datos de empresa"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:o,onClose:l,TransitionComponent:xa,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Datos"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:l,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(O.a,{children:Object(H.jsxs)(Ve.a,{indicatorColor:"primary",value:n,onChange:function(e,t){c(t)},"aria-label":"simple tabs example",centered:!0,children:[Object(H.jsx)(Me.a,{label:"Datos empresa",value:0}),Object(H.jsx)(Me.a,{label:"Datos fiscales",value:1})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(d,{})})]})]})}Object(P.d)(ja||(ja=Object(N.a)(["\n    query ObtenerSucursalesEmpresa($id: ID!){\n        obtenerSucursalesEmpresa(id: $id){\n            _id\n            nombre_sucursal\n            descripcion\n            usuario_sucursal\n            direccion{\n                calle\n                no_ext\n                no_int\n                codigo_postal\n                colonia\n                municipio\n                localidad\n                estado\n                pais\n            }\n            cuenta_sucursal {\n                efectivo\n            }         \n        }\n    }\n"])));var _a=Object(P.d)(ua||(ua=Object(N.a)(["\n    query obtenerDatosSucursal($id: ID!){\n        obtenerDatosSucursal(id: $id){\n            _id\n            nombre_sucursal\n            descripcion\n            usuario_sucursal\n            direccion{\n                calle\n                no_ext\n                no_int\n                codigo_postal\n                colonia\n                municipio\n                localidad\n                estado\n                pais\n            }\n            cuenta_sucursal {\n                efectivo\n            }         \n        }\n    }\n"]))),fa=Object(P.d)(ba||(ba=Object(N.a)(["\n  mutation editarSucursal($id: ID!, $input: EditarSucursal) {\n    editarSucursal(id: $id, input: $input) {\n         _id\n            nombre_sucursal\n            descripcion\n            usuario_sucursal\n            direccion{\n                calle\n                no_ext\n                no_int\n                codigo_postal\n                colonia\n                municipio\n                localidad\n                estado\n                pais\n            }\n            cuenta_sucursal {\n                efectivo\n            }         \n        }\n    }\n"]))),ga=Object(P.d)(pa||(pa=Object(N.a)(["\n    mutation CrearMovimientoCuenta($input: CrearMovimientoCuentaInput, $empresa: ID!, $sucursal: ID!, $tipo: Boolean){\n        crearMovimientoCuenta(input: $input, empresa: $empresa, sucursal: $sucursal, tipo: $tipo){\n            message\n        }\n    }\n"]))),va=Object(P.d)(ma||(ma=Object(N.a)(["\n    query ObtenerHistorialCuenta($empresa: ID!, $sucursal: ID!, $input: ObtenerHistorialCuenta, $tipo: Boolean, $limit: Int, $offset: Int){\n        obtenerHistorialCuenta(empresa: $empresa, sucursal: $sucursal, input: $input, tipo: $tipo, limit: $limit, offset: $offset){\n            saldo_en_caja\n            totalDocs\n            docs {\n                tipo_movimiento\n                id_usuario\n                numero_caja\n                id_Caja\n                numero_usuario_creador\n                nombre_usuario_creador\n                horario_turno\n                concepto\n                comentarios\n                montos_en_caja { \n                    monto_efectivo{\n                        monto \n                    }\n                }\n                fecha_movimiento{\n                    completa\n                }\n               \n                empresa\n                sucursal \n            }            \n        }\n    }\n"]))),Ca=["_id","usuario_sucursal","cuenta_sucursal"],ya=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},subtitle:{marginLeft:"10px",width:"100%"},require:{"& span":{color:"red"}}}})),Aa=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Sa(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=ya(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1===e.accesos.mi_empresa.datos_empresa.editar),o=Object(y.a)(i,1)[0],s=u.a.useState(!1),l=Object(y.a)(s,2),d=l[0],b=l[1],p=u.a.useState(!1),x=Object(y.a)(p,2),h=x[0],_=x[1],f=u.a.useState(!1),I=Object(y.a)(f,2),k=I[0],N=I[1],P=Object(j.useState)({message:"",status:"",open:!1}),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(w.a)(fa),$=Object(y.a)(T,1)[0],W=Object(rt.b)(_a,{variables:{id:e.sucursal._id}}),R=W.loading,V=W.data,M=W.refetch,B=W.error,U=Object(j.useState)({nombre_sucursal:"",descripcion:"",telefono:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}}),q=Object(y.a)(U,2),J=q[0],G=q[1];Object(j.useEffect)((function(){try{M()}catch(e){}}),[M]),Object(j.useEffect)((function(){try{r(R)}catch(e){}}),[R]),Object(j.useEffect)((function(){try{void 0!==V&&G(V.obtenerDatosSucursal[0])}catch(e){}}),[V,G]),Object(j.useEffect)((function(){try{_(B)}catch(e){}}),[B]);var Q=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var a;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(J.nombre_sucursal&&J.descripcion){t.next=3;break}return N(!0),t.abrupt("return");case 3:return t.prev=3,r(!0),J._id,J.usuario_sucursal,J.cuenta_sucursal,a=Object(De.a)(J,Ca),t.next=8,$({variables:{id:e.sucursal._id,input:a}});case 8:r(!1),z({message:"Se han actualizado correctamente los datos.",status:"success",open:!0}),N(!1),t.next=19;break;case 13:t.prev=13,t.t0=t.catch(3),console.log(t.t0),t.t0.networkError?console.log(t.t0.networkError.result):t.t0.graphQLErrors&&console.log(t.t0.graphQLErrors),z({message:"Hubo un error",status:"error",open:!0}),r(!1);case 19:case"end":return t.stop()}}),t,null,[[3,13]])})));return function(){return t.apply(this,arguments)}}(),K=function(){b(!1)},X=function(e){console.log(e.target.value),G(Object(m.a)(Object(m.a)({},J),{},Object(g.a)({},e.target.name,e.target.value)))},Z=function(e){G(Object(m.a)(Object(m.a)({},J),{},{direccion:Object(m.a)(Object(m.a)({},J.direccion),{},Object(g.a)({},e.target.name,e.target.value))}))};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){b(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.k,{className:t.icon})}),"Datos de sucursal"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:d,onClose:K,TransitionComponent:Aa,children:[Object(H.jsx)(Y,{alert:D,setAlert:z}),Object(H.jsx)(st,{loading:c,setLoading:r}),Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Datos"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:K,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(He.a,{children:h?Object(H.jsx)(bt,{error:h}):Object(H.jsxs)(A.a,{style:{marginTop:8},children:[Object(H.jsx)(Qe.a,{container:!0,spacing:3,className:t.require,children:Object(H.jsxs)(Qe.a,{item:!0,md:4,flexdirection:"row",children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:[Object(H.jsx)("span",{children:"* "}),"Nombre de sucursal"]})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:o,type:"text",size:"small",error:k&&!J.nombre_sucursal,name:"nombre_sucursal",variant:"outlined",value:J.nombre_sucursal?J.nombre_sucursal:"",helperText:k?"El campo nombre es obligatorio":"",onChange:X})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:[Object(H.jsx)("span",{children:"* "}),"Descripci\xf3n"]})}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:o,type:"text",size:"small",error:k&&!J.descripcion,name:"descripcion",variant:"outlined",value:J.descripcion?J.descripcion:"",helperText:k?"El campo nombre es obligatorio":"",onChange:X})]})]})}),Object(H.jsxs)(O.a,{mt:5,children:[Object(H.jsx)(L.a,{className:t.subtitle,children:Object(H.jsx)("b",{children:"Domicilio"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:3,className:t.require,children:[Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Calle"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",disabled:o,value:J.direccion.calle?J.direccion.calle:"",onChange:Z})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Num. Ext"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",disabled:o,value:J.direccion.no_ext?J.direccion.no_ext:"",onChange:Z})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Num. Int"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",disabled:o,value:J.direccion.no_int?J.direccion.no_int:"",onChange:Z})]})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"C.P."})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_postal",variant:"outlined",disabled:o,value:J.direccion.codigo_postal?J.direccion.codigo_postal:"",onChange:Z})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Colonia"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",disabled:o,value:J.direccion.colonia?J.direccion.colonia:"",onChange:Z})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Municipio"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",disabled:o,value:J.direccion.municipio?J.direccion.municipio:"",onChange:Z})]})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Localidad"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",disabled:o,value:J.direccion.localidad?J.direccion.localidad:"",onChange:Z})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Estado"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",disabled:o,value:J.direccion.estado?J.direccion.estado:"",onChange:Z})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Pais"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",disabled:o,value:J.direccion.pais?J.direccion.pais:"",onChange:Z})]})]})]})]})}),!1===e.accesos.mi_empresa.datos_empresa.editar?null:Object(H.jsxs)(tt.a,{style:{justifyContent:"center"},children:[Object(H.jsx)(F.a,{onClick:K,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return Q()},color:"primary",variant:"contained",autoFocus:!0,children:"Guardar"})]})]})]})}function Fa(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)("div",{children:Object(H.jsx)(Be,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:5,justifyContent:"center",children:[!1===e.accesos.mi_empresa.datos_empresa.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(ha,{})})}),Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Sa,{})})})]})})})}var Ia=a(20),ka=a(995),wa=a(847),Na=a(923),Pa=a(925),Ea=a(926),Da=a(927),za=a(928),Ta=a(931),$a=a(924),Wa=a(929),Ra=a(930),Va=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},Ma=function(e){for(var t="",a="0123456789",n=a.length,c=0;c<e;c++)t+=a.charAt(Math.floor(Math.random()*n));return t},La=function(e){return e?new Date(e).toLocaleDateString("es-MX",{weekday:"short",year:"numeric",month:"long",day:"numeric"}):null},Ba=function(e){return e?Dt()(e).locale("es-mx").format("ll"):null},Ua=function(e){if(e){return parseFloat(e).toFixed(2).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}return 0},qa=function e(t){if(Array.isArray(t))return t.map(e);if(null!==t&&"object"===typeof t){var a={};for(var n in t)"__typename"!==n&&(a[n]=e(t[n]));return a}return t},Ja=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,r,i;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,a=JSON.parse(localStorage.getItem("DatosVentas")),n=null===a?[]:a.productos,c=!1,r={producto:{},index:0},i=0;i<n.length;i++)n[i].codigo_barras?n[i].codigo_barras===t.codigo_barras&&(r={producto:n[i],index:i},c=!0):n[i].id_producto.datos_generales.clave_alterna===t.id_producto.datos_generales.clave_alterna&&n[i].unidad===t.unidad&&(r={producto:n[i],index:i},c=!0);return e.abrupt("return",{producto_found:r,found:c});case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),Ha=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,r,i,o,s,l,d,j,u,b,p,m,O,x,h,_,f;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.newP,n=t.cantidad,c=t.granel,r=t.origen,i=t.precio_boolean,o=void 0!==i&&i,s=t.precio,e.prev=1,0,0,0,0,0,0,0,O=n>0?n:1,x=c.granel?parseFloat(c.valor):1,h=o?s:a.descuento_activo?a.descuento:a.precio_unidad,_=!0===h.unidad_maxima?h.cantidad_unidads:1,u=h.iva_precio*_,b=h.ieps_precio*_,j=u+b,l=h.precio_venta*_,d=h.precio_neto*_,m=a.id_producto.precios.monedero?a.id_producto.precios.monedero_electronico*_:0,p=d-a.precio_unidad.precio_neto,f={ivaCalculo:parseFloat((u*x*O).toFixed(2)),iepsCalculo:parseFloat((b*x*O).toFixed(2)),impuestoCalculo:parseFloat((j*x*O).toFixed(2)),subtotalCalculo:parseFloat((l*x*O).toFixed(2)),totalCalculo:parseFloat((d*x*O).toFixed(2)),monederoCalculo:parseFloat((m*x*O).toFixed(2)),descuentoCalculo:parseFloat((p*x*O).toFixed(2)),newP:a},"Ventas1"===r?(a.cantidad_venta=x,a.granel_producto=c,a.precio_a_vender=f.totalCalculo,a.precio_actual_producto=parseFloat(h.precio_neto.toFixed(2)),a.precio_actual_object={cantidad_unidad:h.cantidad_unidad?h.cantidad_unidad:1,numero_precio:h.numero_precio?h.numero_precio:1,unidad_maxima:!!h.unidad_maxima&&h.unidad_maxima,precio_general:h.precio_general?parseFloat(h.precio_general.toFixed(2)):0,precio_neto:h.precio_neto?parseFloat(h.precio_neto.toFixed(2)):0,precio_venta:h.precio_venta?parseFloat(h.precio_venta.toFixed(2)):0,iva_precio:h.iva_precio?parseFloat(h.iva_precio.toFixed(2)):0,ieps_precio:h.ieps_precio?parseFloat(h.ieps_precio.toFixed(2)):0,utilidad:h.utilidad?h.utilidad:0,porciento:h.porciento?h.porciento:0,dinero_descontado:h.dinero_descontado?parseFloat(h.dinero_descontado.toFixed(2)):0}):"Ventas2"===r&&(c.granel&&(a.cantidad_venta=x),a.granel_producto=c,a.precio_a_vender=f.totalCalculo,a.precio_anterior=a.precio_actual_producto),e.abrupt("return",f);case 19:return e.prev=19,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),Ga=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,r,i,o,s,l,d,j,u,b,p,m,O,x,h,_,f;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.newP,n=t.cantidad,c=t.granel,r=t.origen,i=t.precio_boolean,o=void 0!==i&&i,s=t.precio,e.prev=1,0,0,0,0,0,0,0,O=n>0?n:1,x=c.granel?parseFloat(c.valor):1,h=o?s:a.descuento_activo?a.descuento:a.precio_unidad,_=!0===h.unidad_maxima?h.cantidad_unidads:1,u=h.iva_precio*_,b=h.ieps_precio*_,j=u+b,l=h.precio_venta*_,d=h.precio_neto*_,m=a.id_producto.precios.monedero?a.id_producto.precios.monedero_electronico*_:0,p=d-a.precio_unidad.precio_neto,console.log(d,x,O),f={ivaCalculo:parseFloat((u*O).toFixed(2)),iepsCalculo:parseFloat((b*O).toFixed(2)),impuestoCalculo:parseFloat((j*O).toFixed(2)),subtotalCalculo:parseFloat((l*O).toFixed(2)),totalCalculo:parseFloat((d*O).toFixed(2)),monederoCalculo:parseFloat((m*O).toFixed(2)),descuentoCalculo:parseFloat((p*O).toFixed(2)),newP:a},"Ventas1"===r?(a.cantidad_venta=x,a.granel_producto=c,a.precio_a_vender=f.totalCalculo,a.precio_actual_producto=parseFloat(h.precio_neto.toFixed(2)),a.precio_actual_object={cantidad_unidad:h.cantidad_unidad?h.cantidad_unidad:1,numero_precio:h.numero_precio?h.numero_precio:1,unidad_maxima:!!h.unidad_maxima&&h.unidad_maxima,precio_general:h.precio_general?parseFloat(h.precio_general.toFixed(2)):0,precio_neto:h.precio_neto?parseFloat(h.precio_neto.toFixed(2)):0,precio_venta:h.precio_venta?parseFloat(h.precio_venta.toFixed(2)):0,iva_precio:h.iva_precio?parseFloat(h.iva_precio.toFixed(2)):0,ieps_precio:h.ieps_precio?parseFloat(h.ieps_precio.toFixed(2)):0,utilidad:h.utilidad?h.utilidad:0,porciento:h.porciento?h.porciento:0,dinero_descontado:h.dinero_descontado?parseFloat(h.dinero_descontado.toFixed(2)):0}):"Ventas2"===r&&(c.granel&&(a.cantidad_venta=x),a.granel_producto=c,a.precio_a_vender=f.totalCalculo,a.precio_anterior=a.precio_actual_producto),e.abrupt("return",f);case 20:return e.prev=20,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(t){return e.apply(this,arguments)}}(),Ya=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,r,i;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=3;break}return e.abrupt("return",!1);case 3:if("XBX"!==t.codigo_unidad){e.next=5;break}return e.abrupt("return",!1);case 5:if(a=t.cantidad_venta,n=t.id_producto.precios.precios_producto.filter((function(e){return e.unidad_mayoreo>0&&e.precio_neto>0})),c={found:!1,pricing:0,number_pricing:0,object_prising:{}},r=n.length,!t.precio_seleccionado){e.next=11;break}return e.abrupt("return",c);case 11:if(!(a<t.id_producto.precios.precios_producto[1].unidad_mayoreo)){e.next=13;break}return e.abrupt("return",c={found:!0,pricing:t.descuento_activo?t.descuento.precio_neto:t.id_producto.precios.precios_producto[0].precio_neto,number_pricing:t.id_producto.precios.precios_producto[0].numero_precio,object_prising:t.descuento_activo?t.descuento:t.id_producto.precios.precios_producto[0]});case 13:i=0;case 14:if(!(i<n.length)){e.next=21;break}if(!(i+1===r&&a>=n[i].unidad_mayoreo)){e.next=17;break}return e.abrupt("return",c={found:!0,pricing:n[i].precio_neto,number_pricing:n[i].numero_precio,object_prising:n[i]});case 17:i+1<r&&a>=n[i].unidad_mayoreo&&a<n[i+1].unidad_mayoreo&&(c={found:!0,pricing:n[i].precio_neto,number_pricing:n[i].numero_precio,object_prising:n[i]});case 18:i++,e.next=14;break;case 21:return e.abrupt("return",c);case 24:return e.prev=24,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(t){return e.apply(this,arguments)}}();var Qa=function(e){var t=0;if("0.00"==(e=parseFloat(e))||"0"==e)return"CERO PESOS CON 00/100 MXN";var a,n,c,r,i,o=e.toString().split("."),s=function(e){for(var t=new Array,a=0;a<e.length;a++)t[a]=e.substr(a,1);return t}(o[0]);switch(s.length){case 1:t=Ka(s[0]);break;case 2:t=Xa(s[0],s[1]);break;case 3:t=Za(s[0],s[1],s[2]);break;case 4:t=function(e,t,a,n){var c=Ka(e)+" MIL "+Za(t,a,n);return c=c.replace("UN MIL ","MIL "),0==n?c.replace(" Y "," "):c}(s[0],s[1],s[2],s[3]);break;case 5:a=s[0],n=s[1],c=s[2],r=s[3],i=s[4],t=Xa(a,n)+" MIL "+Za(c,r,i);break;case 6:t=function(e,t,a,n,c,r){return Za(e,t,a)+" MIL "+Za(n,c,r)}(s[0],s[1],s[2],s[3],s[4],s[5])}return o[1]=isNaN(o[1])?"00":o[1],t+"PESOS CON "+o[1]+"/100 MXN"};function Ka(e){return Array("UN ","DOS ","TRES ","CUATRO ","CINCO ","SEIS ","SIETE ","OCHO ","NUEVE ")[e-1]}function Xa(e,t){var a=Array("ONCE ","DOCE ","TRECE ","CATORCE ","QUINCE","DIECISEIS ","DIECISIETE ","DIECIOCHO ","DIECINUEVE "),n=Array("DIEZ ","VEINTE ","TREINTA ","CUARENTA ","CINCUENTA ","SESENTA ","SETENTA ","OCHENTA ","NOVENTA ");return 0==e&&0==t?"":0==e&&t>0?Ka(t):1==e?0==t?n[e-1]:a[t-1]:2==e?0==t?n[e-1]:1==t?"VEINTIUN ":"VEINTI"+Ka(t):0==t?n[e-1]+" ":1==t?n[e-1]+" Y UNO":n[e-1]+" Y "+Ka(t)}function Za(e,t,a){var n=Array("CIENTO ","DOSCIENTOS ","TRESCIENTOS ","CUATROCIENTOS ","QUINIENTOS ","SEISCIENTOS ","SETECIENTOS ","OCHOCIENTOS ","NOVECIENTOS ");return 0==e&&0==t&&0==a?"":1==e&&0==t&&0==a?"CIEN ":0==e&&0==t&&a>0?Ka(a):0==t&&0==a?n[e-1]+"":0==t?(n[e-1]+""+Xa(t,a)).replace(" Y "," "):0==e?Xa(t,a):n[e-1]+""+Xa(t,a)}function en(){var e=Object(j.useContext)(Pe),t=e.datos_generales,a=e.unidadVentaXDefecto,n=e.setUnidadVentaXDefecto,c=e.unidadVentaSecundaria,r=e.setUnidadVentaSecundaria;return Object(H.jsx)(j.Fragment,{children:Object(H.jsx)(O.a,{children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{children:"Unidad"}),Object(H.jsx)(Da.a,{children:"Precio"}),Object(H.jsx)(Da.a,{children:"Cantidad"}),Object(H.jsx)(Da.a,{children:"Aplicar Descuento"}),Object(H.jsx)(Da.a,{children:"Unidad Principal"})]})}),Object(H.jsxs)(za.a,{children:[Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.codigo_barras}),Object(H.jsx)(Da.a,{children:a.unidad}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[a.descuento_activo&&null!==a.descuento_activo?Object(H.jsx)(Wa.a,{color:!0===a.descuento_activo?"primary":"action"}):null,Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:["$",Ua(a.descuento_activo&&!0===a.descuento_activo?a.descuento.precio_neto:a.precio)]})})]})}),Object(H.jsx)(Da.a,{children:a.cantidad}),Object(H.jsx)(Da.a,{children:a.descuento_activo&&null!==a.descuento_activo?Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ze.a,{checked:!0===a.descuento_activo&&a.descuento_activo,onChange:function(e){return t=e.target.checked,void n(Object(m.a)(Object(m.a)({},a),{},{descuento_activo:t}));var t},inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===a.descuento_activo}),Object(H.jsxs)(L.a,{color:"primary",children:["%",parseFloat(null!==a.descuento_activo?a.descuento.porciento:0)]})]}):null}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(Ze.a,{checked:a.unidad_principal,onChange:function(e){return t=e.target.checked,n(Object(m.a)(Object(m.a)({},a),{},{unidad_principal:!0})),void(t&&r(Object(m.a)(Object(m.a)({},c),{},{unidad_principal:!1})));var t},inputProps:{"aria-label":"primary checkbox"}})})]}),"OTROS"!==t.tipo_producto?null:Object(H.jsx)(tn,{})]})]})})})})}var tn=function(){var e=Object(j.useContext)(Pe),t=e.precios,a=e.unidadVentaXDefecto,n=e.setUnidadVentaXDefecto,c=e.unidadVentaSecundaria,r=e.setUnidadVentaSecundaria,i=Object(j.useState)(0),o=Object(y.a)(i,2),s=o[0],l=o[1];Object(j.useEffect)((function(){var e=c.descuento_activo&&!0===c.descuento_activo?c.descuento.precio_neto:c.precio;l(e)}),[c]);var d=function(e){var a=c.cantidad,n=c.precio_unidad;if(e&&a){var i=e/a,o=t.iva,s=t.ieps,l=t.unidad_de_compra,d=n.precio_venta,j=n.numero_precio,u=n.unidad_maxima,b=d/a,p=parseFloat("0.".concat(o<10?"0".concat(o):o))+parseFloat("0.".concat(s<10?"0".concat(s):s)),O=parseFloat(i/(p+1)),x=parseFloat((O/b*100).toFixed(2)),h=parseFloat(100-x),_=parseFloat(b*x/100),f=parseFloat(b-_),g=parseFloat(_*parseFloat("0.".concat(o<10?"0".concat(o):o))),v=parseFloat(_*parseFloat("0.".concat(s<10?"0".concat(s):s))),C=l.precio_unitario_sin_impuesto,y=parseFloat((_-C)/C*100),A=parseFloat(_+g+v),S=parseFloat(A*a);r(Object(m.a)(Object(m.a)({},c),{},{descuento:{cantidad_unidad:a,numero_precio:j,unidad_maxima:u,precio_general:parseFloat(S.toFixed(2)),precio_neto:parseFloat(S.toFixed(2)),precio_venta:parseFloat(_.toFixed(2)),iva_precio:parseFloat(g.toFixed(2)),ieps_precio:parseFloat(v.toFixed(2)),utilidad:parseFloat(y.toFixed(2)),porciento:parseFloat(h.toFixed(2)),dinero_descontado:parseFloat(f.toFixed(2))}}))}},u=function(e){var a=c.cantidad,n=c.precio_unidad,i=c.descuento;if(s&&a){var o=t.iva,d=t.ieps,j=t.unidad_de_compra,u=(n.precio_venta,n.numero_precio),b=n.unidad_maxima,p=s/a,O=parseFloat("0.".concat(o<10?"0".concat(o):o))+parseFloat("0.".concat(d<10?"0".concat(d):d)),x=parseFloat(p/(O+1)),h=parseFloat(x*i.porciento/100),_=parseFloat(x-h),f=parseFloat(h*parseFloat("0.".concat(o<10?"0".concat(o):o))),g=parseFloat(h*parseFloat("0.".concat(d<10?"0".concat(d):d))),v=j.precio_unitario_sin_impuesto,C=parseFloat((h-v)/v*100),y=parseFloat(h+f+g),A=parseFloat(y*a);l(A),r(Object(m.a)(Object(m.a)({},c),{},{descuento_activo:e,precio:s,descuento:{cantidad_unidad:a,numero_precio:u,unidad_maxima:b,precio_general:parseFloat(A.toFixed(2)),precio_neto:parseFloat(A.toFixed(2)),precio_venta:parseFloat(h.toFixed(2)),iva_precio:parseFloat(f.toFixed(2)),ieps_precio:parseFloat(g.toFixed(2)),utilidad:parseFloat(C.toFixed(2)),porciento:i.porciento,dinero_descontado:parseFloat(_.toFixed(2))}}))}},b=function(e){if(""===e.target.value)return r(Object(m.a)(Object(m.a)({},c),{},{unidad_principal:!1,precio:0})),void n(Object(m.a)(Object(m.a)({},a),{},{unidad_principal:!0}));if(c.precio&&c.cantidad){var i=c.cantidad,o=t.iva,l=t.ieps,d=parseFloat("0.".concat(o<10?"0".concat(o):o))+parseFloat("0.".concat(l<10?"0".concat(l):l)),j=parseFloat(s/i),u=parseFloat(j/(d+1)),b=t.unidad_de_compra.precio_unitario_sin_impuesto,p=parseFloat(u*parseFloat("0.".concat(o<10?"0".concat(o):o))),O=parseFloat(u*parseFloat("0.".concat(l<10?"0".concat(l):l))),x=parseFloat((u-b)/b*100),h=u*i,_=j*i,f=Object(m.a)(Object(m.a)({},c),{},{precio:s,cantidad:i,precio_unidad:{numero_precio:1,precio_venta:parseFloat(h.toFixed(2)),precio_neto:parseFloat(_.toFixed(2)),unidad_mayoreo:0,iva_precio:parseFloat((i*p).toFixed(2)),ieps_precio:parseFloat((i*O).toFixed(2)),utilidad:parseFloat(x.toFixed(2)),unidad_maxima:!0,precio_general:s,cantidad_unidad:i}});r(f)}};return Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{width:220,children:Object(H.jsx)(ee.a,{variant:"outlined",size:"small",name:"codigo_barras",children:Object(H.jsx)(ae.a,{id:"input-codigo-barras",name:"codigo_barras",value:c.codigo_barras,endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{size:"small",color:"primary",onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();r(Object(m.a)(Object(m.a)({},c),{},{codigo_barras:t}))}()},children:Object(H.jsx)(Ra.a,{})})})})})}),Object(H.jsx)(Da.a,{children:c.unidad}),Object(H.jsx)(Da.a,{width:200,children:Object(H.jsx)(S.a,{type:"number",name:"precio",variant:"outlined",size:"small",onBlur:function(e){return b(e)},onChange:function(e){var t=e.target.value;t&&(t=parseFloat(t)),c.descuento_activo&&!0===c.descuento_activo?(console.log("a"),l(t),d(t)):l(t)},value:s,disabled:null!==c.descuento_activo&&!0===c.descuento_activo,InputProps:{inputProps:{min:0},startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"}),endAdornment:Object(H.jsx)(ne.a,{position:"end",children:null!==c.descuento_activo?Object(H.jsx)(Wa.a,{color:c.descuento_activo?"primary":"disabled"}):null})}})}),Object(H.jsx)(Da.a,{width:110,children:Object(H.jsx)(Ta.a,{title:Object(H.jsx)(L.a,{variant:"subtitle2",children:"Pz/Kg por Unidad"}),placement:"top",arrow:!0,children:Object(H.jsx)(S.a,{InputProps:{inputProps:{min:0}},type:"number",variant:"outlined",size:"small",name:"cantidad",onBlur:b,onChange:function(e){var t=e.target.value;t&&(t=parseFloat(t)),r(Object(m.a)(Object(m.a)({},c),{},{cantidad:t}))},value:c.cantidad})})}),Object(H.jsx)(Da.a,{children:null!==c.descuento_activo?Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ze.a,{checked:!!c.descuento_activo&&c.descuento_activo,onChange:function(e){return function(e){var t=e?c.descuento.precio_neto:c.precio;e?u(e):(r(Object(m.a)(Object(m.a)({},c),{},{descuento_activo:e})),l(t))}(e.target.checked)},inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===c.descuento_activo}),Object(H.jsxs)(L.a,{color:"primary",children:["%",parseFloat(c.descuento&&null!==c.descuento?c.descuento.porciento:0)]})]}):null}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(Ze.a,{checked:c.unidad_principal,onChange:function(e){return t=e.target.checked,r(Object(m.a)(Object(m.a)({},c),{},{unidad_principal:!0})),void(t&&n(Object(m.a)(Object(m.a)({},a),{},{unidad_principal:!1})));var t},inputProps:{"aria-label":"primary checkbox"},disabled:0===c.precio})})]})},an=a(49),nn=Object(k.a)((function(e){return{precioTitle:{width:e.spacing(20)},marginInput:{marginTop:19},titulos:{fontWeight:500}}}));function cn(){var e=Object(j.useContext)(Pe).preciosP,t=Object(Ia.a)(e);return Object(H.jsx)(j.Fragment,{children:e.map((function(e,a){return Object(H.jsx)(rn,{data:e,index:a,newPreciosP:t},a)}))})}var rn=function(e){var t=e.data,a=e.index,n=e.newPreciosP,c=nn(),r=Object(j.useContext)(Pe),i=r.preciosP,o=r.precios,s=r.unidadVentaXDefecto,l=r.setUnidadVentaXDefecto,d=r.setPreciosP,u=r.unidadVentaSecundaria,b=r.setUnidadVentaSecundaria,p=Object(m.a)({},i[a]),x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=function(){var e=o.iva,t=o.ieps,c=s.descuento,r=s.descuento_activo,i=u.cantidad,j=u.descuento,O=u.descuento_activo,x=o.unidad_de_compra.precio_unitario_sin_impuesto,h=p.utilidad?p.utilidad:0,_=parseFloat(x*(h/100)+x),f=_*parseFloat("0.".concat(e<10?"0".concat(e):e)),g=_*parseFloat("0.".concat(t<10?"0".concat(t):t)),v=parseFloat(_+(f+g));p.precio_venta=parseFloat(_.toFixed(2)),p.precio_neto=parseFloat(v.toFixed(2)),p.iva_precio=parseFloat(f.toFixed(2)),p.ieps_precio=parseFloat(g.toFixed(2));var C=Object(m.a)(Object(m.a)({},s),{},{precio:v,precio_unidad:{numero_precio:p.numero_precio,precio_neto:parseFloat(v.toFixed(2)),precio_venta:parseFloat(_.toFixed(2)),unidad_mayoreo:p.unidad_mayoreo,iva_precio:parseFloat(f.toFixed(2)),ieps_precio:parseFloat(g.toFixed(2)),utilidad:p.utilidad,unidad_maxima:!1}}),y=Object(m.a)(Object(m.a)({},u),{},{precio:parseFloat((i*v).toFixed(2)),precio_unidad:{numero_precio:p.numero_precio,precio_neto:parseFloat((i*v).toFixed(2)),precio_venta:parseFloat((i*_).toFixed(2)),unidad_mayoreo:p.unidad_mayoreo,iva_precio:parseFloat((i*f).toFixed(2)),ieps_precio:parseFloat((i*g).toFixed(2)),utilidad:p.utilidad,unidad_maxima:!1}});if(1===p.numero_precio){if(!0===r){var A=_*c.porciento/100,S=A+(A*parseFloat("0.".concat(e<10?"0".concat(e):e))+A*parseFloat("0.".concat(t<10?"0".concat(t):t)));C=Object(m.a)(Object(m.a)({},C),{},{precio:parseFloat(v.toFixed(2)),descuento:Object(m.a)(Object(m.a)({},s.descuento),{},{precio_neto:S})})}if(!0===O){var F=_*j.porciento/100,I=F+(F*parseFloat("0.".concat(e<10?"0".concat(e):e))+F*parseFloat("0.".concat(t<10?"0".concat(t):t)));y=Object(m.a)(Object(m.a)({},y),{},{precio:parseFloat((i*v).toFixed(2)),descuento:Object(m.a)(Object(m.a)({},u.descuento),{},{precio_neto:parseFloat((i*I).toFixed(2))})})}l(C),b(y)}n.splice(a,1,p),d(n)};Object(j.useEffect)((function(){(1===p.numero_precio||p.numero_precio>1&&p.precio_neto)&&g()}),[o.unidad_de_compra.precio_unitario_con_impuesto]);var v=function(e,t){switch(e){case"utilidad":t||(p.utilidad=0,p.precio_neto=p.numero_precio>1?0:o.unidad_de_compra.precio_unitario_con_impuesto,n.splice(a,1,p),d(n),f(!1));break;case"precio_neto":t||(p.precio_neto=p.numero_precio>1?0:o.unidad_de_compra.precio_unitario_con_impuesto,p.utilidad=0,n.splice(a,1,p),d(n),f(!1));break;case"unidad_mayoreo":t||(p.unidad_mayoreo=0,n.splice(a,1,p),d(n))}};return Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(O.a,{display:"flex",my:1,mr:1,children:[Object(H.jsx)(O.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(H.jsx)(L.a,{className:c.precioTitle,children:Object(H.jsx)("b",{children:"Utilidad"})})}),Object(H.jsxs)(O.a,{minWidth:130,children:[Object(H.jsxs)(L.a,{className:c.titulos,children:["Precio ",t.numero_precio]}),Object(H.jsx)(O.a,{mb:2}),Object(H.jsx)(S.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"%"})},size:"small",value:p.utilidad,name:"utilidad",variant:"outlined",onChange:function(e){return function(e){if(!e)return p.utilidad="",n.splice(a,1,p),void d(n);var t=o.unidad_de_compra.precio_unitario_sin_impuesto,c=s.descuento,r=s.descuento_activo,i=u.cantidad,j=u.descuento,O=u.descuento_activo,x=o.iva,h=o.ieps,_=t*(e/100)+t,g=_*parseFloat("0.".concat(x<10?"0".concat(x):x)),v=_*parseFloat("0.".concat(h<10?"0".concat(h):h)),C=_+(g+v);p.utilidad=parseFloat(e),p.precio_venta=parseFloat(_.toFixed(2)),p.iva_precio=parseFloat(g.toFixed(2)),p.ieps_precio=parseFloat(v.toFixed(2));var y=o.unidad_de_compra.precio_unitario_con_impuesto;f(C<y&&0!==C),p.precio_neto=parseFloat(C.toFixed(2));var A=Object(m.a)(Object(m.a)({},s),{},{precio:C,precio_unidad:{numero_precio:p.numero_precio,precio_neto:parseFloat(C.toFixed(2)),precio_venta:parseFloat(_.toFixed(2)),unidad_mayoreo:p.unidad_mayoreo,iva_precio:parseFloat(g.toFixed(2)),ieps_precio:parseFloat(v.toFixed(2)),utilidad:p.utilidad,unidad_maxima:!1}}),S=Object(m.a)(Object(m.a)({},u),{},{precio:parseFloat((i*C).toFixed(2)),precio_unidad:{numero_precio:p.numero_precio,precio_neto:parseFloat((i*C).toFixed(2)),precio_venta:parseFloat((i*_).toFixed(2)),unidad_mayoreo:p.unidad_mayoreo,iva_precio:parseFloat((i*g).toFixed(2)),ieps_precio:parseFloat((i*v).toFixed(2)),utilidad:p.utilidad,unidad_maxima:!1}});if(1===p.numero_precio){if(!0===r){var F=_*c.porciento/100,I=F+(F*parseFloat("0.".concat(x<10?"0".concat(x):x))+F*parseFloat("0.".concat(h<10?"0".concat(h):h)));A=Object(m.a)(Object(m.a)({},A),{},{precio:parseFloat(C.toFixed(2)),descuento:Object(m.a)(Object(m.a)({},s.descuento),{},{precio_neto:I})}),A=Object(m.a)(Object(m.a)({},S),{},{precio:parseFloat(C.toFixed(2)),descuento:Object(m.a)(Object(m.a)({},u.descuento),{},{precio_neto:I})})}if(!0===O){var k=_*j.porciento/100,w=k+(k*parseFloat("0.".concat(x<10?"0".concat(x):x))+k*parseFloat("0.".concat(h<10?"0".concat(h):h)));S=Object(m.a)(Object(m.a)({},S),{},{precio:parseFloat((i*C).toFixed(2)),descuento:Object(m.a)(Object(m.a)({},u.descuento),{},{precio_neto:parseFloat((i*w).toFixed(2))})})}l(A),b(S)}n.splice(a,1,p),d(n)}(e.target.value)},onBlur:function(){return v("utilidad",p.utilidad)},error:""===p.utilidad})]})]}),Object(H.jsxs)(O.a,{display:"flex",my:2,mr:1,children:[Object(H.jsx)(O.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(H.jsxs)(O.a,{alignItems:"flex-end",flexDirection:"column",display:t.numero_precio>1?"none":"flex",children:[Object(H.jsx)(L.a,{className:c.precioTitle,children:Object(H.jsx)("b",{children:"Precio de venta"})}),Object(H.jsx)(L.a,{className:c.precioTitle,variant:"caption",color:"textSecondary",children:"(precio sin impuestos)"})]})}),Object(H.jsx)(O.a,{pl:1,children:Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:["$",parseFloat(p.precio_venta.toFixed(2))]})})})]}),Object(H.jsxs)(O.a,{display:"flex",my:1,mr:1,children:[Object(H.jsxs)(O.a,{alignItems:"flex-end",flexDirection:"column",display:t.numero_precio>1?"none":"flex",children:[Object(H.jsx)(L.a,{className:c.precioTitle,children:Object(H.jsx)("b",{children:"Precio venta neto"})}),Object(H.jsx)(L.a,{className:c.precioTitle,variant:"caption",color:"textSecondary",children:"(precio con impuestos)"})]}),Object(H.jsx)(O.a,{className:t.numero_precio>1?c.marginInput:"",children:Object(H.jsx)(S.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},size:"small",name:"precio_neto",variant:"outlined",value:p.precio_neto,onChange:function(e){return function(e){if(!e)return p.precio_neto="",n.splice(a,1,p),void d(n);var t=parseFloat(e),c=s.descuento,r=s.descuento_activo,i=u.cantidad,j=u.descuento,O=u.descuento_activo,x=o.iva,h=o.ieps,_=o.unidad_de_compra.precio_unitario_sin_impuesto,g=parseFloat("0.".concat(x<10?"0".concat(x):x))+parseFloat("0.".concat(h<10?"0".concat(h):h)),v=parseFloat(t/(g+1)),C=v*parseFloat("0.".concat(x<10?"0".concat(x):x)),y=v*parseFloat("0.".concat(h<10?"0".concat(h):h)),A=(t-(C+y)-_)/_*100;p.precio_neto=parseFloat(t.toFixed(2)),p.precio_venta=parseFloat(v.toFixed(2)),p.iva_precio=parseFloat(C.toFixed(2)),p.ieps_precio=parseFloat(y.toFixed(2)),p.utilidad=parseFloat(A.toFixed(2));var S=o.unidad_de_compra.precio_unitario_con_impuesto;f(t<S&&0!==t);var F=Object(m.a)(Object(m.a)({},s),{},{precio:t,precio_unidad:{numero_precio:p.numero_precio,precio_neto:parseFloat(t.toFixed(2)),precio_venta:parseFloat(v.toFixed(2)),unidad_mayoreo:p.unidad_mayoreo,iva_precio:parseFloat(C.toFixed(2)),ieps_precio:parseFloat(y.toFixed(2)),utilidad:p.utilidad,unidad_maxima:!1}}),I=Object(m.a)(Object(m.a)({},u),{},{precio:parseFloat((i*t).toFixed(2)),precio_unidad:{numero_precio:p.numero_precio,precio_neto:parseFloat((i*t).toFixed(2)),precio_venta:parseFloat((i*v).toFixed(2)),unidad_mayoreo:p.unidad_mayoreo,iva_precio:parseFloat((i*C).toFixed(2)),ieps_precio:parseFloat((i*y).toFixed(2)),utilidad:p.utilidad,unidad_maxima:!1}});if(1===p.numero_precio){if(!0===r){var k=v*c.porciento/100,w=k+(k*parseFloat("0.".concat(x<10?"0".concat(x):x))+k*parseFloat("0.".concat(h<10?"0".concat(h):h)));F=Object(m.a)(Object(m.a)({},F),{},{precio:parseFloat(t.toFixed(2)),descuento:Object(m.a)(Object(m.a)({},s.descuento),{},{precio_neto:w})})}if(!0===O){var N=v*j.porciento/100,P=N+(N*parseFloat("0.".concat(x<10?"0".concat(x):x))+N*parseFloat("0.".concat(h<10?"0".concat(h):h)));I=Object(m.a)(Object(m.a)({},I),{},{precio:parseFloat((i*t).toFixed(2)),descuento:Object(m.a)(Object(m.a)({},u.descuento),{},{precio_neto:parseFloat((i*P).toFixed(2))})})}l(F),b(I)}n.splice(a,1,p),d(n)}(e.target.value)},onBlur:function(){return v("precio_neto",p.precio_neto)},error:""===p.precio_neto||_,helperText:_?"Precio menor a costo":""})})]}),Object(H.jsxs)(O.a,{display:"flex",my:2,mr:1,children:[Object(H.jsx)(O.a,{alignItems:"flex-end",display:t.numero_precio>1?"none":"flex",children:Object(H.jsx)(L.a,{className:c.precioTitle,children:Object(H.jsx)("b",{children:"Unidad por mayoreo"})})}),t.numero_precio>1?Object(H.jsx)(O.a,{children:Object(H.jsx)(S.a,{disabled:!parseFloat(o.unidad_de_compra.precio_unitario_sin_impuesto),fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"unidad_mayoreo",variant:"outlined",value:p.unidad_mayoreo,onChange:function(e){return function(e){if(!e)return p.unidad_mayoreo="",n.splice(a,1,p),void d(n);p.unidad_mayoreo=parseInt(e),n.splice(a,1,p),d(n)}(e.target.value)},onBlur:function(){return v("unidad_mayoreo",p.unidad_mayoreo)},error:""===p.unidad_mayoreo})}):null]})]})},on=[{unidad:"Pz",codigo_unidad:"H87"},{unidad:"Caja",codigo_unidad:"XBX"}],sn=[{unidad:"Kg",codigo_unidad:"KGM"},{unidad:"Lt",codigo_unidad:"LTR"},{unidad:"Costal",codigo_unidad:"KGM"}],ln=function(e,t,a){var n=0,c=0,r=0,i=0,o=0,s=0;return"iva_activo"===e?t?(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=.16*parseFloat(c))+(i=parseFloat(c)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)),o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad):(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=0)+(i=parseFloat(c)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)),o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad,a.ieps_activo||(n=0,s=c/a.unidad_de_compra.cantidad)):(s=(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(t<10?".0"+t:"."+t))+(i=parseFloat(c)*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps)))/a.unidad_de_compra.cantidad,o=c/a.unidad_de_compra.cantidad),Object(m.a)(Object(m.a)({},a),{},{iva_activo:"iva_activo"===e?t:a.iva_activo,iva:"iva"===e?parseFloat(t):t?16:0,precio_de_compra:Object(m.a)(Object(m.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(c.toFixed(2)),iva:parseFloat(r.toFixed(2)),ieps:parseFloat(i.toFixed(2)),precio_con_impuesto:parseFloat(n.toFixed(2))}),unidad_de_compra:Object(m.a)(Object(m.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(o.toFixed(2)),precio_unitario_con_impuesto:parseFloat(s.toFixed(2))})})},dn=function(e,t,a){var n=0,c=0,r=0,i=0,o=0,s=0;return"ieps_activo"===e?t?(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+(i=parseFloat(c)*a.ieps),o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad):(i=0,n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+i,o=c/a.unidad_de_compra.cantidad,s=n/a.unidad_de_compra.cantidad,a.iva_activo||(n=0,s=c/a.unidad_de_compra.cantidad)):(s=(n=(c=parseFloat(a.precio_de_compra.precio_sin_impuesto))+(r=parseFloat(c)*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva))+(i=parseFloat(c)*parseFloat(t<10?".0"+t:"."+t)))/a.unidad_de_compra.cantidad,o=c/a.unidad_de_compra.cantidad),Object(m.a)(Object(m.a)({},a),{},{ieps_activo:"ieps_activo"===e?t:a.ieps_activo,ieps:"ieps"===e?parseFloat(t):t?a.ieps:0,precio_de_compra:Object(m.a)(Object(m.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(c.toFixed(2)),iva:parseFloat(r.toFixed(2)),ieps:parseFloat(i.toFixed(2)),precio_con_impuesto:parseFloat(n.toFixed(2))}),unidad_de_compra:Object(m.a)(Object(m.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(o.toFixed(2)),precio_unitario_con_impuesto:parseFloat(s.toFixed(2))})})},jn=Object(k.a)((function(e){return{required:{color:"red"},precioTitle:{width:e.spacing(20),display:"flex",alignItems:"center"},titulos:{fontWeight:500}}}));function un(){var e=jn(),t=Object(j.useContext)(Pe),a=t.precios,n=t.setPrecios,c=t.validacion,r=(t.preciosP,t.update),i=t.unidadVentaXDefecto,o=t.setUnidadVentaXDefecto,s=t.unidadVentaSecundaria,l=t.setUnidadVentaSecundaria,d=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var c,r,i;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("iva"!==t.target.name||t.target.value){e.next=3;break}return n(Object(m.a)(Object(m.a)({},a),{},{iva:""})),e.abrupt("return");case 3:return c=t.target.name,r="iva_activo"===c?t.target.checked:t.target.value,e.next=7,ln(c,r,a);case 7:i=e.sent,h(i.precio_de_compra.precio_con_impuesto),F(i.precio_de_compra.precio_sin_impuesto),N(i.precio_de_compra.precio_con_impuesto),z(i.precio_de_compra.precio_sin_impuesto),n(i);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var c,r,i;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ieps"!==t.target.name||t.target.value){e.next=3;break}return n(Object(m.a)(Object(m.a)({},a),{},{ieps:""})),e.abrupt("return");case 3:return c=t.target.name,r="ieps_activo"===c?t.target.checked:t.target.value,e.next=7,dn(c,r,a);case 7:i=e.sent,h(i.precio_de_compra.precio_con_impuesto),F(i.precio_de_compra.precio_sin_impuesto),N(i.precio_de_compra.precio_con_impuesto),z(i.precio_de_compra.precio_sin_impuesto),n(i);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=Object(j.useState)(a.precio_de_compra.precio_con_impuesto),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useState)(a.precio_de_compra.precio_sin_impuesto),f=Object(y.a)(_,2),A=f[0],F=f[1],I=Object(j.useState)(a.precio_de_compra.precio_con_impuesto),k=Object(y.a)(I,2),w=k[0],N=k[1],P=Object(j.useState)(a.precio_de_compra.precio_sin_impuesto),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(an.useDebounce)(w,800),$=Object(y.a)(T,1)[0],W=Object(an.useDebounce)(D,800),R=Object(y.a)(W,1)[0],V=function(e,t){if("unidad"===e.target.name){var c=t.props.unidad,r=c.codigo_unidad,d=c.unidad,j=a.unidad_de_compra.cantidad*i.precio;"Caja"===d||"Costal"===d?(l(Object(m.a)(Object(m.a)({},s),{},{precio:parseFloat(j.toFixed(2)),codigo_unidad:r,unidad:d,unidad_activa:!0,unidad_principal:!0})),o(Object(m.a)(Object(m.a)({},i),{},{unidad:"Caja"===d?"Pz":"kg",codigo_unidad:"Caja"===d?"H87":"KGM",cantidad:1,precio:i.precio,unidad_principal:!1}))):(o(Object(m.a)(Object(m.a)({},i),{},{unidad:"Pz"===d?"Pz":"Lt"===d?"Lt ":"kg",codigo_unidad:"Pz"===d?"H87":"Lt"===d?"LTR":"KGM",cantidad:1,precio:i.precio,unidad_principal:!0})),l(Object(m.a)(Object(m.a)({},s),{},{precio:parseFloat(j.toFixed(2)),codigo_unidad:"Pz"===d?"XBX":"Lt"===d?"LTR":"KGM",unidad:"Pz"===d?"Caja":"Caja"===d?"LTR":"Costal",unidad_activa:!1,unidad_principal:!1}))),n(Object(m.a)(Object(m.a)({},a),{},{unidad_de_compra:Object(m.a)(Object(m.a)({},a.unidad_de_compra),{},{unidad:d,codigo_unidad:r,cantidad:1}),inventario:Object(m.a)(Object(m.a)({},a.inventario),{},{unidad_de_inventario:d,codigo_unidad:r})}))}else{var u,b;if(a.iva_activo||a.ieps_activo)n(Object(m.a)(Object(m.a)({},a),{},{unidad_de_compra:Object(m.a)(Object(m.a)({},a.unidad_de_compra),{},(u={},Object(g.a)(u,e.target.name,parseFloat(e.target.value)),Object(g.a)(u,"precio_unitario_sin_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),Object(g.a)(u,"precio_unitario_con_impuesto",parseFloat((a.precio_de_compra.precio_con_impuesto/e.target.value).toFixed(2))),u))}));else n(Object(m.a)(Object(m.a)({},a),{},{unidad_de_compra:Object(m.a)(Object(m.a)({},a.unidad_de_compra),{},(b={},Object(g.a)(b,e.target.name,parseFloat(e.target.value)),Object(g.a)(b,"precio_unitario_sin_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),Object(g.a)(b,"precio_unitario_con_impuesto",parseFloat((a.precio_de_compra.precio_sin_impuesto/e.target.value).toFixed(2))),b))}));"Caja"!==a.unidad_de_compra.unidad&&"Costal"!==a.unidad_de_compra.unidad||l(Object(m.a)(Object(m.a)({},s),{},{cantidad:parseFloat(e.target.value)})),o(Object(m.a)(Object(m.a)({},i),{},{cantidad:1}))}},M=Object(j.useState)(0),B=Object(y.a)(M,2),U=B[0],q=B[1];return Object(j.useEffect)((function(){0!==U&&function(e){var t,c=0,r=0,i=0,o=0,s=0,l=0;c=parseFloat(e),t=parseFloat(a.iva<10?".0"+a.iva:"."+a.iva)+parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps),i=(r=c/parseFloat(t+1))*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva),o=r*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps),l=c/a.unidad_de_compra.cantidad,s=r/a.unidad_de_compra.cantidad,isNaN(s)&&(s=0),isNaN(l)&&(l=0),isNaN(i)&&(i=0),isNaN(o)&&(o=0),F(parseFloat(r.toFixed(2))),n(Object(m.a)(Object(m.a)({},a),{},{precio_de_compra:Object(m.a)(Object(m.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(r.toFixed(2)),iva:parseFloat(i.toFixed(2)),ieps:parseFloat(o.toFixed(2)),precio_con_impuesto:parseFloat(c.toFixed(2))}),unidad_de_compra:Object(m.a)(Object(m.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(s.toFixed(2)),precio_unitario_con_impuesto:parseFloat(l.toFixed(2))})}))}($)}),[$]),Object(j.useEffect)((function(){0!==U&&function(e){var t=0,c=0,r=0,i=0,o=0,s=0;t=(c=parseFloat(e))+(r=parseFloat(c*parseFloat(a.iva<10?".0"+a.iva:"."+a.iva)))+(i=parseFloat(c*parseFloat(a.ieps<10?".0"+a.ieps:"."+a.ieps))),o=c/a.unidad_de_compra.cantidad,s=t/a.unidad_de_compra.cantidad,a.iva_activo||a.ieps_activo||(t=c,s=c/a.unidad_de_compra.cantidad),isNaN(o)&&(o=0),isNaN(s)&&(s=0),isNaN(r)&&(r=0),isNaN(i)&&(i=0),h(parseFloat(t.toFixed(2))),n(Object(m.a)(Object(m.a)({},a),{},{precio_de_compra:Object(m.a)(Object(m.a)({},a.precio_de_compra),{},{precio_sin_impuesto:parseFloat(c.toFixed(2)),iva:parseFloat(r.toFixed(2)),ieps:parseFloat(i.toFixed(2)),precio_con_impuesto:parseFloat(t.toFixed(2))}),unidad_de_compra:Object(m.a)(Object(m.a)({},a.unidad_de_compra),{},{precio_unitario_sin_impuesto:parseFloat(o.toFixed(2)),precio_unitario_con_impuesto:parseFloat(s.toFixed(2))})}))}(R)}),[R]),Object(H.jsx)(O.a,{children:Object(H.jsxs)("div",{children:[Object(H.jsxs)(O.a,{mb:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Impuestos"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{noWrap:!0,className:e.titulos,children:"IVA"}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:!a.iva_activo,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(H.jsxs)(ne.a,{position:"start",children:[Object(H.jsx)(Ze.a,{checked:a.iva_activo,onChange:d,name:"iva_activo"}),Object(H.jsx)(L.a,{children:"%"})]})},size:"small",name:"iva",id:"form-producto-iva",variant:"outlined",value:a.iva,onChange:d,onFocus:function(e){var t=e.target,c=t.name,r=t.value;0===parseFloat(r)&&n(Object(m.a)(Object(m.a)({},a),{},Object(g.a)({},c,"")))},onBlur:function(e){var t=e.target,c=t.name;t.value||n(Object(m.a)(Object(m.a)({},a),{},Object(g.a)({},c,16)))},error:""===a.iva})]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{noWrap:!0,className:e.titulos,children:"porcentaje IEPS"}),Object(H.jsx)(S.a,{disabled:!a.ieps_activo,fullWidth:!0,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(H.jsxs)(ne.a,{position:"start",children:[Object(H.jsx)(Ze.a,{checked:a.ieps_activo,onChange:u,name:"ieps_activo"}),Object(H.jsx)(L.a,{children:"%"})]})},size:"small",name:"ieps",id:"form-producto-ieps",variant:"outlined",value:a.ieps,onChange:u,onFocus:function(e){var t=e.target,c=t.name,r=t.value;0===parseFloat(r)&&n(Object(m.a)(Object(m.a)({},a),{},Object(g.a)({},c,"")))},onBlur:function(e){var t=e.target,c=t.name;t.value||n(Object(m.a)(Object(m.a)({},a),{},Object(g.a)({},c,0)))},error:""===a.ieps})]})})]}),Object(H.jsxs)(O.a,{my:3,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Precios y unidad de compra"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,sm:4,md:2,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{noWrap:!0,className:e.titulos,children:"Unidad Compra"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",error:c.error&&!a.unidad_de_compra.unidad,children:[a.granel?Object(H.jsx)(Nt.a,{disabled:r,id:"form-producto-categoria",name:"unidad",value:a.unidad_de_compra.unidad,onChange:V,children:sn.map((function(e,t){return Object(H.jsx)(Pt.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}):Object(H.jsx)(Nt.a,{disabled:r,id:"form-producto-categoria",name:"unidad",value:a.unidad_de_compra.unidad,onChange:V,children:on.map((function(e,t){return Object(H.jsx)(Pt.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}),Object(H.jsx)(wa.a,{children:c.message})]})})]})}),Object(H.jsx)(Qe.a,{item:!0,sm:4,md:2,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{noWrap:!0,align:"center",className:e.titulos,children:"Unidad Conversion"}),Object(H.jsx)(L.a,{align:"center",variant:"h6",children:Object(H.jsx)("b",{children:"Caja"===a.unidad_de_compra.unidad?"Pz":"Costal"===a.unidad_de_compra.unidad?"Kg":a.unidad_de_compra.unidad})})]})}),Object(H.jsx)(Qe.a,{item:!0,sm:4,md:2,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{noWrap:!0,className:e.titulos,children:[Object(H.jsx)("span",{className:e.required,children:"* "}),"Factor por Unidad"]}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:"Caja"!==a.unidad_de_compra.unidad&&"Costal"!==a.unidad_de_compra.unidad,type:"number",InputProps:{inputProps:{min:1}},size:"small",error:c.error&&!a.unidad_de_compra.cantidad,name:"cantidad",id:"form-producto-cantidad",variant:"outlined",value:a.unidad_de_compra.cantidad,helperText:c.message,onChange:V})]})}),Object(H.jsx)(Qe.a,{item:!0,sm:6,md:3,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{noWrap:!0,className:e.titulos,children:[Object(H.jsx)("span",{className:e.required,children:"* "}),"Precio sin impuestos"]}),Object(H.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},fullWidth:!0,size:"small",error:c.error&&!A,name:"precio_sin_impuesto",id:"form-producto-precio_sin_impuesto",variant:"outlined",value:A,helperText:c.message,onChange:function(e){q(1),F(e.target.value),z(e.target.value)},onFocus:function(e){var t=e.target.value;0===parseFloat(t)&&(F(""),z(""))},onBlur:function(e){e.target.value||(F(0),z(""))}})]})}),Object(H.jsx)(Qe.a,{item:!0,sm:6,md:3,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{noWrap:!0,className:e.titulos,children:[Object(H.jsx)("span",{className:e.required,children:"* "}),"Precio con impuestos"]}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:!a.iva_activo&&!a.ieps_activo,type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},size:"small",error:c.error&&!x,name:"precio_con_impuesto",id:"form-producto-precio_con_impuesto",variant:"outlined",value:x,helperText:c.message,onChange:function(e){q(1),h(e.target.value),N(e.target.value)},onFocus:function(e){var t=e.target.value;0===parseFloat(t)&&(h(""),N(""))},onBlur:function(e){e.target.value||(h(0),N(0))}})]})})]}),Object(H.jsx)(O.a,{my:3}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:2,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{align:"center",className:e.titulos,children:"IVA"}),Object(H.jsx)(L.a,{align:"center",variant:"h6",children:Object(H.jsxs)("b",{children:["$ ",parseFloat(a.precio_de_compra.iva.toFixed(2))]})})]})}),Object(H.jsx)(Qe.a,{item:!0,md:2,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{align:"center",className:e.titulos,children:"IEPS"}),Object(H.jsx)(L.a,{align:"center",variant:"h6",children:Object(H.jsxs)("b",{children:["$ ",parseFloat(a.precio_de_compra.ieps.toFixed(2))]})})]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{align:"center",className:e.titulos,children:"Precio unitario sin impuestos"}),Object(H.jsx)(L.a,{align:"center",variant:"h6",children:Object(H.jsxs)("b",{children:["$"," ",parseFloat(a.unidad_de_compra.precio_unitario_sin_impuesto.toFixed(2))]})})]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{align:"center",className:e.titulos,children:"Precio unitario con impuestos"}),Object(H.jsx)(L.a,{align:"center",variant:"h6",children:Object(H.jsxs)("b",{children:["$"," ",parseFloat(a.unidad_de_compra.precio_unitario_con_impuesto.toFixed(2))]})})]})})]}),Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Precios de venta"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(cn,{})}),Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Unidades de venta"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsx)(O.a,{children:Object(H.jsx)(en,{})})]})})}var bn=a(935),pn=a(936),mn=Object(j.createContext)(),On=function(e){var t=e.children,a=Object(j.useState)({producto:{},costo:0,cantidad:1,cantidad_regalo:0,unidad_regalo:"",cantidad_total:0,descuento_porcentaje:0,descuento_precio:0,iva_total:0,ieps_total:0,subtotal:0,impuestos:0,total:0,mantener_precio:!0,impuestos_descuento:0,subtotal_descuento:0,total_descuento:0}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)({productos:[],proveedor:{},en_espera:!1,fecha_registro:Dt()().locale("es-mx").format("YYYY-MM-DD"),almacen:{},compra_credito:!1,fecha_vencimiento_credito:Dt()().locale("es-mx").format("YYYY-MM-DD"),credito_pagado:!1,saldo_credito_pendiente:0,forma_pago:"",descuento_aplicado:!1,descuento:{porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},subtotal:0,impuestos:0,total:0}),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)([{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}]),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)({precios:xe}),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useState)([]),f=Object(y.a)(_,2),g=f[0],v=f[1],C=Object(j.useState)({}),A=Object(y.a)(C,2),S=A[0],F=A[1],I=Object(j.useState)(!1),k=Object(y.a)(I,2),w=k[0],N=k[1],P=Object(j.useState)(0),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(j.useState)(1),$=Object(y.a)(T,2),W=$[0],R=$[1],V=Object(j.useState)(!1),M=Object(y.a)(V,2),L=M[0],B=M[1],U=Object(j.useState)(!1),q=Object(y.a)(U,2),J=q[0],G=q[1];return Object(H.jsx)(mn.Provider,{value:{datosProducto:c,setDatosProducto:r,productosCompra:g,setProductosCompra:v,datosCompra:s,setDatosCompra:l,productoOriginal:x,setProductoOriginal:h,preciosVenta:b,setPreciosVenta:p,isEditing:S,setIsEditing:F,editFinish:w,setEditFinish:N,costo:D,setCosto:z,cantidad:W,setCantidad:R,issue:L,setIssue:B,loadingProductos:J,setLoadingProductos:G},children:t})},xn=a(84),hn=a.n(xn),_n=a(844),fn=a(345),gn=a(998),vn=a(932),Cn=a(933),yn=a(934),An=a(145),Sn=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},Fn=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{maxHeight:"65vh"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(An.alpha)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function In(e){var t=e.from,a=e.setOnUpdate,n=e.onUpdate,c=e.withoutPrice,r=e.onlyPrice,i=Fn(),o=Object(j.useContext)(Pe),s=o.presentaciones,l=(o.setPresentaciones,Object(Ia.a)(s).sort((function(e,t){return Sn(e,t)})));return Object(H.jsx)("div",{className:i.root,children:Object(H.jsx)(fn.a,{className:i.paper,children:Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Existencia"}),Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{width:200,children:"Nombre"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Medida"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Color"}),c?null:Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Da.a,{children:"Precio"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Aplicar descuento"})]}),r?null:Object(H.jsxs)(j.Fragment,{children:[t&&"compra"===t?Object(H.jsx)(Da.a,{padding:"checkbox",children:"Existente"}):null,Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cantidad"})]}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Editar"})]})}),Object(H.jsx)(za.a,{children:l.map((function(e,i){return Object(H.jsx)($n,{producto:e,index:i,from:t,setOnUpdate:a,onUpdate:n,withoutPrice:c,onlyPrice:r},i)}))})]})})})})}var kn,wn,Nn,Pn,En,Dn,zn,Tn,$n=function(e){var t=e.producto,a=e.index,n=e.from,c=e.setOnUpdate,r=e.onUpdate,i=e.withoutPrice,o=e.onlyPrice,s=Object(j.useContext)(Pe),l=s.presentaciones,d=s.setPresentaciones,u=s.preciosP,b=s.precios,p=Object(j.useState)(!0),x=Object(y.a)(p,2),h=x[0],_=x[1],f=Fn(),g=Object(j.useRef)(null),v=Object(Ia.a)(l).sort((function(e,t){return Sn(e,t)})),C=Object(m.a)({},v[a]),A=Object(m.a)({},v[a].descuento),S=Object(m.a)({},t),F=function(e){var t=e.target,n=t.name,c=t.value;if("cantidad"===n){if(!c)return C.cantidad="",C.existencia=!1,v.splice(a,1,C),void d(v);C.existencia="0"!==c,C.cantidad=parseFloat(c)}else if("cantidad_nueva"===n){if(!c)return C.cantidad_nueva="",C.existencia=S.existencia,v.splice(a,1,C),void d(v);C.cantidad_nueva=parseFloat(c),C.existencia=!0}else if("precio"===n){if(!c)return C.precio="",v.splice(a,1,C),void d(v);var r=parseFloat(c),i=b.iva,o=b.ieps,s=parseFloat("0.".concat(i<10?"0".concat(i):i))+parseFloat("0.".concat(o<10?"0".concat(o):o)),l=parseFloat(r/(s+1)),j=parseFloat(l*parseFloat("0.".concat(i<10?"0".concat(i):i))),u=parseFloat(l*parseFloat("0.".concat(o<10?"0".concat(o):o))),p=b.unidad_de_compra.precio_unitario_sin_impuesto,m=parseFloat((l-p)/p*100),O=C.descuento_activo,x=C.descuento;if(O&&!0===O){var h=l*x.porciento/100,_=h+(h*parseFloat("0.".concat(i<10?"0".concat(i):i))+h*parseFloat("0.".concat(o<10?"0".concat(o):o)));A.precio_neto=parseFloat(_.toFixed(2)),C.precio=parseFloat(c),C.descuento=A}else C.precio=parseFloat(c);C.precio_unidad.precio_venta=parseFloat(l.toFixed(2)),C.precio_unidad.precio_neto=parseFloat(r.toFixed(2)),C.precio_unidad.utilidad=parseFloat(m.toFixed(2)),C.precio_unidad.iva_precio=parseFloat(j.toFixed(2)),C.precio_unidad.ieps_precio=parseFloat(u.toFixed(2))}else{if(!c)return C.codigo_barras="",v.splice(a,1,C),void d(v);C.codigo_barras=c}v.splice(a,1,C),d(v)},I=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();C.codigo_barras=t,v.splice(a,1,C),d(v)},k=function(){h?(_(!h),c([].concat(Object(Ia.a)(r),[a]))):(S.cantidad||(C.cantidad=0),S.cantidad_nueva||(C.cantidad_nueva=0),S.precio||(C.precio=u[0].precio_neto),v.splice(a,1,C),d(v),_(!0),r.splice(r.length-1,1),c(Object(Ia.a)(r)))};return Object(H.jsxs)(Ea.a,{hover:!0,selected:!h,className:f.tableRow,children:[Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(Ze.a,{checked:S.existencia,color:"primary"})}),Object(H.jsx)(Da.a,{width:220,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(_n.a,{inputRef:g,onChange:function(e){return F(e)},value:S.codigo_barras,type:"number",name:"codigo_barras",disabled:l.length>0&&!S.nuevo||h}),0===l.length&&S.nuevo||l.length>0&&S.nuevo?Object(H.jsx)(ce.a,{color:"primary",size:"small",onClick:function(){return I()},children:Object(H.jsx)(Ra.a,{})}):null]})}),Object(H.jsx)(Da.a,{width:200,children:S.nombre_comercial}),Object(H.jsx)(Da.a,{padding:"checkbox",children:S.medida._id?Object(H.jsx)(gn.a,{label:S.medida.talla,color:"primary"}):""}),Object(H.jsx)(Da.a,{padding:"checkbox",children:S.color._id?Object(H.jsx)(Ta.a,{title:S.color.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:f.colorContainer,style:{backgroundColor:S.color.hex}})}):null}),i?null:Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Da.a,{width:110,className:f.input,children:Object(H.jsx)(_n.a,{inputRef:g,onChange:function(e){return F(e)},disabled:h,value:S.precio,type:"number",name:"precio"})}),Object(H.jsx)(Da.a,{width:200,children:Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:void 0!==S.descuento_activo&&null!==S.descuento_activo?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Ze.a,{checked:!0===S.descuento_activo&&S.descuento_activo,onChange:function(e){return function(e){C.descuento_activo=e;var t=0,n=b.iva,c=b.ieps,r=C.descuento,i=C.precio,o=parseFloat("0.".concat(n<10?"0".concat(n):n))+parseFloat("0.".concat(c<10?"0".concat(c):c)),s=parseFloat((i/(o+1)).toFixed(2));if(e){var l=s*r.porciento/100;t=l+(l*parseFloat("0.".concat(n<10?"0".concat(n):n))+l*parseFloat("0.".concat(c<10?"0".concat(c):c)))}else t=i;A.precio_neto=parseFloat(t.toFixed(2)),C.descuento=A,v.splice(a,1,C),d(v)}(e.target.checked)},icon:Object(H.jsx)(Cn.a,{}),checkedIcon:Object(H.jsx)(Wa.a,{}),inputProps:{"aria-label":"check descuento"},color:"primary",disabled:null===S.descuento_activo}),Object(H.jsxs)(L.a,{color:!0===S.descuento_activo?"primary":"textSecondary",children:["%",parseFloat(null!==S.descuento?S.descuento.porciento:0)," ","$",parseFloat(null!==S.descuento?S.descuento.precio_neto:0)]})]}):null})})]}),o?null:Object(H.jsx)(j.Fragment,{children:n&&"compra"===n?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Da.a,{padding:"checkbox",children:t.cantidad}),Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(_n.a,{inputRef:g,onChange:function(e){return F(e)},disabled:h,value:S.cantidad_nueva,type:"tel",name:"cantidad_nueva"})})]}):Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(_n.a,{inputRef:g,onChange:function(e){return F(e)},disabled:h,value:S.cantidad,type:"tel",name:"cantidad"})})}),Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(ce.a,{size:"small",onClick:function(){return k()},children:h?Object(H.jsx)(yn.a,{}):Object(H.jsx)(Gt.a,{})})})]})},Wn=["children","value","index"],Rn=["precios_producto"],Vn=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Mn(e){var t=e.children,a=e.value,n=e.index,c=Object(De.a)(e,Wn);return Object(H.jsx)("div",Object(m.a)(Object(m.a)({style:{height:"80vh"},role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},c),{},{children:a===n&&Object(H.jsx)(O.a,{p:3,children:t})}))}function Ln(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}function Bn(e){var t=e.agregarCompra,a=e.handleClose,n=e.cargando,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)([]),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useContext)(mn),p=b.datosProducto,O=b.productoOriginal,x=Object(j.useContext)(Pe),h=x.precios,_=x.setPrecios,f=x.setUnidadesVenta,g=x.setPreciosP,v=x.setUnidadVentaXDefecto,C=x.setUnidadVentaSecundaria,A=function(){return o(!i)},S=function(){var e=O.precios,t=(e.precios_producto,Object(De.a)(e,Rn)),a=O.unidades_de_venta,n=O.unidades_de_venta.filter((function(e){return!1===e.default})),c=O.unidades_de_venta.filter((function(e){return!0===e.default}));_(t),f(a),g(O.precios.precios_producto),v(c[0]),C(n[0]),A()},k=Object(j.useState)(0),w=Object(y.a)(k,2),N=w[0],P=w[1];return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{color:"primary",size:"medium",onClick:function(){return function(){A();var e=p.costo/h.unidad_de_compra.cantidad,t=h.precio_de_compra.precio_sin_impuesto/h.unidad_de_compra.cantidad;isNaN(t)&&(t=0),isNaN(e)&&(e=0),_(Object(m.a)(Object(m.a)({},h),{},{precio_de_compra:Object(m.a)(Object(m.a)({},h.precio_de_compra),{},{precio_con_impuesto:p.costo}),unidad_de_compra:Object(m.a)(Object(m.a)({},h.unidad_de_compra),{},{precio_unitario_con_impuesto:parseFloat(e.toFixed(2)),precio_unitario_sin_impuesto:parseFloat(t.toFixed(2))})}))}()},children:"Actualizar precios"}),Object(H.jsxs)(qe.a,{open:i,TransitionComponent:Vn,keepMounted:!0,onClose:function(){return S()},"aria-labelledby":"alert-precios-compra-title","aria-describedby":"alert-precios-compra-description",fullWidth:!0,maxWidth:"lg",children:[p.producto.datos_generales&&"OTROS"!==p.producto.datos_generales.tipo_producto?Object(H.jsx)(Bt.a,{style:{padding:0},children:Object(H.jsx)(Re.a,{position:"static",color:"default",children:Object(H.jsxs)(Ve.a,{value:N,onChange:function(e,t){P(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(H.jsx)(Me.a,Object(m.a)({label:"Precios",icon:Object(H.jsx)(bn.a,{})},Ln(0))),Object(H.jsx)(Me.a,Object(m.a)({label:"Precios Medidas",icon:Object(H.jsx)(pn.a,{})},Ln(1)))]})})}):null,Object(H.jsx)(He.a,{children:p.producto.datos_generales&&"OTROS"!==p.producto.datos_generales.tipo_producto?Object(H.jsxs)("div",{children:[Object(H.jsx)(Mn,{value:N,index:0,children:Object(H.jsx)(un,{})}),Object(H.jsx)(Mn,{value:N,index:1,children:Object(H.jsx)(In,{from:"compras",datos:p.producto,setOnUpdate:u,onUpdate:d,onlyPrice:!0})})]}):Object(H.jsx)(un,{})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{color:"inherit",size:"large",startIcon:Object(H.jsx)(Gt.a,{}),onClick:function(){return S()},children:"Cancelar"}),Object(H.jsx)(F.a,{size:"large",onClick:function(){t("actualizar_precios"),a(),A()},startIcon:n?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(hn.a,{}),color:"primary",variant:"contained",disabled:!h.precio_de_compra.precio_con_impuesto,children:"Aceptar y agregar compra"})]})]})]})}var Un,qn,Jn,Hn,Gn,Yn,Qn,Kn,Xn=Object(P.d)(kn||(kn=Object(N.a)(["\n  query obtenerConsultasProducto($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultasProducto(empresa: $empresa, sucursal: $sucursal) {\n      categorias {\n        _id\n        categoria\n        subcategorias {\n          _id\n          subcategoria\n        }\n      }\n      departamentos {\n        _id\n        nombre_departamentos\n      }\n      marcas {\n        _id\n        nombre_marca\n      }\n      colores {\n        _id\n        nombre\n        hex\n      }\n      tallas {\n        _id\n        talla\n        tipo\n      }\n      calzados {\n        _id\n        talla\n        tipo\n      }\n      almacenes {\n        _id\n        nombre_almacen\n      }\n      centro_costos {\n        _id\n        cuenta\n        subcuentas {\n          _id\n          subcuenta\n        }\n      }\n      codigos {\n        _id\n        Name\n        Value\n      }\n    }\n  }\n"]))),Zn=Object(P.d)(wn||(wn=Object(N.a)(["\n  mutation crearProducto($input: CrearProductoInput) {\n    crearProducto(input: $input) {\n      message\n    }\n  }\n"]))),ec=Object(P.d)(Nn||(Nn=Object(N.a)(["\n  query obtenerProductos(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n    $almacen: ID\n    $existencias: Boolean\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerProductos(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      almacen: $almacen\n      existencias: $existencias\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        centro_de_costos {\n          id_cuenta\n          cuenta\n          id_subcuenta\n          subcuenta\n        }\n        unidades_de_venta {\n          _id\n          precio\n          cantidad\n          unidad\n          codigo_unidad\n          unidad_principal\n          codigo_barras\n          id_producto\n          descuento_activo\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          default\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        empresa\n        imagenes {\n          location_imagen\n          extencion_imagen\n          url_imagen\n          key_imagen\n        }\n        precio_plazos {\n          precio_cajas {\n            plazo\n            unidad\n            precio\n            codigo_unidad\n          }\n          precio_piezas {\n            plazo\n            unidad\n            precio\n            codigo_unidad\n          }\n          precio_costales {\n            plazo\n            unidad\n            codigo_unidad\n            precio\n          }\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            ieps\n            iva\n            precio_con_impuesto\n            precio_sin_impuesto\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n            codigo_unidad\n          }\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          granel\n        }\n        medidas_producto {\n          _id\n          cantidad\n          codigo_unidad\n          unidad\n          almacen\n          descuento_activo\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          codigo_barras\n          color {\n            _id\n            nombre\n            hex\n          }\n          existencia\n          medida {\n            _id\n            talla\n            tipo\n          }\n          nombre_comercial\n          precio\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n        inventario_general {\n          _id\n          cantidad_existente\n          unidad_inventario\n          codigo_unidad\n          cantidad_existente_maxima\n          unidad_maxima\n          id_almacen_general\n          eliminado\n        }\n        medidas_registradas\n        sucursal\n        usuario\n      }\n      totalDocs\n    }\n  }\n"]))),tc=Object(P.d)(Pn||(Pn=Object(N.a)(["\n  mutation actualizarProducto($id: ID!, $input: ActualizarProductoInput, $empresa:ID!, $sucursal:ID!) {\n    actualizarProducto(id: $id, input: $input, empresa: $empresa, sucursal:$sucursal ) {\n      message\n    }\n  }\n"]))),ac=Object(P.d)(En||(En=Object(N.a)(["\n  mutation eliminarProducto($id: ID!, $empresa:ID!, $sucursal:ID!) {\n    eliminarProducto(id: $id, empresa: $empresa, sucursal:$sucursal) {\n      message\n    }\n  }\n"]))),nc=Object(P.d)(Dn||(Dn=Object(N.a)(["\n  query obtenerProductosInactivos($empresa: ID!, $sucursal: ID!) {\n    obtenerProductosInactivos(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      producto {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            ieps\n            iva\n            precio_con_impuesto\n            precio_sin_impuesto\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            unidad_mayoreo\n            utilidad\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          granel\n        }\n      }\n      cantidad_existente\n      unidad_de_inventario\n      id_almacen\n      eliminado\n      empresa\n      sucursal\n    }\n  }\n"]))),cc=Object(P.d)(zn||(zn=Object(N.a)(["\n  mutation activarProducto($id: ID!, $empresa:ID!, $sucursal:ID!) {\n    activarProducto(id: $id, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),rc=Object(P.d)(Tn||(Tn=Object(N.a)(["\n  mutation crearProductoRapido($input: CrearProductoRapidoInput) {\n    crearProductoRapido(input: $input) {\n      message\n    }\n  }\n"]))),ic=a(272),oc=Object(P.d)(Un||(Un=Object(N.a)(["\n  mutation crearColor($input: CrearColorInput) {\n    crearColor(input: $input) {\n      _id\n      nombre\n      hex\n      empresa {\n        nombre_empresa\n        correo_empresa\n        nombre_dueno\n        telefono_dueno\n        sucursales_activas\n        limite_sucursales\n        _id\n      }\n    }\n  }\n"]))),sc=Object(P.d)(qn||(qn=Object(N.a)(["\n  query obtenerColores($empresa: ID!) {\n    obtenerColores(empresa: $empresa) {\n      _id\n      nombre\n      hex\n      empresa {\n        nombre_empresa\n        correo_empresa\n        nombre_dueno\n        telefono_dueno\n        sucursales_activas\n        limite_sucursales\n        _id\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n        descripcion\n      }\n    }\n  }\n"]))),lc=Object(P.d)(Jn||(Jn=Object(N.a)(["\n\tmutation actualizarColor($input: ActualizarColorInput, $id: ID!, $empresa:ID!, $sucursal:ID!) {\n\t\tactualizarColor(id: $id, input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),dc=Object(P.d)(Hn||(Hn=Object(N.a)(["\n\tmutation eliminarColor($id: ID!, $empresa:ID!, $sucursal:ID!) {\n\t\teliminarColor(id: $id, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function jc(e){var t=e.refetch,a=Object(j.useState)({}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)({nombre:"",hex:""}),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)({message:"",status:"",open:!1}),u=Object(y.a)(d,2),b=u[0],p=u[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=Object(j.useState)(!1),_=Object(y.a)(h,2),f=_[0],g=_[1],A=function(){return g(!f)},I=Object(w.a)(oc),k=Object(y.a)(I,1)[0],N=function(){var e=Object(C.a)(Object(v.a)().mark((function e(a){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),s.nombre&&s.hex){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,n=s,e.next=7,k({variables:{input:{nombre:n.nombre,hex:n.hex,empresa:x.empresa._id,sucursal:x.sucursal._id}}});case 7:t(),l({nombre:"",hex:""}),p({message:"\xa1Listo!",status:"success",open:!0}),A(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),p({message:"Hubo un error",status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsxs)(F.a,{color:"primary",onClick:function(){return A()},children:[Object(H.jsx)(Ut.a,{}),"nuevo color"]})}),Object(H.jsxs)(qe.a,{open:f,scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&A()},children:[Object(H.jsx)(He.a,{children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Y,{alert:b,setAlert:p}),Object(H.jsx)(ic.a,{color:c,onChangeComplete:function(e){r(e),l(Object(m.a)(Object(m.a)({},s),{},{hex:e.hex.toUpperCase()}))}}),Object(H.jsxs)(O.a,{mt:2,children:[Object(H.jsx)(L.a,{children:"Color seleccionado:"}),s.hex?Object(H.jsx)(O.a,{bgcolor:s.hex,height:30,width:220}):Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",width:220,children:Object(H.jsx)(L.a,{color:"secondary",children:"NINGUNO"})})]}),Object(H.jsx)(O.a,{my:2,children:Object(H.jsx)("form",{id:"form-registro-color",onSubmit:function(e){return N(e)},children:Object(H.jsx)(S.a,{label:"Nombre del color",variant:"outlined",size:"small",value:s.nombre,onChange:function(e){return l(Object(m.a)(Object(m.a)({},s),{},{nombre:e.target.value.toUpperCase()}))},fullWidth:!0,focused:!0})})})]})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{variant:"outlined",color:"primary",onClick:function(){return A()},size:"large",children:"Cancelar"}),Object(H.jsx)(F.a,{variant:"contained",color:"primary",type:"submit",form:"form-registro-color",size:"large",startIcon:Object(H.jsx)(Yt.a,{}),children:"Guardar"})]})]})]})}var uc=Object(P.d)(Gn||(Gn=Object(N.a)(["\n  mutation crearTalla($input: CrearTallaInput) {\n    crearTalla(input: $input) {\n      message\n    }\n  }\n"]))),bc=Object(P.d)(Yn||(Yn=Object(N.a)(["\n  query obtenerTallas($empresa: ID!, $tipo: String!) {\n    obtenerTallas(empresa: $empresa, tipo: $tipo) {\n      _id\n      talla\n      tipo\n      empresa {\n        nombre_empresa\n        correo_empresa\n        nombre_dueno\n        telefono_dueno\n        sucursales_activas\n        limite_sucursales\n        _id\n      }\n    }\n  }\n"]))),pc=Object(P.d)(Qn||(Qn=Object(N.a)(["\n\tmutation actualizarTalla($input: ActualizarTallaInput, $id: ID!, $empresa:ID!, $sucursal:ID!) {\n\t\tactualizarTalla(id: $id, input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),mc=Object(P.d)(Kn||(Kn=Object(N.a)(["\n\tmutation eliminarTalla($input: ActualizarTallaInput,$id: ID!, $empresa:ID!, $sucursal:ID!) {\n\t\teliminarTalla(id: $id, input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));function Oc(e){var t=e.setMedidasSeleccionadas,a=e.refetch,n=e.tipo_producto,c=Object(j.useState)(""),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)({message:"",status:"",open:!1}),p=Object(y.a)(b,2),m=p[0],x=p[1],h=JSON.parse(localStorage.getItem("sesionCafi")),_=Object(j.useContext)(Pe).datos_generales,f=Object(w.a)(uc),g=Object(y.a)(f,1)[0],A=function(){return u(!d)},I=function(){var e=Object(C.a)(Object(v.a)().mark((function e(c){var r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),i){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,r=i,e.next=7,g({variables:{input:{talla:r,tipo:_.tipo_producto?_.tipo_producto:n,empresa:h.empresa._id,sucursal:h.sucursal._id}}});case 7:a(),t([r]),o(""),x({message:"\xa1Listo!",status:"success",open:!0}),A(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),x({message:"Hubo un error",status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsxs)(F.a,{color:"primary",onClick:function(){return A()},children:[Object(H.jsx)(Ut.a,{})," Nueva talla"]})}),Object(H.jsxs)(qe.a,{open:d,scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&A()},children:[Object(H.jsx)(He.a,{children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Y,{alert:m,setAlert:x}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:Object(H.jsx)("form",{id:"form-registro-color",onSubmit:function(e){return I(e)},children:Object(H.jsx)(S.a,{id:"outlined-error-helper-text",label:"ROPA"===_.tipo_producto?"Talla":"N\xfamero",variant:"outlined",size:"small",focused:!0,fullWidth:!0,value:i,onChange:function(e){return o(e.target.value.toUpperCase())}})})})]})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{variant:"outlined",color:"primary",onClick:function(){return A()},size:"large",children:"Cancelar"}),Object(H.jsx)(F.a,{variant:"contained",color:"primary",type:"submit",form:"form-registro-color",size:"large",startIcon:Object(H.jsx)(Yt.a,{}),children:"Guardar"})]})]})]})}var xc=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"},titulos:{fontWeight:500}}})),hc=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function _c(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=e.from,c=e.withoutPrice,r=Object(j.useContext)(Pe),i=r.presentaciones,o=r.datos_generales,s=t.colores,l=t.tallas,d=t.calzados,u=Object(j.useState)([]),b=Object(y.a)(u,2),p=b[0],m=b[1],x=Object(j.useState)([]),h=Object(y.a)(x,2),_=h[0],f=h[1],g="ROPA"===o.tipo_producto?Object(Ia.a)(l):Object(Ia.a)(d),v=Object(j.useState)([]),C=Object(y.a)(v,2),A=C[0],S=C[1],F=xc(),I=Object(j.useCallback)((function(){var e=[],t=[];Object(Ia.a)(i).forEach((function(a){a.color._id&&e.push(a.color),a.medida._id&&t.push(a.medida)}));var a={},n={},c=e.filter((function(e){var t=!a[e._id];return a[e._id]=!0,t})),r=t.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t}));f(Object(Ia.a)(c)),m(Object(Ia.a)(r))}),[i]);return Object(j.useEffect)((function(){I()}),[I]),Object(H.jsx)("div",{children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsxs)(O.a,{width:"100%",style:A.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(L.a,{className:F.titulos,children:"ROPA"===o.tipo_producto?"Talla":"N\xfamero"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(Oc,{setMedidasSeleccionadas:m,refetch:a})]}),Object(H.jsx)(Qe.a,{container:!0,children:g.map((function(e,t){return Object(H.jsx)(fc,{talla:e,coloresSeleccionados:_,medidasSeleccionadas:p,setMedidasSeleccionadas:m},t)}))})]})}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsxs)(O.a,{width:"100%",style:A.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(L.a,{className:F.titulos,children:"Color"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(jc,{refetch:a})]}),Object(H.jsx)(Qe.a,{container:!0,children:s.map((function(e,t){return Object(H.jsx)(gc,{color:e,coloresSeleccionados:_,setColoresSeleccionados:f,medidasSeleccionadas:p},t)}))})]})})]}),Object(H.jsx)(O.a,{mt:3}),Object(H.jsx)(In,{from:n,withoutPrice:c,setOnUpdate:S,onUpdate:A})]})})}var fc=function(e){var t=e.talla,a=e.coloresSeleccionados,n=e.medidasSeleccionadas,c=e.setMedidasSeleccionadas,r=xc(),i=Object($e.a)(),o=Object(j.useContext)(Pe),s=o.setPresentaciones,l=o.presentaciones,d=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=o.almacen_existente,x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useCallback)((function(){n.forEach((function(e){e._id===t._id&&f(!0)}))}),[t._id,n]);Object(j.useEffect)((function(){if(O)return g()}),[g]);return Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)("div",{className:r.colorContainer,onClick:function(){return function(e){var r=Object(Ia.a)(n);_?r.forEach((function(a,n){a._id===t._id&&(r.splice(n,1),f(e),l.forEach((function(e){e.nuevo||e.medida._id===a._id&&m([].concat(Object(Ia.a)(p),[e]))})))})):(r.push(t),f(e));var i=[],o=Object(Ia.a)(l),j=b.iva,O=b.ieps;if(a.length||o.length){if(!a.length&&o.length>0)for(var x=function(e){var t=r[e],a=o.filter((function(e){return e.medida._id===t._id})),n=parseFloat(u[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))),c=parseFloat(u[0].precio_venta*parseFloat("0.".concat(O<10?"0".concat(O):O)));a.length?i.push(a[0]):i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:hc(),nombre_comercial:d.nombre_comercial,medida:t,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(n.toFixed(2)),ieps_precio:parseFloat(c.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},h=0;h<r.length;h++)x(h);else if(a.length>0&&1===r.length&&e)for(var g=0;g<o.length;g++)for(var v=0;v<r.length;v++)i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:o[g].existencia,codigo_barras:o[g].codigo_barras,nombre_comercial:o[g].nombre_comercial,medida:r[v],color:o[g].color,precio:o[g].precio,cantidad:o[g].cantidad,cantidad_nueva:o[g].cantidad_nueva,nuevo:!0,precio_unidad:o[g].precio_unidad});else if(a.length>0&&r.length>0)for(var C=function(e){for(var t=r[e],n=function(e){var n=a[e],c=o.filter((function(e){return e.medida._id===t._id&&n._id===e.color._id})),r=parseFloat(u[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))),s=parseFloat(u[0].precio_venta*parseFloat("0.".concat(O<10?"0".concat(O):O)));c.length?i.push(c[0]):i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:hc(),nombre_comercial:d.nombre_comercial,medida:t,color:n,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(r.toFixed(2)),ieps_precio:parseFloat(s.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},c=0;c<a.length;c++)n(c)},y=0;y<r.length;y++)C(y);else if(a.length>0&&!r.length&&o.filter((function(e){return e.medida._id})).length)for(var A=0;A<o.length;A++){var S=o[A];i.push({_id:S._id,unidad:"Pz",codigo_unidad:"H87",existencia:S.existencia,codigo_barras:S.codigo_barras,nombre_comercial:S.nombre_comercial,medida:{},color:S.color,precio:S.precio,cantidad:S.cantidad,cantidad_nueva:S.cantidad_nueva,nuevo:!0,precio_unidad:S.precio_unidad})}}else for(var F=0;F<r.length;F++){var I=r[F],k=parseFloat(u[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))),w=parseFloat(u[0].precio_venta*parseFloat("0.".concat(O<10?"0".concat(O):O)));i.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:hc(),nombre_comercial:d.nombre_comercial,medida:I,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(k.toFixed(2)),ieps_precio:parseFloat(w.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})}c(Object(Ia.a)(r)),s(i)}(!_)},style:_?{backgroundColor:i.palette.primary.main}:null,children:Object(H.jsx)(L.a,{variant:"button",noWrap:!0,style:{color:i.palette.getContrastText(_?i.palette.primary.main:"#FFFFFF"),fontSize:16},children:t.talla})})})},gc=function(e){var t=e.color,a=e.coloresSeleccionados,n=e.setColoresSeleccionados,c=e.medidasSeleccionadas,r=xc(),i=Object($e.a)(),o=Object(j.useContext)(Pe),s=o.presentaciones,l=o.setPresentaciones,d=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=o.almacen_existente,x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useCallback)((function(){a.forEach((function(e){e._id===t._id&&f(!0)}))}),[t._id,a]);Object(j.useEffect)((function(){if(O)return g()}),[g]);return Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)(Ta.a,{title:t.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:r.colorContainer,style:{backgroundColor:t.hex,color:i.palette.getContrastText(t.hex)},onClick:function(){return function(e){_?a.forEach((function(n,c){n._id===t._id&&(a.splice(c,1),f(e),s.forEach((function(e){e.nuevo||e.color._id===n._id&&m([].concat(Object(Ia.a)(p),[e]))})))})):(a.push(t),f(e));var r=[],i=Object(Ia.a)(s),o=b.iva,j=b.ieps;if(c.length||i.length){if(!c.length&&i.length>0)for(var O=function(e){var t=a[e],n=i.filter((function(e){return e.color._id===t._id})),c=parseFloat(u[0].precio_venta*parseFloat("0.".concat(o<10?"0".concat(o):o))),s=parseFloat(u[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j)));n.length?r.push(n[0]):r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:hc(),nombre_comercial:d.nombre_comercial,medida:{},color:t,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(c.toFixed(2)),ieps_precio:parseFloat(s.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},x=0;x<a.length;x++)O(x);else if(c.length>0&&1===a.length&&e)for(var h=0;h<i.length;h++)for(var g=0;g<a.length;g++)r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:i[h].existencia,codigo_barras:i[h].codigo_barras,nombre_comercial:i[h].nombre_comercial,medida:i[h].medida,color:a[g],precio:i[h].precio,cantidad:i[h].cantidad,cantidad_nueva:i[h].cantidad_nueva,nuevo:!0,precio_unidad:i[h].precio_unidad});else if(c.length>0&&a.length>0)for(var v=function(e){for(var t=a[e],n=function(e){var a=c[e],n=i.filter((function(e){return e.medida._id===a._id&&t._id===e.color._id})),s=parseFloat(u[0].precio_venta*parseFloat("0.".concat(o<10?"0".concat(o):o))),l=parseFloat(u[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j)));n.length?r.push(n[0]):r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:hc(),nombre_comercial:d.nombre_comercial,medida:a,color:t,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(s.toFixed(2)),ieps_precio:parseFloat(l.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},s=0;s<c.length;s++)n(s)},C=0;C<a.length;C++)v(C);else if(c.length>0&&!a.length&&i.filter((function(e){return e.color._id})).length)for(var y=0;y<i.length;y++){var A=i[y];r.push({_id:A._id,unidad:"Pz",codigo_unidad:"H87",existencia:A.existencia,codigo_barras:A.codigo_barras,nombre_comercial:A.nombre_comercial,medida:A.medida,color:{nombre:"",hex:""},precio:A.precio,cantidad:A.cantidad,cantidad_nueva:A.cantidad_nueva,nuevo:!0,precio_unidad:A.precio_unidad})}}else for(var S=0;S<a.length;S++){var F=a[S],I=parseFloat(u[0].precio_venta*parseFloat("0.".concat(o<10?"0".concat(o):o))),k=parseFloat(u[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j)));r.push({_id:"",unidad:"Pz",codigo_unidad:"H87",existencia:!1,codigo_barras:hc(),nombre_comercial:d.nombre_comercial,medida:{},color:F,precio:u[0].precio_neto,cantidad:0,cantidad_nueva:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(I.toFixed(2)),ieps_precio:parseFloat(k.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})}n(Object(Ia.a)(a)),l(r)}(!_)},children:_?Object(H.jsx)(Yt.a,{}):null})})})},vc=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Cc(e){var t=e.verificate,a=e.setVerificate,n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(j.useContext)(mn),l=s.datosProducto,d=s.datosCompra,u=(s.setLoadingProductos,Object(rt.b)(Xn,{variables:{empresa:o.empresa._id,sucursal:o.sucursal._id}})),b=u.loading,p=u.data,m=u.error,O=u.refetch;if(b)return Object(H.jsx)(F.a,{color:"primary",size:"medium",disabled:!0,startIcon:Object(H.jsx)(I.a,{size:16,color:"inherit"}),children:"Medidas"});if(m)return Object(H.jsx)(bt,{error:m});var x=p.obtenerConsultasProducto,h=function(){i(!r),a(!1)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Ta.a,{title:"Selecciona medidas y colores",disableHoverListener:!0,open:t,placement:"top",children:Object(H.jsx)(F.a,{color:t?"secondary":"inherit",variant:"outlined",size:"medium",onClick:function(){return h()},startIcon:Object(H.jsx)(pn.a,{}),disabled:!l.producto.datos_generales,children:"Medidas"})}),Object(H.jsxs)(qe.a,{open:r,TransitionComponent:vc,keepMounted:!0,onClose:h,"aria-labelledby":"alert-tallas-compra","aria-describedby":"alert-tallas-compra-description",fullWidth:!0,maxWidth:"lg",children:[Object(H.jsx)(He.a,{children:Object(H.jsx)(_c,{datos:l.producto,obtenerConsultasProducto:x,refetch:O,from:"compra",almacen:d.almacen,withoutPrice:!0})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{size:"large",onClick:function(){return h()},startIcon:Object(H.jsx)(Yt.a,{}),color:"primary",variant:"contained",children:"Aceptar"})})]})]})}var yc=a(98),Ac=a.n(yc),Sc=a(943),Fc=a(939),Ic=a(897),kc=a(849),wc=a(938),Nc=a(937),Pc=a(124),Ec=a.n(Pc),Dc="QUJTT0xVQ0lPTkVTOkxlb24yMDE4Iw==",zc="https://apisandbox.facturama.mx/";Ec.a.ajaxSetup({beforeSend:function(e){e.withCredentials=!0,e.setRequestHeader("Authorization","Basic "+Dc)}});var Tc,$c,Wc,Rc=function(){var e={url:zc};function t(t,a,n){return Ec.a.get(e.url+t+"/"+a,void 0,n,"json")}function a(t,a){return Ec.a.get(e.url+t,void 0,a,"json")}function n(t,a,n,c){Ec.a.ajax({url:e.url+t,type:"POST",dataType:"json",data:JSON.stringify(a),contentType:"application/json",success:n,error:c})}function c(t,a,n,c){Ec.a.ajax({url:e.url+t,type:"PUT",data:JSON.stringify(a),contentType:"application/json",success:n,error:c})}function r(t,a,n,c){Ec.a.ajax({url:e.url+t+"/"+a,type:"DELETE",async:!1,success:n,error:c})}var i={Clients:{Get:function(e,a){return t("client",e,a)},List:function(e){return a("client",e)},Create:function(e,t,a){n("client",e,t,a)},Remove:function(e,t,a){r("client/",e,t,a)},Update:function(e,t,a,n){c("client/"+e,t,a,n)}},Products:{Get:function(e,a){return t("product",e,a)},List:function(e){return a("product",e)},Create:function(e,t,a){n("product",e,t,a)},Remove:function(e,t,a){r("product/",e,t,a)},Update:function(e,t,a,n){c("product/"+e,t,a,n)}},BranchOffice:{Get:function(e,a){return t("branchOffice",e,a)},List:function(e){return a("branchOffice",e)},Create:function(e,t,a){n("branchOffice",e,t,a)},Remove:function(e,t,a){r("branchOffice",e,t,a)},Update:function(e,t,a,n){c("branchOffice/"+e,t,a,n)}},Series:{List:function(e,a){return t("serie",e,a)},Create:function(e,t,a,c){n("serie/"+e,t,a,c)},Remove:function(e,t,a,n){r("serie/"+e,t,a,n)},Update:function(e,t,a,n,r){c("serie/"+e+"/"+t,a,n,r)}},Cfdi:{Get:function(e,a){return t("cfdi",e,a)},List:function(t,a){return function(t,a,n){return Ec.a.get(e.url+t+a,void 0,n,"json")}("cfdi",t,a)},Create:function(e,t,a){n("2/cfdis",e,t,a)},Send:function(t,a){!function(t,a,n){Ec.a.ajax({url:e.url+t+a,type:"POST",async:!1,success:n})}("cfdi",t,a)},Cancel:function(e,t,a){r("cfdi",e,t,a)},Download:function(e,a,n,c){t("cfdi/"+e+"/"+a,n,c)},Acuse:function(e,a,n,c){t("acuse/"+e+"/"+a,n,c)}},TaxEntity:{Get:function(e){return a("taxEntity",e)},Update:function(e,t,a){c("taxEntity",e,t,a)},UploadCsd:function(e,t,a){c("taxEntity/UploadCsd",e,t,a)},UploadImage:function(e,t,a){c("taxEntity/UploadLogo",e,t,a)}},Catalogs:{States:function(e,t){return a("catalogs/municipalities?countryCode"+e,t)},Municipalities:function(e,t){return a("catalogs/municipalities?stateCode"+e,t)},Localities:function(e,t){return a("catalogs/localities?stateCode"+e,t)},Neighborhoods:function(e,t){return a("catalogs/neighborhoods?postalCode"+e,t)},ProductsOrServices:function(e,t){return a("catalogs/ProductsOrServices?keyword="+e,t)},PostalCodes:function(e,t){return a("catalogs/PostalCodes?keyword="+e,t)},Units:function(e){return a("catalogs/Units",e)},Currencies:function(e){return a("catalogs/Currencies",e)},Countries:function(e){return a("catalogs/Countries",e)},PaymentForms:function(e){return a("catalogs/PaymentForms",e)},PaymentMethods:function(e){return a("catalogs/PaymentMethods",e)},FederalTaxes:function(e){return a("catalogs/FederalTaxes",e)},FiscalRegimens:function(e){return a("catalogs/FiscalRegimens",e)},CfdiTypes:function(e){return a("catalogs/CfdiTypes",e)},RelationTypes:function(e){return a("catalogs/RelationTypes",e)},CfdiUses:function(e,t){return a("catalogs/CfdiUses?keyword="+e,t)}},getToken:function(){return"Basic "+Dc},getBaseUri:function(){return e.url}};return i}(),Vc=Object(P.d)(Tc||(Tc=Object(N.a)(["\n  mutation crearCodigoProducto($input: CodigoCatalogoProductoInput) {\n    crearCodigoProducto(input: $input) {\n      message\n    }\n  }\n"]))),Mc=(Object(P.d)($c||($c=Object(N.a)(["\n  query obtenerCodigosProducto($empresa: ID!, $sucursal: ID) {\n    obtenerCodigosProducto(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      Name\n      Value\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n    }\n  }\n"]))),Object(P.d)(Wc||(Wc=Object(N.a)(["\n  mutation eliminarCodigoProducto($id: ID!) {\n    eliminarCodigoProducto(id: $id) {\n      message\n    }\n  }\n"])))),Lc=a(1007),Bc=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Uc=Object(k.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper},spin_container:{position:"absolute",height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},spin:{zIndex:9999},titulos:{fontWeight:500}}}));function qc(e){var t=e.codigos,a=e.refetch,n=Uc(),c=JSON.parse(localStorage.getItem("sesionCafi")),r=u.a.useState(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useContext)(Pe),d=l.datos_generales,b=l.setDatosGenerales,p=Object(j.useState)(""),x=Object(y.a)(p,2),h=x[0],_=x[1],f=Object(j.useState)([]),g=Object(y.a)(f,2),A=g[0],k=g[1],N=Object(j.useState)(!1),P=Object(y.a)(N,2),E=P[0],D=P[1],z=Object(j.useState)(!1),T=Object(y.a)(z,2),$=T[0],W=T[1],R=Object(j.useState)(!1),V=Object(y.a)(R,2),M=V[0],B=V[1],U=Object(j.useState)({}),q=Object(y.a)(U,2),J=q[0],G=q[1],Q=Object(j.useState)(""),K=Object(y.a)(Q,2),X=K[0],Z=K[1],ee=Object(j.useState)({message:"",status:"",open:!1}),te=Object(y.a)(ee,2),ae=te[0],re=te[1],ie=Object(w.a)(Vc),oe=Object(y.a)(ie,1)[0],se=Object(w.a)(Mc),le=Object(y.a)(se,1)[0],de=function(){G({}),k([]),_(""),s(!1)},je=Object(Lc.a)(h,500),ue=Object(y.a)(je,1)[0],be=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var n,r,i,o;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Name,r=t.Value,b(Object(m.a)(Object(m.a)({},d),{},{clave_producto_sat:{Name:n,Value:r}})),e.prev=2,W(!0),e.next=6,oe({variables:{input:{Name:n,Value:r,empresa:c.empresa._id,sucursal:c.sucursal._id}}});case 6:(i=e.sent)&&(o=i.data.crearCodigoProducto.message,re({message:o,status:"success",open:!0}),W(!1),a(),de()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),W(!1),re({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var n,c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,B(!0),e.next=4,le({variables:{id:t._id}});case 4:(n=e.sent)&&(c=n.data.eliminarCodigoProducto.message,re({message:c,status:"success",open:!0}),b(Object(m.a)(Object(m.a)({},d),{},{clave_producto_sat:{Name:"",Value:""}})),B(!1),a()),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),B(!1),re({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),me=function(){de()},Oe=Object(j.useCallback)(Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue){e.next=3;break}return k([]),e.abrupt("return");case 3:return D(!0),e.prev=4,e.next=7,Rc.Catalogs.ProductsOrServices(ue,(function(e){k(e),D(!1)}),(function(e){e&&e.responseJSON&&Z(e.responseJSON),D(!1)}));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),e.t0&&e.t0.responseJSON&&Z(e.t0.responseJSON.Message),D(!1);case 13:case"end":return e.stop()}}),e,null,[[4,9]])}))),[ue]);return Object(j.useEffect)((function(){Oe()}),[Oe]),Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:ae,setAlert:re}),Object(H.jsx)(L.a,{className:n.titulos,children:"Clave de producto SAT"}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(ka.a,{id:"catalogos-bd-productos",size:"small",options:t,disabled:M,getOptionLabel:function(e){return e.Name?"".concat(e.Value," - ").concat(e.Name):""},fullWidth:!0,renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{variant:"outlined",InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsxs)(j.Fragment,{children:[M?Object(H.jsx)(I.a,{size:20}):null,e.InputProps.endAdornment]})})}))},renderOption:function(e){return Object(H.jsxs)(j.Fragment,{children:["".concat(e.Value," - ").concat(e.Name),Object(H.jsx)("div",{style:{flexGrow:1}}),Object(H.jsx)(ce.a,{size:"small",onClick:function(){return pe(e)},children:Object(H.jsx)(Gt.a,{})})]})},onChange:function(e,t){return function(e){if(!e)return b(Object(m.a)(Object(m.a)({},d),{},{clave_producto_sat:{Name:"",Value:""}})),null;b(Object(m.a)(Object(m.a)({},d),{},{clave_producto_sat:{Name:e.Name,Value:e.Value}}))}(t)},getOptionSelected:function(e,t){return e.Value===t.Value},value:d.clave_producto_sat}),Object(H.jsx)(F.a,{color:"primary",onClick:function(){return s(!0)},children:Object(H.jsx)(Nc.a,{})})]}),Object(H.jsxs)(qe.a,{open:o,TransitionComponent:Bc,keepMounted:!0,onClose:me,"aria-labelledby":"alert-dialog-clave-producto",fullWidth:!0,maxWidth:"sm",children:[Object(H.jsx)(Bt.a,{id:"alert-dialog-clave-producto",children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:"Catalogo de productos y servicios SAT"}),Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return me()},size:"large",disabled:$,children:Object(H.jsx)(Gt.a,{})})})]})}),$?Object(H.jsx)("div",{className:n.spin_container,children:Object(H.jsx)(I.a,{className:n.spin,size:35})}):null,Object(H.jsxs)("div",{style:$?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsxs)(O.a,{p:2,children:[Object(H.jsx)(S.a,{variant:"outlined",label:"producto, servicio o giro de la empresa",fullWidth:!0,size:"small",onChange:function(e){_(e.target.value),Z("")},value:h,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(Nc.a,{color:"disabled"})})},error:!!X,helperText:X||""}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(Mt.a,{severity:"info",children:"Para seleccionar un cliente haz un doble click!"})})]}),Object(H.jsx)(He.a,{style:{height:"50vh"},children:Object(H.jsx)(O.a,{my:3,className:n.root,children:E?Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"25vh",children:Object(H.jsx)(I.a,{})}):Object(H.jsx)(Ic.a,{dense:!0,component:"nav","aria-label":"main mailbox folders",children:A.map((function(e,t){return Object(H.jsx)(or,{producto:e,busqueda:h,handleOk:be,setSelectedIndex:G,selectedIndex:J},t)}))})})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){return me()},children:"Cancelar"})})]})]})]})}var Jc,Hc,Gc,Yc,Qc,Kc,Xc,Zc,er,tr,ar,nr,cr,rr,ir,or=function(e){var t=e.producto,a=e.busqueda,n=e.handleOk,c=e.selectedIndex,r=e.setSelectedIndex,i=a.includes("potacio");return"0"!==t.Value||i?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(kc.a,{button:!0,selected:c.Value===t.Value,onClick:function(e){return a=e.detail,r(c=t),void(2===a&&n(c));var a,c},children:Object(H.jsx)(wc.a,{primary:"".concat(t.Value," - ").concat(t.Name)})}),Object(H.jsx)(et.a,{})]}):null},sr=Object(P.d)(Jc||(Jc=Object(N.a)(["\n\tmutation crearCategoria($input: CrearCategoriasInput) {\n\t\tcrearCategoria(input: $input) {\n\t\t\t_id\n\t\t\tcategoria\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),lr=Object(P.d)(Hc||(Hc=Object(N.a)(["\n\tmutation crearSubcategoria($idCategoria: ID!, $input: CrearSubcategoriasInput, $empresa: ID!, $sucursal: ID!) {\n\t\tcrearSubcategoria(idCategoria: $idCategoria, input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),dr=Object(P.d)(Gc||(Gc=Object(N.a)(["\n\tmutation actualizarCategoria($idCategoria: ID!, $input: ActualizarCategoriasInput, $empresa: ID!, $sucursal: ID!) {\n\t\tactualizarCategoria(idCategoria: $idCategoria, input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),jr=Object(P.d)(Yc||(Yc=Object(N.a)(["\n\tmutation actualizarSubcategoria($idCategoria: ID!, $idSubcategoria: ID!, $input: ActualizarSubcategoriasInput, $empresa: ID!, $sucursal: ID!) {\n\t\tactualizarSubcategoria(idCategoria: $idCategoria, idSubcategoria: $idSubcategoria, input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),ur=Object(P.d)(Qc||(Qc=Object(N.a)(["\n\tquery obtenerCategorias($empresa: ID!, $sucursal: ID!) {\n\t\tobtenerCategorias(empresa: $empresa, sucursal: $sucursal) {\n\t\t\t_id\n\t\t\tcategoria\n\t\t\tsubcategorias {\n\t\t\t\t_id\n\t\t\t\tsubcategoria\n\t\t\t}\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),br=Object(P.d)(Kc||(Kc=Object(N.a)(["\n\tmutation eliminarCategoria($idCategoria: ID!,$empresa: ID!, $sucursal: ID!) {\n\t\teliminarCategoria(idCategoria: $idCategoria, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),pr=Object(P.d)(Xc||(Xc=Object(N.a)(["\n\tmutation eliminarSubcategoria($idCategoria: ID!, $idSubcategoria: ID!, $empresa: ID!, $sucursal: ID!) {\n\t\teliminarSubcategoria(idCategoria: $idCategoria, idSubcategoria: $idSubcategoria, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),mr=Object(P.d)(Zc||(Zc=Object(N.a)(["\n  query ObtenerDepartamentos($empresa: ID!, $sucursal: ID!) {\n    obtenerDepartamentos(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      nombre_departamentos\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n    }\n  }\n"]))),Or=Object(P.d)(er||(er=Object(N.a)(["\n  mutation CrearDepartamentos(\n    $input: DepartamentosInput\n    $empresa: ID!\n    $sucursal: ID!\n  ) {\n    crearDepartamentos(input: $input, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),xr=Object(P.d)(tr||(tr=Object(N.a)(["\n\tmutation ActualzarDepartamentos($input: DepartamentosInput, $id: ID!, $empresa:ID!, $sucursal:ID!){\n        actualzarDepartamentos(input: $input, id: $id, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),hr=Object(P.d)(ar||(ar=Object(N.a)(["\n    mutation EliminarDepartamento($id: ID!, $empresa:ID!, $sucursal:ID!){\n        eliminarDepartamento(id: $id, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n\t\n"]))),_r=Object(P.d)(nr||(nr=Object(N.a)(["\n  query ObtenerMarcas($empresa: ID!, $sucursal: ID) {\n    obtenerMarcas(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      nombre_marca\n    }\n  }\n"]))),fr=Object(P.d)(cr||(cr=Object(N.a)(["\n  mutation CrearMarca($input: MarcasInput!, $empresa: ID!, $sucursal: ID!) {\n    crearMarcas(input: $input, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),gr=Object(P.d)(rr||(rr=Object(N.a)(["\n    mutation actualzarMarcas($input: MarcasInput, $id: ID!, $empresa:ID!, $sucursal:ID! ) {\n\t\tactualzarMarcas(id: $id, input: $input, empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),vr=Object(P.d)(ir||(ir=Object(N.a)(["\n  mutation eliminarMarca($id: ID!, $empresa: ID!, $sucursal: ID!) {\n    eliminarMarca(id: $id, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"])));function Cr(e){var t=e.tipo,a=e.name,n=e.refetch,c=e.subcategorias,r=e.setSubcategorias,i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],O=Object(j.useState)(!1),x=Object(y.a)(O,2),h=x[0],_=x[1],f=Object(j.useState)(""),A=Object(y.a)(f,2),k=A[0],N=A[1],P=JSON.parse(localStorage.getItem("sesionCafi")),E=Object(j.useContext)(Pe),D=E.datos_generales,z=E.setDatosGenerales,T=Object(j.useState)({message:"",status:"",open:!1}),$=Object(y.a)(T,2),W=$[0],R=$[1],V=Object(w.a)(sr),M=Object(y.a)(V,1)[0],L=Object(w.a)(lr),B=Object(y.a)(L,1)[0],U=Object(w.a)(Or),q=Object(y.a)(U,1)[0],J=Object(w.a)(fr),G=Object(y.a)(J,1)[0],Q=function(){l(!s)},K=function(){var e=Object(C.a)(Object(v.a)().mark((function e(i){var o,s,l,d,j,u,b,O,x,h;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.preventDefault(),k){e.next=4;break}return p(!0),e.abrupt("return");case 4:o={input:Object(g.a)({},a,k),empresa:P.empresa._id,sucursal:P.sucursal._id},"categoria"===t&&(o={input:(s={},Object(g.a)(s,a,k),Object(g.a)(s,"empresa",P.empresa._id),Object(g.a)(s,"sucursal",P.sucursal._id),s)}),"subcategoria"===t&&(o={input:Object(g.a)({},a,k),idCategoria:D.id_categoria}),_(!0),e.prev=8,e.t0=t,e.next="categoria"===e.t0?12:"subcategoria"===e.t0?19:"departamento"===e.t0?27:"marca"===e.t0?34:41;break;case 12:return e.next=14,M({variables:o});case 14:return l=e.sent,n(),d=l.data.crearCategoria._id,z(Object(m.a)(Object(m.a)({},D),{},{categoria:k,id_categoria:d})),e.abrupt("break",42);case 19:return e.next=21,B(Object(m.a)({empresa:P.empresa._id,sucursal:P.sucursal._id},o));case 21:return j=e.sent,n(),u=j.data.crearSubcategoria.message,r([].concat(Object(Ia.a)(c),[{_id:u,subcategoria:k}])),z(Object(m.a)(Object(m.a)({},D),{},{subcategoria:k,id_subcategoria:u})),e.abrupt("break",42);case 27:return e.next=29,q({variables:o});case 29:return b=e.sent,n(),O=b.data.crearDepartamentos.message,z(Object(m.a)(Object(m.a)({},D),{},{departamento:k,id_departamento:O})),e.abrupt("break",42);case 34:return e.next=36,G({variables:o});case 36:return x=e.sent,n(),h=x.data.crearMarcas.message,z(Object(m.a)(Object(m.a)({},D),{},{marca:k,id_marca:h})),e.abrupt("break",42);case 41:return e.abrupt("break",42);case 42:R({message:"\xa1Listo!",status:"success",open:!0}),_(!1),Q(),e.next=51;break;case 47:e.prev=47,e.t1=e.catch(8),_(!1),e.t1.message?R({message:e.t1.message,status:"error",open:!0}):R({message:"Hubo un error",status:"error",open:!0});case 51:case"end":return e.stop()}}),e,null,[[8,47]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{color:"primary",onClick:function(){return Q()},disabled:"subcategoria"===t&&!D.id_categoria,children:Object(H.jsx)(Ut.a,{})}),Object(H.jsxs)(qe.a,{open:s,onClose:Q,"aria-labelledby":"modal-title-".concat(t),children:[Object(H.jsx)(Y,{alert:W,setAlert:R}),Object(H.jsxs)(Bt.a,{id:"modal-title-".concat(t),children:["Registrar ",t]}),Object(H.jsx)(He.a,{children:Object(H.jsx)("form",{id:"registro-".concat(a),onSubmit:function(e){return K(e)},children:Object(H.jsx)(S.a,{error:b,name:a,autoFocus:!0,label:t,fullWidth:!0,variant:"outlined",onChange:function(e){N(e.target.value)},helperText:b?"Campo obligatorio":"",inputProps:{style:{textTransform:"uppercase"}}})})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return Q()},color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{form:"registro-".concat(a),type:"submit",variant:"contained",color:"primary",endIcon:h?Object(H.jsx)(I.a,{color:"inherit",size:18}):null,children:"Guardar"})]})]})]})}var yr=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function Ar(e){var t=e.categorias,a=e.refetch,n=yr(),c=Object(j.useContext)(Pe),r=c.datos_generales,i=c.setDatosGenerales,o=c.setSubcategorias;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Categoria"}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(ka.a,{id:"form-producto-categoria",size:"small",fullWidth:!0,options:t,getOptionLabel:function(e){return e.categoria},renderInput:function(e){var t=Object(m.a)({},e);return t.inputProps.style={textTransform:"uppercase"},Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},t),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){if(!t)return i(Object(m.a)(Object(m.a)({},r),{},{categoria:"",id_categoria:""})),void o([]);i(Object(m.a)(Object(m.a)({},r),{},{categoria:t.categoria,id_categoria:t._id})),o(t.subcategorias)}(0,t)},getOptionSelected:function(e,t){return e.categoria===t.categoria},value:r.categoria?r:null}),Object(H.jsx)(Cr,{tipo:"categoria",name:"categoria",refetch:a})]})]})}var Sr=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function Fr(e){var t=e.refetch,a=Sr(),n=Object(j.useContext)(Pe),c=n.datos_generales,r=n.setDatosGenerales,i=n.subcategorias,o=n.setSubcategorias;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(L.a,{className:a.titulos,children:"Subcategoria"}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(ka.a,{id:"form-producto-subcategoria",size:"small",fullWidth:!0,options:i,getOptionLabel:function(e){return e.subcategoria},renderInput:function(e){var t=Object(m.a)({},e);return t.inputProps.style={textTransform:"uppercase"},Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},t),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){r(t?Object(m.a)(Object(m.a)({},c),{},{subcategoria:t.subcategoria,id_subcategoria:t._id}):Object(m.a)(Object(m.a)({},c),{},{subcategoria:"",id_subcategoria:""}))}(0,t)},getOptionSelected:function(e,t){return e.subcategoria===t.subcategoria},value:c.subcategoria?c:null}),Object(H.jsx)(Cr,{tipo:"subcategoria",name:"subcategoria",refetch:t,subcategorias:i,setSubcategorias:o})]})]})}var Ir=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function kr(e){var t=e.departamentos,a=e.refetch,n=Ir(),c=Object(j.useContext)(Pe),r=c.datos_generales,i=c.setDatosGenerales;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Departamento"}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(ka.a,{id:"form-producto-departamento",size:"small",fullWidth:!0,options:t,getOptionLabel:function(e){return e.nombre_departamentos?e.nombre_departamentos:e.departamento},renderInput:function(e){var t=Object(m.a)({},e);return t.inputProps.style={textTransform:"uppercase"},Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},t),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){i(t?Object(m.a)(Object(m.a)({},r),{},{departamento:t.nombre_departamentos,id_departamento:t._id}):Object(m.a)(Object(m.a)({},r),{},{departamento:"",id_departamento:""}))}(0,t)},getOptionSelected:function(e,t){return e.nombre_departamentos===t.departamento},value:r.departamento?r:null}),Object(H.jsx)(Cr,{tipo:"departamento",name:"nombre_departamentos",refetch:a})]})]})}var wr=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function Nr(e){var t=e.marcas,a=e.refetch,n=wr(),c=Object(j.useContext)(Pe),r=c.datos_generales,i=c.setDatosGenerales;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Marca"}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(ka.a,{id:"form-producto-marca",size:"small",fullWidth:!0,options:t,getOptionLabel:function(e){return e.nombre_marca?e.nombre_marca:e.marca},renderInput:function(e){var t=Object(m.a)({},e);return t.inputProps.style={textTransform:"uppercase"},Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},t),{},{variant:"outlined"}))},onChange:function(e,t){return function(e,t){i(t?Object(m.a)(Object(m.a)({},r),{},{marca:t.nombre_marca,id_marca:t._id}):Object(m.a)(Object(m.a)({},r),{},{marca:"",id_marca:""}))}(0,t)},getOptionSelected:function(e,t){return e.nombre_marca===t.marca},value:r.marca?r:null}),Object(H.jsx)(Cr,{tipo:"marca",name:"nombre_marca",refetch:a})]})]})}var Pr=Object(k.a)((function(e){return{formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},obligatorio:{color:"red"},titulos:{fontWeight:500},without_arrows:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}}));function Er(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=Pr(),c=Object(j.useContext)(Pe),r=c.datos_generales,i=c.setDatosGenerales,o=c.validacion,s=c.precios,l=c.setPrecios,d=c.centro_de_costos,u=c.setSubcostos,b=Object(j.useContext)(Pe),p=b.setSubcategorias,x=b.unidadVentaXDefecto,h=b.setUnidadVentaXDefecto,_=b.unidadVentaSecundaria,f=b.setUnidadVentaSecundaria,v=b.presentaciones,C=b.update,y=t.categorias,F=t.departamentos,I=t.marcas,k=t.centro_costos,w=t.codigos,N=function(e){var t=e.target,a=t.name,n=t.value;if("monedero_electronico"===a)return n?void l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},a,parseFloat(n)))):void l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},a,"")));"codigo_barras"===a&&h(Object(m.a)(Object(m.a)({},x),{},{codigo_barras:n})),"tipo_producto"===a&&"OTROS"!==n&&(l(Object(m.a)(Object(m.a)({},s),{},{granel:!1,inventario:Object(m.a)(Object(m.a)({},s.inventario),{},{unidad_de_inventario:"Pz",codigo_unidad:"H87"}),unidad_de_compra:Object(m.a)(Object(m.a)({},s.unidad_de_compra),{},{unidad:"Pz",codigo_unidad:"H87"})})),h(Object(m.a)(Object(m.a)({},x),{},{unidad:"Pz",codigo_unidad:"H87"})),f(Object(m.a)(Object(m.a)({},_),{},{unidad:"Caja",codigo_unidad:"XBX"}))),i(Object(m.a)(Object(m.a)({},r),{},Object(g.a)({},a,n)))},P=function(e){var t,a,n=e.target,c=n.name,r=n.checked;"monedero"===c&&r?l(Object(m.a)(Object(m.a)({},s),{},{monedero_electronico:1,monedero:r})):"granel"===c&&r?(l(Object(m.a)(Object(m.a)({},s),{},(t={},Object(g.a)(t,c,r),Object(g.a)(t,"inventario",Object(m.a)(Object(m.a)({},s.inventario),{},{unidad_de_inventario:"Kg",codigo_unidad:"KGM"})),Object(g.a)(t,"unidad_de_compra",Object(m.a)(Object(m.a)({},s.unidad_de_compra),{},{unidad:"Kg",codigo_unidad:"KGM"})),t))),h(Object(m.a)(Object(m.a)({},x),{},{unidad:"Kg",codigo_unidad:"KGM"})),f(Object(m.a)(Object(m.a)({},_),{},{unidad:"Costal",codigo_unidad:"KGM"}))):(l(Object(m.a)(Object(m.a)({},s),{},(a={},Object(g.a)(a,c,r),Object(g.a)(a,"inventario",Object(m.a)(Object(m.a)({},s.inventario),{},{unidad_de_inventario:"Pz",codigo_unidad:"H87"})),Object(g.a)(a,"unidad_de_compra",Object(m.a)(Object(m.a)({},s.unidad_de_compra),{},{unidad:"Pz",codigo_unidad:"H87"})),a))),h(Object(m.a)(Object(m.a)({},x),{},{unidad:"Pz",codigo_unidad:"H87"})),f(Object(m.a)(Object(m.a)({},_),{},{unidad:"Caja",codigo_unidad:"XBX"})))};return Object(j.useEffect)((function(){if(C){var e=y.filter((function(e){return e._id===r.id_categoria})),t=k.filter((function(e){return e._id===d.id_cuenta}));e.length>0&&p(e[0].subcategorias),t.length>0&&u(t[0].subcuentas)}}),[C]),Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(A.a,{maxWidth:"lg",children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:3,xs:12,children:Object(H.jsxs)(ee.a,{variant:"outlined",size:"small",name:"codigo_barras",fullWidth:!0,className:n.without_arrows,children:[Object(H.jsx)(L.a,{className:n.titulos,children:"C\xf3digo de barras"}),Object(H.jsx)(ae.a,{disabled:!(!C||!r.codigo_barras),style:{padding:0},id:"form-producto-codigo-barras",name:"codigo_barras",value:r.codigo_barras?r.codigo_barras:"",type:"number",onChange:N,autoFocus:!0,endAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(ce.a,{disabled:!(!C||!r.codigo_barras),onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();i(Object(m.a)(Object(m.a)({},r),{},{codigo_barras:t})),h(Object(m.a)(Object(m.a)({},x),{},{codigo_barras:t}))}()},color:"primary",size:"small",children:Object(H.jsx)(Fc.a,{})})})})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsxs)(L.a,{className:n.titulos,children:[Object(H.jsx)("span",{className:n.obligatorio,children:"* "}),"Clave alterna"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o.error&&!r.clave_alterna,name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",value:r.clave_alterna?r.clave_alterna:"",helperText:o.message,onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsxs)(L.a,{className:n.titulos,children:[Object(H.jsx)("span",{className:n.obligatorio,children:"* "}),"Tipo de producto"]}),Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",error:o.error&&!r.tipo_producto,children:[Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"tipo_producto",value:r.tipo_producto?r.tipo_producto:"",disabled:v.length,onChange:N,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Object(H.jsx)(Pt.a,{value:"ROPA",children:"ROPA"}),Object(H.jsx)(Pt.a,{value:"CALZADO",children:"CALZADO"}),Object(H.jsx)(Pt.a,{value:"OTROS",children:"OTROS"})]}),Object(H.jsx)(wa.a,{children:o.message})]})]}),Object(H.jsx)(Qe.a,{item:!0,md:5,xs:12,children:Object(H.jsx)(qc,{codigos:w,refetch:a})}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsxs)(L.a,{className:n.titulos,children:[Object(H.jsx)("span",{className:n.obligatorio,children:"* "}),"Nombre comercial"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o.error&&!r.nombre_comercial,name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:r.nombre_comercial?r.nombre_comercial:"",helperText:o.message,onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsxs)(L.a,{className:n.titulos,children:[Object(H.jsx)("span",{className:n.obligatorio,children:"* "}),"Nombre gen\xe9rico"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o.error&&!r.nombre_generico,name:"nombre_generico",id:"form-producto-nombre-generico",variant:"outlined",value:r.nombre_generico?r.nombre_generico:"",helperText:o.message,onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Descripci\xf3n"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"descripcion",id:"form-producto-descripcion",variant:"outlined",value:r.descripcion?r.descripcion:"",onChange:N,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(Ar,{refetch:a,categorias:y})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(Fr,{refetch:a})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(kr,{refetch:a,departamentos:F})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(Nr,{refetch:a,marcas:I})})]}),Object(H.jsx)(O.a,{display:"flex",mt:4,children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,md:3,xs:12,children:C?null:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Granel"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsx)("div",{className:n.formInput,children:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:!!s.granel&&s.granel,onChange:P,name:"granel",disabled:"OTROS"!==r.tipo_producto}),label:"Vender a granel"})})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Farmacia"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsx)("div",{className:n.formInput,children:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:!!r.receta_farmacia&&r.receta_farmacia,onChange:function(e){i(Object(m.a)(Object(m.a)({},r),{},{receta_farmacia:e.target.checked}))},name:"receta_farmacia"}),label:"Necesita receta",name:"receta_farmacia"})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Monedero el\xe9ctronico"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsx)(O.a,{children:Object(H.jsxs)(O.a,{className:n.formInput,children:[Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:s.monedero,onChange:P,name:"monedero"}),label:"Monedero electr\xf3nico"}),Object(H.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0},startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},size:"small",label:"Valor por punto",name:"monedero_electronico",id:"form-producto-monedero_electronico",variant:"outlined",value:s.monedero_electronico,onChange:N,disabled:!s.monedero,onBlur:function(){s.monedero_electronico||l(Object(m.a)(Object(m.a)({},s),{},{monedero_electronico:1}))},error:""===s.monedero_electronico})]})})]})]})})]})})}var Dr=a(940),zr=a(941),Tr=a(472),$r=a.n(Tr),Wr=Object(k.a)((function(e){return{formInputFlex:{display:"flex",width:"100%","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(0),"px ").concat(e.spacing(1),"px")},input:{display:"none"},imagen:{maxHeight:"100%",maxWidth:"100%"}}}));function Rr(){var e=Wr(),t=Object(j.useContext)(Pe),a=t.imagenes,n=t.setImagenes,c=t.setOnPreview,r=t.onPreview,i=a.map((function(e,t){return Object(H.jsx)(Yr,{index:t,imagen:e},t)}));return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)("input",{accept:"image/*",className:e.input,id:"contained-button-file",type:"file",onChange:function(e){var t=e.target.files;e.target.files.length<1||(n([].concat(Object(Ia.a)(a),[t[0]])),c({image:URL.createObjectURL(t[0])}))}}),Object(H.jsx)("label",{htmlFor:"contained-button-file",children:Object(H.jsx)(F.a,{variant:"text",color:"primary",component:"span",startIcon:Object(H.jsx)(Dr.a,{}),children:"Cargar imagen"})})]}),i]}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsxs)(O.a,{display:"flex",minHeight:300,children:[Object(H.jsx)(O.a,{mx:1,children:Object(H.jsx)(et.a,{orientation:"vertical"})}),Object(H.jsx)(O.a,{width:"100%",height:"50vh",display:"flex",justifyContent:"center",alignItems:"center",children:r.image?Object(H.jsx)("img",{alt:"img-onPreview",src:r.image,className:e.imagen}):Object(H.jsx)($r.a,{style:{fontSize:150}})})]})})]})})}var Vr,Mr,Lr,Br,Ur,qr,Jr,Hr,Gr,Yr=function(e){var t=e.imagen,a=e.index,n=Wr(),c=t.key_imagen?t.url_imagen:URL.createObjectURL(t),r=Object(j.useContext)(Pe),i=r.imagenes,o=r.setImagenes,s=r.setOnPreview,l=r.onPreview,d=r.imagenes_eliminadas,u=r.setImagenesEliminadas,b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],x=p[1],h=function(){return x(!m)};return Object(H.jsxs)(O.a,{my:2,mr:5,children:[Object(H.jsxs)(O.a,{className:n.formInputFlex,children:[Object(H.jsx)(O.a,{height:70,width:70,children:Object(H.jsx)("img",{alt:"producto-img-prev",src:c,width:"100%"})}),Object(H.jsxs)(O.a,{width:"90%",children:[Object(H.jsx)(L.a,{noWrap:!0,children:t.key_imagen?t.key_imagen:t.name}),t.key_imagen?null:Object(H.jsxs)(L.a,{variant:"caption",children:[t.size," bits"]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",children:[Object(H.jsx)(F.a,{size:"small",startIcon:Object(H.jsx)(Jt.a,{}),onClick:function(){return s({index:a,image:c})},children:"previsualizar"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(Qr,{handleModal:h,open:m,eliminarImagen:function(){t.key_imagen&&u([].concat(Object(Ia.a)(d),[t])),l.index===a&&s({index:"",image:""});var e=Object(Ia.a)(i);e.splice(a,1),o(Object(Ia.a)(e)),h()}})]})]})]}),Object(H.jsx)(et.a,{})]})},Qr=function(e){var t=e.handleModal,a=e.open,n=e.eliminarImagen;return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{size:"small",color:"secondary",startIcon:Object(H.jsx)(zr.a,{}),onClick:function(){return t()},children:"eliminar"}),Object(H.jsxs)(qe.a,{open:a,onClose:t,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return t()},color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return n()},children:"Eliminar"})]})]})]})},Kr=Object(j.createContext)(),Xr=function(e){var t=e.children,a=Object(j.useState)({nombre_almacen:"",id_usuario_encargado:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1];return Object(H.jsx)(Kr.Provider,{value:{datosAlmacen:c,setDatosAlmacen:r,update:s,setUpdate:l,error:b,setError:p,openRegistro:x,setOpenRegistro:h},children:t})},Zr=Object(P.d)(Vr||(Vr=Object(N.a)(["\n  mutation CrearAlmacen($input: CrearAlmacen, $id: ID!, $empresa: ID!) {\n    crearAlmacen(input: $input, id: $id, empresa: $empresa) {\n      _id\n    }\n  }\n"]))),ei=Object(P.d)(Mr||(Mr=Object(N.a)(["\n  query obtenerAlmacenes($id: ID!) {\n    obtenerAlmacenes(id: $id) {\n      _id\n      nombre_almacen\n      id_usuario_encargado {\n        _id\n        nombre\n      }\n      id_sucursal {\n        _id\n        nombre_sucursal\n        descripcion\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n      }\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      default_almacen\n    }\n  }\n"]))),ti=Object(P.d)(Lr||(Lr=Object(N.a)(["\n  mutation ActualizarAlmacen($input: EditarAlmacen, $id: ID!) {\n    actualizarAlmacen(input: $input, id: $id) {\n      message\n    }\n  }\n"]))),ai=Object(P.d)(Br||(Br=Object(N.a)(["\n  mutation eliminarAlmacen($id: ID!) {\n    eliminarAlmacen(id: $id) {\n      message\n    }\n  }\n"]))),ni=Object(P.d)(Ur||(Ur=Object(N.a)(["\n  query obtenerProductosAlmacenes(\n    $input: InputProductosAlmacenes \n    $limit: Int \n    $offset: Int\n  ) {\n    obtenerProductosAlmacenes(\n      input: $input\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          inventario {\n            inventario_maximo\n            inventario_minimo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          precio_de_compra {\n            ieps\n            iva\n            precio_con_impuesto\n            precio_sin_impuesto\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n        }\n        medidas_producto {\n          _id\n          cantidad\n          almacen\n          descuento_activo\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          codigo_barras\n          color {\n            _id\n            nombre\n            hex\n          }\n          existencia\n          medida {\n            _id\n            talla\n            tipo\n          }\n          nombre_comercial\n          precio\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n        existencia_almacenes {\n          _id {\n            producto\n            almacen {\n              _id\n              nombre_almacen\n            }\n          }\n          unidad_inventario\n          cantidad_existente\n          unidad_maxima\n          cantidad_existente_maxima\n        }\n        empresa\n        sucursal\n      }\n      totalDocs   \n    }\n  }\n"]))),ci=Object(P.d)(qr||(qr=Object(N.a)(["\n  query obtenerCategorias($empresa: ID!, $sucursal: ID!) {\n    obtenerCategorias(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      categoria\n      subcategorias {\n        _id\n        subcategoria\n      }\n    }\n  }\n"]))),ri=Object(P.d)(Jr||(Jr=Object(N.a)(["\n  mutation CrearTraspaso(\n    $input: CrearTraspasoInput\n    $usuario: ID!\n    $empresa: ID!\n  ) {\n    crearTraspaso(input: $input, usuario: $usuario, empresa: $empresa) {\n      message\n      resp\n    }\n  }\n"]))),ii=Object(P.d)(Hr||(Hr=Object(N.a)(["\n  query obtenerProductosPorEmpresa($empresa: ID!, $filtro: String, $limit: Int, \n    $offset: Int) {\n    obtenerProductosPorEmpresa(empresa: $empresa, filtro: $filtro,  limit: $limit\n      offset: $offset) {\n      docs {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precio_plazos {\n          precio_cajas {\n            plazo\n            unidad\n            precio\n          }\n          precio_piezas {\n            plazo\n            unidad\n            precio\n          }\n          precio_costales {\n            plazo\n            unidad\n            precio\n          }\n        }\n        precios {\n          ieps\n          ieps_activo\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            ieps\n            iva\n            precio_con_impuesto\n            precio_sin_impuesto\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            unidad_mayoreo\n            utilidad\n            ieps_precio\n            iva_precio\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          granel\n        }\n        sucursal\n        usuario\n        empresa\n      },\n      totalDocs  \n    }\n  }\n"]))),oi=Object(P.d)(Gr||(Gr=Object(N.a)(["\n  query obtenerTraspasos(\n    $input: ConsultaTraspasosInput\n    $limit: Int\n    $offset: Int\n  ) { \n    obtenerTraspasos(input: $input, limit: $limit, offset: $offset) {\n      docs {\n        _id\n        cantidad\n        unidad\n        id_traspaso {\n          concepto_traspaso {\n            nombre_concepto\n          }\n          fecha_registro\n          almacen_origen {\n            _id\n            nombre_almacen\n          }\n          almacen_destino {\n            _id\n            nombre_almacen\n          }\n        }\n        producto {\n          datos_generales {\n            nombre_comercial\n          }\n        }\n      }\n      totalDocs\n    }\n  }\n"]))),si={mi_empresa:{datos_empresa:{ver:!1,agregar:!1,editar:!1,eliminar:!1},informacion_fiscal:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},compras:{abrir_compra:{ver:!1,agregar:!1,editar:!1,eliminar:!1},compras_realizadas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},compras_espera:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},tesoreria:{cuentas_empresa:{ver:!1,agregar:!1,editar:!1,eliminar:!1},egresos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},abonos_proveedores:{ver:!1,agregar:!1,editar:!1,eliminar:!1},abonos_clientes:{ver:!1,agregar:!1,editar:!1,eliminar:!1},caja_principal:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},reportes:{reporte_historial_cajas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_turnos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_compras:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_ventas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},rerporte_almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_corte_caja:{ver:!1,agregar:!1,editar:!1,eliminar:!1},reporte_tesoreria:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},ventas:{cancelar_venta:{ver:!1,agregar:!1,editar:!1,eliminar:!1},precios_productos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},pre_corte:{ver:!1,agregar:!1,editar:!1,eliminar:!1},cotizaciones:{ver:!1,agregar:!1,editar:!1,eliminar:!1},administrador:{ver:!1,agregar:!1,editar:!1,eliminar:!1},eliminar_ventas:{ver:!1,agregar:!1,editar:!1,eliminar:!1},producto_rapido:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},almacenes:{almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1},traspasos:{ver:!1,agregar:!1,editar:!1,eliminar:!1},inventario_almacen:{ver:!1,agregar:!1,editar:!1,eliminar:!1}},catalogos:{clientes:{ver:!1,agregar:!1,eliminar:!1,editar:!1},usuarios:{ver:!1,agregar:!1,eliminar:!1,editar:!1},productos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},marcas:{ver:!1,agregar:!1,eliminar:!1,editar:!1},contabilidad:{ver:!1,agregar:!1,eliminar:!1,editar:!1},provedores:{ver:!1,agregar:!1,eliminar:!1,editar:!1},cajas:{ver:!1,agregar:!1,eliminar:!1,editar:!1},departamentos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},centro_costos:{ver:!1,agregar:!1,eliminar:!1,editar:!1},conceptos_almacen:{ver:!1,agregar:!1,eliminar:!1,editar:!1},categorias:{ver:!1,agregar:!1,eliminar:!1,editar:!1},colores:{ver:!1,agregar:!1,eliminar:!1,editar:!1},tallas_numeros:{ver:!1,agregar:!1,eliminar:!1,editar:!1}},facturacion:{generar_cdfi:{ver:!1,agregar:!1,editar:!1,eliminar:!1},cdfi_realizados:{ver:!1,agregar:!1,editar:!1,eliminar:!1},registro_series_cdfi:{ver:!1,agregar:!1,editar:!1,eliminar:!1}}},li=Object(j.createContext)(),di=function(e){var t=e.children,a=Object(j.useState)({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_usuario:!0,accesos:si}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)({error:!1,message:""}),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useState)(""),f=Object(y.a)(_,2),g=f[0],v=f[1];return Object(H.jsx)(li.Provider,{value:{usuario:c,setUsuario:r,toUpdate:s,setToUpdate:l,error:b,setError:p,update:x,setUpdate:h,username:g,setUsername:v},children:t})},ji=Object(k.a)((function(e){return{title:{fontWeight:"500","& span":{color:"red"}}}}));function ui(e){var t=e.accion,a=ji(),n=Object(j.useContext)(li),c=n.usuario,r=n.username,i=n.setUsername,o=Object(j.useState)(null),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(!1),b=Object(y.a)(u,2),p=b[0],m=b[1],O=Object(w.a)(E),x=Object(y.a)(O,1)[0],h=Object(an.useDebounce)(r,800),_=Object(y.a)(h,1)[0],f=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,m(!0),e.next=6,x({variables:{username:t}});case 6:d(!0),m(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),d(!1),m(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.useEffect)((function(){f(_)}),[_]),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(L.a,{className:a.title,children:"Username"}),Object(H.jsx)(S.a,{fullWidth:!0,placeholder:"Ej: Juan96",autoComplete:"new-password",type:"text",size:"small",disabled:"registrar"!==t&&c.username_login,error:!1===l,variant:"outlined",value:c.username_login?c.username_login:r,helperText:!1===l?"Este username ya existe":"",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:p?Object(H.jsx)(I.a,{size:20}):!0===l?Object(H.jsx)(Yt.a,{color:"primary"}):null})},onChange:function(e){return i(e.target.value)}})]})}var bi=Object(k.a)((function(e){return{title:{fontWeight:"500","& span":{color:"red"}},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:150,height:150,border:"dashed 2px #000000"},avatar:{width:135,height:135,"& > .icon":{fontSize:100}}}}));function pi(e){var t=e.accion,a=bi(),n=Object(j.useContext)(li),c=n.usuario,r=n.setUsuario,i=n.error,o=Object(j.useState)(""),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(!1),b=Object(y.a)(u,2),p=b[0],x=b[1],h=Object(j.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;d(e)},r(Object(m.a)(Object(m.a)({},c),{},{imagen:e[0]}))}),[c,r]),_=Object(at.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:h}),f=_.getRootProps,v=_.getInputProps,C=function(e){"numero_usuario"!==e.target.name?r(Object(m.a)(Object(m.a)({},c),{},Object(g.a)({},e.target.name,e.target.value))):r(Object(m.a)(Object(m.a)({},c),{},Object(g.a)({},e.target.name,parseInt(e.target.value))))},A=function(e){r(Object(m.a)(Object(m.a)({},c),{},{direccion:Object(m.a)(Object(m.a)({},c.direccion),{},Object(g.a)({},e.target.name,e.target.value))}))};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:3,style:{display:"flex",justifyContent:"center",marginTop:"8px"},children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(O.a,Object(m.a)(Object(m.a)({className:a.avatarContainer},f()),{},{children:[Object(H.jsx)("input",Object(m.a)({},v())),l?Object(H.jsx)(Ke.a,{variant:"square",className:a.avatar,src:"".concat(l)}):Object(H.jsx)(Ke.a,{variant:"square",className:a.avatar,src:"".concat(c.imagen)})]})),Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{color:"secondary",size:"medium",onClick:function(){r(Object(m.a)(Object(m.a)({},c),{},{imagen:""})),d("")},startIcon:Object(H.jsx)(ct.a,{}),children:"Remover imagen"})})]})}),Object(H.jsx)(Qe.a,{item:!0,md:9,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:6,children:[Object(H.jsxs)(L.a,{className:a.title,children:[Object(H.jsx)("span",{children:"* "}),"Nombre usuario"]}),Object(H.jsx)(S.a,{fullWidth:!0,autoComplete:"new-password",type:"text",size:"small",error:i.error&&!c.nombre,name:"nombre",variant:"outlined",value:c.nombre?c.nombre:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",inputProps:{style:{textTransform:"uppercase"}},onChange:C})]}),Object(H.jsx)(Qe.a,{item:!0,xs:12,md:6,children:Object(H.jsx)(ui,{accion:t})}),"registrar"===t?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:6,children:[Object(H.jsxs)(L.a,{className:a.title,children:[Object(H.jsx)("span",{children:"* "}),"Contrase\xf1a"]}),Object(H.jsxs)(ee.a,{fullWidth:!0,size:"small",error:!(!i.error||c.password)||!(!i.error||"Las contrase\xf1as no coinciden"!==i.message),name:"password",variant:"outlined",children:[Object(H.jsx)(ae.a,{autoComplete:"new-password",name:"password",type:p?"text":"password",value:c.password?c.password:"",onChange:C,endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!p)},onMouseDown:function(){return x(!p)},children:p?Object(H.jsx)(ie.a,{color:"primary"}):Object(H.jsx)(se.a,{color:"primary"})})})}),Object(H.jsx)(wa.a,{children:i.message})]})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:6,children:[Object(H.jsxs)(L.a,{className:a.title,children:[Object(H.jsx)("span",{children:"* "}),"Repetir contrase\xf1a"]}),Object(H.jsxs)(ee.a,{fullWidth:!0,size:"small",error:!(!i.error||c.password)||!(!i.error||"Las contrase\xf1as no coinciden"!==i.message),name:"repeatPassword",variant:"outlined",children:[Object(H.jsx)(ae.a,{name:"repeatPassword",type:p?"text":"password",value:c.repeatPassword?c.repeatPassword:"",onChange:C,endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return x(!p)},onMouseDown:function(){return x(!p)},children:p?Object(H.jsx)(ie.a,{color:"primary"}):Object(H.jsx)(se.a,{color:"primary"})})})}),Object(H.jsx)(wa.a,{children:i.message})]})]})]}):Object(H.jsx)(Qe.a,{item:!0,xs:12,md:12,children:Object(H.jsx)(mi,{})})]})}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:4,children:[Object(H.jsxs)(L.a,{className:a.title,children:[Object(H.jsx)("span",{children:"* "}),"Email"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:i.error&&!c.email,name:"email",variant:"outlined",value:c.email?c.email:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",onChange:C})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:4,children:[Object(H.jsxs)(L.a,{className:a.title,children:[Object(H.jsx)("span",{children:"* "}),"Num. Telefono"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:i.error&&!c.telefono,name:"telefono",variant:"outlined",value:c.telefono?c.telefono:"",helperText:i.error&&"Las contrase\xf1as no coinciden"!==i.message?i.message:"",onChange:C})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:4,children:[Object(H.jsx)(L.a,{className:a.title,children:"Num. Celular"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"celular",variant:"outlined",value:c.celular?c.celular:"",onChange:C})]})]}),Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsx)(L.a,{className:a.title,children:Object(H.jsx)("b",{children:"Domicilio"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:3,children:[Object(H.jsx)(L.a,{className:a.title,children:"Calle"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"calle",variant:"outlined",value:c.direccion.calle?c.direccion.calle:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:3,children:[Object(H.jsx)(L.a,{className:a.title,children:"Colonia"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"colonia",variant:"outlined",value:c.direccion.colonia?c.direccion.colonia:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:2,children:[Object(H.jsx)(L.a,{className:a.title,children:"Num. Ext"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"no_ext",variant:"outlined",value:c.direccion.no_ext?c.direccion.no_ext:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:2,children:[Object(H.jsx)(L.a,{className:a.title,children:"Num. Int"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"no_int",variant:"outlined",value:c.direccion.no_int?c.direccion.no_int:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:2,children:[Object(H.jsx)(L.a,{className:a.title,children:"CP"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"codigo_postal",variant:"outlined",value:c.direccion.codigo_postal?c.direccion.codigo_postal:"",onChange:A})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:3,children:[Object(H.jsx)(L.a,{className:a.title,children:"Municipio"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",value:c.direccion.municipio?c.direccion.municipio:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:3,children:[Object(H.jsx)(L.a,{className:a.title,children:"Localidad"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"localidad",variant:"outlined",value:c.direccion.localidad?c.direccion.localidad:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:3,children:[Object(H.jsx)(L.a,{className:a.title,children:"Estado"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"estado",variant:"outlined",value:c.direccion.estado?c.direccion.estado:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:3,children:[Object(H.jsx)(L.a,{className:a.title,children:"Pais"}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,name:"pais",variant:"outlined",value:c.direccion.pais?c.direccion.pais:"",onChange:A,inputProps:{style:{textTransform:"uppercase"}}})]})]})]})}var mi=function(){var e=Object(j.useState)(!1),t=Object(y.a)(e,2),a=t[0],n=t[1],c=bi(),r=Object(j.useContext)(li),i=r.usuario,o=r.setUsuario,s=r.error,l=r.setError,d=r.update,u=r.setUpdate,b=Object(j.useState)(!1),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useState)(!1),f=Object(y.a)(_,2),A=f[0],S=f[1],k=Object(j.useState)({message:"",status:"",open:!1}),N=Object(y.a)(k,2),P=N[0],E=N[1],D=Object(w.a)(T),z=Object(y.a)(D,1)[0],$=function(){n(!1),l({error:!1,message:""})},W=function(e){o(Object(m.a)(Object(m.a)({},i),{},Object(g.a)({},e.target.name,e.target.value)))},R=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.password&&i.repeatPassword){e.next=3;break}return l({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 3:if(i.password===i.repeatPassword){e.next=6;break}return l({error:!0,message:"Las contrase\xf1as no coinciden"}),e.abrupt("return");case 6:return S(!0),e.prev=7,e.next=10,z({variables:{input:{password:i.password,repeatPassword:i.repeatPassword},id:i._id}});case 10:u(!d),E({message:"\xa1Listo!",status:"success",open:!0}),S(!1),$(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(7),E({message:"Hubo un error",status:"error",open:!0}),S(!1);case 20:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{color:"primary",variant:"text",onClick:function(){n(!0)},children:"Cambiar contrase\xf1a"}),Object(H.jsxs)(qe.a,{open:a,onClose:$,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(H.jsx)(Y,{alert:P,setAlert:E}),Object(H.jsx)(Bt.a,{id:"alert-dialog-title",children:"Cambiar contrase\xf1a"}),Object(H.jsx)(He.a,{children:Object(H.jsxs)("form",{autocomplete:"off",children:[Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsxs)(L.a,{className:c.title,children:[Object(H.jsx)("span",{children:"* "}),"Contrase\xf1a"]}),Object(H.jsxs)(ee.a,{fullWidth:!0,size:"small",error:!(!s.error||i.password)||!(!s.error||"Las contrase\xf1as no coinciden"!==s.message),name:"password",variant:"outlined",children:[Object(H.jsx)(ae.a,{name:"password",type:x?"text":"password",value:i.password?i.password:"",onChange:W,endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return h(!x)},onMouseDown:function(){return h(!x)},children:x?Object(H.jsx)(ie.a,{color:"primary"}):Object(H.jsx)(se.a,{color:"primary"})})})}),Object(H.jsx)(wa.a,{children:s.message})]})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsxs)(L.a,{className:c.title,children:[Object(H.jsx)("span",{children:"* "}),"Repetir contrase\xf1a"]}),Object(H.jsxs)(ee.a,{fullWidth:!0,size:"small",error:!(!s.error||i.password)||!(!s.error||"Las contrase\xf1as no coinciden"!==s.message),name:"repeatPassword",variant:"outlined",children:[Object(H.jsx)(ae.a,{name:"repeatPassword",type:x?"text":"password",value:i.repeatPassword?i.repeatPassword:"",onChange:W,endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){return h(!x)},onMouseDown:function(){return h(!x)},children:x?Object(H.jsx)(ie.a,{color:"primary"}):Object(H.jsx)(se.a,{color:"primary"})})})}),Object(H.jsx)(wa.a,{children:s.message})]})]})]})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:$,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:R,color:"primary",variant:"contained",autoFocus:!0,endIcon:A?Object(H.jsx)(I.a,{color:"inherit",size:25}):null,children:"Confirmar"})]})]})]})};function Oi(e){var t,a,n,c,r,i,o,s=e.arregloAccesos,l=e.obtenerAccesos,d=e.departamento,j=e.subDepartamento;return Object(H.jsxs)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:[Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:!!s&&(null===(t=s[d][j])||void 0===t?void 0:t.ver),name:"ver",color:"primary",onChange:function(e){return l(e,d,j)}}),label:Object(H.jsx)(O.a,{mr:2,display:"flex",children:"ventas"===d&&"cancelar_venta"!==j?"Autorizar":"Ver"})}),"informacion_fiscal"===j||"datos_empresa"===j||"abrir_compra"===j||"compras_realizadas"===j||"compras_espera"===j||"traspasos"===j||"inventario_almacen"===j||"cuentas_empresa"===j||"generar_cdfi"===j||"cdfi_realizados"===j||"reportes"===d||"ventas"===d||"caja_principal"===j||"egresos"===j?null:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:!!s&&(null===(a=s[d][j])||void 0===a?void 0:a.agregar),name:"agregar",disabled:!s||!1===(null===(n=s[d][j])||void 0===n?void 0:n.ver),color:"primary",onChange:function(e){return l(e,d,j)}}),label:Object(H.jsx)(O.a,{mr:2,display:"flex",children:"Agregar"})}),"cajas"===j||"abrir_compra"===j||"compras_realizadas"===j||"traspasos"===j||"inventario_almacen"===j||"abonos_proveedores"===j||"abonos_clientes"===j||"egresos"===j||"caja_principal"===j||"generar_cdfi"===j||"cdfi_realizados"===j||"registro_series_cdfi"===j||"reportes"===d||"ventas"===d&&"cancelar_venta"!==j?null:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:!!s&&(null===(c=s[d][j])||void 0===c?void 0:c.editar),name:"editar",disabled:!s||!1===(null===(r=s[d][j])||void 0===r?void 0:r.ver),color:"primary",onChange:function(e){return l(e,d,j)}}),label:Object(H.jsx)(O.a,{mr:2,display:"flex",children:"Editar"})}),"informacion_fiscal"===j||"datos_empresa"===j||"abrir_compra"===j||"compras_realizadas"===j||"traspasos"===j||"inventario_almacen"===j||"cuentas_empresa"===j||"abonos_proveedores"===j||"generar_cdfi"===j||"cdfi_realizados"===j||"abonos_clientes"===j||"egresos"===j||"caja_principal"===j||"reportes"===d||"ventas"===d?null:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:!!s&&(null===(i=s[d][j])||void 0===i?void 0:i.eliminar),name:"eliminar",color:"primary",disabled:!s||!1===(null===(o=s[d][j])||void 0===o?void 0:o.ver),onChange:function(e){return l(e,d,j)}}),label:Object(H.jsx)(O.a,{display:"flex",children:"Eliminar"})})]})}function xi(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Clientes"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"clientes"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Usuarios"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"usuarios"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Productos"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"productos"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Marcas"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"marcas"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Provedores"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"provedores"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Contabilidad"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"contabilidad"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Cajas"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"cajas"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Departamento"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"departamentos"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Centro de costos"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"centro_costos"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Conceptos almacen"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"conceptos_almacen"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Categorias"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"categorias"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Colores"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"colores"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Tallas y Numeros"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"catalogos",subDepartamento:"tallas_numeros"})]})})})})]})}function hi(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Datos de Empresa"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"mi_empresa",subDepartamento:"datos_empresa"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Informaci\xf3n Fiscal"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"mi_empresa",subDepartamento:"informacion_fiscal"})]})})})})]})}function _i(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Abrir una compra"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"abrir_compra"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Compras realizadas"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"compras_realizadas"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Compras en espera"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"compras",subDepartamento:"compras_espera"})]})})})})]})}function fi(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Almacenes"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"almacen"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Traspasos"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"traspasos"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Inventario por almacen"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"almacenes",subDepartamento:"inventario_almacen"})]})})})})]})}function gi(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Cuentas"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"cuentas_empresa"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Abonos Proveedores"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"abonos_proveedores"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Abonos Clientes"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"abonos_clientes"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Egresos"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"egresos"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Caja principal"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"tesoreria",subDepartamento:"caja_principal"})]})})})})]})}function vi(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Reportes Historiales Cajas"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_historial_cajas"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Reportes turnos usuarios "})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_turnos"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Reportes de compras "})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_compras"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Reportes de ventas "})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_ventas"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Reportes de almacenes "})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"rerporte_almacen"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Reportes de cortes "})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_corte_caja"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Reportes tesoreria "})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"reportes",subDepartamento:"reporte_tesoreria"})]})})})})]})}function Ci(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Cancelar ventas"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"cancelar_venta"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Precios de productos"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"precios_productos"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Pre cortes de caja"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"pre_corte"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Cotizaciones"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"cotizaciones"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Producto Rapido"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"producto_rapido"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Panel de administrador"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"administrador"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Eliminar ventas pendientes"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"ventas",subDepartamento:"eliminar_ventas"})]})})})})]})}function yi(e){var t=e.obtenerAccesos,a=e.arregloAccesos;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(L.a,{variant:"h6",children:"Marca los permisos que deseas asignar a este usuario"})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Generar nuevo CDFI"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"facturacion",subDepartamento:"generar_cdfi"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"CDFIs realizados"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"facturacion",subDepartamento:"cdfi_realizados"})]})})})}),Object(H.jsx)(O.a,{p:1,display:"flex",justifyContent:"center",children:Object(H.jsx)(O.a,{width:"80%",children:Object(H.jsx)(fn.a,{elevation:3,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{ml:1,p:1,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Registrar series CDFI"})})}),Object(H.jsx)(Oi,{arregloAccesos:a,obtenerAccesos:t,departamento:"facturacion",subDepartamento:"registro_series_cdfi"})]})})})})]})}var Ai=a.p+"static/media/almacen.31993015.svg",Si=a.p+"static/media/money.bce30921.svg",Fi=a.p+"static/media/factura.19f7e224.svg",Ii=a.p+"static/media/cart-add.eacbdb19.svg",ki=["children","value","index"];function wi(e){var t=e.children,a=e.value,n=e.index,c=Object(De.a)(e,ki);return Object(H.jsx)("div",Object(m.a)(Object(m.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(H.jsx)(O.a,{p:1,minHeight:"20vh",children:t})}))}function Ni(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var Pi=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:30},icon:{fontSize:30}}}));function Ei(e){var t=e.obtenerAccesos,a=e.arregloAccesos,n=Pi(),c=Object(j.useState)({message:"",status:"",open:!1}),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(0),l=Object(y.a)(s,2),d=l[0],u=l[1];return Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Y,{alert:i,setAlert:o}),Object(H.jsx)(Re.a,{position:"static",color:"transparent",elevation:0,children:Object(H.jsxs)(Ve.a,{value:d,onChange:function(e,t){u(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(H.jsx)(Me.a,Object(m.a)({label:"Mi empresa",icon:Object(H.jsx)(We.r,{className:n.icon})},Ni(0))),Object(H.jsx)(Me.a,Object(m.a)({label:"Almacenes",icon:Object(H.jsx)("img",{src:Ai,alt:"icono almacen",className:n.iconSvg})},Ni(1))),Object(H.jsx)(Me.a,Object(m.a)({label:"Compras",icon:Object(H.jsx)(We.m,{className:n.icon})},Ni(2))),Object(H.jsx)(Me.a,Object(m.a)({label:"Catalogos",icon:Object(H.jsx)(We.j,{className:n.icon})},Ni(3))),Object(H.jsx)(Me.a,Object(m.a)({label:"Tesoreria",icon:Object(H.jsx)("img",{src:Si,alt:"icono money",className:n.iconSvg})},Ni(4))),Object(H.jsx)(Me.a,Object(m.a)({label:"Reportes",icon:Object(H.jsx)(We.s,{className:n.icon})},Ni(5))),Object(H.jsx)(Me.a,Object(m.a)({label:"Facturaci\xf3n",icon:Object(H.jsx)("img",{src:Fi,alt:"icono factura",className:n.iconSvg})},Ni(6))),Object(H.jsx)(Me.a,Object(m.a)({label:"Ventas",icon:Object(H.jsx)("img",{src:Ii,alt:"icono ventas",className:n.iconSvg})},Ni(7)))]})}),Object(H.jsx)(wi,{value:d,index:0,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(hi,{obtenerAccesos:t,arregloAccesos:a})})}),Object(H.jsx)(wi,{value:d,index:1,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(fi,{obtenerAccesos:t,arregloAccesos:a})})}),Object(H.jsx)(wi,{value:d,index:2,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(_i,{obtenerAccesos:t,arregloAccesos:a})})}),Object(H.jsx)(wi,{value:d,index:3,children:Object(H.jsx)(O.a,{p:0,children:Object(H.jsx)(xi,{obtenerAccesos:t,arregloAccesos:a})})}),Object(H.jsx)(wi,{value:d,index:4,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(gi,{obtenerAccesos:t,arregloAccesos:a})})}),Object(H.jsx)(wi,{value:d,index:5,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(vi,{obtenerAccesos:t,arregloAccesos:a})})}),Object(H.jsx)(wi,{value:d,index:6,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(yi,{obtenerAccesos:t,arregloAccesos:a})})}),Object(H.jsx)(wi,{value:d,index:7,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(Ci,{obtenerAccesos:t,arregloAccesos:a})})})]})}var Di=a.p+"static/media/perfil.00a5b172.svg",zi=a.p+"static/media/permisos.694c0322.svg",Ti=["children","value","index"],$i=["numero_usuario","_id","sucursal","empresa","turno_en_caja_activo","estado_usuario"];function Wi(e){var t=e.children,a=e.value,n=e.index,c=Object(De.a)(e,Ti);return Object(H.jsx)("div",Object(m.a)(Object(m.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(H.jsx)(O.a,{minHeight:"70vh",children:t})}))}function Ri(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var Vi=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},rootPrincipal:{padding:0,margin:0},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:35}}}));function Mi(e){var t=e.accion,a=e.datos,n=e.fromEmergent,c=e.refetch,r=e.isOnline,i=Vi(),o=Object(j.useContext)(li),s=o.usuario,l=o.setUsuario,d=o.setError,u=o.update,b=o.setUpdate,p=o.username,x=o.setUsername,h=Object(j.useState)(!1),_=Object(y.a)(h,2),f=_[0],A=_[1],S=Object(j.useState)(0),I=Object(y.a)(S,2),k=I[0],N=I[1],P=Object(j.useState)(!1),E=Object(y.a)(P,2),z=E[0],$=E[1],W=Object(j.useState)({message:"",status:"",open:!1}),R=Object(y.a)(W,2),V=R[0],M=R[1],L=JSON.parse(localStorage.getItem("sesionCafi")),B=Object(j.useCallback)((function(){l({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},turno_en_caja_activo:!1,estado_usuario:!0,accesos:si}),x("")}),[l]),U=function(){A(!0),"registrar"!==t&&l(a)},q=function(){A(!1),B()},J=Object(w.a)(D),G=Object(y.a)(J,1)[0],Q=Object(w.a)(T),K=Object(y.a)(Q,1)[0],X=function(){var e=Object(C.a)(Object(v.a)().mark((function e(a){var r,i;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),"registrar"!==t){e.next=10;break}if(s.nombre&&s.password&&s.repeatPassword&&s.telefono&&s.email){e.next=5;break}return d({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 5:if(s.password===s.repeatPassword){e.next=8;break}return d({error:!0,message:"Las contrase\xf1as no coinciden"}),e.abrupt("return");case 8:e.next=13;break;case 10:if(s.nombre&&s.telefono&&s.email){e.next=13;break}return d({error:!0,message:"Este campo es requerido"}),e.abrupt("return");case 13:if($(!0),e.prev=14,"registrar"!==t){e.next=26;break}return s.numero_usuario=Va(1e5,999999),s.username_login=p,s.empresa=L.empresa._id,s.sucursal=L.sucursal._id,s.turno_en_caja_activo=!1,r=s,e.next=24,G({variables:{input:r}});case 24:e.next=30;break;case 26:return s.numero_usuario,s._id,s.sucursal,s.empresa,s.turno_en_caja_activo,s.estado_usuario,(i=Object(De.a)(s,$i)).username_login||(i.username_login=p),e.next=30,K({variables:{id:s._id,input:i,empresa:L.empresa._id,sucursal:L.sucursal._id}});case 30:b(!u),M({message:"\xa1Listo!",status:"success",open:!0}),d({error:!1,message:""}),$(!1),q(),n&&c(),e.next=43;break;case 38:e.prev=38,e.t0=e.catch(14),console.log(),M({message:"Hubo un error en el servidor",status:"error",open:!0}),$(!1);case 43:case"end":return e.stop()}}),e,null,[[14,38]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:V,setAlert:M}),"registrar"===t?n?Object(H.jsx)(ce.a,{color:"primary",onClick:U,disabled:!r,children:Object(H.jsx)(Ut.a,{})}):Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",onClick:U,startIcon:Object(H.jsx)(Ut.a,{}),disabled:!r,children:"AGREGAR"}):Object(H.jsx)(ce.a,{disabled:!r,onClick:U,children:Object(H.jsx)(yn.a,{})}),Object(H.jsxs)(qe.a,{open:f,onClose:q,fullWidth:!0,maxWidth:"md",children:[Object(H.jsxs)(O.a,{className:i.root,children:[Object(H.jsx)(st,{loading:z,setLoading:$}),Object(H.jsx)(Re.a,{position:"static",color:"default",elevation:0,children:Object(H.jsxs)(Ve.a,{value:k,onChange:function(e,t){N(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(H.jsx)(Me.a,Object(m.a)({label:"Informaci\xf3n b\xe1sica",icon:Object(H.jsx)("img",{src:Di,alt:"icono perfil",className:i.iconSvg})},Ri(0))),Object(H.jsx)(Me.a,Object(m.a)({label:"Permisos",icon:Object(H.jsx)("img",{src:zi,alt:"icono factura",className:i.iconSvg})},Ri(1))),Object(H.jsx)(O.a,{ml:58,mt:3,children:Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:q,size:"large",children:Object(H.jsx)(Ye.a,{})})})})]})}),Object(H.jsxs)("form",{id:"form-usuario",onSubmit:X,autocomplete:"off",children:[Object(H.jsx)(Wi,{value:k,index:0,children:Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(pi,{accion:t})})}),Object(H.jsx)(Wi,{value:k,index:1,children:Object(H.jsx)(Ei,{arregloAccesos:s.accesos,obtenerAccesos:function(e,t,a){var n=e.target,c=n.name,r=n.checked;l(Object(m.a)(Object(m.a)({},s),{},{accesos:Object(m.a)(Object(m.a)({},s.accesos),{},Object(g.a)({},t,Object(m.a)(Object(m.a)({},s.accesos[t]),{},Object(g.a)({},a,Object(m.a)(Object(m.a)({},s.accesos[t][a]),{},Object(g.a)({},c,r))))))}))}})})]})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{variant:"contained",color:"primary",type:"submit",form:"form-usuario",size:"large",startIcon:Object(H.jsx)(hn.a,{}),children:"Guardar"})})]})]})}var Li=["id_usuario_encargado"],Bi=["id_usuario_encargado"],Ui=["id_sucursal","_id"],qi=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function Ji(e){var t,a=e.accion,n=e.datos,c=e.fromEmergent,r=Object(j.useContext)(Kr),i=r.datosAlmacen,o=r.setDatosAlmacen,s=r.error,l=r.setError,d=r.update,u=r.setUpdate,b=JSON.parse(localStorage.getItem("sesionCafi")),p=Object(w.a)(Zr),x=Object(y.a)(p,1)[0],h=Object(w.a)(ti),_=Object(y.a)(h,1)[0],f=[],I=qi(),k=Object(j.useState)({message:"",status:"",open:!1}),N=Object(y.a)(k,2),P=N[0],E=N[1],D=Object(j.useState)(!1),T=Object(y.a)(D,2),$=T[0],W=T[1],R=Object(j.useContext)(Pe),V=R.almacen_inicial,M=R.setAlmacenInicial,B=Object(j.useState)(!1),U=Object(y.a)(B,2),q=U[0],J=U[1],G=Object(rt.b)(z,{variables:{sucursal:"".concat(b.sucursal._id),empresa:"".concat(b.empresa._id),eliminado:!1}}),Q=G.data,K=G.refetch,X=Object(j.useCallback)((function(){o({nombre_almacen:"",id_usuario_encargado:"",direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""}})}),[o]),Z=function(){if(W(!0),n){var e={};if(n.id_usuario_encargado){var t=n.id_usuario_encargado;(e=Object(De.a)(n,Li)).id_usuario_encargado=t._id}else e=n;o(e)}},te=function(){W(!1),X()},ae=function(e,t){"id_usuario_encargado"!==e.target.name?o(Object(m.a)(Object(m.a)({},i),{},Object(g.a)({},e.target.name,e.target.value.toUpperCase()))):o(Object(m.a)(Object(m.a)({},i),{},Object(g.a)({},e.target.name,t.props.user._id)))},ne=function(e){o(Object(m.a)(Object(m.a)({},i),{},{direccion:Object(m.a)(Object(m.a)({},i.direccion),{},Object(g.a)({},e.target.name,e.target.value.toUpperCase()))}))},re=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,n,c,r,o;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i.nombre_almacen){e.next=6;break}return l(!0),e.abrupt("return");case 6:if("registrar"!==a){e.next=23;break}if(t={},""!==i.id_usuario_encargado){e.next=15;break}return i.id_usuario_encargado,c=Object(De.a)(i,Bi),e.next=12,x({variables:{input:c,id:b.sucursal._id,empresa:b.empresa._id}});case 12:n=e.sent,e.next=19;break;case 15:return t=i,e.next=18,x({variables:{input:t,id:b.sucursal._id,empresa:b.empresa._id}});case 18:n=e.sent;case 19:r=n.data.crearAlmacen._id,K&&(M(Object(m.a)(Object(m.a)({},V),{},{id_almacen:r,almacen:i.nombre_almacen})),K()),e.next=26;break;case 23:return i.id_sucursal,i._id,o=Object(De.a)(i,Ui),e.next=26,_({variables:{input:{nombre_almacen:o.nombre_almacen,id_usuario_encargado:o.id_usuario_encargado,direccion:o.direccion},id:i._id}});case 26:u(!d),E({message:"\xa1Listo!",status:"success",open:!0}),l(!1),J(!1),te();case 31:e.next=38;break;case 33:e.prev=33,e.t0=e.catch(0),console.log(e.t0),E({message:"Hubo un error",status:"error",open:!0}),J(!1);case 38:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(){return e.apply(this,arguments)}}();return Q&&(f=Q.obtenerUsuarios),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:P,setAlert:E}),"registrar"===a?c?Object(H.jsx)(ce.a,{color:"primary",onClick:Z,children:Object(H.jsx)(Ac.a,{})}):Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",onClick:Z,startIcon:Object(H.jsx)(Ac.a,{}),children:"AGREGAR"}):Object(H.jsx)(ce.a,{onClick:Z,children:Object(H.jsx)(yn.a,{})}),Object(H.jsxs)(qe.a,{open:$,onClose:te,fullWidth:!0,maxWidth:"md",children:[Object(H.jsx)(st,{loading:q,setLoading:J}),Object(H.jsxs)(O.a,{display:"flex",flexDirection:"row",children:[Object(H.jsx)(O.a,{style:{width:"93%"},children:Object(H.jsx)(Bt.a,{id:"form-dialog-title",children:"Registro almacen"})}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:te,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]}),Object(H.jsxs)(A.a,{maxWidth:"md",children:[Object(H.jsxs)("div",{className:I.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"80%",children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("span",{style:{color:"red"},children:"* "}),Object(H.jsx)("b",{children:"Nombre Almacen"})]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:s,name:"nombre_almacen",id:"form-producto-codigo-barras",variant:"outlined",value:i.nombre_almacen,onChange:ae,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(O.a,{width:"100%",display:"flex",flexDirection:"row",children:[Object(H.jsxs)(O.a,{width:"70%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Encargado de almacen"})}),Object(H.jsx)(ee.a,{fullWidth:!0,size:"small",variant:"outlined",children:Object(H.jsx)(Nt.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",name:"id_usuario_encargado",renderValue:function(e){return e},onChange:ae,children:null===(t=f)||void 0===t?void 0:t.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.nombre,user:e,children:e.nombre},t)}))})})]}),Object(H.jsx)(O.a,{mt:2,width:"10%",children:Object(H.jsx)(di,{children:Object(H.jsx)(Mi,{accion:"registrar",fromEmergent:!0,refetch:K})})}),Object(H.jsxs)(O.a,{width:"35%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Sucursal"})}),Object(H.jsx)(L.a,{style:{marginTop:"7px"},children:b.sucursal.nombre_sucursal})]})]})]}),Object(H.jsxs)(O.a,{mt:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Domicilio"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)("div",{className:I.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Calle"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"calle",variant:"outlined",value:i.direccion.calle,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"No. exterior"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_ext",variant:"outlined",value:i.direccion.no_ext,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"No. interior "})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",value:i.direccion.no_int,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]})]}),Object(H.jsxs)("div",{className:I.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Codigo Postal"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",type:"number",name:"codigo_postal",variant:"outlined",value:i.direccion.codigo_postal,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Colonia"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"colonia",variant:"outlined",value:i.direccion.colonia,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Municipio"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"municipio",variant:"outlined",value:i.direccion.municipio,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]})]}),Object(H.jsxs)("div",{className:I.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Localidad"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"localidad",variant:"outlined",value:i.direccion.localidad,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Estado"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"estado",variant:"outlined",value:i.direccion.estado,inputProps:{style:{textTransform:"uppercase"}},onChange:ne})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Pa\xeds"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"pais",variant:"outlined",value:i.direccion.pais,onChange:ne,inputProps:{style:{textTransform:"uppercase"}}})]})]}),Object(H.jsx)(O.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",onClick:re,children:"Guardar"})})]})]})]})}var Hi,Gi,Yi,Qi,Ki,Xi,Zi,eo=Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));function to(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=eo(),c=Object(j.useContext)(Pe),r=c.datos_generales,i=c.precios,o=c.setPrecios,s=c.almacen_inicial,l=c.setAlmacenInicial,d=(c.selectedDate,c.setSelectedDate,c.update),u=t.almacenes,b=function(e,t){if(e.target.value)if("unidad_de_inventario"!==e.target.name)o(Object(m.a)(Object(m.a)({},i),{},{inventario:Object(m.a)(Object(m.a)({},i.inventario),{},Object(g.a)({},e.target.name,parseFloat(e.target.value)))}));else{var a,n=t.props.unidad,c=n.codigo_unidad,r=n.unidad;o(Object(m.a)(Object(m.a)({},i),{},{inventario:Object(m.a)(Object(m.a)({},i.inventario),{},(a={},Object(g.a)(a,e.target.name,r),Object(g.a)(a,"codigo_unidad",c),a))}))}else o(Object(m.a)(Object(m.a)({},i),{},{inventario:Object(m.a)(Object(m.a)({},i.inventario),{},Object(g.a)({},e.target.name,""))}))};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Inventario"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Inventario m\xednimo"}),Object(H.jsx)(S.a,{fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"inventario_minimo",id:"form-producto-inventario_minimo",variant:"outlined",value:i.inventario.inventario_minimo,onChange:b,onFocus:function(e){var t=e.target,a=t.name,n=t.value;0===parseFloat(n)&&o(Object(m.a)(Object(m.a)({},i),{},{inventario:Object(m.a)(Object(m.a)({},i.inventario),{},Object(g.a)({},a,""))}))},onBlur:function(e){var t=e.target,a=t.name;""===t.value&&o(Object(m.a)(Object(m.a)({},i),{},{inventario:Object(m.a)(Object(m.a)({},i.inventario),{},Object(g.a)({},a,0))}))},error:""===i.inventario.inventario_minimo})]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Inventario m\xe1ximo"}),Object(H.jsx)(S.a,{fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"inventario_maximo",id:"form-producto-inventario_maximo",variant:"outlined",value:i.inventario.inventario_maximo,onChange:b,onFocus:function(e){var t=e.target,a=t.name,n=t.value;0===parseFloat(n)&&o(Object(m.a)(Object(m.a)({},i),{},{inventario:Object(m.a)(Object(m.a)({},i.inventario),{},Object(g.a)({},a,""))}))},onBlur:function(e){var t=e.target,a=t.name;""===t.value&&o(Object(m.a)(Object(m.a)({},i),{},{inventario:Object(m.a)(Object(m.a)({},i.inventario),{},Object(g.a)({},a,0))}))},error:""===i.inventario.inventario_maximo})]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Unidad de inventario"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"unidad_de_inventario",children:i.granel?Object(H.jsx)(Nt.a,{name:"unidad_de_inventario",value:i.inventario.unidad_de_inventario,onChange:b,children:sn.map((function(e,t){return Object(H.jsx)(Pt.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))}):Object(H.jsx)(Nt.a,{name:"unidad_de_inventario",value:i.inventario.unidad_de_inventario,onChange:b,children:on.map((function(e,t){return Object(H.jsx)(Pt.a,{unidad:e,value:e.unidad,children:e.unidad},t)}))})})})]})})]}),d?null:"OTROS"===r.tipo_producto?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(O.a,{my:3,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Almacen incial"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,style:{alignItems:"center"},children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{className:n.titulos,children:["Cantidad inicial en ",Object(H.jsx)("b",{children:i.unidad_de_compra.unidad})]}),Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsx)(S.a,{fullWidth:!0,type:"number",InputProps:{inputProps:{min:0}},size:"small",name:"cantidad",variant:"outlined",value:s.cantidad,onChange:function(e){e.target.value?"almacen"!==e.target.name?l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},e.target.name,parseFloat(e.target.value)))):l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},e.target.name,e.target.value))):l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},e.target.name,"")))},onFocus:function(e){var t=e.target,a=t.name,n=t.value;0===parseFloat(n)&&l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},a,"")))},onBlur:function(e){var t=e.target,a=t.name;""===t.value&&l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},a,0)))},error:""===s.cantidad})})]})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{className:n.titulos,children:"Almacen"}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"almacen",error:s.cantidad>0&&!s.almacen,children:Object(H.jsxs)(Nt.a,{name:"almacen",value:s.almacen,onChange:function(e,t){var a;l(Object(m.a)(Object(m.a)({},s),{},(a={},Object(g.a)(a,e.target.name,e.target.value),Object(g.a)(a,t.props.name,t.props.id),a)))},children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Seleccione uno"})}),u?u.map((function(e){return Object(H.jsx)(Pt.a,{name:"id_almacen",value:e.nombre_almacen,id:e._id,children:e.nombre_almacen},e._id)})):Object(H.jsx)(Pt.a,{value:""})]})}),Object(H.jsx)(Xr,{children:Object(H.jsx)(Ji,{accion:"registrar",refetch:a,fromEmergent:!0})})]})]})})]})]}):null]})}function ao(e,t,a,n){return e.clave_alterna&&e.tipo_producto&&e.nombre_generico&&e.nombre_comercial?t.precio_de_compra.precio_con_impuesto&&t.precio_de_compra.precio_sin_impuesto&&t.unidad_de_compra.cantidad?e.clave_alterna&&e.tipo_producto&&e.nombre_generico&&e.nombre_comercial?a.cantidad>0&&!a.almacen&&"OTROS"===e.tipo_producto?(console.log("si hay cantidad almacen pero no hay almacen seleccionado"),{error:!0,message:"Campo obligatorio",vista3:!0}):{error:!1,message:""}:{error:!0,message:"Campo obligatorio",vista1:!0}:{error:!0,message:"Campo obligatorio",vista2:!0}:t.precio_de_compra.precio_con_impuesto&&t.precio_de_compra.precio_sin_impuesto&&t.unidad_de_compra.cantidad?{error:!0,message:"Campo obligatorio",vista1:!0}:{error:!0,message:"Campo obligatorio",vista1:!0,vista2:!0}}var no=Object(P.d)(Hi||(Hi=Object(N.a)(["\n\tmutation crearCuenta($input: CrearCuentasInput) {\n\t\tcrearCuenta(input: $input) {\n\t\t\t_id\n\t\t\tcuenta\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),co=Object(P.d)(Gi||(Gi=Object(N.a)(["\n\tmutation crearSubcuenta($idCuenta: ID!, $input: CrearSubcuentasInput, $empresa: ID!, $sucursal: ID!) {\n\t\tcrearSubcuenta(idCuenta: $idCuenta, input: $input,  empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),ro=Object(P.d)(Yi||(Yi=Object(N.a)(["\n\tmutation actualizarCuenta($idCuenta: ID!, $input: ActualizarCuentasInput, $empresa: ID!, $sucursal: ID!) {\n\t\tactualizarCuenta(idCuenta: $idCuenta, input: $input,  empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),io=Object(P.d)(Qi||(Qi=Object(N.a)(["\n\tmutation actualizarSubcuenta($idCuenta: ID!, $idSubcuenta: ID!, $input: ActualizarSubcuentasInput, $empresa: ID!, $sucursal: ID!) {\n\t\tactualizarSubcuenta(idCuenta: $idCuenta, idSubcuenta: $idSubcuenta, input: $input,  empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),oo=Object(P.d)(Ki||(Ki=Object(N.a)(["\n\tquery obtenerCuentas($empresa: ID!) {\n\t\tobtenerCuentas(empresa: $empresa) {\n\t\t\t_id\n\t\t\tcuenta\n\t\t\tsubcuentas {\n\t\t\t\t_id\n\t\t\t\tsubcuenta\n\t\t\t}\n\t\t\tempresa {\n\t\t\t\t_id\n\t\t\t\tnombre_empresa\n\t\t\t\tcorreo_empresa\n\t\t\t\tnombre_dueno\n\t\t\t\ttelefono_dueno\n\t\t\t}\n\t\t\tsucursal {\n\t\t\t\t_id\n\t\t\t\tnombre_sucursal\n\t\t\t\tdescripcion\n\t\t\t}\n\t\t}\n\t}\n"]))),so=Object(P.d)(Xi||(Xi=Object(N.a)(["\n\tmutation eliminarCuenta($id: ID!, $empresa: ID!, $sucursal: ID!) {\n\t\teliminarCuenta(id: $id,  empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"]))),lo=Object(P.d)(Zi||(Zi=Object(N.a)(["\n\tmutation eliminarSubcuenta($idCuenta: ID!, $idSubcuenta: ID!, $empresa: ID!, $sucursal: ID!) {\n\t\teliminarSubcuenta(idCuenta: $idCuenta, idSubcuenta: $idSubcuenta,  empresa: $empresa, sucursal: $sucursal) {\n\t\t\tmessage\n\t\t}\n\t}\n"])));Object(k.a)((function(e){return{titulos:{fontWeight:500}}}));Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& > .precios-box":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(3),"px")}}}}));var jo=a(942),uo=a(944),bo=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t,a){var n,c,r,i;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("datos_generales"!==a){e.next=16;break}return n={clave_alterna:t.clave_alterna,tipo_producto:t.tipo_producto,nombre_comercial:t.nombre_comercial,nombre_generico:t.nombre_generico,receta_farmacia:t.receta_farmacia},null!==t.codigo_barras&&""!==t.codigo_barras&&(n=Object(m.a)(Object(m.a)({},n),{},{codigo_barras:t.codigo_barras})),null!==t.descripcion&&""!==t.descripcion&&(n=Object(m.a)(Object(m.a)({},n),{},{descripcion:t.descripcion})),null!==t.id_categoria&&""!==t.id_categoria&&(n=Object(m.a)(Object(m.a)({},n),{},{id_categoria:t.id_categoria})),null!==t.categoria&&""!==t.categoria&&(n=Object(m.a)(Object(m.a)({},n),{},{categoria:t.categoria})),null!==t.subcategoria&&""!==t.subcategoria&&(n=Object(m.a)(Object(m.a)({},n),{},{subcategoria:t.subcategoria})),null!==t.id_subcategoria&&""!==t.id_subcategoria&&(n=Object(m.a)(Object(m.a)({},n),{},{id_subcategoria:t.id_subcategoria})),null!==t.id_departamento&&""!==t.id_departamento&&(n=Object(m.a)(Object(m.a)({},n),{},{id_departamento:t.id_departamento})),null!==t.departamento&&""!==t.departamento&&(n=Object(m.a)(Object(m.a)({},n),{},{departamento:t.departamento})),null!==t.id_marca&&""!==t.id_marca&&(n=Object(m.a)(Object(m.a)({},n),{},{id_marca:t.id_marca})),null!==t.marca&&""!==t.marca&&(n=Object(m.a)(Object(m.a)({},n),{},{marca:t.marca})),null!==t.clave_producto_sat.Name&&(n=Object(m.a)(Object(m.a)({},n),{},{clave_producto_sat:t.clave_producto_sat})),e.abrupt("return",n);case 16:if("unidades_de_venta"!==a){e.next=20;break}for(c=[],r=0;r<t.length;r++)i={_id:t[r]._id,cantidad:t[r].cantidad,id_producto:t[r].id_producto,precio:t[r].precio,unidad_principal:t[r].unidad_principal,unidad:t[r].unidad,codigo_unidad:t[r].codigo_unidad,precio_unidad:t[r].precio_unidad},null!==t[r].codigo_barras&&""!==t[r].codigo_barras&&(i=Object(m.a)(Object(m.a)({},i),{},{codigo_barras:t[r].codigo_barras})),null!==t[r].default&&""!==t[r].default&&(i=Object(m.a)(Object(m.a)({},i),{},{default:t[r].default})),null!==t[r].descuento_activo&&""!==t[r].descuento_activo&&(i=Object(m.a)(Object(m.a)({},i),{},{descuento_activo:t[r].descuento_activo,descuento:t[r].descuento})),c.push(i);return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),po=a.p+"static/media/portapapeles.076ba120.svg",mo=a.p+"static/media/etiqueta-de-precio.5aa1aed4.svg",Oo=a.p+"static/media/tarea-completada.84984eff.svg",xo=a.p+"static/media/imagenes.7a731a8c.svg",ho=a.p+"static/media/tallas-colores.29392f8a.svg",_o=["children","value","index"],fo=["precios_producto"],go=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}];function vo(e){var t=e.children,a=e.value,n=e.index,c=Object(De.a)(e,_o);return Object(H.jsx)("div",Object(m.a)(Object(m.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(H.jsx)(O.a,{p:3,height:"70vh",children:t})}))}function Co(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var yo=Object(k.a)((function(e){return{root_app:{flexGrow:1,backgroundColor:e.palette.background.paper,display:"flex",maxHeight:"80vh"},iconSvg:{width:50},dialogContent:{padding:0},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},tabs:{borderRight:"1px solid ".concat(e.palette.divider)}}}));function Ao(e){var t=e.accion,a=e.datos,n=e.productosRefetch,c=e.fromCompra,r=e.getProductos,i=e.isOnline,o=yo(),s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(0),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useContext)(Pe),f=_.datos_generales,g=_.setDatosGenerales,A=_.precios,S=_.setPrecios,k=_.validacion,N=_.setValidacion,P=_.preciosP,E=_.setPreciosP,D=_.imagenes,z=_.setImagenes,T=_.setUnidadesVenta,$=_.almacen_inicial,W=_.setAlmacenInicial,R=_.unidadVentaXDefecto,V=_.setUnidadVentaXDefecto,M=_.centro_de_costos,B=_.setCentroDeCostos,U=_.setUpdate,q=_.preciosPlazos,J=_.setPreciosPlazos,G=_.setSubcategorias,Y=_.setOnPreview,Q=_.setSubcostos,K=_.imagenes_eliminadas,X=_.setImagenesEliminadas,Z=_.presentaciones,ee=_.setPresentaciones,te=_.presentaciones_eliminadas,ae=_.setPresentacionesEliminadas,ne=_.setAlmacenExistente,re=(_.almacen_existente,_.unidadVentaSecundaria),ie=_.setUnidadVentaSecundaria,oe=JSON.parse(localStorage.getItem("sesionCafi")),se=Object(j.useContext)(Pe).setAlert,le=Object(j.useState)(!1),de=Object(y.a)(le,2),je=de[0],ue=de[1],be=f.tipo_producto,pe=Object(w.a)(Zn),me=Object(y.a)(pe,1)[0],fe=Object(w.a)(tc),Ae=Object(y.a)(fe,1)[0],Se=function(e){u(!d),U(t),e&&t?ke(e):Ie()},Fe=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var i,o,s,l,d,j;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=ao(f,A,$,0)).error){e.next=4;break}return N(i),e.abrupt("return");case 4:if(N(i),!(Z.length>0)){e.next=11;break}if(Z.filter((function(e){return e.color._id&&e.medida._id})).length===Z.length){e.next=11;break}return N({error:!0,message:"Faltan medidas o colores a tus presentaciones",vista7:!0}),se({message:"Faltan medidas o colores en tus presentaciones",status:"error",open:!0}),e.abrupt("return");case 11:return o=[Object(m.a)({},R),Object(m.a)({},re)],A.precios_producto=P,s=D,t&&(s=Object(Ia.a)(D).filter((function(e){return!e.key_imagen}))),e.next=17,bo(f,"datos_generales");case 17:return e.t0=e.sent,e.t1=A,e.t2=s,e.t3=K,e.t4=$,e.t5=M,e.next=25,bo(o,"unidades_de_venta");case 25:if(e.t6=e.sent,e.t7=Z,e.t8=te,e.t9=q,e.t10=oe.empresa._id,e.t11=oe.sucursal._id,e.t12=oe._id,l={datos_generales:e.t0,precios:e.t1,imagenes:e.t2,imagenes_eliminadas:e.t3,almacen_inicial:e.t4,centro_de_costos:e.t5,unidades_de_venta:e.t6,presentaciones:e.t7,presentaciones_eliminadas:e.t8,precio_plazos:e.t9,empresa:e.t10,sucursal:e.t11,usuario:e.t12},ue(!0),e.prev=34,!t){e.next=42;break}return e.next=38,Ae({variables:{input:l,id:a._id,empresa:oe.empresa._id,sucursal:oe.sucursal._id}});case 38:d=e.sent,se({message:"\xa1Listo! ".concat(d.data.actualizarProducto.message),status:"success",open:!0}),e.next=46;break;case 42:return e.next=44,me({variables:{input:l}});case 44:j=e.sent,se({message:"\xa1Listo! ".concat(j.data.crearProducto.message),status:"success",open:!0});case 46:ue(!1),Se(),c?r():n(),e.next=57;break;case 51:e.prev=51,e.t13=e.catch(34),ue(!1),se({message:"Error: ".concat(e.t13.message),status:"error",open:!0}),console.log(e.t13),e.t13.networkError?console.log(e.t13.networkError.result):e.t13.graphQLErrors&&console.log(e.t13.graphQLErrors);case 57:case"end":return e.stop()}}),e,null,[[34,51]])})));return function(){return e.apply(this,arguments)}}(),Ie=function(){g(Oe),S(xe),V(he),ie(_e),E(go),T(ge),W(ve),B({}),J(ye),G([]),z([]),Y({index:"",image:""}),N({error:!1,message:""}),Q([]),X([]),ee([]),ae([]),h(0)},ke=function(e){var t=e.precios,a=(t.precios_producto,Object(De.a)(t,fo)),n=e.unidades_de_venta,c=e.unidades_de_venta.filter((function(e){return!1===e.default})),r=e.unidades_de_venta.filter((function(e){return!0===e.default}));g(e.datos_generales),S(a),B(e.centro_de_costos?e.centro_de_costos:Ce),z(e.imagenes),J(e.precio_plazos),T(n),E(e.precios.precios_producto),V(r[0]),ie(c[0]),ee(e.medidas_producto?e.medidas_producto:[]),e.inventario_general.length>0?ne(!0):ne(!1)};window.onkeydown=function(e){114===e.keyCode&&document.getElementById("modal-registro-product").click()};var we=Object(H.jsx)(F.a,{variant:"contained",color:"primary",onClick:function(){return Fe()},size:"large",startIcon:Object(H.jsx)(hn.a,{}),disabled:!(f.clave_alterna&&f.tipo_producto&&f.nombre_generico&&f.nombre_comercial&&A.precio_de_compra.precio_con_impuesto&&A.precio_de_compra.precio_sin_impuesto&&A.unidad_de_compra.cantidad),children:"Guardar"}),Ne=function(){return t||3!==x?t&&"OTROS"===be&&3===x||t&&"OTROS"!==be&&4===x?we:Object(H.jsx)(F.a,{variant:"contained",color:"primary",onClick:function(){return h(x+1)},size:"large",endIcon:Object(H.jsx)(jo.a,{}),disableElevation:!0,children:"Siguiente"}):we};return Object(H.jsxs)(j.Fragment,{children:[t?Object(H.jsx)(ce.a,{size:"medium",color:"default",onClick:function(){return Se(a)},disabled:!i,children:Object(H.jsx)(yn.a,{})}):c?Object(H.jsx)(ce.a,{disabled:!i,color:"primary",onClick:function(){return Se()},children:Object(H.jsx)(Ut.a,{})}):Object(H.jsx)(F.a,{id:"modal-registro-product",color:"primary",variant:"contained",size:"large",onClick:function(){return Se()},startIcon:Object(H.jsx)(Ut.a,{}),disabled:!i,children:"Agregar"}),Object(H.jsxs)(qe.a,{open:d,fullWidth:!0,maxWidth:"lg",scroll:"paper",disableEscapeKeyDown:!0,onClose:function(e,t){"backdropClick"!==t&&Se()},children:[Object(H.jsxs)("div",{className:o.root_app,children:[Object(H.jsxs)(Ve.a,{style:{minWidth:"200px"},value:x,onChange:function(e,t){h(t)},variant:"scrollable",orientation:"vertical",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",className:o.tabs,children:[Object(H.jsx)(Me.a,Object(m.a)({style:{minWidth:"200px"},label:"Datos generales",icon:Object(H.jsx)(Sc.a,{color:"secondary",badgeContent:Object(H.jsx)(L.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista1,children:Object(H.jsx)("img",{src:po,alt:"icono registro",className:o.iconSvg})})},Co(0))),Object(H.jsx)(Me.a,Object(m.a)({style:{minWidth:"200px"},label:"Precios de venta",icon:Object(H.jsx)(Sc.a,{color:"secondary",badgeContent:Object(H.jsx)(L.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista2,children:Object(H.jsx)("img",{src:mo,alt:"icono venta",className:o.iconSvg})})},Co(1))),Object(H.jsx)(Me.a,Object(m.a)({style:{minWidth:"200px"},label:"Inventario y almacen",icon:Object(H.jsx)(Sc.a,{color:"secondary",badgeContent:Object(H.jsx)(L.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista3,children:Object(H.jsx)("img",{src:Oo,alt:"icono almacen",className:o.iconSvg})})},Co(2))),Object(H.jsx)(Me.a,Object(m.a)({style:{minWidth:"200px"},label:"Imagenes",icon:Object(H.jsx)("img",{src:xo,alt:"icono imagenes",className:o.iconSvg})},Co(3))),t&&"OTROS"!==f.tipo_producto?Object(H.jsx)(Me.a,Object(m.a)({style:{minWidth:"200px"},label:"Tallas y colores",icon:Object(H.jsx)(Sc.a,{color:"secondary",badgeContent:Object(H.jsx)(L.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!k.error||!k.vista7,children:Object(H.jsx)("img",{src:ho,alt:"icono colores",className:o.iconSvg})})},Co(4))):null]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(O.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return Se()},size:"large",children:Object(H.jsx)(Gt.a,{})})}),Object(H.jsxs)(He.a,{className:o.dialogContent,children:[Object(H.jsx)(it.a,{className:o.backdrop,open:je,children:Object(H.jsx)(I.a,{color:"inherit"})}),Object(H.jsx)(So,{value:x})]})]})]}),Object(H.jsxs)(tt.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(H.jsx)(F.a,{variant:"outlined",color:"primary",onClick:function(){return h(x-1)},size:"large",startIcon:Object(H.jsx)(uo.a,{}),disabled:0===x,children:"Anterior"}),Object(H.jsx)(Ne,{})]})]})]})}var So=function(e){var t=e.value,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(rt.b)(Xn,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id},fetchPolicy:"network-only"}),c=n.loading,r=n.data,i=n.error,o=n.refetch;if(Object(j.useEffect)((function(){return function(){o()}}),[o]),c)return Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h6",children:"Cargando..."})]});if(i)return Object(H.jsx)(bt,{error:i});var s=r.obtenerConsultasProducto;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(vo,{value:t,index:0,children:Object(H.jsx)(Er,{obtenerConsultasProducto:s,refetch:o})}),Object(H.jsx)(vo,{value:t,index:1,children:Object(H.jsx)(un,{})}),Object(H.jsx)(vo,{value:t,index:2,children:Object(H.jsx)(to,{obtenerConsultasProducto:s,refetch:o})}),Object(H.jsx)(vo,{value:t,index:3,children:Object(H.jsx)(Rr,{})}),Object(H.jsx)(vo,{value:t,index:4,children:Object(H.jsx)(_c,{obtenerConsultasProducto:s,refetch:o})})]})},Fo=a(175);function Io(){var e=Object(j.useContext)(mn).preciosVenta;return Object(H.jsx)("div",{children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{"aria-label":"simple table",size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{minWidth:150},children:"Precios de venta"}),[1,2,3,4,5,6].map((function(e,t){return Object(H.jsx)(Da.a,{style:{minWidth:100},children:e},t)}))]})}),Object(H.jsx)(za.a,{children:["Utilidad","Precio de venta"].map((function(t,a){return Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{border:0},children:Object(H.jsx)("b",{children:t})}),e.map((function(e,a){return Object(H.jsx)(ko,{data:e,index:a,tipo:t},a)}))]},a)}))})]})})})}var ko=function(e){var t=e.data,a=e.tipo,n=e.index,c=Object(j.useContext)(mn),r=c.preciosVenta,i=c.setPreciosVenta,o=c.datosProducto,s=c.productoOriginal.precios,l=Object(j.useState)(t.precio_neto),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(m.a)({},r[n]),O=Object(Ia.a)(r),x=o.costo/s.unidad_de_compra.cantidad,h=s.precio_de_compra.precio_sin_impuesto/s.unidad_de_compra.cantidad;isNaN(h)&&(h=0),isNaN(x)&&(x=0);var _=Object(j.useCallback)((function(){if(p.numero_precio===t.numero_precio){p.precio_neto=x,b(x);var e=(t.utilidad?t.utilidad:0)/100,a=parseFloat((h*e+h).toFixed(2));if(p.precio_venta=parseFloat(a.toFixed(2)),s.iva_activo||s.ieps_activo){var c=x+x*e;p.precio_neto=parseFloat(c.toFixed(2)),b(parseFloat(c.toFixed(2)))}else p.precio_neto=parseFloat(a.toFixed(2)),b(parseFloat(a.toFixed(2)));O.splice(n,1,p),i(O)}}),[o.costo,o.cantidad]);switch(Object(j.useEffect)((function(){(1===t.numero_precio||t.numero_precio>1&&u)&&_()}),[_]),a){case"Utilidad":return Object(H.jsxs)(Da.a,{style:{border:0},children:[t.utilidad,"%"]});case"Precio de venta":return Object(H.jsxs)(Da.a,{style:{border:0},children:["$",parseFloat(u.toFixed(2))]});default:return null}},wo=a(947);function No(){var e=Object(j.useContext)(mn),t=e.datosProducto,a=e.setDatosProducto,n=e.productoOriginal,c=Object(j.useContext)(Pe).presentaciones,r=n.precios,i=r.iva,o=r.ieps,s=r.precio_de_compra,l=s.precio_sin_impuesto,d=s.precio_con_impuesto,u=s.iva,b=s.ieps,p=u+b,x=t.costo-p,h=0,_=0;if(c.length>0){if(c.forEach((function(e){var t=e.cantidad_nueva;_+=t||0})),isNaN(_))return;h=_}else h=t.cantidad;var f=x*h;return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(O.a,{display:"flex",width:200,children:[Object(H.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var n=parseFloat(e),c=Math.round(n/f*100),r=f-n,s=parseFloat(r)*parseFloat(i<10?".0"+i:"."+i),j=parseFloat(r)*parseFloat(o<10?".0"+o:"."+o),O=s+j,x=r+O;a(Object(m.a)(Object(m.a)({},t),{},{impuestos_descuento:O,descuento_porcentaje:parseFloat(c),descuento_precio:parseFloat(n.toFixed(2)),subtotal_descuento:parseFloat(r.toFixed(2)),total_descuento:parseFloat(x.toFixed(2)),iva_total:parseFloat(s.toFixed(2)),ieps_total:parseFloat(j.toFixed(2))}))}else a(Object(m.a)(Object(m.a)({},t),{},{impuestos_descuento:p*h,descuento_porcentaje:0,descuento_precio:0,subtotal_descuento:l*h,total_descuento:d*h,iva_total:u*h,ieps_total:b*h}))}(e.target.value)},disabled:!t.producto.datos_generales,value:t.descuento_precio,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",onChange:function(e){return function(e){if(e&&0!==parseFloat(e)){var n=parseFloat(e),c=Math.round(f*n/100),r=f-c,s=parseFloat(r)*parseFloat(i<10?".0"+i:"."+i),j=parseFloat(r)*parseFloat(o<10?".0"+o:"."+o),O=s+j,x=r+O;a(Object(m.a)(Object(m.a)({},t),{},{impuestos_descuento:parseFloat(O.toFixed(2)),descuento_porcentaje:parseFloat(n),descuento_precio:parseFloat(c.toFixed(2)),subtotal_descuento:parseFloat(r.toFixed(2)),total_descuento:parseFloat(x.toFixed(2)),iva_total:parseFloat(s.toFixed(2)),ieps_total:parseFloat(j.toFixed(2))}))}else a(Object(m.a)(Object(m.a)({},t),{},{impuestos_descuento:p*h,descuento_porcentaje:0,descuento_precio:0,subtotal_descuento:l*h,total_descuento:d*h,iva_total:u*h,ieps_total:b*h}))}(e.target.value)},disabled:!t.producto.datos_generales,value:t.descuento_porcentaje,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"%"})}})]})})}var Po=Object(j.createContext)(),Eo=function(e){var t=e.children,a=Object(j.useState)({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_cliente:!0}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useState)([]),f=Object(y.a)(_,2),g=f[0],v=f[1],C=Object(j.useState)(!1),A=Object(y.a)(C,2),S=A[0],F=A[1];return Object(H.jsx)(Po.Provider,{value:{cliente:c,setCliente:r,toUpdate:s,setToUpdate:l,error:b,setError:p,update:x,setUpdate:h,setUpdateClientVenta:F,updateClientVenta:S,clientes:g,setClientes:v},children:t})},Do=Object(k.a)((function(e){return{avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:150,height:150,border:"dashed 2px #000000"},avatar:{width:135,height:135,"& > .icon":{fontSize:100}},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},title:{fontWeight:"500","& span":{color:"red"}}}}));function zo(e){var t=e.tipo,a=e.accion,n=Do(),c=Object(j.useContext)(Po),r=c.cliente,i=c.setCliente,o=c.error,s=Object(j.useState)(""),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useCallback)((function(e){var t=new FileReader;t.readAsDataURL(e[0]),t.onload=function(){var e=t.result;u(e)},i(Object(m.a)(Object(m.a)({},r),{},{imagen:e[0]}))}),[r,i]),p=Object(at.a)({accept:"image/jpeg, image/png",noKeyboard:!0,onDrop:b}),x=p.getRootProps,h=p.getInputProps,_=function(e){var t=e.target,a=t.name,n=t.value;i(Object(m.a)(Object(m.a)({},r),{},Object(g.a)({},a,n)))},f=function(e){var t=e.target,a=t.name,n=t.value;i(Object(m.a)(Object(m.a)({},r),{},{direccion:Object(m.a)(Object(m.a)({},r.direccion),{},Object(g.a)({},a,n))}))};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Qe.a,{container:!0,className:n.input,children:[Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,style:{display:"flex",justifyContent:"center",marginTop:"8px",flexDirection:"column"},children:[Object(H.jsxs)(O.a,Object(m.a)(Object(m.a)({className:n.avatarContainer},x()),{},{children:[Object(H.jsx)("input",Object(m.a)({},h())),d?Object(H.jsx)(Ke.a,{variant:"square",className:n.avatar,src:"".concat(d)}):Object(H.jsx)(Ke.a,{variant:"square",className:n.avatar,src:"".concat(r.imagen)})]})),Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{color:"secondary",size:"medium",onClick:function(){i(Object(m.a)(Object(m.a)({},r),{},{imagen:""})),u("")},startIcon:Object(H.jsx)(oa.a,{}),children:"Remover imagen"})})]}),Object(H.jsx)(Qe.a,{item:!0,md:9,xs:12,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:["registrar"===a?null:Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"N. Cliente"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"numero_cliente",variant:"outlined",value:r.numero_cliente?r.numero_cliente:"",onChange:_,disabled:!0,type:"number"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:"registrar"===a?12:9,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:[Object(H.jsx)("span",{children:"* "}),"Nombre"," ","CLIENTE"===t?"cliente":"proveedor"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.nombre_cliente,name:"nombre_cliente",variant:"outlined",value:r.nombre_cliente?r.nombre_cliente:"",helperText:o?"Campo Requerido":"",onChange:_,inputProps:{style:{textTransform:"uppercase"}}})]}),"CLIENTE"===t?null:Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:[Object(H.jsx)("span",{children:"* "}),"Representante"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.representante,name:"representante",variant:"outlined",value:r.representante?r.representante:"",helperText:o?"Campo Requerido":"",onChange:_,inputProps:{style:{textTransform:"uppercase"}}})]}),"CLIENTE"!==t?null:Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{item:!0,md:"CLIENTE"===t?6:4,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:[Object(H.jsx)("span",{children:"* "}),"Clave(Tarjeta de puntos)"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.clave_cliente,name:"clave_cliente",variant:"outlined",value:r.clave_cliente?r.clave_cliente:"",helperText:o?"Campo Requerido":"",onChange:_,InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{color:"primary",size:"small",onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();i(Object(m.a)(Object(m.a)({},r),{},{clave_cliente:t}))}()},children:Object(H.jsx)(Ra.a,{})})})},type:"number"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:"CLIENTE"===t?6:4,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"Fecha nacimiento"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_nacimiento",variant:"outlined",type:"date",onChange:_,value:r.fecha_nacimiento?r.fecha_nacimiento:""})]})]})]})}),Object(H.jsx)(Qe.a,{item:!0,md:12,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"CURP"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"curp",variant:"outlined",value:r.curp?r.curp:"",onChange:_,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:[Object(H.jsx)("span",{children:"* "}),"Email"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.email,name:"email",variant:"outlined",value:r.email?r.email:"",helperText:o?"Campo Requerido":"",onChange:_})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:[Object(H.jsx)("span",{children:"* "}),"Num. Telefono"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.telefono,name:"telefono",variant:"outlined",value:r.telefono?r.telefono:"",helperText:o?"Campo Requerido":"",onChange:_,type:"number"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"Num. Celular"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"celular",variant:"outlined",value:r.celular?r.celular:"",onChange:_,type:"number"})]})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:12,children:[Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsx)(L.a,{className:n.title,children:Object(H.jsx)("b",{children:"Domicilio"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:["CLIENTE"===t?Object(H.jsx)("span",{children:"* "}):null,"Calle"]}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,error:o&&!r.direccion.calle,name:"calle",variant:"outlined",value:r.direccion.calle?r.direccion.calle:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:["CLIENTE"===t?Object(H.jsx)("span",{children:"* "}):null,"Num. Ext"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.no_ext,name:"no_ext",variant:"outlined",value:r.direccion.no_ext?r.direccion.no_ext:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"Num. Int"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"no_int",variant:"outlined",value:r.direccion.no_int?r.direccion.no_int:"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:["CLIENTE"===t?Object(H.jsx)("span",{children:"* "}):null,"C\xf3digo postal"]}),Object(H.jsx)(S.a,{size:"small",fullWidth:!0,error:o&&!r.direccion.codigo_postal,name:"codigo_postal",variant:"outlined",value:r.direccion.codigo_postal?r.direccion.codigo_postal:"",helperText:o?"Campo Requerido":"",onChange:f})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:["CLIENTE"===t?Object(H.jsx)("span",{children:"* "}):null,"Colonia"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.colonia,name:"colonia",variant:"outlined",value:r.direccion.colonia?r.direccion.colonia:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:["CLIENTE"===t?Object(H.jsx)("span",{children:"* "}):null,"Municipio"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.municipio,name:"municipio",variant:"outlined",value:r.direccion.municipio?r.direccion.municipio:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"Localidad"}),Object(H.jsx)(S.a,{size:"small",name:"localidad",variant:"outlined",value:r.direccion.localidad?r.direccion.localidad:"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:["CLIENTE"===t?Object(H.jsx)("span",{children:"* "}):null,"Estado"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.estado,name:"estado",variant:"outlined",value:r.direccion.estado?r.direccion.estado:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:n.title,children:["CLIENTE"===t?Object(H.jsx)("span",{children:"* "}):null,"Pais"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:o&&!r.direccion.pais,name:"pais",variant:"outlined",value:r.direccion.pais?r.direccion.pais:"",helperText:o?"Campo Requerido":"",onChange:f,inputProps:{style:{textTransform:"uppercase"}}})]})]})]})]})})}var To,$o,Wo,Ro,Vo=a(945),Mo=Object(k.a)((function(e){return{title:{fontWeight:"500"}}}));function Lo(e){var t=e.tipo,a=e.cliente_base,n=Mo(),c=Object(j.useContext)(Po),r=c.cliente,i=c.setCliente,o=a?a.credito_disponible:0,s=(a?a.limite_credito:0)-o,l=function(e){var t=e.target.name;if("numero_descuento"!==t)if("limite_credito"!==t)i(Object(m.a)(Object(m.a)({},r),{},Object(g.a)({},e.target.name,e.target.value)));else{var a,n=parseInt(e.target.value)-s;i(Object(m.a)(Object(m.a)({},r),{},(a={},Object(g.a)(a,e.target.name,parseInt(e.target.value)),Object(g.a)(a,"credito_disponible",n),a)))}else i(Object(m.a)(Object(m.a)({},r),{},Object(g.a)({},e.target.name,parseInt(e.target.value))))};return Object(H.jsxs)(j.Fragment,{children:["CLIENTE"===t?Object(H.jsx)(O.a,{my:3,children:Object(H.jsxs)(Mt.a,{severity:"info",children:["Si deseas hacer facturas a este cliente el ",Object(H.jsx)("b",{children:"RFC"})," y la"," ",Object(H.jsx)("b",{children:"Razon social"})," son obligatorios."]})}):null,Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Cr\xe9dito utilizado:"})," $"," ",s?Ua(s):0]})}),Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Cr\xe9dito disponible:"})," $"," ",r.credito_disponible?Ua(r.credito_disponible):0]})})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"RFC"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"rfc",variant:"outlined",value:r.rfc?r.rfc:"",onChange:l,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"Razon social"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"razon_social",variant:"outlined",value:r.razon_social?r.razon_social:"",onChange:l,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"Limite de cr\xe9dito"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"limite_credito",variant:"outlined",value:r.limite_credito?r.limite_credito:"",onChange:l,error:s>r.limite_credito,InputProps:{startAdornment:Object(H.jsx)(ne.a,{children:"$"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"D\xedas de cr\xe9dito"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"dias_credito",variant:"outlined",placeholder:"30",value:r.dias_credito?r.dias_credito:"",onChange:l,inputProps:{style:{textTransform:"uppercase"}},InputProps:{startAdornment:Object(H.jsx)(ne.a,{children:Object(H.jsx)(Vo.a,{color:"action"})})}})]})]}),"CLIENTE"!==t?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(O.a,{my:3,children:[Object(H.jsx)(L.a,{className:n.title,children:"Datos bancarios"}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"Banco"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"banco",variant:"outlined",value:r.banco?r.banco:"",onChange:l,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:n.title,children:"No. de Cuenta Bancaria"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"numero_cuenta",variant:"outlined",value:r.numero_cuenta?r.numero_cuenta:"",onChange:l})]})]})]}):null]})}var Bo,Uo,qo,Jo,Ho,Go,Yo,Qo=Object(P.d)(To||(To=Object(N.a)(["\n  mutation crearCliente($input: CrearClienteInput) {\n    crearCliente(input: $input) {\n      _id\n      numero_cliente\n      clave_cliente\n      representante\n      nombre_cliente\n      rfc\n      curp\n      telefono\n      celular\n      email\n      numero_descuento\n      limite_credito\n      dias_credito\n      razon_social\n      direccion {\n        calle\n        no_ext\n        no_int\n        codigo_postal\n        colonia\n        municipio\n        localidad\n        estado\n        pais\n      }\n      imagen\n      estado_cliente\n      tipo_cliente\n    }\n  }\n"]))),Ko=Object(P.d)($o||($o=Object(N.a)(["\n  query obtenerClientes(\n    $tipo: String!\n    $filtro: String\n    $empresa: ID!\n    $eliminado: Boolean\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerClientes(\n      tipo: $tipo\n      filtro: $filtro\n      empresa: $empresa\n      eliminado: $eliminado\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        numero_cliente\n        clave_cliente\n        representante\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        credito_disponible\n        dias_credito\n        razon_social\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        estado_cliente\n        tipo_cliente\n        banco\n        numero_cuenta\n        empresa {\n          _id\n          nombre_empresa\n          correo_empresa\n          nombre_dueno\n          telefono_dueno\n          sucursales_activas\n          limite_sucursales\n        }\n        sucursal {\n          _id\n          nombre_sucursal\n          descripcion\n        }\n        monedero_electronico\n        fecha_nacimiento\n        fecha_registro\n        eliminado\n      }\n      totalDocs\n    }\n  }\n"]))),Xo=Object(P.d)(Wo||(Wo=Object(N.a)(["\n  mutation actualizarCliente($input: ActualizarClienteInput, $id: ID!, $empresa:ID!, $sucursal:ID!) {\n    actualizarCliente(id: $id, input: $input, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),Zo=Object(P.d)(Ro||(Ro=Object(N.a)(["\n  mutation eliminarCliente($id: ID!, $empresa:ID!, $sucursal:ID!) {\n    eliminarCliente(id: $id, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),es=["numero_cliente","_id","clave_cliente","sucursal","empresa"];function ts(e){var t=e.tipo,a=e.accion,n=e.datos,c=e.refetch,r=e.fromCompras,i=e.ventas,o=e.handleClickOpen,s=e.isOnline,l=Object(j.useContext)(Po),d=l.cliente,u=l.setCliente,b=l.setError,p=l.updateClientVenta,x=l.setUpdateClientVenta,h=l.update,_=l.setUpdate,f=Object(j.useState)(!1),g=Object(y.a)(f,2),S=g[0],I=g[1],k=Object(j.useState)(!1),N=Object(y.a)(k,2),P=N[0],E=N[1],D=Object(j.useState)({message:"",status:"",open:!1}),z=Object(y.a)(D,2),T=z[0],$=z[1],W=JSON.parse(localStorage.getItem("sesionCafi")),R=Object(j.useCallback)((function(){u({direccion:{calle:"",no_ext:"",no_int:"",codigo_postal:"",colonia:"",municipio:"",localidad:"",estado:"",pais:""},estado_cliente:!0})}),[u]),V=function(){I(!0),n&&u(n)},M=function(){I(!1),R()},B=Object(w.a)(Qo),U=Object(y.a)(B,1)[0],q=Object(w.a)(Xo),J=Object(y.a)(q,1)[0],G=function(){var e=Object(C.a)(Object(v.a)().mark((function e(r){var s,l,j,u,O,f,g;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),(s=Object(m.a)({},d)).nombre_cliente&&s.telefono&&s.email){e.next=8;break}if("CLIENTE"===t||s.representante){e.next=6;break}return b(!0),e.abrupt("return");case 6:return b(!0),e.abrupt("return");case 8:if("CLIENTE"!==t){e.next=12;break}if(s.clave_cliente&&s.direccion.calle&&s.direccion.municipio&&s.direccion.estado&&s.direccion.pais){e.next=12;break}return b(!0),e.abrupt("return");case 12:if("registrar"===a||!n.limite_credito||!n.credito_disponible){e.next=17;break}if(!(n.limite_credito-n.credito_disponible>s.limite_credito)){e.next=17;break}return $({message:"Cr\xe9dito utilizado es mayor al l\xedmite de cr\xe9dito",status:"error",open:!0}),e.abrupt("return");case 17:if(E(!0),e.prev=18,"registrar"!==a){e.next=31;break}return s.tipo_cliente=t,s.empresa=W.empresa._id,s.sucursal=W.sucursal._id,"CLIENTE"===t&&(s.representante=""),l=s,e.next=27,U({variables:{input:l}});case 27:j=e.sent,!0===i&&(O=JSON.parse(localStorage.getItem("DatosVentas")),f=null===O?{}:O,localStorage.setItem("DatosVentas",JSON.stringify({subTotal:void 0===f.subTotal?0:f.subTotal,total:void 0===f.total?0:f.total,impuestos:void 0===f.impuestos?0:f.impuestos,iva:void 0===f.iva?0:f.iva,ieps:void 0===f.ieps?0:f.ieps,descuento:void 0===f.descuento?0:f.descuento,monedero:void 0===f.monedero?0:f.monedero,cliente:j.data.crearCliente,venta_cliente:!0,productos:(null===(u=f.productos)||void 0===u?void 0:u.length)>0?f.productos:[],tipo_emision:f.tipo_emision?f.tipo_emision:"TICKET"})),x(!p),M(),o()),e.next=34;break;case 31:return s.numero_cliente,s._id,s.clave_cliente,s.sucursal,s.empresa,g=Object(De.a)(s,es),e.next=34,J({variables:{input:g,id:s._id,empresa:W.empresa._id,sucursal:W.sucursal._id}});case 34:c&&c(),_(!h),$({message:"\xa1Listo!",status:"success",open:!0}),b(!1),E(!1),M(),e.next=48;break;case 42:e.prev=42,e.t0=e.catch(18),$({message:e.t0.message,status:"error",open:!0}),E(!1),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 48:case"end":return e.stop()}}),e,null,[[18,42]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:T,setAlert:$}),"registrar"===a?r?Object(H.jsx)(ce.a,{color:"primary",disabled:!s,onClick:V,children:Object(H.jsx)(Ut.a,{})}):Object(H.jsx)(F.a,{disabled:!s,color:"primary",variant:"contained",onClick:V,startIcon:Object(H.jsx)(Ut.a,{}),children:"Agregar"}):Object(H.jsx)(ce.a,{disabled:!s,size:"small",onClick:V,children:Object(H.jsx)(yn.a,{})}),Object(H.jsxs)(qe.a,{open:S,onClose:function(e,t){"backdropClick"!==t&&M()},fullWidth:!0,maxWidth:"md",children:[Object(H.jsxs)(Bt.a,{style:{padding:0},children:[Object(H.jsx)(st,{loading:P,setLoading:E}),Object(H.jsx)(Re.a,{position:"static",color:"default",elevation:0,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",children:"registrar"===a?"Registrar":"Actualizar"}),Object(H.jsx)(O.a,{flexGrow:1}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return M()},children:Object(H.jsx)(Gt.a,{})})]})})]}),Object(H.jsx)(He.a,{children:Object(H.jsx)(A.a,{children:Object(H.jsxs)("form",{id:"crear-cliente-form",onSubmit:G,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Informaci\xf3n b\xe1sica"})}),Object(H.jsx)(et.a,{}),Object(H.jsx)(zo,{tipo:t,accion:a}),Object(H.jsx)(O.a,{my:2}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Informaci\xf3n de credito"})}),Object(H.jsx)(et.a,{}),Object(H.jsx)(Lo,{tipo:t,accion:a,cliente_base:n})]})})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{variant:"contained",color:"primary",size:"large",startIcon:Object(H.jsx)(Yt.a,{}),type:"submit",form:"crear-cliente-form",children:"Guardar"})})]})]})}var as=Object(P.d)(Bo||(Bo=Object(N.a)(["\n  mutation crearCompra(\n    $input: CrearCompraInput\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n  ) {\n    crearCompra(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n    ) {\n      message\n    }\n  }\n"]))),ns=Object(P.d)(Uo||(Uo=Object(N.a)(["\n  mutation crearCompraEnEspera(\n    $input: CrearCompraInput\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n  ) {\n    crearCompraEnEspera(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n    ) {\n      message\n    }\n  }\n"]))),cs=Object(P.d)(qo||(qo=Object(N.a)(["\n  mutation cancelarCompra($empresa: ID!, $sucursal:ID!, $id_compra: ID!, $data_sesion: cancelarCompraInput){\n    cancelarCompra(empresa:$empresa, sucursal:$sucursal, id_compra: $id_compra, data_sesion: $data_sesion){\n      message\n    }\n  }\n"]))),rs=Object(P.d)(Jo||(Jo=Object(N.a)(["\n  query obtenerComprasRealizadas(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n    $fecha: String\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerComprasRealizadas(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      fecha: $fecha\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n      _id\n      estatus_credito\n      usuario {\n        _id\n        numero_usuario\n        nombre\n        estado_usuario\n      }\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n      proveedor {\n        id_proveedor {\n          _id\n          numero_cliente\n          clave_cliente\n          nombre_cliente\n          telefono\n          email\n        }\n        numero_cliente\n        clave_cliente\n        nombre_cliente\n      }\n      productos {\n        _id\n        id_compra\n        id_traspaso\n        id_producto\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            granel\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              unidad_mayoreo\n              utilidad\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n          }\n          unidades_de_venta {\n            _id\n            cantidad\n            codigo_barras\n            id_producto\n            precio\n            unidad\n            unidad_principal\n          }\n        }\n        concepto\n        cantidad\n        cantidad_regalo\n        cantidad_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        unidad\n        id_unidad_venta\n        empresa\n        sucursal\n        usuario\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n      }\n      status\n      almacen {\n        id_almacen {\n          _id\n          nombre_almacen\n          id_usuario_encargado {\n            _id\n            numero_usuario\n            nombre\n          }\n        }\n        nombre_almacen\n      }\n      compra_credito\n      credito_pagado\n      saldo_credito_pendiente\n      fecha_vencimiento_credito\n      subtotal\n      impuestos\n      total\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n      folio\n    }\n    totalDocs\n    }\n  }\n"]))),is=Object(P.d)(Ho||(Ho=Object(N.a)(["\n  query obtenerComprasEnEspera($empresa: ID!, $sucursal: ID!, $filtro: String, $limit: Int\n    $offset: Int) {\n    obtenerComprasEnEspera(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      limit: $limit\n      offset: $offset\n    ) {\n      docs{\n        _id\n      en_espera\n      proveedor {\n        id_proveedor\n        clave_cliente\n        numero_cliente\n        nombre_cliente\n      }\n      almacen {\n        id_almacen\n        nombre_almacen\n      }\n      productos {\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra {\n              ieps\n              iva\n              precio_con_impuesto\n              precio_sin_impuesto\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            granel\n          }\n          imagenes {\n            url_imagen\n            location_imagen\n            key_imagen\n            extencion_imagen\n          }\n          centro_de_costos {\n            cuenta\n            id_cuenta\n            id_subcuenta\n            subcuenta\n          }\n          precio_plazos {\n            precio_cajas {\n              plazo\n              unidad\n              precio\n            }\n            precio_costales {\n              plazo\n              unidad\n              precio\n            }\n            precio_piezas {\n              plazo\n              unidad\n              precio\n            }\n          }\n          empresa\n          sucursal\n          usuario\n          unidades_de_venta {\n            _id\n            precio\n            cantidad\n            unidad\n            unidad_principal\n            codigo_barras\n            id_producto\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          presentaciones {\n            _id\n            almacen\n            cantidad\n            cantidad_nueva\n            codigo_barras\n            color {\n              hex\n              nombre\n              _id\n            }\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            existencia\n            medida {\n              talla\n              tipo\n              _id\n            }\n            nombre_comercial\n            precio\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n        }\n        id_producto\n        cantidad\n        cantidad_regalo\n        unidad_regalo\n        cantidad_total\n        iva_total\n        ieps_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        subtotal_descuento\n        total_descuento\n      }\n      impuestos\n      subtotal\n      total\n      fecha_registro\n      }\n      totalDocs\n    }\n  }\n"]))),os=Object(P.d)(Go||(Go=Object(N.a)(["\n  query obtenerConsultaGeneralCompras($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultaGeneralCompras(empresa: $empresa, sucursal: $sucursal) {\n      productos {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            unidad_mayoreo\n            utilidad\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n          granel\n        }\n        imagenes {\n          url_imagen\n          location_imagen\n          key_imagen\n          extencion_imagen\n        }\n        centro_de_costos {\n          cuenta\n          id_cuenta\n          id_subcuenta\n          subcuenta\n        }\n        precio_plazos {\n          precio_cajas {\n            plazo\n            unidad\n            precio\n          }\n          precio_costales {\n            plazo\n            unidad\n            precio\n          }\n          precio_piezas {\n            plazo\n            unidad\n            precio\n          }\n        }\n        unidades_de_venta {\n          _id\n          precio\n          cantidad\n          concepto\n          unidad\n          unidad_principal\n          codigo_barras\n          id_producto\n          empresa\n          sucursal\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          descuento_activo\n          default\n        }\n        inventario_general {\n          _id\n          cantidad_existente\n          unidad_inventario\n          cantidad_existente_maxima\n          unidad_maxima\n        }\n        medidas_producto {\n          _id\n          cantidad\n          codigo_barras\n          color {\n            hex\n            nombre\n            _id\n          }\n          existencia\n          medida {\n            talla\n            tipo\n            _id\n          }\n          nombre_comercial\n          precio\n        }\n        medidas_registradas\n        empresa\n        sucursal\n        usuario\n      }\n      proveedores {\n        _id\n        numero_cliente\n        clave_cliente\n        representante\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        dias_credito\n        razon_social\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        estado_cliente\n        tipo_cliente\n        banco\n        numero_cuenta\n        empresa {\n          _id\n        }\n        sucursal {\n          _id\n        }\n      }\n      almacenes {\n        _id\n        nombre_almacen\n        default_almacen\n        id_usuario_encargado {\n          _id\n          numero_usuario\n          nombre\n          email\n          imagen\n          estado_usuario\n        }\n        id_sucursal {\n          _id\n          nombre_sucursal\n          usuario_sucursal\n        }\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n      }\n    }\n  }\n"]))),ss=Object(P.d)(Yo||(Yo=Object(N.a)(["\n  mutation eliminarCompraEnEspera($id: ID!) {\n    eliminarCompraEnEspera(id: $id) {\n      message\n    }\n  }\n"]))),ls=a(946),ds={producto:{},costo:0,cantidad:0,cantidad_regalo:0,unidad_regalo:"",cantidad_total:0,descuento_porcentaje:0,descuento_precio:0,iva_total:0,ieps_total:0,subtotal:0,impuestos:0,total:0,mantener_precio:!0,impuestos_descuento:0,subtotal_descuento:0,total_descuento:0},js={productos:[],proveedor:{},en_espera:!1,fecha_registro:Dt()().locale("es-mx").format(),almacen:{},compra_credito:!1,fecha_vencimiento_credito:Dt()().locale("es-mx").format(),credito_pagado:!1,saldo_credito_pendiente:0,forma_pago:"",descuento_aplicado:!1,descuento:{porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},subtotal:0,impuestos:0,total:0},us=[{numero_precio:1,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:2,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:3,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:4,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:5,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0},{numero_precio:6,utilidad:0,precio_neto:0,unidad_mayoreo:0,precio_venta:0,iva_precio:0,ieps_precio:0}],bs={precios:xe},ps=[];function ms(e){var t=e.getProductos,a=(e.status,JSON.parse(localStorage.getItem("sesionCafi"))),n=Object(j.useContext)(mn),c=n.datosCompra,r=n.setDatosCompra,i=n.setDatosProducto,o=n.productosCompra,s=Object(j.useContext)(Pe),l=s.setDatosGenerales,d=s.setPrecios,u=s.setValidacion,b=s.setPreciosP,p=s.setImagenes,x=s.setUnidadesVenta,h=s.almacen_inicial,_=s.setAlmacenInicial,f=s.setUnidadVentaXDefecto,v=s.setUnidadVentaSecundaria,C=s.setCentroDeCostos,y=s.setPreciosPlazos,A=s.setSubcategorias,F=s.setOnPreview,k=s.setSubcostos,w=s.setImagenesEliminadas,N=s.setPresentaciones,P=s.setPresentacionesEliminadas,E=Object(rt.b)(os,{variables:{sucursal:a.sucursal._id,empresa:a.empresa._id}}),D=E.loading,z=E.data,T=E.error,$=E.refetch,W=function(e,a){a?"proveedor"===e?r(Object(m.a)(Object(m.a)({},c),{},{proveedor:{id_proveedor:a._id,nombre_cliente:a.nombre_cliente,numero_cliente:a.numero_cliente,clave_cliente:a.clave_cliente}})):(i(ds),R(),r(Object(m.a)(Object(m.a)({},c),{},{almacen:{id_almacen:a._id,nombre_almacen:a.nombre_almacen,default_almacen:a.default_almacen}})),_(Object(m.a)(Object(m.a)({},h),{},{id_almacen:a._id,almacen:a.nombre_almacen,default_almacen:a.default_almacen})),t(a._id)):r(Object(m.a)(Object(m.a)({},c),{},Object(g.a)({},e,{})))},R=function(){l(Oe),d(xe),f(he),v(_e),b(fe),x([]),_(ve),C({}),y(ye),A([]),p([]),F({index:"",image:""}),u({error:!1,message:""}),k([]),w([]),N([]),P([])},V=Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(S.a,{size:"small",fullWidth:!0,value:"Error",error:!0,disabled:!0,variant:"outlined"}),Object(H.jsx)(ce.a,{disabled:!0,children:Object(H.jsx)(ls.a,{fontSize:"default"})})]})}),M=Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(S.a,{size:"small",fullWidth:!0,disabled:!0,value:"Cargando...",variant:"outlined"}),Object(H.jsx)(ce.a,{disabled:!0,children:Object(H.jsx)(I.a,{size:24})})]})});if(D)return Object(H.jsxs)(Qe.a,{container:!0,spacing:2,alignItems:"center",children:[M,M,M]});if(T)return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,alignItems:"center",children:[V,V,V]})});var L=z.obtenerConsultaGeneralCompras,B=L.almacenes,U=L.proveedores;return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,alignItems:"center",children:[Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(ka.a,{disabled:o.length>0,id:"combo-box-proveedor",size:"small",fullWidth:!0,options:U,getOptionLabel:function(e){return e.nombre_cliente},renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{label:"Proveedor",variant:"outlined"}))},onChange:function(e,t){return W("proveedor",t)},getOptionSelected:function(e){return e.nombre_cliente},value:c.proveedor.nombre_cliente?c.proveedor:null}),Object(H.jsx)(ts,{accion:"registrar",tipo:"PROVEEDOR",refetch:$,fromCompras:!0})]})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(ka.a,{disabled:o.length>0,id:"combo-box-almacen",size:"small",fullWidth:!0,options:B,getOptionLabel:function(e){return e.nombre_almacen},renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{label:"Almacen",variant:"outlined"}))},onChange:function(e,t){return W("almacen",t)},getOptionSelected:function(e){return e.nombre_almacen},value:c.almacen.nombre_almacen?c.almacen:null}),Object(H.jsx)(Xr,{children:Object(H.jsx)(Ji,{accion:"registrar",fromEmergent:!0,refetch:$})})]})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,md:4,children:Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){r(Object(m.a)(Object(m.a)({},c),{},{fecha_registro:e.target.value}))},InputProps:{inputProps:{max:Dt()().locale("es-mx").format("YYYY-MM-DD")}},value:c.fecha_registro})})})]})})}function Os(){var e=Object(j.useContext)(mn).datosProducto;return Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{style:{fontSize:16},children:"Subtotal:"}),Object(H.jsx)(L.a,{style:{fontSize:18},children:Object(H.jsxs)("b",{children:["$",Ua(e.subtotal_descuento)]})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{style:{fontSize:16},children:"Impuestos:"}),Object(H.jsx)(L.a,{style:{fontSize:18},children:Object(H.jsxs)("b",{children:["$",Ua(e.impuestos_descuento)]})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{style:{fontSize:16},children:"Descuento:"}),Object(H.jsx)(L.a,{style:{fontSize:18},children:Object(H.jsxs)("b",{children:[e.descuento_porcentaje,"%"]})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{style:{fontSize:16},children:"Total:"}),Object(H.jsx)(L.a,{style:{fontSize:18},children:Object(H.jsxs)("b",{children:["$",Ua(e.total_descuento)]})})]})]})}var xs=function(e){var t,a,n=e.productoOriginal,c=e.porcentaje,r=e.cantidad,i=e.costo,o=n.precios,s=o.iva,l=o.ieps,d=o.precio_de_compra.precio_con_impuesto;t=parseFloat(s<10?".0"+s:"."+s)+parseFloat(l<10?".0"+l:"."+l);var j=(a=d/parseFloat(t+1))*parseFloat(s<10?".0"+s:"."+s),u=a*parseFloat(l<10?".0"+l:"."+l),b=j+u,p=(i-b)*r,m=Math.round(p*c/100),O=p-m,x=parseFloat(O)*parseFloat(s<10?".0"+s:"."+s),h=parseFloat(O)*parseFloat(l<10?".0"+l:"."+l),_=x+h;return{result:{iva_precio:x,ieps_precio:h,impuestos:_,porcentaje:c,cantidad_descontada:m,subtotal_con_descuento:O,total:O+_},anterior:{impuesto_actual:b,precio_sin_impuesto:a,precio_con_impuesto:d,cantidad:r,iva_precio_actual:j,ieps_precio_actual:u}}},hs=["precios_producto"];function _s(e){var t=e.status,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useContext)(mn),c=n.datosProducto,r=n.setDatosProducto,i=n.productosCompra,o=n.setProductosCompra,s=n.datosCompra,l=n.productoOriginal,d=n.setProductoOriginal,b=n.setPreciosVenta,p=n.setDatosCompra,x=n.isEditing,h=n.setIsEditing,_=n.editFinish,f=n.setEditFinish,A=n.costo,k=n.setCosto,w=n.cantidad,N=n.setCantidad,P=n.loadingProductos,E=n.setLoadingProductos,D=Object(j.useContext)(Pe),z=D.datos_generales,T=D.setDatosGenerales,$=D.precios,W=D.setPrecios,R=D.setValidacion,V=D.preciosP,M=D.setPreciosP,B=D.imagenes,U=D.setImagenes,q=D.setUnidadesVenta,J=D.almacen_inicial,G=D.setAlmacenInicial,Q=D.unidadVentaXDefecto,K=D.setUnidadVentaXDefecto,X=D.unidadVentaSecundaria,Z=D.setUnidadVentaSecundaria,te=D.centro_de_costos,ae=D.setCentroDeCostos,re=D.preciosPlazos,ie=D.setPreciosPlazos,oe=D.setSubcategorias,se=D.setOnPreview,le=D.setSubcostos,de=D.imagenes_eliminadas,je=D.setImagenesEliminadas,ue=D.presentaciones,be=D.setPresentaciones,pe=D.presentaciones_eliminadas,me=D.setPresentacionesEliminadas,fe=D.setAlmacenExistente,ge=Object(j.useState)(!1),Ae=Object(y.a)(ge,2),Se=Ae[0],Fe=Ae[1],Ie=0;"enEspera"===t&&s&&(Ie=1);var ke=Object(j.useState)(!1),we=Object(y.a)(ke,2),Ne=we[0],Ee=we[1],ze=Object(j.useState)(!1),Te=Object(y.a)(ze,2),$e=Te[0],We=Te[1],Re=Object(j.useState)(0),Ve=Object(y.a)(Re,2),Me=Ve[0],Le=Ve[1],Be=Object(j.useState)(""),Ue=Object(y.a)(Be,2),qe=Ue[0],Je=Ue[1],He=Object(Fo.a)(),Ge=Object(j.useState)([]),Ye=Object(y.a)(Ge,2),Ke=Ye[0],Xe=Ye[1],Ze=Object(j.useState)(0),et=Object(y.a)(Ze,2),tt=et[0],at=et[1],nt=Object(j.useState)({message:"",status:"",open:!1}),ct=Object(y.a)(nt,2),rt=ct[0],it=ct[1],ot=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var n,c,r,i,o=arguments;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",c=o.length>2&&void 0!==o[2]?o[2]:0,We(!0),e.prev=3,r=t||s.almacen._id,E(!0),e.next=8,He.query({query:ec,variables:{almacen:r,filtro:n,empresa:a.empresa._id,sucursal:a.sucursal._id,limit:15,offset:c},fetchPolicy:"network-only"});case 8:i=e.sent,E(!1),i.data&&(Xe(n?i.data.obtenerProductos.docs:[].concat(Object(Ia.a)(Ke),Object(Ia.a)(i.data.obtenerProductos.docs))),at(i.data.obtenerProductos.totalDocs)),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(3),E(!1),it({message:"Hubo un error al cargar los productos",status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),st=Object(an.useDebounce)(A,500),lt=Object(y.a)(st,1)[0],dt=Object(an.useDebounce)(w,500),jt=Object(y.a)(dt,1)[0],ut=Object(an.useDebounce)(qe,500),bt=Object(y.a)(ut,1)[0];Object(j.useEffect)((function(){Ke&&function(e){var t=xs({productoOriginal:l,porcentaje:c.descuento_porcentaje,cantidad:c.cantidad,costo:parseFloat(e)}),a=t.result,n=t.anterior;if(!e)return void r(Object(m.a)(Object(m.a)({},c),{},{costo:0,impuestos_descuento:n.impuesto_actual*n.cantidad,subtotal_descuento:n.precio_sin_impuesto*n.cantidad,total_descuento:n.precio_con_impuesto*n.cantidad,iva_total:n.iva_precio_actual*n.cantidad,ieps_total:n.ieps_precio_actual*n.cantidad}));r(Object(m.a)(Object(m.a)({},c),{},{costo:parseFloat(e),iva_total:parseFloat(a.iva_precio.toFixed(2)),ieps_total:parseFloat(a.ieps_precio.toFixed(2)),impuestos_descuento:parseFloat(a.impuestos.toFixed(2)),descuento_porcentaje:a.porcentaje?parseFloat(a.porcentaje.toFixed(2)):0,descuento_precio:a.cantidad_descontada?parseFloat(a.cantidad_descontada.toFixed(2)):0,subtotal_descuento:parseFloat(a.subtotal_con_descuento.toFixed(2)),total_descuento:parseFloat(a.total.toFixed(2))}))}(lt)}),[lt]),Object(j.useEffect)((function(){Ke&&mt(jt)}),[jt]),Object(j.useEffect)((function(){if(ue.length>0){var e=0,t=0;ue.forEach((function(a){var n=a.cantidad_nueva;e+=n||0,isNaN(e)&&(t=0),t=e})),t&&mt(t)}}),[ue]),Object(j.useEffect)((function(){1===Ie&&ot(s.almacen._id)}),[Ie]),Object(j.useEffect)((function(){$e&&ot(s.almacen._id,bt)}),[bt]);var pt=function(e){if(!e)return r(ds),k(0),N(0),_t(),void ot(s.almacen._id);var t=e.precios.precio_de_compra,a=t.ieps,n=t.iva,i=t.precio_con_impuesto,o=t.precio_sin_impuesto,l=n+a;r(Object(m.a)(Object(m.a)({},c),{},{producto:e,id_producto:e._id,costo:i,cantidad:"OTROS"===e.datos_generales.tipo_producto?1:0,unidad_regalo:e.precios.unidad_de_compra.unidad,descuento_porcentaje:0,descuento_precio:0,subtotal:o,impuestos:parseFloat(l.toFixed(2)),total:i,subtotal_descuento:o,total_descuento:i})),ht(e),k(i),N("OTROS"===e.datos_generales.tipo_producto?1:0),d(e),b(e.precios.precios_producto)};function mt(e){var t=xs({productoOriginal:l,porcentaje:c.descuento_porcentaje,cantidad:e,costo:c.costo}),a=t.result,n=t.anterior;r(e?Object(m.a)(Object(m.a)({},c),{},{cantidad:parseFloat(e),iva_total:parseFloat(a.iva_precio.toFixed(2)),ieps_total:parseFloat(a.ieps_precio.toFixed(2)),impuestos_descuento:parseFloat(a.impuestos.toFixed(2)),descuento_porcentaje:a.porcentaje?parseFloat(a.porcentaje):0,descuento_precio:a.cantidad_descontada?parseFloat(a.cantidad_descontada.toFixed(2)):0,subtotal_descuento:parseFloat(a.subtotal_con_descuento.toFixed(2)),total_descuento:parseFloat(a.total.toFixed(2))}):Object(m.a)(Object(m.a)({},c),{},{cantidad:"",impuestos_descuento:n.impuesto_actual*n.cantidad,subtotal_descuento:n.precio_sin_impuesto*n.cantidad,total_descuento:n.precio_con_impuesto*n.cantidad,iva_total:n.iva_precio_actual*n.cantidad,ieps_total:n.ieps_precio_actual*n.cantidad}))}var Ot=function(e){var t=e.target,a=t.value,n=t.name;r(Object(m.a)(Object(m.a)({},c),{},Object(g.a)({},n,a)))};var xt=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var n,l,j,u,b,O,g,C,y,A,S,F,I,w,P,E,D,T,W,R,M,L,U,q,H,G,Y,K,Z,ee,ae,ne,ce,ie;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(m.a)({},s),l=Object(m.a)({},c),j=Object(m.a)({},z),u=Object(Ia.a)(ue),b=Object(m.a)({},$),O=Object(Ia.a)(V),g=Object(m.a)({},J),C=Object(m.a)({},te),y=Object(Ia.a)(pe),A=Object(m.a)({},re),Ee(!0),l.producto.datos_generales&&n.proveedor.nombre_cliente&&n.almacen.nombre_almacen){e.next=14;break}return Ee(!1),e.abrupt("return");case 14:if("OTROS"===j.tipo_producto){e.next=26;break}if(!(u.length>0)){e.next=23;break}if(u.filter((function(e){return e.color._id&&e.medida._id&&e.existencia})).length===u.length){e.next=21;break}return Fe(!0),Ee(!1),e.abrupt("return");case 21:e.next=26;break;case 23:return Fe(!0),Ee(!1),e.abrupt("return");case 26:return S=[Object(m.a)({},Q),Object(m.a)({},X)],l.mantener_precio=!t,b.precios_producto=O,e.next=31,bo(j,"datos_generales");case 31:return e.t0=e.sent,e.t1=b,e.t2=B,e.t3=de,e.t4=g,e.t5=C,e.next=39,bo(S,"unidades_de_venta");case 39:e.t6=e.sent,e.t7=u,e.t8=y,e.t9=A,e.t10=a.empresa._id,e.t11=a.sucursal._id,e.t12=a._id,F={datos_generales:e.t0,precios:e.t1,imagenes:e.t2,imagenes_eliminadas:e.t3,almacen_inicial:e.t4,centro_de_costos:e.t5,unidades_de_venta:e.t6,presentaciones:e.t7,presentaciones_eliminadas:e.t8,precio_plazos:e.t9,empresa:e.t10,sucursal:e.t11,usuario:e.t12},l.producto=F,"OTROS"!==l.producto.datos_generales.tipo_producto?l.cantidad_total=l.cantidad:(I=l.cantidad_regalo,w=l.cantidad,P=l.unidad_regalo,E=l.producto.precios.unidad_de_compra.cantidad,T=w*E+(D="Pz"===P||"Kg"===P||"Lt"===P?I:I*E),E>1?(l.cantidad_regalo=D/E,l.cantidad_total=T/E):(l.cantidad_regalo=D,l.cantidad_total=T)),l.impuestos=l.impuestos_descuento,l.subtotal=l.subtotal_descuento,l.total=l.total_descuento,x.producto?(W=Object(Ia.a)(i),n.impuestos-=x.producto.impuestos,n.subtotal-=x.producto.subtotal,n.total-=x.producto.total,R=parseFloat((n.subtotal+=l.subtotal).toFixed(2)),M=parseFloat(n.impuestos+=l.impuestos),L=parseFloat((n.total+=l.total).toFixed(2)),W.splice(x.index,1,l),o(W),p(Object(m.a)(Object(m.a)({},n),{},{subtotal:R,impuestos:M,total:L})),h({}),f(!_),d({precios:xe}),r(ds),k(0),N(0),Ee(!1)):(U=i.map((function(e,t){return e.id_producto===l.id_producto?{prod_exist:e,index:t}:""})).filter(Boolean),U.length>0?(q=Object(Ia.a)(i),H=U[0],G=H.index,Y=H.prod_exist,n.subtotal-=Y.subtotal,n.impuestos-=Y.impuestos,n.total-=Y.total,K=parseFloat((n.subtotal+=l.subtotal).toFixed(2)),Z=parseFloat((n.impuestos+=l.impuestos).toFixed(2)),ee=parseFloat((n.total+=l.total).toFixed(2)),q.splice(G,1,l),o(q),p(Object(m.a)(Object(m.a)({},n),{},{subtotal:K,impuestos:Z,total:ee}))):(ae=Object(Ia.a)(i),ne=parseFloat((n.subtotal+=l.subtotal).toFixed(2)),ce=parseFloat((n.impuestos+=l.impuestos).toFixed(2)),ie=parseFloat((n.total+=l.total).toFixed(2)),ae.splice(0,0,l),o(ae),p(Object(m.a)(Object(m.a)({},n),{},{subtotal:ne,impuestos:ce,total:ie}))),d({precios:xe}),r(ds),k(0),N(0),Ee(!1));case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ht=function(e){var t=e.precios,a=(t.precios_producto,Object(De.a)(t,hs)),n=e.unidades_de_venta,c=n.filter((function(e){return!1===e.default})),r=n.filter((function(e){return!0===e.default}));T(e.datos_generales),W(a),ae(e.centro_de_costos?e.centro_de_costos:Ce),U(e.imagenes),ie(e.precio_plazos),q(n),M(e.precios.precios_producto),K(r[0]),Z(c[0]),be(e.medidas_producto?e.medidas_producto:[]),s.almacen.id_almacen&&0===e.medidas_producto.length&&G(Object(m.a)(Object(m.a)({},J),{},{id_almacen:s.almacen.id_almacen,almacen:s.almacen.nombre_almacen})),e.inventario_general.length>0?fe(!0):fe(!1)},_t=function(){T(Oe),W(xe),K(he),Z(_e),M(go),q([]),G(ve),ae({}),ie(ye),oe([]),U([]),se({index:"",image:""}),R({error:!1,message:""}),le([]),je([]),be([]),me([])};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:rt,setAlert:it}),Object(H.jsx)(ms,{status:t,getProductos:ot}),Object(H.jsx)(O.a,{my:1}),Object(H.jsxs)(Qe.a,{container:!0,spacing:1,alignItems:"center",children:[Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(O.a,{width:200,children:Object(H.jsx)(ka.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,loading:P,options:Ke,getOptionLabel:function(e){return e.datos_generales.codigo_barras?e.datos_generales.codigo_barras:"N/A"},renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{variant:"outlined",onChange:function(e){return Je(e.target.value)},InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsxs)(u.a.Fragment,{children:[P?Object(H.jsx)(I.a,{color:"primary",size:20}):null,e.InputProps.endAdornment]})})}))},onChange:function(e,t){return pt(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!s.almacen.id_almacen||!s.proveedor.id_proveedor||P})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Producto"}),Object(H.jsxs)(O.a,{display:"flex",width:250,alignItems:"center",children:[Object(H.jsx)(ka.a,{id:"combo-box-producto-nombre",size:"small",fullWidth:!0,loading:P,options:Ke,getOptionLabel:function(e){return e.datos_generales.nombre_comercial},renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{onChange:function(e){return Je(e.target.value)},variant:"outlined",InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsxs)(u.a.Fragment,{children:[P?Object(H.jsx)(I.a,{color:"primary",size:20}):null,e.InputProps.endAdornment]})})}))},onChange:function(e,t){return pt(t)},getOptionSelected:function(e,t){return e._id===t._id},ListboxProps:{styles:{height:300},onScroll:function(e){var t=e.target,a=t.scrollHeight,n=t.scrollTop,c=t.clientHeight;if(a-parseInt(n+1)===c&&Ke.length<tt){var r=Me+1;Le(r),ot(s.almacen._id,"",r)}}},value:c.producto.datos_generales?c.producto:null,disabled:!s.almacen.id_almacen||!s.proveedor.id_proveedor||P}),s.almacen.id_almacen&&s.proveedor.id_proveedor?Object(H.jsx)(Ao,{accion:!1,getProductos:ot,fromCompra:!0}):Object(H.jsx)(ce.a,{disabled:!0,children:Object(H.jsx)(Ac.a,{})})]})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Clave"}),Object(H.jsx)(O.a,{width:140,children:Object(H.jsx)(ka.a,{id:"combo-box-producto-clave",size:"small",fullWidth:!0,loading:P,options:Ke,getOptionLabel:function(e){return e.datos_generales.clave_alterna},renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{variant:"outlined",onChange:function(e){return Je(e.target.value)},InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsxs)(u.a.Fragment,{children:[P?Object(H.jsx)(I.a,{color:"primary",size:20}):null,e.InputProps.endAdornment]})})}))},onChange:function(e,t){return pt(t)},getOptionSelected:function(e,t){return e._id===t._id},value:c.producto.datos_generales?c.producto:null,disabled:!s.almacen.id_almacen||!s.proveedor.id_proveedor||P})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Costo"}),Object(H.jsx)(O.a,{width:100,children:Object(H.jsx)(S.a,{inputMode:"decimal",name:"costo",variant:"outlined",size:"small",fullWidth:!0,disabled:!c.producto.datos_generales,value:A,onChange:function(e){return k(e.target.value)},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})})]}),c.producto.datos_generales&&"OTROS"===c.producto.datos_generales.tipo_producto?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Unidad"}),Object(H.jsx)(O.a,{width:100,children:Object(H.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,"aria-readonly":"true",value:c.producto.precios.unidad_de_compra.unidad,disabled:!0})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Cantidad"}),Object(H.jsx)(O.a,{width:100,children:Object(H.jsx)(S.a,{name:"cantidad",variant:"outlined",size:"small",fullWidth:!0,type:"number",InputProps:{inputProps:{min:1}},disabled:!c.producto.datos_generales,value:w,onChange:function(e){return N(e.target.value)}})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Cant. regalo"}),Object(H.jsx)(O.a,{width:100,children:Object(H.jsx)(S.a,{name:"cantidad_regalo",variant:"outlined",size:"small",fullWidth:!0,inputMode:"numeric",disabled:!c.producto.datos_generales,value:c.cantidad_regalo,onChange:function(e){return t=e.target.value,void r(t?Object(m.a)(Object(m.a)({},c),{},{cantidad_regalo:parseFloat(t)}):Object(m.a)(Object(m.a)({},c),{},{cantidad_regalo:""}));var t}})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Unidad. regalo"}),Object(H.jsx)(O.a,{width:100,children:Object(H.jsx)(ee.a,{variant:"outlined",size:"small",name:"unidad_regalo",fullWidth:!0,children:c.producto.precios.granel?Object(H.jsxs)(Nt.a,{id:"select-unidad-regalo",disabled:!c.producto.datos_generales,name:"unidad_regalo",value:c.unidad_regalo,onChange:Ot,children:[Object(H.jsx)(Pt.a,{value:"Kg",children:"Kg"}),Object(H.jsx)(Pt.a,{value:"Costal",children:"Costal"}),Object(H.jsx)(Pt.a,{value:"Lt",children:"Lt"})]}):Object(H.jsxs)(Nt.a,{id:"select-unidad-regalo",disabled:!c.producto.datos_generales,name:"unidad_regalo",value:c.unidad_regalo,onChange:Ot,children:[Object(H.jsx)(Pt.a,{value:"Caja",children:"Caja"}),Object(H.jsx)(Pt.a,{value:"Pz",children:"Pz"})]})})})]})]}):Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Cantidad total"}),Object(H.jsx)(O.a,{width:110,children:Object(H.jsx)(S.a,{name:"cantidad",variant:"outlined",size:"small",fullWidth:!0,type:"number",disabled:!0,value:c.cantidad})})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsx)(L.a,{children:"Descuento"}),Object(H.jsx)(No,{})]})]}),Object(H.jsx)(O.a,{mt:1,children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,xs:12,md:7,padding:"checkbox",children:Object(H.jsx)(Io,{})}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:5,style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(Os,{})}),Object(H.jsxs)(O.a,{display:"flex",children:[c.producto.datos_generales&&"OTROS"!==c.producto.datos_generales.tipo_producto?Object(H.jsx)(Cc,{verificate:Se,setVerificate:Fe}):null,Object(H.jsx)(O.a,{mx:1}),c.costo!==l.precios.precio_de_compra.precio_con_impuesto?Object(H.jsx)(gs,{agregarCompra:xt,cargando:Ne}):Object(H.jsx)(F.a,{style:P?{pointerEvents:"none",opacity:.4}:null,variant:"contained",color:"primary",startIcon:Ne?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ac.a,{}),disableElevation:!0,disabled:!c.producto.datos_generales||("OTROS"===c.producto.datos_generales.tipo_producto?!(s.proveedor.nombre_cliente&&s.almacen.nombre_almacen&&c.costo&&c.cantidad):!(s.proveedor.nombre_cliente&&s.almacen.nombre_almacen&&c.costo)),onClick:function(){return xt()},children:x.producto?"Actualizar ":"Agregar a compra"})]})]})]})})]})}var fs=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),gs=function(e){var t=e.agregarCompra,a=e.cargando,n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useContext)(mn),s=o.datosProducto,l=o.datosCompra,d=o.isEditing,u=o.loadingProductos,b=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{style:u?{pointerEvents:"none",opacity:.4}:null,variant:"contained",color:"primary",startIcon:Object(H.jsx)(Ac.a,{}),disableElevation:!0,disabled:!s.producto.datos_generales||("OTROS"===s.producto.datos_generales.tipo_producto?!(l.proveedor.nombre_cliente&&l.almacen.nombre_almacen&&s.costo&&s.cantidad):!(l.proveedor.nombre_cliente&&l.almacen.nombre_almacen&&s.costo)),onClick:function(){i(!0)},children:d.producto?"Actualizar ":"Agregar a compra"}),Object(H.jsxs)(qe.a,{open:r,TransitionComponent:fs,keepMounted:!0,onClose:function(){return b()},"aria-labelledby":"modal-agregar-compra",children:[Object(H.jsx)(Bt.a,{id:"modal-agregar-compra",style:{padding:0},children:Object(H.jsxs)(Mt.a,{severity:"info",icon:Object(H.jsx)(wo.a,{style:{fontSize:30}}),style:{padding:16},children:[Object(H.jsx)(Lt.a,{style:{fontSize:20},children:"El costo es diferente al precio de compra actual"}),Object(H.jsx)(L.a,{style:{fontSize:18},children:"\xbfDesea actualizar los precios o mantenerlos?"})]})}),Object(H.jsxs)(tt.a,{style:{display:"flex",justifyContent:"center"},children:[Object(H.jsx)(F.a,{onClick:function(){return b()},color:"default",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){t(),b()},color:"primary",children:"Mantener"}),Object(H.jsx)(Bn,{cargando:a,handleClose:b,agregarCompra:t})]})]})]})},vs=a(473),Cs=a.n(vs),ys=a(948),As=["precios_producto"],Ss=function(e,t,a){var n=t.setDatosGenerales,c=t.setPrecios,r=t.setValidacion,i=t.setPreciosP,o=t.setImagenes,s=t.setUnidadesVenta,l=t.almacen_inicial,d=t.setAlmacenInicial,j=t.setUnidadVentaXDefecto,u=t.setUnidadVentaSecundaria,b=t.setCentroDeCostos,p=t.setPreciosPlazos,O=t.setSubcategorias,x=t.setOnPreview,h=t.setSubcostos,_=t.setImagenesEliminadas,f=t.setPresentaciones,g=t.setPresentacionesEliminadas,v=t.datosCompra;if("SET"===e){var C=a.precios,y=(C.precios_producto,Object(De.a)(C,As)),A=a.unidades_de_venta,S=A.filter((function(e){return!1===e.default})),F=A.filter((function(e){return!0===e.default}));n(a.datos_generales),c(y),b(a.centro_de_costos?a.centro_de_costos:Ce),o(a.imagenes),p(a.precio_plazos),s(A),i(a.precios.precios_producto),j(F[0]),u(S[0]),f(a.presentaciones?a.presentaciones:[]),v.almacen.id_almacen&&0===a.presentaciones.length&&d(Object(m.a)(Object(m.a)({},l),{},{id_almacen:v.almacen.id_almacen,almacen:v.almacen.nombre_almacen}))}else n(Oe),c(xe),j(he),u(_e),i(go),s([]),d(ve),b({}),p(ye),O([]),o([]),x({index:"",image:""}),r({error:!1,message:""}),h([]),_([]),f([]),g([])},Fs=Object(k.a)({root:{width:"100%"},container:{height:"40vh"}});function Is(){var e=Fs(),t=Object(j.useContext)(mn),a=t.productosCompra,n=t.loadingProductos,c=t.datosCompra,r=Object(Ia.a)(a);return Object(H.jsxs)(fn.a,{className:e.root,variant:"outlined",children:[Object(H.jsx)(Na.a,{className:e.container,style:n?{pointerEvents:"none",opacity:.4}:null,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{children:"Producto"}),Object(H.jsx)(Da.a,{children:"Precio de compra"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cantidad"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cantidad regalo"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cantidad total"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Presentaciones"}),Object(H.jsx)(Da.a,{children:"IVA Total"}),Object(H.jsx)(Da.a,{children:"IEPS Total"}),Object(H.jsx)(Da.a,{children:"Editar"}),Object(H.jsx)(Da.a,{children:"Remover"})]})}),Object(H.jsx)(za.a,{children:r.map((function(e,t){return Object(H.jsx)(ks,{producto:e,index:t},t)}))})]})}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,justifyContent:"flex-end",children:[Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsxs)(L.a,{style:{fontSize:18},children:["Subtotal:"," ",Object(H.jsxs)("b",{children:["$",c.subtotal?Ua(c.subtotal):0]})]})}),Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsxs)(L.a,{style:{fontSize:18},children:["Impuestos:"," ",Object(H.jsxs)("b",{children:["$",c.impuestos?Ua(c.impuestos):0]})]})}),Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)(L.a,{style:{fontSize:18},children:Object(H.jsxs)("b",{children:["Total: $",c.total?Ua(c.total):0]})})})]})]})}var ks=function(e){var t=e.producto,a=e.index,n=Object(j.useContext)(mn),c=n.datosCompra,r=n.setDatosProducto,i=n.setProductoOriginal,o=n.setPreciosVenta,s=n.isEditing,l=n.setIsEditing,d=n.editFinish,u=n.setCosto,b=n.setCantidad,p=n.setIssue,m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useContext)(Pe),f={setDatosGenerales:_.setDatosGenerales,setPrecios:_.setPrecios,setValidacion:_.setValidacion,setPreciosP:_.setPreciosP,setImagenes:_.setImagenes,setUnidadesVenta:_.setUnidadesVenta,almacen_inicial:_.almacen_inicial,setAlmacenInicial:_.setAlmacenInicial,setUnidadVentaXDefecto:_.setUnidadVentaXDefecto,setUnidadVentaSecundaria:_.setUnidadVentaSecundaria,setCentroDeCostos:_.setCentroDeCostos,setPreciosPlazos:_.setPreciosPlazos,setSubcategorias:_.setSubcategorias,setOnPreview:_.setOnPreview,setSubcostos:_.setSubcostos,setImagenesEliminadas:_.setImagenesEliminadas,setPresentaciones:_.setPresentaciones,setPresentacionesEliminadas:_.setPresentacionesEliminadas,datosCompra:c};Object(j.useEffect)((function(){h(!1)}),[d]),Object(j.useEffect)((function(){t.cantidad&&p(!1)}),[t.cantidad]);var g=t.producto.precios.unidad_de_compra.unidad,v=t.cantidad,C=t.cantidad_regalo,A=t.cantidad_total;return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:x||!v,style:s.producto&&!x?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsx)(Da.a,{children:t.producto.datos_generales&&t.producto.datos_generales.codigo_barras?t.producto.datos_generales.codigo_barras:"-"}),Object(H.jsx)(Da.a,{children:t.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{width:180,children:v?Object(H.jsxs)("b",{children:["$ ",Ua(t.total)]}):Object(H.jsx)(ys.a,{color:"error"})}),Object(H.jsxs)(Da.a,{children:[v,Object(H.jsxs)("b",{children:["(",g,")"]})]}),Object(H.jsxs)(Da.a,{children:[C,Object(H.jsxs)("b",{children:["(",g,")"]})]}),Object(H.jsxs)(Da.a,{children:[A,Object(H.jsxs)("b",{children:["(",g,")"]})]}),Object(H.jsx)(Da.a,{children:t.producto.presentaciones.length>0?t.producto.presentaciones.length:"N/A"}),Object(H.jsx)(Da.a,{width:140,children:"".concat(t.producto.precios.iva,"% - $").concat(t.iva_total?Ua(t.iva_total):0)}),Object(H.jsx)(Da.a,{width:140,children:"".concat(t.producto.precios.ieps,"% - $").concat(t.ieps_total?Ua(t.ieps_total):0)}),Object(H.jsx)(Da.a,{width:50,children:x?Object(H.jsx)(ce.a,{color:"inherit",size:"small",onClick:function(){return h(!1),l({}),r(ds),Ss("RESET",f),u(0),void b(1)},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{color:"primary",size:"small",onClick:function(){return h(!0),l({producto:t,index:a,finish:!1}),r(t),Ss("SET",f,t.producto),i(t.producto),o(t.producto.precios.precios_producto),u(t.costo),void b(t.cantidad)},children:Object(H.jsx)(yn.a,{})})}),Object(H.jsx)(Da.a,{width:50,children:Object(H.jsx)(Ns,{index:a,isSelected:x})})]})},ws=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Ns=function(e){var t=e.index,a=e.isSelected,n=Object(j.useContext)(mn),c=n.productosCompra,r=n.setProductosCompra,i=n.datosCompra,o=n.setDatosCompra,s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=function(){u(!1)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{color:"secondary",size:"small",onClick:function(){u(!0)},disabled:a,children:Object(H.jsx)(Cs.a,{})}),Object(H.jsxs)(qe.a,{open:d,TransitionComponent:ws,keepMounted:!0,onClose:b,"aria-labelledby":"modal-eliminar-compra",children:[Object(H.jsx)(Bt.a,{id:"modal-eliminar-compra",children:"Seguro que quiere eliminar esto de la lista?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:b,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){var e=Object(Ia.a)(c),a=e.splice(t,1);o(Object(m.a)(Object(m.a)({},i),{},{subtotal:i.subtotal-a[0].subtotal,impuestos:i.impuestos-a[0].impuestos,total:i.total-a[0].total})),r(Object(Ia.a)(e)),b()},color:"secondary",children:"Aceptar"})]})]})]})},Ps=a(949),Es=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Ds(e){var t=e.realizarCompraBD,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],x=Object(j.useState)([]),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useContext)(mn),v=g.productosCompra,C=g.datosCompra,A=g.setDatosCompra,k=g.issue,w={subtotal:0,impuestos:0,total:0,descuento_aplicado:!1,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0},N=Object(j.useState)(w),P=Object(y.a)(N,2),E=P[0],D=P[1],z=function(){return r(!1)},T=Object(j.useState)(0),$=Object(y.a)(T,2),W=$[0],R=$[1],V=Object(j.useState)(0),M=Object(y.a)(V,2),B=M[0],U=M[1],q=Object(Lc.a)(W,700),J=Object(y.a)(q,1)[0],G=Object(Lc.a)(B,700),Y=Object(y.a)(G,1)[0];return Object(j.useEffect)((function(){!function(){for(var e=Object(Ia.a)(v),t=Object(m.a)({},w),a=E.porcentaje,n=E.cantidad_descontada,c=E.descuento_aplicado,r=[],i=0;i<e.length;i++){var o=e[i],s=Object(m.a)({},o),l=s.producto.precios,d=l.iva,j=l.ieps,u=s.subtotal,b=Math.round(u*a/100),p=u-b,O=parseFloat(p)*parseFloat(d<10?".0"+d:"."+d),x=parseFloat(p)*parseFloat(j<10?".0"+j:"."+j),h=O+x,_=p+h;s.iva_total=O,s.ieps_total=x,s.descuento_porcentaje=a,s.descuento_precio=b,s.impuestos=h,s.subtotal=p,s.total=_,t.impuestos+=h,t.subtotal+=p,t.total+=_,r.push(s)}f(r),t.porcentaje=a,t.cantidad_descontada=n,t.descuento_aplicado=c,D(t)}()}),[J,Y]),Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{autoFocus:!0,color:"primary",variant:"contained",size:"large",onClick:function(){return r(!0)},disabled:!v.length||k,startIcon:Object(H.jsx)(Yt.a,{}),children:"Guardar"}),Object(H.jsxs)(qe.a,{open:c,TransitionComponent:Es,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&z()},"aria-labelledby":"dialog-confirmacion-compra","aria-describedby":"dialog-confirmacion-compra-description",fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{style:{padding:0},children:Object(H.jsx)(O.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return z()},size:"small",disabled:s,children:Object(H.jsx)(Gt.a,{style:{fontSize:30}})})})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(O.a,{my:2,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:12,children:[Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:b,onChange:function(e){return p(e.target.checked)}}),label:"Compra a cr\xe9dito"}),Object(H.jsx)(L.a,{children:"Fecha de vencimiento del cr\xe9dito"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){A(Object(m.a)(Object(m.a)({},C),{},{fecha_vencimiento_credito:e.target.value}))},disabled:!b,value:C.fecha_vencimiento_credito})]}),Object(H.jsx)(Qe.a,{item:!0,md:12,children:Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"forma_pago",children:[Object(H.jsx)(te.a,{id:"forma_pago",children:"Forma de pago"}),Object(H.jsx)(Nt.a,{labelId:"forma_pago",value:C.forma_pago,name:"forma_pago",onChange:function(e){return t=e.target.value,void A(Object(m.a)(Object(m.a)({},C),{},{forma_pago:t}));var t},label:"Forma de pago",children:zs.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:e.Name},t)}))})]})}),Object(H.jsx)(Qe.a,{item:!0,md:12,children:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:E.descuento_aplicado,onChange:function(e){return t=e.target.checked,void D(t?Object(m.a)(Object(m.a)({},E),{},{descuento_aplicado:t}):Object(m.a)(Object(m.a)({},E),{},{subtotal:C.subtotal,total:C.total,descuento_aplicado:t,porcentaje:0,cantidad_descontada:0,precio_con_descuento:0}));var t},name:"descuento_aplicado"}),label:"Aplicar descuento"})}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){!function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(t/C.subtotal*100);D(Object(m.a)(Object(m.a)({},E),{},{porcentaje:a,cantidad_descontada:t}))}else D(Object(m.a)(Object(m.a)({},E),{},{porcentaje:0,cantidad_descontada:0}))}(e.target.value),R(e.target.value)},disabled:!E.descuento_aplicado,value:E.cantidad_descontada,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsx)(S.a,{variant:"outlined",type:"number",size:"small",fullWidth:!0,onChange:function(e){!function(e){if(e&&0!==parseFloat(e)){var t=parseFloat(e),a=Math.round(C.subtotal*t/100);D(Object(m.a)(Object(m.a)({},E),{},{porcentaje:t,cantidad_descontada:a}))}else D(Object(m.a)(Object(m.a)({},E),{},{porcentaje:0,cantidad_descontada:0}))}(e.target.value),U(e.target.value)},disabled:!E.descuento_aplicado,value:E.porcentaje,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"%"})}})}),Object(H.jsx)(Qe.a,{item:!0,md:4,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Subtotal:"})," $"+Ua(E.subtotal?E.subtotal:C.subtotal)]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Impuestos:"})," $"+Ua(E.impuestos?E.impuestos:C.impuestos)]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Total:"})," $"+Ua(E.total?E.total:C.total)]})})]})})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){p(!1),f([]),D(w),t(!1,b,z,l,E,_)},variant:"contained",color:"primary",startIcon:s?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Yt.a,{}),disabled:s||!C.forma_pago,children:"Guardar"})})]})]})}var zs=[{Name:"Efectivo",Value:"01"},{Name:"Cheque nominativo",Value:"02"},{Name:"Transferencia electr\xf3nica de fondos",Value:"03"},{Name:"Tarjeta de cr\xe9dito",Value:"04"},{Name:"Monedero electr\xf3nico",Value:"05"},{Name:"Vales de despensa",Value:"08"},{Name:"Tarjeta de d\xe9bito",Value:"28"},{Name:"Por definir",Value:"99"}],Ts=["descuento_aplicado","subtotal","total","impuestos"],$s=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),Ws=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Rs(e){var t=e.compra,a=e.status,n=e.handleOpenDetalles,c=e.refetchEspera,r=$s(),i=u.a.useState(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=function(){l(!0)};return Object(H.jsxs)("div",{children:["enEspera"===a?Object(H.jsx)(F.a,{fullWidth:!0,onClick:d,color:"primary",variant:"contained",size:"large",startIcon:Object(H.jsx)(Yt.a,{}),children:"continuar compra"}):Object(H.jsx)(F.a,{fullWidth:!0,onClick:d,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.n,{className:r.icon})}),"Abrir una compra"]})}),Object(H.jsx)(On,{children:Object(H.jsx)(Vs,{open:s,handleClose:function(){l(!1),"enEspera"===a&&(n(),c())},status:a,compra:t})})]})}var Vs=function(e){var t=e.open,a=e.handleClose,n=e.compra,c=e.status,r=$s(),i=Object(j.useContext)(mn),o=i.productosCompra,s=i.datosCompra,l=i.setDatosProducto,d=i.setProductosCompra,u=i.setDatosCompra,b=i.setProductoOriginal,p=i.setPreciosVenta,x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=JSON.parse(localStorage.getItem("sesionCafi")),A=JSON.parse(localStorage.getItem("turnoEnCurso")),S=Object(j.useState)({message:"",status:"",open:!1}),I=Object(y.a)(S,2),k=I[0],N=I[1],P=Object(j.useState)(!1),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(w.a)(as),$=Object(y.a)(T,1)[0],W=Object(w.a)(ns),R=Object(y.a)(W,1)[0],V=!!g&&g.accesos.tesoreria.caja_principal.ver,M=function(){l(ds),d(ps),u(js),b(bs),p(us)};Object(j.useEffect)((function(){"enEspera"===c&&n&&!0===t&&(u(n),d(n.productos))}),[t]);var B=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t,a,n,r,i,l){var d,j,u,b,p,O,x;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=Object(m.a)({},s),j=Object(Ia.a)(o),u=j,"enEspera"===c&&(u=j.map((function(e){return delete e.conflicto,e})),delete d.empresa,delete d.sucursal,delete d.usuario),z(!0),r&&r(!0),e.prev=6,d.productos=u,!t){e.next=16;break}return d.en_espera=!0,e.next=12,R({variables:{input:d,empresa:g.empresa._id,sucursal:g.sucursal._id,usuario:g._id}});case 12:b=e.sent,N({message:"\xa1Listo! ".concat(b.data.crearCompraEnEspera.message),status:"success",open:!0}),e.next=27;break;case 16:return a&&(d.compra_credito=!0,d.saldo_credito_pendiente=d.total),i.descuento_aplicado&&(i.descuento_aplicado,i.subtotal,i.total,i.impuestos,p=Object(De.a)(i,Ts),d.productos=l,d.descuento_aplicado=i.descuento_aplicado,d.subtotal=i.subtotal,d.impuestos=i.impuestos,d.total=i.total,d.descuento=p),O=null,A&&(O={horario_en_turno:A.horario_en_turno,numero_caja:A?parseInt(A.numero_caja):null,id_caja:A.id_caja,id_usuario:g._id,token_turno_user:A.token_turno_user,numero_usuario_creador:A?parseFloat(A.usuario_en_turno.numero_usuario):null,nombre_usuario_creador:A.usuario_en_turno.nombre}),d.turnoEnCurso=O,d.admin=V,d.sesion={id_usuario:g._id,nombre_usuario:g.nombre,numero_usuario:g.numero_usuario},e.next=25,$({variables:{input:d,empresa:g.empresa._id,sucursal:g.sucursal._id,usuario:g._id}});case 25:x=e.sent,N({message:"\xa1Listo! ".concat(x.data.crearCompra.message),status:"success",open:!0});case 27:z(!1),M(),n&&(n(),r(!1)),e.next=42;break;case 32:if(e.prev=32,e.t0=e.catch(6),z(!1),n&&(n(),r(!1)),console.log(e.t0),!e.t0.message){e.next=40;break}return N({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 40:N({message:"Error de servidor",status:"error",open:!0}),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 42:case"end":return e.stop()}}),e,null,[[6,32]])})));return function(t,a,n,c,r,i){return e.apply(this,arguments)}}(),U=function(){o.length>0?f(!_):(M(),a())};return Object(H.jsxs)(qe.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:Ws,children:[Object(H.jsx)(Bt.a,{style:{padding:0},children:Object(H.jsx)(Re.a,{className:r.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:r.title,children:"Nueva compra"}),Object(H.jsxs)(O.a,{m:1,children:[Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:U,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})}),Object(H.jsx)(Ms,{handleClose:a,handleToggleDelete:U,openDelete:_})]})]})})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(Y,{alert:k,setAlert:N}),Object(H.jsx)(st,{loading:D,setLoading:z}),Object(H.jsx)(_s,{status:c}),Object(H.jsx)(O.a,{my:2}),Object(H.jsx)(Is,{})]}),Object(H.jsxs)(tt.a,{style:{justifyContent:"enEspera"===c?"flex-end":"space-between"},children:["enEspera"===c?null:Object(H.jsx)(F.a,{autoFocus:!0,color:"primary",variant:"contained",size:"large",onClick:function(){return B(!0)},disabled:!o.length,startIcon:Object(H.jsx)(Ps.a,{}),children:"Compra en espera"}),Object(H.jsx)(Ds,{realizarCompraBD:B})]})]})},Ms=function(e){var t=e.handleClose,a=e.handleToggleDelete,n=e.openDelete,c=Object(j.useContext)(mn),r=c.setProductosCompra,i=c.setDatosCompra,o=c.setPreciosVenta,s=c.setProductoOriginal,l=c.setDatosProducto;return Object(H.jsx)("div",{children:Object(H.jsxs)(qe.a,{open:n,TransitionComponent:Ws,keepMounted:!0,onClose:a,"aria-labelledby":"modal-eliminar-compra",children:[Object(H.jsx)(Bt.a,{id:"modal-eliminar-compra",children:"\xbfQuieres cancelar esta compra?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:a,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){l(ds),i(js),o(us),s(bs),r(ps),a(),t()},color:"secondary",children:"Aceptar"})]})]})})},Ls=a(999),Bs=a(177),Us=a.n(Bs),qs=a(950),Js=a(63),Hs=a.n(Js),Gs=Hs.a.ExcelFile,Ys=Hs.a.ExcelFile.ExcelSheet,Qs=Hs.a.ExcelFile.ExcelColumn;function Ks(e){var t=e.compra,a=t.almacen,n=t.proveedor,c=t.fecha_registro,r=t.subtotal,i=t.impuestos,o=t.total,s=t.productos,l=[{almacen:a.nombre_almacen,proveedor:n.nombre_cliente,fecha_registro:La(c),subtotal:Ua(r),impuestos:Ua(i),total:Ua(o)}],d=s.map((function(e){var t=e.producto,a=e.medida,n=e.color,c=e.unidad,r=e.cantidad,i=e.Cantidad_regalo,o=e.cantidad_total,s=e.descuento_precio,l=e.descuento_porcentaje,d=e.subtotal,j=e.impuestos,u=e.total;return{producto:t.datos_generales.nombre_comercial,medida:a?a.medida:"N/A",color:n?n.color:"N/A",unidad:c,cantidad:r,Cantidad_regalo:i,cantidad_total:o,descuento_precio:s,descuento_porcentaje:l,subtotal:Ua(d),impuestos:Ua(j),total:Ua(u)}}));return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Gs,{element:Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"primary",startIcon:Object(H.jsx)(qs.a,{}),children:"Exportar a Excel"})}),filename:"Detalle de compra",children:[Object(H.jsxs)(Ys,{data:l,name:"Detalle compra",children:[Object(H.jsx)(Qs,{label:"Almacen",value:"almacen"}),Object(H.jsx)(Qs,{label:"Proveedor",value:"proveedor"}),Object(H.jsx)(Qs,{label:"Fecha de compra",value:"fecha_registro"}),Object(H.jsx)(Qs,{label:"Subtotal",value:"subtotal"}),Object(H.jsx)(Qs,{label:"Impuestos",value:"impuestos"}),Object(H.jsx)(Qs,{label:"Total",value:"total"})]}),Object(H.jsxs)(Ys,{data:d,name:"Productos de la compra",children:[Object(H.jsx)(Qs,{label:"Producto",value:"producto"}),Object(H.jsx)(Qs,{label:"Medida",value:"medida"}),Object(H.jsx)(Qs,{label:"Color",value:"color"}),Object(H.jsx)(Qs,{label:"Unidad",value:"unidad"}),Object(H.jsx)(Qs,{label:"Cantidad",value:"cantidad"}),Object(H.jsx)(Qs,{label:"Cantidad de regalo",value:"cantidad_regalo"}),Object(H.jsx)(Qs,{label:"Cantidad total",value:"cantidad_total"}),Object(H.jsx)(Qs,{label:"Precio de descuento",value:"descuento_precio"}),Object(H.jsx)(Qs,{label:"Porcentaje de descuento",value:"descuento_porcentaje"}),Object(H.jsx)(Qs,{label:"Subtotal",value:"subtotal"}),Object(H.jsx)(Qs,{label:"Impuestos",value:"impuestos"}),Object(H.jsx)(Qs,{label:"Total",value:"total"})]})]})})}var Xs=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function Zs(e){var t=e.compra,a=Xs(),n=Object($e.a)(),c=t.productos,r=Object(j.useState)(""),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)([]),d=Object(y.a)(l,2),u=d[0],b=d[1];return Object(j.useEffect)((function(){b(c.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(o.toLowerCase())})))}),[o,c]),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(O.a,{mb:1,display:"flex",children:[Object(H.jsxs)(L.a,{style:{marginRight:16},children:[Object(H.jsx)("b",{children:"Proveedor: "}),t.proveedor.nombre_cliente]}),Object(H.jsxs)(L.a,{style:{marginRight:16},children:[Object(H.jsx)("b",{children:"Almacen: "}),t.almacen.nombre_almacen]}),Object(H.jsx)(L.a,{style:{marginRight:16},children:Object(H.jsxs)("b",{children:["Subtotal: $",t.subtotal]})}),Object(H.jsx)(L.a,{style:{marginRight:16},children:Object(H.jsxs)("b",{children:["Impuestos: $",t.impuestos]})}),Object(H.jsx)(L.a,{style:{marginRight:16},children:Object(H.jsxs)("b",{children:["Total: $",t.total]})}),t.status&&"CANCELADO"===t.status?Object(H.jsx)(gn.a,{label:"Compra Cancelada",color:"secondary",variant:"outlined"}):!0===t.compra_credito?Object(H.jsx)(gn.a,{label:!0===t.credito_pagado?"Credito pagado":"Saldo pendiente: $".concat(Ua(t.saldo_credito_pendiente)),style:{color:!0===t.compra_credito?n.palette.primary.main:n.palette.warning.main,borderColor:!0===t.compra_credito?n.palette.primary.main:n.palette.warning.main},variant:"outlined"}):Object(H.jsx)(gn.a,{label:"CONTADO",color:"inherit",variant:"outlined"})]}),Object(H.jsx)(O.a,{mb:2,display:"flex",children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,sm:6,xs:12,children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar un producto en esta compra...",onChange:function(e){return t=e.target.value,s(t);var t},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(Us.a,{color:"action"})})}})}),Object(H.jsx)(Qe.a,{item:!0,sm:6,xs:12,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(Ks,{compra:t})})})]})}),Object(H.jsx)(fn.a,{className:a.root,children:Object(H.jsx)(Na.a,{className:a.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Producto"}),Object(H.jsx)(Da.a,{children:"Medida"}),Object(H.jsx)(Da.a,{children:"Color"}),Object(H.jsx)(Da.a,{children:"Unidad"}),Object(H.jsx)(Da.a,{children:"Cantidad"}),Object(H.jsx)(Da.a,{children:"C. regalo"}),Object(H.jsx)(Da.a,{children:"C. total"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:u.map((function(e,t){return Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:e.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(H.jsx)(gn.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:n.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(H.jsx)(Da.a,{children:e.unidad}),Object(H.jsx)(Da.a,{children:e.cantidad}),Object(H.jsx)(Da.a,{children:e.cantidad_regalo}),Object(H.jsx)(Da.a,{children:e.cantidad_total}),Object(H.jsx)(Da.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.subtotal)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.impuestos)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.total)]})})]},t)}))})]})})})]})}var el=a(951),tl=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function al(e){var t=e.compra,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],j=u.a.useState({message:"",status:"",open:!1}),b=Object(y.a)(j,2),p=b[0],m=b[1],O=JSON.parse(localStorage.getItem("sesionCafi")),x=JSON.parse(localStorage.getItem("turnoEnCurso")),h=!!O&&O.accesos.tesoreria.caja_principal.ver,_=Object(w.a)(cs),f=Object(y.a)(_,1)[0],g=function(){i(!1)},A=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n,c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,n=null,x&&(n={horario_en_turno:x.horario_en_turno,numero_caja:x?parseInt(x.numero_caja):null,id_caja:x.id_caja,id_usuario:O._id,token_turno_user:x.token_turno_user,numero_usuario_creador:x?parseFloat(x.usuario_en_turno.numero_usuario):null,nombre_usuario_creador:x.usuario_en_turno.nombre}),e.next=6,f({variables:{empresa:O.empresa._id,sucursal:O.sucursal._id,id_compra:t._id,data_sesion:{turno:n,admin:h,sesion:{id_usuario:O._id,nombre_usuario:O.nombre,numero_usuario:O.numero_usuario}}}});case 6:c=e.sent,m({message:"\xa1Listo! ".concat(c.data.cancelarCompra.message),status:"success",open:!0}),d(!1),a(),g(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),d(!1),m({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"secondary",size:"small",onClick:function(){i(!0)},disabled:!(!t.status||"CANCELADO"!==t.status),children:Object(H.jsx)(Gt.a,{})}),Object(H.jsx)(Y,{alert:p,setAlert:m}),Object(H.jsxs)(qe.a,{open:r,TransitionComponent:tl,keepMounted:!0,onClose:g,"aria-labelledby":"alert-dialog-cancel-compra",children:[Object(H.jsx)(Bt.a,{id:"alert-dialog-cancel-compra",children:"\xbfEst\xe1 seguro que desea cancelar esta compra?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:g,color:"inherit",children:"Cerrar"}),Object(H.jsx)(F.a,{onClick:function(){return A()},color:"secondary",disabled:l,startIcon:l?Object(H.jsx)(I.a,{color:"inherit",size:20}):null,children:"Cancelar Compra"})]})]})]})}var nl=Object(k.a)({root:{width:"100%"},container:{height:"68vh"}});function cl(e){var t=e.obtenerComprasRealizadas,a=e.refetch,n=e.limit,c=e.page,r=e.setPage,i=(e.filtro,e.filtroFecha,nl()),o=Object($e.a)(),s=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(fn.a,{className:i.root,variant:"outlined",children:[Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Almacen"}),Object(H.jsx)(Da.a,{children:"Proveedor"}),Object(H.jsx)(Da.a,{children:"Fecha de compra"}),Object(H.jsx)(Da.a,{children:"Compra a credito"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Detalles"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cancelar"})]})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){return Object(H.jsx)(rl,{compra:e,refetch:a,theme:o},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:n,page:c,onPageChange:function(e,t){r(t),a({empresa:s.empresa._id,sucursal:s.sucursal._id,offset:t})}})]})}var rl=function(e){var t=e.compra,a=e.refetch,n=e.theme,c=t.almacen,r=t.proveedor,i=t.fecha_registro,o=t.compra_credito,s=t.credito_pagado,l=t.subtotal,d=t.impuestos,j=t.total;return Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:c.nombre_almacen}),Object(H.jsx)(Da.a,{children:r.nombre_cliente}),Object(H.jsx)(Da.a,{children:Ba(i)}),Object(H.jsx)(Da.a,{children:t.status&&"CANCELADO"===t.status?Object(H.jsx)(gn.a,{label:"CANCELADO",color:"secondary",variant:"outlined"}):!0===o?Object(H.jsx)(gn.a,{label:!0===s?"PAGADO":"PENDIENTE",style:{color:!0===s?n.palette.primary.main:n.palette.warning.main,borderColor:!0===s?n.palette.primary.main:n.palette.warning.main},variant:"outlined"}):Object(H.jsx)(gn.a,{label:"CONTADO",color:"default",variant:"outlined"})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(l)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(d)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(j)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(ol,{compra:t})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(al,{compra:t,refetch:a})})]})},il=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),ol=function(e){var t=e.compra,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!c)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{size:"small",onClick:function(){return i()},children:Object(H.jsx)(el.a,{})}),Object(H.jsxs)(qe.a,{open:c,onClose:i,fullWidth:!0,maxWidth:"lg",TransitionComponent:il,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{variant:"h6",style:{flexGrow:1},children:"Datos de venta"}),Object(H.jsx)(F.a,{variant:"text",color:"primary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(Zs,{compra:t})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(Yt.a,{}),onClick:function(){return i()},children:"Aceptar"})})]})]})},sl=a(952),ll=a(67),dl=Hs.a.ExcelFile,jl=Hs.a.ExcelFile.ExcelSheet,ul=Hs.a.ExcelFile.ExcelColumn;function bl(e){var t=e.obtenerComprasRealizadas,a=e.filtro,n=e.filtroFecha,c=e.refetch,r=u.a.useState(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=u.a.useState(0),d=Object(y.a)(l,2),j=d[0],b=d[1],p=function(){s(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){s(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:o,onClose:p,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Reportes de compras"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo: exportar\xe1 todos los registros filtrados"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:j,onChange:function(e){return function(e){b(e),c(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:p,color:"inherit",children:"Cancelar"}),Object(H.jsx)(pl,{datosExcel:t.docs,filtro:a,filtroFecha:n})]})]})]})}var pl=function(e){var t=e.datosExcel,a=e.filtro,n=e.filtroFecha,c=t.map((function(e){var t=e.almacen,a=e.proveedor,n=e.fecha_registro,c=e.subtotal,r=e.impuestos,i=e.total;return{almacen:t.nombre_almacen,proveedor:a.nombre_cliente,fecha_registro:La(n),subtotal:Ua(c),impuestos:Ua(r),total:Ua(i)}})),r="";return a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since," y filtradas por ").concat(a):a&&!n.fecha?r="Lista de compras realizadas filtradas por ".concat(a):!a&&n.fecha?r="Lista de compras realizadas desde hace ".concat(n.since):a||n.fecha||(r="Lista de compras realizadas"),Object(H.jsx)(j.Fragment,{children:Object(H.jsx)(dl,{element:Object(H.jsx)(F.a,{variant:"contained",color:"primary",startIcon:Object(H.jsx)(ll.a,{}),disableElevation:!0,children:"Exportar"}),filename:r,children:Object(H.jsxs)(jl,{data:c,name:r,children:[Object(H.jsx)(ul,{label:"Almacen",value:"almacen"}),Object(H.jsx)(ul,{label:"Proveedor",value:"proveedor"}),Object(H.jsx)(ul,{label:"Fecha de compra",value:"fecha_registro"}),Object(H.jsx)(ul,{label:"Subtotal",value:"subtotal"}),Object(H.jsx)(ul,{label:"Impuestos",value:"impuestos"}),Object(H.jsx)(ul,{label:"Total",value:"total"})]})})})},ml=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),Ol=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function xl(){var e=ml(),t=u.a.useState(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.h,{className:e.icon})}),"Compras realizadas"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Ol,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Compras realizadas"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(A.a,{maxWidth:"xl",children:Object(H.jsx)(hl,{})})]})]})}var hl=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(j.useState)(""),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)({fecha:"",since:"todos"}),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)(0),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useRef)(null),m=Object(j.useRef)(null),x=Object(rt.b)(rs,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,fecha:o.fecha,limit:20,offset:0},fetchPolicy:"network-only"}),h=x.loading,_=x.data,f=x.error,g=x.refetch;if(h)return Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h5",children:"Cargando"})]});if(f)return Object(H.jsx)(bt,{error:f,altura:300});var v=[];_&&(v=_.obtenerComprasRealizadas);return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{my:3,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),g({filtro:t,fecha:o.fecha,offset:0}),c(t),b(0)}(e,e.target[0].value)},children:Object(H.jsx)(S.a,{inputRef:p,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{type:"submit",color:"primary",size:"medium",children:Object(H.jsx)(sl.a,{})})})}})})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:[Object(H.jsx)(te.a,{id:"label-select-fecha-filter",children:"Filtrar desde..."}),Object(H.jsxs)(Nt.a,{inputRef:m,labelId:"label-select-fecha-filter",value:o.since,onChange:function(e){return function(e){switch(e){case"7 dias":s({since:e,fecha:Dt()().subtract(7,"d").format()}),g({filtro:n,fecha:Dt()().subtract(7,"d").format(),offset:0}),b(0);break;case"2 semanas":s({since:e,fecha:Dt()().subtract(2,"w").format()}),g({filtro:n,fecha:Dt()().subtract(2,"w").format(),offset:0}),b(0);break;case"1 mes":s({since:e,fecha:Dt()().subtract(1,"M").format()}),g({filtro:n,fecha:Dt()().subtract(1,"M").format(),offset:0}),b(0);break;case"3 meses":s({since:e,fecha:Dt()().subtract(3,"M").format()}),g({filtro:n,fecha:Dt()().subtract(3,"M").format(),offset:0}),b(0);break;case"6 meses":s({since:e,fecha:Dt()().subtract(6,"M").format()}),g({filtro:n,fecha:Dt()().subtract(6,"M").format(),offset:0}),b(0);break;case"8 meses":s({since:e,fecha:Dt()().subtract(8,"M").format()}),g({filtro:n,fecha:Dt()().subtract(8,"M").format(),offset:0}),b(0);break;case"1 a\xf1o":s({since:e,fecha:Dt()().subtract(1,"y").format()}),g({filtro:n,fecha:Dt()().subtract(1,"y").format(),offset:0}),b(0);break;default:s({since:"todos",fecha:""}),g({filtro:n,fecha:"",offset:0}),b(0)}}(e.target.value)},label:"Filtrar desde...",children:[Object(H.jsx)(Pt.a,{value:"todos",children:Object(H.jsx)("em",{children:"Todos los registros"})}),Object(H.jsx)(Pt.a,{value:"7 dias",children:"hace 7 d\xedas"}),Object(H.jsx)(Pt.a,{value:"2 semanas",children:"hace 2 semanas"}),Object(H.jsx)(Pt.a,{value:"1 mes",children:"hace 1 mes"}),Object(H.jsx)(Pt.a,{value:"3 meses",children:"hace 3 meses"}),Object(H.jsx)(Pt.a,{value:"6 meses",children:"hace 6 meses"}),Object(H.jsx)(Pt.a,{value:"8 meses",children:"hace 8 meses"}),Object(H.jsx)(Pt.a,{value:"1 a\xf1o",children:"hace 1 a\xf1o"})]})]})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(bl,{obtenerComprasRealizadas:v,filtro:n,filtroFecha:o,refetch:g})})})]})}),n||o.fecha?Object(H.jsxs)(O.a,{display:"flex",mb:1,children:[Object(H.jsx)(L.a,{variant:"h6",children:"Resultados de:"}),Object(H.jsx)(O.a,{mr:1}),n?Object(H.jsx)(gn.a,{variant:"outlined",size:"medium",label:n,onDelete:function(){g({filtro:"",fecha:o.fecha,offset:0}),c(""),b(0),p.current.value=""}}):null,Object(H.jsx)(O.a,{mx:1}),o.fecha?Object(H.jsx)(gn.a,{variant:"outlined",size:"medium",label:"Desde hace ".concat(o.since),onDelete:function(){b(0),g({filtro:n,fecha:"",offset:0}),s({since:"todos",fecha:""}),m.current.value="todos"}}):null]}):null,Object(H.jsx)(cl,{obtenerComprasRealizadas:v,refetch:g,page:u,setPage:b,limit:20,filtro:n,filtroFecha:o})]})},_l=a(953),fl=a(955),gl=a(954),vl=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Cl(e){var t=e.compra,a=e.nuevoArray,n=e.setNuevoArray,c=e.setVerificado,r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=function(){s(!0)},m=function(){u&&c(!0),s(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"contained",color:"primary",onClick:function(){return p()},startIcon:Object(H.jsx)(_l.a,{}),children:"Continuar compra"}),Object(H.jsx)(qe.a,{open:o,TransitionComponent:vl,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&m()},"aria-labelledby":"dialog-verificarcompra-title","aria-describedby":"dialog-verificarcompra-description",fullWidth:!0,maxWidth:"sm",children:Object(H.jsx)(yl,{handleClose:m,compra:t,handleClickOpen:p,open:o,nuevoArray:a,setNuevoArray:n,setSuccess:b})})]})}var yl=function(e){var t=e.handleClose,a=e.compra,n=e.handleClickOpen,c=e.open,r=(e.nuevoArray,e.setNuevoArray),i=e.setSuccess,o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=JSON.parse(localStorage.getItem("sesionCafi")),b=0,p=Object(gl.a)(ec,{variables:{empresa:u.empresa._id,sucursal:u.sucursal._id,almacen:a.almacen.id_almacen,limit:0,offset:0},fetchPolicy:"network-only"}),x=Object(y.a)(p,2),h=x[0],_=x[1],f=_.loading,g=_.data,v=_.error;if(g&&(b=1),Object(j.useEffect)((function(){c&&0===b&&(h(),b=1)}),[n]),Object(j.useEffect)((function(){g&&function(){d(!0);for(var e=a.productos,t=Object(Ia.a)(e),n=!1,c=function(a){var c=e[a],r=Object(m.a)({},c),i=Object(m.a)({},c.producto),o=C.filter((function(e){return e._id===r.id_producto})),s=i.precios,l=i.unidades_de_venta,d=i.presentaciones,j=o[0].precios,u=o[0].unidades_de_venta,b=o[0].medidas_producto;s.unidad_de_compra.cantidad===j.unidad_de_compra.cantidad&&s.unidad_de_compra.precio_unitario_con_impuesto===j.unidad_de_compra.precio_unitario_con_impuesto&&s.unidad_de_compra.unidad===j.unidad_de_compra.unidad||(i.precios=j,r.producto=i,r.conflicto=!0,t[a]=r,n=!0);var p=l.filter((function(e){return!0===e.default})),O=u.filter((function(e){return!0===e.default}));if(p[0].cantidad===O[0].cantidad&&p[0].precio===O[0].precio&&p[0].unidad===O[0].unidad||(i.unidades_de_venta=u,r.producto=i,r.conflicto=!0,t[a]=r,n=!0),d.length>0)if(b.length>0)if(d.length===b.length)for(var x=0;x<d.length;x++)for(var h=d[x],_=0;_<b.length;_++){var f=b[_];h.medida._id===f.medida._id&&h.color._id===f.color._id&&h.almacen===f.almacen&&(h.cantidad===f.cantidad&&h.precio===f.precio||(i.presentaciones=b,r.producto=i,r.conflicto=!0,t[a]=r,n=!0))}else i.presentaciones=b,r.producto=i,r.conflicto=!0,t[a]=r,n=!0;else r.conflicto=!0,t[a]=r,n=!0},o=0;o<e.length;o++)c(o);var s=[],l=0,j=0,u=0;if(n){for(var b=function(e){var a=Object(m.a)({},t[e]);if("OTROS"!==a.producto.datos_generales.tipo_producto)a.producto.presentaciones.length>0?(a.cantidad=0,a.producto.presentaciones.forEach((function(e){var t=e.cantidad,n=e.cantidad_nueva,c=n||0;a.cantidad+=t+c})),isNaN(a.cantidad)&&(a.cantidad=0),a.cantidad_total=a.cantidad):(a.cantidad=0,a.cantidad_total=a.cantidad);else{var n=a.cantidad_regalo,c=a.cantidad,r=a.unidad_regalo,i=a.producto.precios.unidad_de_compra.cantidad,o="Pz"===r||"Kg"===r||"Lt"===r?n:n*i,d=c*i+o;i>1?(a.cantidad_regalo=o/i,a.cantidad_total=d/i):(a.cantidad_regalo=o,a.cantidad_total=d)}var b=a.producto.precios.precio_de_compra,p=b.iva,O=b.ieps,x=b.precio_con_impuesto,h=b.precio_sin_impuesto;a.total_con_descuento=x,a.costo=x,a.iva_total=p*a.cantidad_total,a.ieps_total=O*a.cantidad_total,a.impuestos=(p+O)*a.cantidad_total,a.subtotal=h*a.cantidad_total,a.total=x*a.cantidad_total,a.descuento_porcentaje>0&&(a.descuento_precio=Math.round(x*a.descuento_porcentaje/100),a.total_con_descuento=x-a.descuento_precio),l+=a.subtotal,j+=a.impuestos,u+=a.total_con_descuento*a.cantidad_total,s.push(a)},p=0;p<t.length;p++)b(p);r({_id:a._id,almacen:a.almacen,proveedor:a.proveedor,productos:s,en_espera:a.en_espera,fecha_registro:a.fecha_registro,impuestos:j,subtotal:l,total:u})}else r(a);setTimeout((function(){d(!1),i(!0)}),1500)}()}),[g]),f)return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(He.a,{style:{height:150,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(H.jsx)(ia.a,{id:"dialog-verificarcompra-description",children:"Si ya no hay existencias en tu producto se marcaran en la tabla y se quitaran al retomar la compra para no causar conflictos, podras editar tu compra mas adelante"}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(I.a,{size:18,color:"primary",style:{marginRight:8}}),"Obteniendo productos de la Base de datos..."]})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:t,color:"inherit",children:"Cancelar"})})]});if(v)return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(He.a,{children:Object(H.jsx)(bt,{error:v,altura:130})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:t,color:"inherit",children:"Cerrar"})})]});var C=[];return g&&(C=g.obtenerProductos.docs),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(He.a,{style:{height:150,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[Object(H.jsx)(ia.a,{id:"dialog-verificarcompra-description",children:"Si ya no hay existencias en tu producto se marcaran en la tabla y se quitaran al retomar la compra para no causar conflictos, podras editar tu compra mas adelante"}),l?Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(I.a,{size:18,color:"primary",style:{marginRight:8}}),"Verificando existencias en tus productos..."]}):null,l?null:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(fl.a,{color:"primary",style:{marginRight:8}}),"Listo, producto verificados"]})]}),Object(H.jsx)(tt.a,{children:l?Object(H.jsx)(F.a,{onClick:t,color:"inherit",children:"Cancelar"}):Object(H.jsx)(F.a,{onClick:t,color:"primary",startIcon:Object(H.jsx)(Yt.a,{}),children:"Aceptar"})})]})},Al=a(956),Sl=Object(k.a)({root:{width:"100%"},container:{height:"50vh"}});function Fl(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=e.handleOpenDetalles,r=Sl(),i=Object($e.a)(),o=Object(j.useState)(Object(m.a)({},t)),s=Object(y.a)(o,2),l=s[0],d=s[1],u=l.productos,b=JSON.parse(localStorage.getItem("sesionCafi")),p=Object(j.useState)(""),x=Object(y.a)(p,2),h=x[0],_=x[1],f=Object(j.useState)([]),g=Object(y.a)(f,2),v=g[0],C=g[1],A=Object(j.useState)(),F=Object(y.a)(A,2),I=F[0],k=F[1],w=Object(j.useState)(!1),N=Object(y.a)(w,2),P=N[0],E=N[1];return Object(j.useEffect)((function(){C(u.filter((function(e){return e.producto.datos_generales.nombre_comercial.toLowerCase().includes(h.toLowerCase())})))}),[h,u]),Object(j.useEffect)((function(){P&&I&&d(I)}),[P]),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(O.a,{mb:1,display:"flex",children:[Object(H.jsxs)(L.a,{style:{marginRight:16},children:[Object(H.jsx)("b",{children:"Proveedor: "}),l.proveedor.nombre_cliente]}),Object(H.jsxs)(L.a,{style:{marginRight:16},children:[Object(H.jsx)("b",{children:"Almacen: "}),l.almacen.nombre_almacen]}),Object(H.jsx)(L.a,{style:{marginRight:16},children:Object(H.jsxs)("b",{children:["Subtotal: $",parseFloat(l.subtotal.toFixed(2))]})}),Object(H.jsx)(L.a,{style:{marginRight:16},children:Object(H.jsxs)("b",{children:["Impuestos: $",parseFloat(l.impuestos.toFixed(2))]})}),Object(H.jsx)(L.a,{style:{marginRight:16},children:Object(H.jsxs)("b",{children:["Total: $",Ua(parseFloat(l.total.toFixed(2)))]})})]}),Object(H.jsx)(O.a,{mb:2,display:"flex",children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,sm:6,xs:12,children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",onChange:function(e){return t=e.target.value,_(t);var t},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(Us.a,{color:"action"})})}})}),Object(H.jsx)(Qe.a,{item:!0,sm:6,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",children:[!1===b.accesos.compras.compras_espera.eliminar?null:Object(H.jsx)(kl,{compra:l,setAlert:a,refetch:n,handleOpenDetalles:c}),Object(H.jsx)(O.a,{mx:1}),!1===b.accesos.compras.compras_espera.editar?null:P?Object(H.jsx)(Rs,{compra:l,status:"enEspera",handleOpenDetalles:c,refetchEspera:n}):Object(H.jsx)(Cl,{compra:l,nuevoArray:I,setNuevoArray:k,setVerificado:E})]})})]})}),Object(H.jsx)(fn.a,{className:r.root,variant:"outlined",children:Object(H.jsx)(Na.a,{className:r.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[P?Object(H.jsx)(Da.a,{}):null,Object(H.jsx)(Da.a,{children:"Producto"}),Object(H.jsx)(Da.a,{children:"Medida"}),Object(H.jsx)(Da.a,{children:"Color"}),Object(H.jsx)(Da.a,{children:"Unidad"}),Object(H.jsx)(Da.a,{children:"Cantidad"}),Object(H.jsx)(Da.a,{children:"C. regalo"}),Object(H.jsx)(Da.a,{children:"C. total"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:v.map((function(e,t){return Object(H.jsxs)(Ea.a,{tabIndex:-1,selected:e.conflicto,children:[P?Object(H.jsx)(Da.a,{style:{paddingTop:0,paddingBottom:0},children:e.conflicto?Object(H.jsx)(ys.a,{color:"primary"}):Object(H.jsx)(fl.a,{style:{color:i.palette.success.main}})}):null,Object(H.jsx)(Da.a,{children:e.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(H.jsx)(gn.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:i.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(H.jsx)(Da.a,{children:e.unidad}),Object(H.jsx)(Da.a,{children:e.cantidad}),Object(H.jsx)(Da.a,{children:e.cantidad_regalo}),Object(H.jsx)(Da.a,{children:e.cantidad_total}),Object(H.jsx)(Da.a,{children:"$".concat(e.descuento_precio," - %").concat(e.descuento_porcentaje)}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.subtotal)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.impuestos)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.total)]})})]},t)}))})]})})})]})}var Il=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),kl=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=e.handleOpenDetalles,r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(w.a)(ss),m=Object(y.a)(p,1)[0],O=function(){s(!o)},x=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,m({variables:{id:t._id}});case 4:r=e.sent,a({message:"\xa1Listo! ".concat(r.data.eliminarCompraEnEspera.message),status:"success",open:!0}),n(),b(!1),O(),c(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),b(!1),a({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{color:"secondary",startIcon:Object(H.jsx)(Al.a,{}),onClick:function(){return O()},children:"Eliminar compra"}),Object(H.jsxs)(qe.a,{open:o,onClose:O,TransitionComponent:Il,children:[Object(H.jsx)(Bt.a,{children:"\xbfDesea eliminar esta compra?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{variant:"text",color:"inherit",size:"large",startIcon:Object(H.jsx)(Ye.a,{}),onClick:function(){return O()},children:"Cancelar"}),Object(H.jsx)(F.a,{variant:"text",color:"secondary",size:"large",disabled:u,startIcon:u?Object(H.jsx)(I.a,{size:18,color:"inherit"}):Object(H.jsx)(Yt.a,{}),onClick:function(){return x()},children:"Eliminar"})]})]})]})},wl=Object(k.a)({root:{width:"100%"},container:{height:"68vh"}});function Nl(e){var t=e.obtenerComprasEnEspera,a=e.refetch,n=e.page,c=e.setPage,r=e.limit,i=(e.filtro,wl()),o=Object(j.useState)({message:"",status:"",open:!1}),s=Object(y.a)(o,2),l=s[0],d=s[1],u=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(fn.a,{className:i.root,variant:"outlined",children:[Object(H.jsx)(Y,{alert:l,setAlert:d}),Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Almacen"}),Object(H.jsx)(Da.a,{children:"Proveedor"}),Object(H.jsx)(Da.a,{children:"Fecha de compra"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"}),Object(H.jsx)(Da.a,{children:"Detalles"}),!1===u.accesos.compras.compras_espera.elimina?null:Object(H.jsx)(Da.a,{children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){return Object(H.jsx)(Pl,{compra:e,refetch:a,setAlert:d},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:r,page:n,onPageChange:function(e,t){c(t),a({empresa:u.empresa._id,sucursal:u.sucursal._id,offset:t})}})]})}var Pl=function(e){var t=e.compra,a=e.refetch,n=e.setAlert,c=t.almacen,r=t.proveedor,i=t.fecha_registro,o=t.subtotal,s=t.impuestos,l=t.total,d=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:c.nombre_almacen}),Object(H.jsx)(Da.a,{children:r.nombre_cliente}),Object(H.jsx)(Da.a,{children:La(i)}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(o)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(s)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(l)]})}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(Dl,{compra:t,refetch:a,setAlert:n})}),!1===d.accesos.compras.compras_espera.eliminar?null:Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(zl,{compra:t,refetch:a,setAlert:n})})]})},El=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Dl=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=function(){o(!i)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{size:"small",onClick:function(){return s()},children:Object(H.jsx)(el.a,{})}),Object(H.jsxs)(qe.a,{open:i,onClose:s,fullWidth:!0,maxWidth:"lg",TransitionComponent:El,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra en espera"}),Object(H.jsx)(F.a,{variant:"text",color:"primary",onClick:s,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(Fl,{compra:t,refetch:n,setAlert:a,handleOpenDetalles:s})})]})]})},zl=function(e){var t=e.compra,a=e.setAlert,n=e.refetch,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(w.a)(ss),p=Object(y.a)(b,1)[0],m=function(){o(!i)},O=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,p({variables:{id:t._id}});case 4:c=e.sent,a({message:"\xa1Listo! ".concat(c.data.eliminarCompraEnEspera.message),status:"success",open:!0}),n(),u(!1),m(),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),u(!1),a({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{size:"small",onClick:function(){return m()},children:Object(H.jsx)(Al.a,{color:"error"})}),Object(H.jsxs)(qe.a,{open:i,onClose:m,TransitionComponent:El,children:[Object(H.jsx)(Bt.a,{children:"\xbfDesea eliminar esta compra?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{variant:"text",color:"inherit",size:"large",startIcon:Object(H.jsx)(Ye.a,{}),onClick:function(){return m()},children:"Cancelar"}),Object(H.jsx)(F.a,{variant:"text",color:"secondary",size:"large",disabled:d,startIcon:d?Object(H.jsx)(I.a,{size:18,color:"inherit"}):Object(H.jsx)(Yt.a,{}),onClick:function(){return O()},children:"Eliminar"})]})]})]})},Tl=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),$l=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Wl(){var e=Tl(),t=u.a.useState(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.l,{className:e.icon})}),"Compras en espera"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:$l,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Compras en espera"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(A.a,{maxWidth:"xl",children:Object(H.jsx)(Rl,{})})]})]})}var Rl=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(j.useState)(""),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useRef)(null),i=Object(j.useState)(0),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(rt.b)(is,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtro:n,limit:20,offset:0},fetchPolicy:"network-only"}),u=d.loading,b=d.data,p=d.error,m=d.refetch;if(u)return Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h5",children:"Cargando"})]});if(p)return Object(H.jsx)(bt,{error:p,altura:300});var x=[];b&&(x=b.obtenerComprasEnEspera);return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{my:3,maxWidth:500,children:Object(H.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),m({filtro:t}),c(t)}(e,e.target[0].value)},children:Object(H.jsx)(S.a,{inputRef:r,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{type:"submit",color:"primary",size:"medium",children:Object(H.jsx)(sl.a,{})})})}})})}),Object(H.jsx)(Nl,{obtenerComprasEnEspera:x,refetch:m,page:s,setPage:l,limit:20,filtro:n})]})};function Vl(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)(A.a,{maxWidth:"md",children:Object(H.jsxs)(Qe.a,{container:!0,spacing:3,justifyContent:"center",children:[!1===e.accesos.compras.abrir_compra.ver?null:Object(H.jsx)(Qe.a,{item:!0,md:4,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Rs,{})})}),!1===e.accesos.compras.compras_realizadas.ver?null:Object(H.jsx)(Qe.a,{item:!0,md:4,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(xl,{})})}),!1===e.accesos.compras.compras_espera.ver?null:Object(H.jsx)(Qe.a,{item:!0,md:4,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Wl,{})})})]})})}var Ml=a(503),Ll=a(957),Bl=["representante","estado_cliente","tipo_cliente","empresa","sucursal","fecha_nacimiento","fecha_registro","eliminado"],Ul=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),ql=Object(k.a)({root:{width:"100%"},container:{height:"63vh"}});function Jl(e){var t=e.user,a=e.tipo,n=e.filtro,c=e.ventas,r=e.handleClickOpen,i=e.isOnline,o=ql(),s=Object(j.useContext)(Po),l=s.setUpdateClientVenta,d=s.updateClientVenta,u=s.update,b=Object(Lc.a)(n,1e3),p=Object(y.a)(b,1)[0],x=Object(j.useState)(0),h=Object(y.a)(x,2),_=h[0],f=h[1],g=JSON.parse(localStorage.getItem("sesionCafi")),v=Object(rt.b)(Ko,{variables:{tipo:a,filtro:p,empresa:g.empresa._id,eliminado:!1,limit:20,offset:_},fetchPolicy:"network-only"}),C=v.loading,A=v.data,S=v.error,k=v.refetch;Object(j.useEffect)((function(){k()}),[u,k]);var w=Object(j.useState)(!1),N=Object(y.a)(w,2),P=N[0],E=N[1],D=Object(j.useState)({}),z=Object(y.a)(D,2),T=z[0],$=z[1],W=Object(j.useState)({message:"",status:"",open:!1}),R=Object(y.a)(W,2),V=R[0],M=R[1],B=function(e,t){c&&(E(!0),$(e))};if(C)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",width:"120vh",children:Object(H.jsx)(I.a,{})});if(S)return Object(H.jsx)(bt,{error:S});var U=A.obtenerClientes;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:V,setAlert:M}),Object(H.jsxs)(fn.a,{className:o.root,variant:"outlined",children:[Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{width:"110",children:"No. Cliente"}),Object(H.jsx)(Da.a,{width:"100",children:"Clave"}),Object(H.jsx)(Da.a,{width:"200",children:"Nombre"}),Object(H.jsx)(Da.a,{width:"150",children:"Correo"}),Object(H.jsx)(Da.a,{width:"200",children:"Fecha Registro"}),"EMPLEADO"===t?null:Object(H.jsx)(Da.a,{width:"100",children:"Estado"}),Object(H.jsx)(Da.a,{width:"50",children:"Editar"}),"EMPLEADO"===t?null:Object(H.jsx)(Da.a,{width:"50",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:U.docs.map((function(e,a){return Object(H.jsx)(Hl,{isOnline:i,user:t,datos:e,handleClickOpenModal:B,setAlert:M,refetch:k,ventas:c,dataSelectRowClient:T},a)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:U.totalDocs,rowsPerPage:20,page:_,onPageChange:function(e,t){f(t)}}),Object(H.jsxs)(qe.a,{open:P,onClose:function(){return E(!1)},"aria-labelledby":"select-dialog-cliente-venta","aria-describedby":"select-cliente-venta-description",children:[Object(H.jsx)(Bt.a,{id:"select-dialog-cliente-venta",children:"\xbfEstas seguro que desea seleccionar este cliente?"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(L.a,{children:"Cliente: ".concat(T.nombre_cliente)}),Object(H.jsx)(L.a,{children:"N\xfamero de clave: ".concat(T.clave_cliente)}),Object(H.jsx)(ia.a,{id:"select-cliente-venta-description",children:"Al seleccionar el cliente se colocara en la venta."})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return E(!1)},color:"primary",autoFocus:!0,children:"cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return function(){T.representante,T.estado_cliente,T.tipo_cliente,T.empresa,T.sucursal,T.fecha_nacimiento,T.fecha_registro,T.eliminado;var e=Object(De.a)(T,Bl);try{var t,a=JSON.parse(localStorage.getItem("DatosVentas")),n=null===a?{}:a;localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)({},n),{},{subTotal:void 0===n.subTotal?0:n.subTotal,total:void 0===n.total?0:n.total,impuestos:void 0===n.impuestos?0:n.impuestos,iva:void 0===n.iva?0:n.iva,ieps:void 0===n.ieps?0:n.ieps,descuento:void 0===n.descuento?0:n.descuento,monedero:void 0===n.monedero?0:n.monedero,cliente:e||{},venta_cliente:!0,productos:(null===(t=n.productos)||void 0===t?void 0:t.length)>0?n.productos:[],tipo_emision:n.tipo_emision?n.tipo_emision:"TICKET"}))),l(!d),E(!P),r()}catch(S){console.log(S)}}()},color:"primary",children:"Aceptar"})]})]})]})]})}var Hl=function(e){var t=e.datos,a=e.user,n=e.handleClickOpenModal,c=e.setAlert,r=e.refetch,i=e.ventas,o=e.dataSelectRowClient,s=e.isOnline,l=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(j.useContext)(Po),u=d.update,b=d.setUpdate,p=Object(j.useState)(!1),m=Object(y.a)(p,2),O=m[0],x=m[1],h=JSON.parse(localStorage.getItem("sesionCafi")),_=Object(w.a)(Xo),f=Object(y.a)(_,1)[0],g=function(){var e=Object(C.a)(Object(v.a)().mark((function e(a){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.prev=1,e.next=4,f({variables:{input:{estado_cliente:a.target.checked},id:t._id,empresa:h.empresa._id,sucursal:h.sucursal._id}});case 4:b(!u),x(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),x(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,onClick:function(e){return n(t,e)},hover:i,style:i?{cursor:"pointer"}:null,selected:i&&o.numero_cliente===t.numero_cliente,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.numero_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.clave_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.nombre_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.email})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:Ba(t.fecha_registro)})}),"EMPLEADO"===a?null:Object(H.jsx)(Da.a,{children:O?Object(H.jsx)(I.a,{size:30}):Object(H.jsx)(Ll.a,{checked:t.estado_cliente,disabled:!s,onChange:g,color:"primary",size:"small"})}),Object(H.jsx)(Da.a,{width:50,children:!1===l.accesos.catalogos.clientes.editar?null:Object(H.jsx)(ts,{tipo:"CLIENTE",accion:"actualizar",datos:t,refetch:r,isOnline:s})}),Object(H.jsx)(Da.a,{width:50,children:!1===l.accesos.catalogos.clientes.eliminar?null:Object(H.jsx)(Gl,{isOnline:s,datos:t,setAlert:c,refetch:r})})]})})},Gl=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=e.isOnline,r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(w.a)(Zo),d=Object(y.a)(l,1)[0],u=Object(j.useState)(!1),b=Object(y.a)(u,2),p=b[0],m=b[1],O=JSON.parse(localStorage.getItem("sesionCafi")),x=Object(j.useContext)(Po),h=x.update,_=x.setUpdate,f=function(){s(!1)},g=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,d({variables:{id:t._id,empresa:O.empresa._id,sucursal:O.sucursal._id}});case 4:(c=e.sent)&&(r=c.data.eliminarCliente.message,a({message:r,status:"success",open:!0}),n()),m(!1),_(!h),f(),e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(1),console.log(e.t0),m(!1),!e.t0.message){e.next=18;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 18:a({message:"Hubo un error",status:"error",open:!0});case 19:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{disabled:!c,size:"small",color:"secondary",onClick:function(){s(!0)},children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:o,TransitionComponent:Ul,keepMounted:!0,onClose:function(){return f()},"aria-labelledby":"alert-eliminar-cliente",children:[Object(H.jsx)(Bt.a,{id:"alert-eliminar-cliente",children:"\xbfEst\xe1 seguro de eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return f()},color:"inherit",disabled:p,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return g()},color:"secondary",disabled:p,startIcon:p?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})},Yl=a(958),Ql=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Kl(e){var t=e.tipo,a=e.refetchProveedores,n=e.isOnline,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(""),l=Object(y.a)(s,2),d=l[0],u=l[1],b=function(){return o(!i)};return console.log(n),Object(H.jsxs)("div",{children:[Object(H.jsxs)(F.a,{disableElevation:!0,color:"inherit",onClick:b,startIcon:Object(H.jsx)(oa.a,{}),disabled:!n,children:["CLIENTE"===t?"Clientes":"Proveedores "," eliminados"]}),Object(H.jsxs)(qe.a,{open:i,TransitionComponent:Ql,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&b()},"aria-labelledby":"dialog-clientes-eliminados",maxWidth:"md",fullWidth:!0,children:[Object(H.jsx)(Bt.a,{id:"dialog-clientes-eliminados",children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsxs)(L.a,{variant:"h6",children:["CLIENTE"===t?"Clientes":"Proveedores "," eliminados"]}),Object(H.jsx)(F.a,{variant:"contained",onClick:b,color:"secondary",children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{mb:2,children:Object(H.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,placeholder:"Buscar cliente: No. cliente, clave o nombre...",onChange:function(e){return u(e.target.value)},value:d,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(Nc.a,{})})}})}),Object(H.jsx)(Xl,{tipo:t,filter:d,refetchProveedores:a})]})]})]})}var Xl=function(e){var t=e.tipo,a=e.filter,n=e.refetchProveedores,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(j.useContext)(Po).update,i=Object(j.useState)(0),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(an.useDebounce)(a,800),u=Object(y.a)(d,1)[0],b=Object(rt.b)(Ko,{variables:{tipo:t,filtro:u||"",empresa:c.empresa._id,eliminado:!0,limit:20,offset:s},fetchPolicy:"network-only"}),p=b.loading,m=b.data,x=b.error,h=b.refetch;if(Object(j.useEffect)((function(){h()}),[r,h]),p)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh",children:Object(H.jsx)(I.a,{})});if(x)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh",children:Object(H.jsx)(bt,{error:x})});if(!p&&!x&&!m)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh",children:Object(H.jsx)(L.a,{variant:"h6",children:"No hay clientes eliminados"})});var _=m.obtenerClientes;return Object(H.jsxs)(O.a,{height:"60vh",children:[Object(H.jsx)(Na.a,{style:{height:"50vh"},children:Object(H.jsxs)($a.a,{"aria-label":"simple table",size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"No. Cliente"}),Object(H.jsx)(Da.a,{children:"Clave"}),Object(H.jsx)(Da.a,{children:"Nombre"}),Object(H.jsx)(Da.a,{children:"Correo"}),Object(H.jsx)(Da.a,{children:"Fecha Registro"}),Object(H.jsx)(Da.a,{align:"right",children:"Reactivar"})]})}),Object(H.jsx)(za.a,{children:_.docs.map((function(e,t){return Object(H.jsx)(Zl,{datos:e,refetchProveedores:n},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:_.totalDocs,rowsPerPage:20,page:s,onPageChange:function(e,t){l(t)}})]})},Zl=function(e){var t=e.datos,a=e.refetchProveedores,n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=JSON.parse(localStorage.getItem("sesionCafi")),b=Object(j.useState)({message:"",status:"",open:!1}),p=Object(y.a)(b,2),m=p[0],O=p[1],x=Object(j.useContext)(Po),h=x.setUpdate,_=x.update,f=Object(w.a)(Xo),g=Object(y.a)(f,1)[0],A=function(){var e=Object(C.a)(Object(v.a)().mark((function e(n){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,g({variables:{input:{eliminado:!1},id:t._id,empresa:u.empresa._id,sucursal:u.sucursal._id}});case 4:d(!1),h(!_),a&&a(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),d(!1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){return i(!r)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.numero_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.clave_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.nombre_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.email})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:Dt()(t.fecha_registro).format("DD/MM/YYYY")})}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(ce.a,{color:"primary",size:"small",onClick:S,children:Object(H.jsx)(Yl.a,{style:{fontSize:30}})})})]}),Object(H.jsxs)(qe.a,{open:r,onClose:S,"aria-labelledby":"reactivar-cliente-dialog",children:[Object(H.jsx)(Bt.a,{id:"reactivar-cliente-dialog",children:"Se reactivar\xe1 este cliente"}),Object(H.jsx)(Y,{alert:m,setAlert:O}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:S,color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return A()},color:"primary",autoFocus:!0,startIcon:l?Object(H.jsx)(I.a,{size:20}):null,children:"Aceptar"})]})]})]})},ed=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),td=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function ad(){var e=Object(j.useContext)(be).isOnline,t=ed(),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(""),s=Object(y.a)(o,2),l=s[0],d=s[1],u=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{onClick:function(){i(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.i,{className:t.icon})}),"Cliente"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:r,onClose:u,TransitionComponent:td,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Cliente"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:u,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(O.a,{mx:4,my:3,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:8,children:Object(H.jsxs)(fn.a,{className:t.root,children:[Object(H.jsx)(Ml.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return d(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&d(e.target.defaultValue)},value:l}),Object(H.jsx)(ce.a,{onClick:function(){return d(l)},children:Object(H.jsx)(Nc.a,{})})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:[!1===a.accesos.catalogos.clientes.agregar?null:Object(H.jsx)(Kl,{isOnline:e,tipo:"CLIENTE"}),Object(H.jsx)(O.a,{mx:1}),!1===a.accesos.catalogos.clientes.agregar?null:Object(H.jsx)(ts,{isOnline:e,tipo:"CLIENTE",accion:"registrar"})]})]})}),Object(H.jsx)(O.a,{mx:4,children:Object(H.jsx)(Jl,{isOnline:e,tipo:"CLIENTE",filtro:l})})]})]})}var nd,cd,rd,id,od=a(337),sd=a.n(od),ld=a(1e3),dd=Object(P.d)(nd||(nd=Object(N.a)(["\n\tmutation CrearDescuentoUnidad($input: ObjetoDescuentoUnidadesInput!){\n        crearDescuentoUnidad(input: $input){\n            message\n        }\n  }\n"]))),jd=(Object(P.d)(cd||(cd=Object(N.a)(["\n\tmutation ActualizarDescuentoUnidad($input: ObjetoDescuentoUnidadesInput!){\n        actualizarDescuentoUnidad(input: $input){\n            message\n        }\n    }\n"]))),Object(P.d)(rd||(rd=Object(N.a)(["\n\tmutation DesactivarDescuentoUnidad($input: ActivarDescuentoUnidades , $id: ID!){\n        desactivarDescuentoUnidad(input: $input, id: $id){\n            message\n        }\n    }\n"])))),ud=Object(P.d)(id||(id=Object(N.a)(["\n\tmutation ELiminarDescuentoUnidad( $id: ID!){\n        eliminarDescuentoUnidad( id: $id){\n            message\n        }\n    }\n"]))),bd=[{id:"cantidad",label:"Cantidad"},{id:"tipo",label:"Tipo"},{id:"precio",label:"Precio U."},{id:"precioDes",label:"Precio Desc."},{id:"descuento",label:"% Desc."},{id:"eliminar",label:"Eliminar"},{id:"activo",label:"Activo"}];function pd(e){var t=e.onSelectAllClick,a=e.numSelected,n=e.rowCount,c=e.datosPrecios,r=!1;return null===c||void 0===c||c.forEach((function(e){if(e.medida)return r=!0})),Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(Ze.a,{indeterminate:a>0&&a<n,checked:n>0&&a===n,onChange:t,inputProps:{"aria-label":"select all desserts"}})}),bd.map((function(e){return Object(H.jsx)(Da.a,{align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",children:e.label},e.id)})),!0===r?Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(Da.a,{children:"Talla"}),Object(H.jsx)(Da.a,{children:"Color"})]}):null]})})}var md=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{height:300},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:30,width:30,margin:1,borderRadius:"15%",cursor:"pointer"}}}));function Od(e){var t=e.value,a=e.datos,n=e.setCleanList,c=e.cleanList,r=e.verificarDatos,i=e.setPrecioPrueba,o=e.productosRefetch,s=e.setLoading,l=e.loading,d=md(),u=Object(j.useContext)(Pe),b=u.datosPreciosProducto,p=u.setPreciosProductos,m=u.setDatosPreciosProducto,O=Object(j.useState)({message:"",status:"",open:!1}),x=Object(y.a)(O,2),h=x[0],_=x[1],f=parseFloat((100-t).toFixed(2)),g=Object(j.useState)([]),v=Object(y.a)(g,2),C=v[0],A=v[1],S=Object(j.useState)(0),F=Object(y.a)(S,2),I=F[0],k=(F[1],Object(j.useState)(5)),w=Object(y.a)(k,2),N=w[0];w[1];a&&(a.medidas_producto.length>0?m(a.medidas_producto):m(a.unidades_de_venta));var P=function(e,t){var a=C.indexOf(t),n=[];-1===a?n=n.concat(C,t):0===a?n=n.concat(C.slice(1)):a===C.length-1?n=n.concat(C.slice(0,-1)):a>0&&(n=n.concat(C.slice(0,a),C.slice(a+1))),i(0===n.length?0:n),p(n),r(n),A(n)};Object(j.useEffect)((function(){A([]),n(!1)}),[c]);var E=N-Math.min(N,b.length-I*N);return Object(H.jsxs)("div",{className:d.root,children:[Object(H.jsx)(Y,{alert:h,setAlert:_}),Object(H.jsxs)(fn.a,{className:d.paper,children:[Object(H.jsx)(st,{loading:l,setLoading:s}),Object(H.jsx)(Na.a,{className:d.table,children:Object(H.jsxs)($a.a,{className:d.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"a dense table",children:[Object(H.jsx)(pd,{classes:d,numSelected:C.length,onSelectAllClick:function(e){if(e.target.checked){var t=b.map((function(e){return e}));return A(t),r(t),void p(t)}p([]),A([])},rowCount:b.length,datosPrecios:b}),Object(H.jsxs)(za.a,{children:[b.map((function(e,n){var c,r=(c=e,-1!==C.indexOf(c)),i="enhanced-table-checkbox-".concat(n);return Object(H.jsx)(xd,{setLoading:s,productosRefetch:o,handleClick:P,selected:C,row:e,setAlert:_,porcentaje:f,value:t,datos:a,isItemSelected:r,labelId:i},e._id)})),E>0&&Object(H.jsx)(Ea.a,{style:{height:53*E},children:Object(H.jsx)(Da.a,{colSpan:6})})]})]})})]})]})}function xd(e){var t,a,n,c,r=e.row,i=e.value,o=e.isItemSelected,s=e.setLoading,l=e.datos,d=e.labelId,u=e.setAlert,b=e.porcentaje,p=e.productosRefetch,m=e.handleClick,O=e.selected,x=md(),h=Object($e.a)(),_=Object(j.useState)(!1),f=Object(y.a)(_,2),g=f[0],A=f[1],S=Object(j.useContext)(Pe).setDatosPreciosProducto,F=Object(w.a)(jd),I=Object(y.a)(F,1)[0],k=Object(w.a)(ud),N=Object(y.a)(k,1)[0],P=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,I({variables:{input:{descuento_activo:!r.descuento_activo},id:r._id}});case 4:s(!1),p(),u({message:"Estado de descuento actualizado",status:"success",open:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),u({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),E=function(){A(!g),D()},D=function(){l.medidas_producto.length>0?(S(l.medidas_producto),s(!1)):(S(l.unidades_de_venta),s(!1))},z=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,p(),e.next=5,N({variables:{id:r._id}});case 5:t=e.sent,E(),D(),u({message:t.data.eliminarDescuentoUnidad.message,status:"success",open:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),u({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox","aria-checked":o,tabIndex:-1,selected:o,children:[Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(Ze.a,{onClick:function(e){m(e,r)},checked:o,inputProps:{"aria-labelledby":d}})}),Object(H.jsx)(Da.a,{align:"center",children:r.cantidad}),Object(H.jsx)(Da.a,{align:"center",children:null===r||void 0===r?void 0:r.unidad}),Object(H.jsx)(Da.a,{align:"center",children:r.precio}),Object(H.jsx)(Da.a,{align:"center",children:!0===o&&O.length>1?Object(H.jsxs)("b",{style:{color:"green"},children:[" ","$",parseFloat((r.precio*b/100).toFixed(2))," "]}):null===r.descuento?0:Object(H.jsxs)("b",{style:{color:"green"},children:[" $",r.descuento.precio_neto," "]})}),Object(H.jsx)(Da.a,{align:"center",children:!0===o&&O.length>1?Object(H.jsxs)("b",{style:{color:"red"},children:[" ",i,"% "]}):r.descuento&&null!==r.descuento?Object(H.jsxs)("b",{style:{color:"red"},children:[" ",r.descuento.porciento,"% "]}):0}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(hd,{row:r,handleModal:E,openModal:g,handleDelete:z})}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(Ll.a,{onChange:P,color:"primary",disabled:!r.descuento||0===r.descuento.porciento,defaultChecked:!!r.descuento_activo&&r.descuento_activo,name:"descuento_activo",inputProps:{"aria-label":"secondary checkbox"}},r._id)},r._id),r.medida?Object(H.jsx)(Da.a,{align:"center",children:null===r||void 0===r||null===(t=r.medida)||void 0===t?void 0:t.talla}):null,r.color?Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(Ta.a,{title:null===r||void 0===r||null===(a=r.color)||void 0===a?void 0:a.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:x.colorContainer,style:{backgroundColor:null===r||void 0===r||null===(n=r.color)||void 0===n?void 0:n.hex,color:h.palette.getContrastText(null===r||void 0===r||null===(c=r.color)||void 0===c?void 0:c.hex)}})})}):null]},r._id)}var hd=function(e){var t=e.row,a=e.handleModal,n=e.openModal,c=e.handleDelete;return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"secondary",onClick:a,disabled:!t.descuento||0===t.descuento.porciento,children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:n,onClose:a,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:a,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:c,children:"Eliminar"})]})]})]})},_d=Object(k.a)((function(e){return{avatarGroup:{"& > .MuiAvatarGroup-avatar":{width:e.spacing(8),height:e.spacing(8)}},root:{width:400},rootSlice:{width:350},margin:{height:e.spacing(3)},rootTable:{height:300}}}));function fd(e){var t=e.datos,a=e.productosRefetch,n=e.isOnline,c=Object(w.a)(dd),r=Object(y.a)(c,1)[0],i=Object(j.useContext)(Pe),o=i.setDatosPreciosProducto,s=i.preciosDescuentos,l=i.setPreciosDescuentos,d=i.preciosProductos,u=i.setPreciosProductos,b=t.precios.iva,p=t.precios.ieps,m=t.precios.unidad_de_compra.precio_unitario_sin_impuesto,x=Object(j.useState)({message:"",status:"",open:!1}),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useState)(!1),A=Object(y.a)(g,2),I=A[0],k=A[1],N=Object(j.useState)(!1),P=Object(y.a)(N,2),E=P[0],D=P[1],z=Object(j.useState)(!1),T=Object(y.a)(z,1)[0],$=Object(j.useState)(!1),W=Object(y.a)($,2),R=W[0],V=W[1],M=Object(j.useState)(0),B=Object(y.a)(M,2),U=B[0],q=B[1],J=Object(j.useState)(0),G=Object(y.a)(J,2),Q=G[0],K=G[1],X=_d(),Z=function(){t.medidas_producto.length>0?(o(t.medidas_producto),V(!1)):(o(t.unidades_de_venta),V(!1)),q(0),K(0),s.splice(0,s.length)},ee=function(){k(!I),Z()},te=Object(j.useCallback)((function(e){for(var t=0;t<e.length;t++)e[t].descuento&&0!==e[t].descuento.porciento&&(K(e[t].descuento.porciento),1===e.length&&q(e[t].descuento.precio_neto))}),[t]),ae=[];var ne=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V(!0),e.prev=1,e.next=4,r({variables:{input:{descuentos:s}}});case 4:Z(),a(),K(0),u([]),l([]),D(!E),f({message:"\xa1Listo descuentos realizados!",status:"success",open:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),f({message:"\xa1Oh no, ocurrio un problema con el servidor!",status:"error",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:_,setAlert:f}),Object(H.jsx)(ce.a,{color:function(){if(t.medidas_producto.length>0)for(var e=0;e<t.medidas_producto.length;e++){var a;return!0===(null===(a=t.medidas_producto[e])||void 0===a?void 0:a.descuento_activo)?"primary":"default"}else for(var n=0;n<t.unidades_de_venta.length;n++){var c;return!0===(null===(c=t.unidades_de_venta[n])||void 0===c?void 0:c.descuento_activo)?"primary":"default"}}(),onClick:ee,size:"medium",disabled:!n||t.inventario_general&&t.inventario_general.length>0&&!0===t.inventario_general[0].eliminado,children:Object(H.jsx)(sd.a,{})}),Object(H.jsxs)(qe.a,{open:I,onClose:Z,fullWidth:!0,maxWidth:"lg",children:[Object(H.jsx)(st,{loading:R,setLoading:V}),Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(O.a,{flexGrow:1,display:"flex",alignItems:"center",children:"Descuento de Producto"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:ee,size:"large",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{textAlign:"center",children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Nombre comercial: "}),t.datos_generales.nombre_comercial?t.datos_generales.nombre_comercial:"-"]})}),Object(H.jsx)(O.a,{textAlign:"center",children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Nombre gen\xe9rico: "}),t.datos_generales.nombre_generico?t.datos_generales.nombre_generico:"-"]})}),Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,lg:8,md:6,xs:12,children:Object(H.jsx)(O.a,{p:1,children:Object(H.jsx)(Od,{verificarDatos:te,productosRefetch:a,datos:t,value:Q,cleanList:E,setCleanList:D,setPrecioPrueba:q,setLoading:V,loading:R})})}),Object(H.jsxs)(Qe.a,{item:!0,lg:4,md:6,xs:12,children:[Object(H.jsx)(O.a,{mt:5,dislay:"flex",justifyContent:"center",children:Object(H.jsxs)("div",{className:X.root,children:[Object(H.jsx)(O.a,{textAlign:"center",children:Object(H.jsx)(L.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(H.jsx)("b",{children:"Porcentaje de descuento"})})}),Object(H.jsx)(O.a,{my:5}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",justifyItems:"center",className:X.rootSlice,children:Object(H.jsx)(ld.a,{disabled:0===d.length,getAriaValueText:function(e){return"".concat(e)},value:Q,"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",onChange:function(e,t){K(t),s.splice(0,s.length);for(var a=0;a<d.length;a++){var n=parseFloat(100-t),c=0,r=0,i=d[a].precio_unidad.cantidad_unidad;c=parseFloat(d[a].precio_unidad.precio_venta*n/100),r=parseFloat(d[a].precio_unidad.precio_venta-c);var o=parseFloat(c*parseFloat("0.".concat(b<10?"0".concat(b):b))),j=parseFloat(c*parseFloat("0.".concat(p<10?"0".concat(p):p))),u=parseFloat((c-m)/m*100),O=parseFloat(c+o+j),x=parseFloat(O*i);ae={_id:d[a]._id,descuento_activo:!0,descuento:{cantidad_unidad:i,numero_precio:d[a].precio_unidad.numero_precio,unidad_maxima:d[a].precio_unidad.unidad_maxima,precio_general:parseFloat(x.toFixed(2)),precio_neto:parseFloat(O.toFixed(2)),precio_venta:parseFloat(c.toFixed(2)),iva_precio:parseFloat(o.toFixed(2)),ieps_precio:parseFloat(j.toFixed(2)),utilidad:parseFloat(u.toFixed(2)),porciento:t,dinero_descontado:parseFloat(r.toFixed(2))}},q(parseFloat(O.toFixed(2))),1!==d.length?s.push(ae):l([ae])}}})})]})}),Object(H.jsx)(O.a,{mt:5,display:"flex",justifyContent:"center",children:1===d.length?Object(H.jsxs)("div",{children:[Object(H.jsx)(L.a,{children:"Precio con Descuento"}),Object(H.jsx)(S.a,{type:"number",InputProps:{inputProps:{min:0}},size:"small",variant:"outlined",value:U,onChange:function(e){return function(e){var t=parseFloat(e.target.value);if(1===d.length){q(t);var a=parseFloat("0.".concat(b<10?"0".concat(b):b))+parseFloat("0.".concat(p<10?"0".concat(p):p)),n=parseFloat(t/(a+1)),c=d[0].precio_unidad.cantidad_unidad,r=0,i=0,o=parseFloat(n/d[0].precio_unidad.precio_venta*100),s=parseFloat(100-o);i=parseFloat(d[0].precio_unidad.precio_venta*o/100),r=parseFloat(d[0].precio_unidad.precio_venta-i);var j=parseFloat(i*parseFloat("0.".concat(b<10?"0".concat(b):b))),u=parseFloat(i*parseFloat("0.".concat(p<10?"0".concat(p):p))),O=parseFloat((i-m)/m*100),x=parseFloat(i+j+u),h=parseFloat(x*c);ae={_id:d[0]._id,descuento_activo:!0,descuento:{cantidad_unidad:c,numero_precio:d[0].precio_unidad.numero_precio,unidad_maxima:d[0].precio_unidad.unidad_maxima,precio_general:parseFloat(h.toFixed(2)),precio_neto:parseFloat(x.toFixed(2)),precio_venta:parseFloat(i.toFixed(2)),iva_precio:parseFloat(j.toFixed(2)),ieps_precio:parseFloat(u.toFixed(2)),utilidad:parseFloat(O.toFixed(2)),porciento:parseFloat(s.toFixed(2)),dinero_descontado:parseFloat(r.toFixed(2))}},K(parseFloat(s.toFixed(2))),l([ae])}}(e)}})]}):null}),Object(H.jsx)(O.a,{mt:2,display:"flex",justifyContent:"center",children:Object(H.jsx)(F.a,{disabled:0===d.length||!0===T,variant:"contained",color:"primary",size:"large",onClick:ne,children:"Guardar"})})]})]})]})]})]})}var gd=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function vd(e){var t=e.datos,a=e.productosRefetch,n=e.isOnline,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=JSON.parse(localStorage.getItem("sesionCafi")),p=Object(j.useContext)(Pe),m=p.actualizarLista,O=p.setActualizarLista,x=p.setAlert,h=Object(w.a)(ac),_=Object(y.a)(h,1)[0],f=function(){return o(!i)},g=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,_({variables:{id:t._id,empresa:b.empresa._id,sucursal:b.sucursal._id}});case 4:n=e.sent,O(!m),a(),x({message:"\xa1Listo! ".concat(n.data.eliminarProducto.message),status:"success",open:!0}),u(!1),f(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),x({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),u(!1),f();case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return console.log(n),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Ta.a,{title:"Solo se puede eliminar un producto si este tiene 0 en inventarios",arrow:!0,children:Object(H.jsx)(ce.a,{onClick:function(){return f()},disabled:!n,color:"secondary",children:Object(H.jsx)(zr.a,{})})}),Object(H.jsxs)(qe.a,{open:i,TransitionComponent:gd,keepMounted:!0,onClose:function(){return f()},"aria-labelledby":"alert-dialog-delete-producto",children:[Object(H.jsx)(Bt.a,{id:"alert-dialog-delete-producto",children:"\xbfEst\xe1s seguro de eliminar este producto?"}),Object(H.jsxs)(tt.a,{style:{display:"flex",justifyContent:"center"},children:[Object(H.jsx)(F.a,{onClick:function(){return f()},color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return g()},color:"secondary",startIcon:d?Object(H.jsx)(I.a,{color:"inherit",size:20}):null,children:"Eliminar"})]})]})]})}var Cd=a(959),yd=a(474),Ad=a.n(yd);function Sd(e){var t=e.barcode,a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)},o={width:2,height:50,format:"CODE128",displayValue:!0,fontOptions:"",font:"monospace",textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0};return Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(L.a,{children:t}),Object(H.jsxs)(qe.a,{open:c,onClose:i,children:[Object(H.jsxs)(He.a,{children:[Object(H.jsx)(Ad.a,Object(m.a)({value:t},o)),","]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:i,color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:i,color:"primary",startIcon:Object(H.jsx)(Cd.a,{}),children:"Imprimir"})]})]})]})}var Fd=Object(k.a)({root:{width:"100%"},container:{height:"65vh","& ::-webkit-scrollbar":{display:"none"}},avatar:{width:130,height:130}});function Id(e){var t=e.obtenerProductos,a=e.productosRefetch,n=e.page,c=e.setPage,r=e.limit,i=e.isOnline,o=Fd();return Object(H.jsxs)("div",{className:o.root,children:[Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"sticky table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Codigo barras"}),Object(H.jsx)(Da.a,{children:"Clave alterna"}),Object(H.jsx)(Da.a,{children:"Nombre comercial"}),Object(H.jsx)(Da.a,{children:"Existencia"}),Object(H.jsx)(Da.a,{children:"Tipo"}),Object(H.jsx)(Da.a,{children:"Editar"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Eliminar"})]})}),Object(H.jsx)(za.a,{className:"hide-scroll",children:t.docs.map((function(e,t){return Object(H.jsx)(kd,{producto:e,productosRefetch:a,isOnline:i},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:r,page:n,onPageChange:function(e,t){c(t)}})]})}var kd=function(e){var t=e.producto,a=e.productosRefetch,n=e.isOnline,c=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(Sd,{barcode:t.datos_generales.codigo_barras})}),Object(H.jsx)(Da.a,{children:t.datos_generales.clave_alterna}),Object(H.jsx)(Da.a,{children:t.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{children:t.inventario_general.map((function(e){return"".concat(e.cantidad_existente," ").concat(e.unidad_inventario)}))}),Object(H.jsx)(Da.a,{children:t.datos_generales.tipo_producto}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:!1===c.accesos.catalogos.productos.editar?null:Object(H.jsx)(Ao,{isOnline:n,accion:!0,datos:t,productosRefetch:a})}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(fd,{isOnline:n,datos:t,productosRefetch:a})}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:!1===c.accesos.catalogos.productos.eliminar?null:Object(H.jsx)(Ta.a,{title:"Solo se puede eliminar un producto si este tiene 0 en inventarios",arrow:!0,children:Object(H.jsx)(vd,{isOnline:n,datos:t,productosRefetch:a})})})]})})},wd=a(961),Nd=a(960),Pd=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Ed(e){var t=e.productosActivosRefetch,a=e.isOnline,n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=function(){return i(!r)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{disableElevation:!0,color:"primary",onClick:o,size:"large",startIcon:Object(H.jsx)(Yl.a,{}),disabled:!a,children:"Productos inactivos"}),Object(H.jsxs)(qe.a,{open:r,TransitionComponent:Pd,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&o()},"aria-labelledby":"dialog-productos-eliminados",maxWidth:"md",fullWidth:!0,children:[Object(H.jsx)(Bt.a,{id:"dialog-productos-eliminados",children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:"Productos inactivos"}),Object(H.jsx)(F.a,{variant:"contained",onClick:o,color:"secondary",children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(Dd,{productosActivosRefetch:t})})]})]})}var Dd=function(e){var t=e.productosActivosRefetch,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useContext)(Pe).actualizarLista,c=Object(rt.b)(nc,{variables:{sucursal:a.sucursal._id,empresa:a.empresa._id}}),r=c.loading,i=c.data,o=c.error,s=c.refetch;if(Object(j.useEffect)((function(){s()}),[s,n]),r)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(o)return Object(H.jsx)(bt,{error:o});if(!r&&!o&&!i)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(L.a,{variant:"h6",children:"No hay productos inactivos"})});var l=i.obtenerProductosInactivos;return Object(H.jsx)(O.a,{height:"60vh",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{"aria-label":"simple table",size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{align:"left",children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{align:"left",children:"Clave alterna"}),Object(H.jsx)(Da.a,{children:"Nombre comercial"}),Object(H.jsx)(Da.a,{align:"right",children:"Reactivar"})]})}),Object(H.jsx)(za.a,{children:l.map((function(e,a){return Object(H.jsx)(zd,{datos:e,refetch:s,productosActivosRefetch:t},a)}))})]})})})},zd=function(e){var t=e.datos,a=e.refetch,n=e.productosActivosRefetch,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=JSON.parse(localStorage.getItem("sesionCafi")),p=t.producto.datos_generales,m=Object(j.useContext)(Pe).setAlert,O=Object(w.a)(cc),x=Object(y.a)(O,1)[0],h=function(){return o(!i)},_=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,x({variables:{id:t._id,empresa:b.empresa._id,sucursal:b.sucursal._id}});case 4:c=e.sent,a(),n(),m({message:"\xa1Listo! ".concat(c.data.activarProducto.message),status:"success",open:!0}),u(!1),h(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),m({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),u(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{align:"left",children:p.codigo_barras}),Object(H.jsx)(Da.a,{align:"left",children:p.clave_alterna}),Object(H.jsx)(Da.a,{children:p.nombre_comercial}),Object(H.jsx)(Da.a,{align:"right",children:d?Object(H.jsx)(ce.a,{color:"primary",disabled:!0,onClick:h,children:Object(H.jsx)(I.a,{size:26})}):Object(H.jsx)(ce.a,{color:"primary",onClick:h,children:Object(H.jsx)(Nd.a,{})})})]}),Object(H.jsxs)(qe.a,{open:i,onClose:h,"aria-labelledby":"reactivar-producto-dialog",children:[Object(H.jsx)(Bt.a,{id:"reactivar-producto-dialog",children:"Se reactivar\xe1 este producto"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:h,color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return _()},color:"primary",autoFocus:!0,children:"Aceptar"})]})]})]})},Td=a.p+"static/media/productos.c55f4823.svg",$d=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100},iconSvg:{width:100},root:{flexGrow:1,backgroundColor:e.palette.background.paper}}})),Wd=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Rd(){var e=Object(j.useContext)(be).isOnline,t=$d(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useContext)(Pe),o=i.alert,s=i.setAlert,l=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Td,alt:"icono ropa",className:t.iconSvg})}),"Productos"]})}),Object(H.jsx)(Y,{alert:o,setAlert:s}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:l,TransitionComponent:Wd,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Productos"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:l,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(Vd,{isOnline:e})]})]})}var Vd=function(e){var t=e.isOnline,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useState)(""),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(""),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(!0),b=Object(y.a)(u,2),p=b[0],m=b[1],x=Object(j.useState)(0),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useState)(0),v=Object(y.a)(g,2),C=v[0],A=v[1],S=$d(),F=Object(rt.b)(ec,{variables:{sucursal:a.sucursal._id,empresa:a.empresa._id,filtro:r,existencias:p,limit:20,offset:C},fetchPolicy:"network-only"}),k=F.loading,w=F.data,N=F.error,P=F.refetch;if(k)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(N)return Object(H.jsx)(bt,{error:N});var E=w.obtenerProductos;return Object(H.jsxs)("div",{children:[Object(H.jsxs)(O.a,{mx:4,mt:3,display:"flex",children:[Object(H.jsx)(O.a,{style:{width:"500px"},children:Object(H.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),""===l)return i(""),void P({filtro:""});i(l)},style:{display:"flex",alignItems:"center"},children:[Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsx)(ae.a,{id:"search-producto",type:"text",value:l,onChange:function(e){return d(e.target.value)},endAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(ce.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(H.jsx)(Nc.a,{})})})})}),""!==r?Object(H.jsx)(ce.a,{color:"primary",onClick:function(){return d(""),i(""),void P({filtro:""})},children:Object(H.jsx)(wd.a,{})}):null]})}),Object(H.jsx)(O.a,{flexGrow:1}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(Ed,{isOnline:t,productosActivosRefetch:P}),Object(H.jsx)(O.a,{mx:1}),!1===a.accesos.catalogos.productos.agregar?null:Object(H.jsx)(Ao,{accion:!1,productosRefetch:P,isOnline:t})]})]}),Object(H.jsxs)(O.a,{mx:4,children:[Object(H.jsx)("div",{className:S.root,children:Object(H.jsxs)(Ve.a,{indicatorColor:"primary",value:_,onChange:function(e,t){f(t),m(0===t)},"aria-label":"simple tabs example",children:[Object(H.jsx)(Me.a,{label:"Productos de Sucursal"}),Object(H.jsx)(Me.a,{label:"Todos los productos"})]})}),Object(H.jsx)(Id,{obtenerProductos:E,productosRefetch:P,setPage:A,page:C,limit:20,isOnline:t})]})]})};function Md(){return Object(H.jsx)(Ee,{children:Object(H.jsx)(Rd,{})})}var Ld=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"50vh"}}}));function Bd(e){var t=e.tipo,a=e.datos,n=e.toUpdate,c=e.setToUpdate,r=e.setValue,i=e.refetch,o=e.isOnline,s=JSON.parse(localStorage.getItem("sesionCafi")),l=Ld(),d=Object(j.useState)(""),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)([]),x=Object(y.a)(m,2),h=x[0],_=x[1],f=Object(j.useState)({status:"",message:"",open:!1}),g=Object(y.a)(f,2),v=g[0],C=g[1];return Object(j.useEffect)((function(){_(a.filter((function(e){return e.talla.toLowerCase().includes(b.toLowerCase())})))}),[b,a]),Object(H.jsxs)("div",{className:l.root,children:[Object(H.jsx)(Y,{alert:v,setAlert:C}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:1,children:Object(H.jsx)(S.a,{fullWidth:!0,placeholder:"Buscar...",variant:"outlined",size:"small",onChange:function(e){return p(e.target.value)}})}),Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{className:l.container,children:Object(H.jsxs)($a.a,{className:l.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"ROPA"===t?"Talla":"N\xfamero"}),!1===s.accesos.catalogos.tallas_numeros.editar?null:Object(H.jsx)(Da.a,{padding:"normal",children:"Editar"}),!1===s.accesos.catalogos.tallas_numeros.eliminar?null:Object(H.jsx)(Da.a,{padding:"normal",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:h.map((function(e,a){return Object(H.jsx)(Ud,{row:e,setAlert:C,tipo:t,toUpdate:n,setToUpdate:c,setValue:r,refetch:i,isOnline:o},a)}))})]})})})]})}var Ud=function(e){var t=e.row,a=e.setAlert,n=e.tipo,c=e.toUpdate,r=e.setToUpdate,i=e.setValue,o=e.refetch,s=e.isOnline,l=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=function(){return p(!b)},O=Object(w.a)(mc),x=Object(y.a)(O,1)[0],h=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x({variables:{id:t._id,input:{tipo:n,talla:""},empresa:l.empresa._id,sucursal:l.sucursal._id}});case 3:c=e.sent,r={message:c.data.eliminarTalla.message,status:"success",open:!0},a(r),o(),m(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),m(),a({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),_=function(e){if(!e)return r(""),void i("");r(e._id),i(e.talla)};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,selected:c===t._id,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:t.talla})})}),!1===l.accesos.catalogos.tallas_numeros.editar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:c===t._id?Object(H.jsx)(ce.a,{onClick:function(){return _()},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{disabled:!s,onClick:function(){return _(t)},children:Object(H.jsx)(yn.a,{})})}),!1===l.accesos.catalogos.tallas_numeros.eliminar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(qd,{handleModal:m,openModal:b,handleDelete:h,isOnline:s})})]})})},qd=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete,c=e.isOnline;return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{disabled:!c,color:"secondary",onClick:t,children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:a,onClose:t,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})]})},Jd=a.p+"static/media/shirt.e9a5af44.svg",Hd=a.p+"static/media/shoes.cec0fb6e.svg";function Gd(e){var t=e.tipo,a=Object(j.useContext)(be).isOnline,n=Object(j.useState)(""),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(""),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)({message:"",status:"",open:!1}),b=Object(y.a)(u,2),p=b[0],m=b[1],x=JSON.parse(localStorage.getItem("sesionCafi")),h=Object(j.useState)({loading:!1,tipo:""}),_=Object(y.a)(h,2),f=_[0],g=_[1],A=Object(rt.b)(bc,{variables:{empresa:x.empresa._id,tipo:t},fetchPolicy:"network-only"}),k=A.loading,N=A.data,P=A.error,E=A.refetch,D=Object(w.a)(uc),z=Object(y.a)(D,1)[0],T=Object(w.a)(pc),$=Object(y.a)(T,1)[0];if(k)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(P)return Object(H.jsx)(bt,{error:P});var W=N.obtenerTallas,R=function(){var e=Object(C.a)(Object(v.a)().mark((function e(a){var n,c,o,s;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),r){e.next=3;break}return e.abrupt("return");case 3:if(g({loading:!0,tipo:t}),e.prev=4,c=r,!l){e.next=17;break}if(!1!==x.accesos.catalogos.tallas_numeros.editar){e.next=11;break}return e.abrupt("return",m({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 11:return o=qa(c),e.next=14,$({variables:{input:{talla:o,tipo:t},id:l,empresa:x.empresa._id,sucursal:x.sucursal._id}});case 14:n=e.sent;case 15:e.next=24;break;case 17:if(!1!==x.accesos.catalogos.tallas_numeros.agregar){e.next=21;break}return e.abrupt("return",m({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 21:return e.next=23,z({variables:{input:{talla:c,tipo:t,empresa:x.empresa._id,sucursal:x.sucursal._id}}});case 23:n=e.sent;case 24:E(),i(""),d(""),g({loading:!1,tipo:""}),s=l?{message:n.data.actualizarTalla.message,status:"success",open:!0}:{message:n.data.crearTalla.message,status:"success",open:!0},m(s),e.next=39;break;case 32:if(e.prev=32,e.t0=e.catch(4),g({loading:!1,tipo:""}),!e.t0.message){e.next=38;break}return m({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 38:m({message:"Hubo un error",status:"error",open:!0});case 39:case"end":return e.stop()}}),e,null,[[4,32]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Y,{alert:p,setAlert:m}),Object(H.jsx)(O.a,{my:2,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,justifyContent:"center",children:[Object(H.jsx)(Qe.a,{item:!0,children:"ROPA"===t?Object(H.jsx)("img",{src:Jd,alt:"icono tallas",style:{width:40}}):Object(H.jsx)("img",{src:Hd,alt:"icono numeros",style:{width:40}})}),Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)("form",{id:"form-talla",onSubmit:R,children:Object(H.jsx)(S.a,{id:"outlined-error-helper-text",label:"ROPA"===t?"Talla":"N\xfamero",variant:"outlined",size:"small",value:r,onChange:function(e){return i(e.target.value)},inputProps:{style:{textTransform:"uppercase"}},disabled:f.loading})})}),Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,type:"submit",onClick:R,form:"form-talla",disabled:!a||f.loading&&f.tipo===t,startIcon:f.loading&&f.tipo===t?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ut.a,{}),children:"Guardar"})})]})}),Object(H.jsx)(Bd,{isOnline:a,datos:W,tipo:t,toUpdate:l,setToUpdate:d,setValue:i,refetch:E})]})}var Yd=a(475),Qd=a.n(Yd);function Kd(e){var t=e.texto,a=(e.width,Object(j.useState)(!1)),n=Object(y.a)(a,2),c=n[0],r=n[1];return Object(H.jsxs)(O.a,{mx:1,children:[Object(H.jsx)(F.a,{variant:"text",color:"secondary",onClick:function(){return r(!0)},size:"large",children:Object(H.jsx)(Qd.a,{style:{fontSize:35,color:"white"}})}),Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:c,onClose:function(){r(!1)},autoHideDuration:1e4,message:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(L.a,{children:t})]})})]})}var Xd=a.p+"static/media/tallas.80f41ac8.svg",Zd=Object(k.a)((function(e){return{root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},iconSvg:{width:100},icon:{fontSize:100}}})),ej=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function tj(){var e=Zd(),t=Object(j.useState)(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:r,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Xd,alt:"icono ropa",className:e.iconSvg})}),"Tallas y numeros"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:ej,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Tallas y n\xfameros"}),Object(H.jsxs)(O.a,{m:1,flexDirection:"row",display:"flex",children:[Object(H.jsx)(Kd,{texto:"En este apartado se registran las  tallas y/o n\xfameros que se asignar\xe1n a un producto tipo Ropa o Calzado seg\xfan sea el caso ."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(A.a,{children:Object(H.jsx)(O.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:5,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(Gd,{tipo:"ROPA"})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(Gd,{tipo:"CALZADO"})})]})})})]})]})}var aj=[{id:1,label:"No. Cliente",minWidth:100},{id:2,label:"Clave",minWidth:100},{id:3,label:"Nombre",minWidth:150},{id:4,label:"Razon Social",minWidth:150},{id:5,label:"Correo",minWidth:150},{id:6,label:"Fecha registro",minWidth:100},{id:7,label:"Estado",minWidth:100}],nj=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),cj=Object(k.a)({root:{width:"100%"},container:{height:"68vh"},avatar:{width:130,height:130}});function rj(e){var t=e.obtenerClientes,a=e.refetch,n=e.page,c=e.setPage,r=e.limit,i=e.isOnline,o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(j.useState)({message:"",status:"",open:!1}),l=Object(y.a)(s,2),d=l[0],u=l[1],b=cj();return Object(H.jsxs)(fn.a,{className:b.root,variant:"outlined",children:[Object(H.jsx)(Y,{alert:d,setAlert:u}),Object(H.jsx)(Na.a,{className:b.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,"aria-label":"sticky table",size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[aj.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,children:e.label},e.id)})),!1===o.accesos.catalogos.provedores.editar?null:Object(H.jsx)(Da.a,{align:"right",children:"Editar"},9),!1===o.accesos.catalogos.provedores.eliminar?null:Object(H.jsx)(Da.a,{align:"right",children:"Eliminar"},10)]})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){return Object(H.jsx)(ij,{datos:e,setAlert:u,refetch:a,isOnline:i},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:r,page:n,onPageChange:function(e,t){c(t)}})]})}var ij=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=e.isOnline,r=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.numero_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.clave_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.nombre_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.razon_social})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.email})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:Ba(t.fecha_registro)})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.estado_cliente?"Activo":"Inactivo"})}),!1===r.accesos.catalogos.provedores.editar?null:Object(H.jsx)(Da.a,{width:50,children:Object(H.jsx)(ts,{tipo:"PRROVEEDOR",accion:"actualizar",datos:t,refetch:n,isOnline:c})}),!1===r.accesos.catalogos.provedores.eliminar?null:Object(H.jsx)(Da.a,{width:50,children:Object(H.jsx)(oj,{datos:t,setAlert:a,refetch:n,isOnline:c})})]})},oj=function(e){var t=e.datos,a=e.setAlert,n=e.refetch,c=e.isOnline,r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(w.a)(Zo),d=Object(y.a)(l,1)[0],u=Object(j.useState)(!1),b=Object(y.a)(u,2),p=b[0],m=b[1],O=Object(j.useContext)(Po),x=O.setUpdate,h=O.update,_=JSON.parse(localStorage.getItem("sesionCafi")),f=function(){s(!1)},g=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,d({variables:{id:t._id,empresa:_.empresa._id,sucursal:_.sucursal._id}});case 4:(c=e.sent)&&(r=c.data.eliminarCliente.message,a({message:r,status:"success",open:!0}),n()),m(!1),x(!h),f(),e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(1),console.log(e.t0),m(!1),!e.t0.message){e.next=18;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 18:a({message:"Hubo un error",status:"error",open:!0});case 19:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{disabled:!c,size:"small",color:"secondary",onClick:function(){s(!0)},children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:o,TransitionComponent:nj,keepMounted:!0,onClose:function(){return f()},"aria-labelledby":"alert-eliminar-cliente",children:[Object(H.jsx)(Bt.a,{id:"alert-eliminar-cliente",children:"\xbfEst\xe1 seguro de eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return f()},color:"inherit",disabled:p,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return g()},color:"secondary",disabled:p,startIcon:p?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})},sj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100,fontSize:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),lj=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function dj(){var e=Object(j.useContext)(be).isOnline,t=sj(),a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.g,{className:t.icon})}),"Proveedores"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:lj,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Proveedores"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado se registran los proveedores que se podr\xe1n seleccionar en la compra de un producto."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(fj,{isOnline:e})})]})]})}var jj,uj,bj,pj,mj,Oj,xj,hj,_j,fj=function(e){var t=e.isOnline,a=sj(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(j.useState)(""),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(""),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(0),p=Object(y.a)(b,2),m=p[0],x=p[1],h=JSON.parse(localStorage.getItem("sesionCafi")),_=Object(rt.b)(Ko,{variables:{tipo:"PROVEEDOR",filtro:i,empresa:h.empresa._id,eliminado:!1,limit:20,offset:m},fetchPolicy:"network-only"}),f=_.loading,g=_.data,v=_.error,C=_.refetch;if(f)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(v)return Object(H.jsx)(bt,{error:v});var A=g.obtenerClientes;return Object(H.jsxs)(O.a,{mt:2,children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:8,children:Object(H.jsxs)(fn.a,{className:a.root,children:[Object(H.jsx)(Ml.a,{fullWidth:!0,placeholder:"Buscar proveedor...",onChange:function(e){return u(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&o(e.target.defaultValue)},value:d}),Object(H.jsx)(ce.a,{onClick:function(){return o(d)},children:Object(H.jsx)(Nc.a,{})})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:[!1===n.accesos.catalogos.clientes.agregar?null:Object(H.jsx)(Kl,{isOnline:t,tipo:"PROVEEDOR",refetchProveedores:C}),Object(H.jsx)(O.a,{mx:1}),!1===n.accesos.catalogos.provedores.ver?null:Object(H.jsx)(ts,{isOnline:t,tipo:"PROVEEDOR",accion:"registrar",refetch:C})]})]}),Object(H.jsx)(O.a,{mt:2,children:Object(H.jsx)(rj,{obtenerClientes:A,isOnline:t,refetch:C,page:m,setPage:x,limit:20})})]})},gj=Object(P.d)(jj||(jj=Object(N.a)(["\n  mutation CrearCaja($input: CrearCajasInput!, $empresa: ID!, $sucursal: ID!) {\n    crearCaja(input: $input, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),vj=Object(P.d)(uj||(uj=Object(N.a)(["\n  query ObtenerCajasSucursales($empresa: ID!, $sucursal: ID!) {\n    obtenerCajasSucursal(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      numero_caja\n      activa\n      usuario_creador {\n        numero_usuario\n        nombre\n        email\n      }\n      cantidad_efectivo_actual\n      usuario_en_caja {\n        _id\n        numero_usuario\n        nombre\n        email\n      }\n      principal\n    }\n  }\n"]))),Cj=Object(P.d)(bj||(bj=Object(N.a)(["\n  mutation CrearHistorialCaja(\n    $input: CrearHistorialCajasInput!\n    $empresa: ID!\n    $sucursal: ID!\n  ) {\n    crearHistorialCaja(input: $input, empresa: $empresa, sucursal: $sucursal) {\n      message\n    }\n  }\n"]))),yj=Object(P.d)(pj||(pj=Object(N.a)(["\n  query ObtenerHistorialCaja(\n    $input: HistorialCajasInput\n    $id_Caja: ID!\n    $empresa: ID!\n    $sucursal: ID!\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerHistorialCaja(\n      input: $input\n      id_Caja: $id_Caja\n      empresa: $empresa\n      sucursal: $sucursal\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        tipo_movimiento\n        concepto\n        horario_turno\n        numero_caja\n        numero_usuario_creador\n        nombre_usuario_creador\n        hora_moviento {\n          hora\n          minutos\n          segundos\n          completa\n        }\n        fecha_movimiento {\n          year\n          mes\n          dia\n          no_dia_year\n          no_semana_year\n          completa\n        }\n        montos_en_caja {\n          monto_efectivo {\n            monto\n          }\n          monto_tarjeta_credito {\n            monto\n          }\n          monto_tarjeta_debito {\n            monto\n          }\n          monto_creditos {\n            monto\n          }\n          monto_monedero {\n            monto\n          }\n          monto_transferencia {\n            monto\n          }\n          monto_cheques {\n            monto\n          }\n          monto_vales_despensa {\n            monto\n          }\n        }\n      }\n      totalDocs\n    }\n  }\n"]))),Aj=Object(P.d)(mj||(mj=Object(N.a)(["\n  mutation eliminarCaja($id: ID!) {\n    eliminarCaja(id: $id) {\n      message\n    }\n  }\n"]))),Sj=(Object(P.d)(Oj||(Oj=Object(N.a)(["\n  mutation ActualizarCaja($input: EditarCaja, $id: ID!) {\n    actualizarCaja(id: $id, input: $input) {\n      _id\n      numero_caja\n      activa\n    }\n  }\n"]))),Object(P.d)(xj||(xj=Object(N.a)(["\n  query ObtenerPreCorteCaja(\n    $empresa: ID!\n    $sucursal: ID!\n    $input: PreCortesDeCajaInput\n    $cajaPrincipal: Boolean\n  ) {\n    obtenerPreCorteCaja(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n      cajaPrincipal: $cajaPrincipal\n    ) {\n      monto_efectivo_precorte\n    }\n  }\n"])))),Fj=Object(P.d)(hj||(hj=Object(N.a)(["\n  query ObtenerCortesDeCaja(\n    $empresa: ID!\n    $sucursal: ID!\n    $input: FiltroCorteDeCajaInput\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerCortesDeCaja(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        concepto\n        token_turno_user\n        numero_caja\n        horario_en_turno\n        id_caja\n        hora_salida {\n          completa\n        }\n        fecha_salida {\n          completa\n        }\n        fecha_movimiento\n        usuario_en_turno {\n          nombre\n          telefono\n          email\n          numero_usuario\n        }\n        montos_en_caja {\n          monto_efectivo {\n            monto\n          }\n          monto_tarjeta_credito {\n            monto\n          }\n          monto_tarjeta_debito {\n            monto\n          }\n          monto_creditos {\n            monto\n          }\n          monto_monedero {\n            monto\n          }\n          monto_transferencia {\n            monto\n          }\n          monto_cheques {\n            monto\n          }\n          monto_vales_despensa {\n            monto\n          }\n        }\n        sucursal {\n          nombre_sucursal\n        }\n      }\n      totalDocs\n    }\n  }\n"]))),Ij=Object(P.d)(_j||(_j=Object(N.a)(["\n  query ObtenerCorteCaja(\n    $empresa: ID!\n    $sucursal: ID!\n    $input: CorteDeCajaInput\n  ) {\n    obtenerCorteCaja(empresa: $empresa, sucursal: $sucursal, input: $input) {\n      montos_en_sistema {\n        monto_efectivo\n        monto_tarjeta_debito\n        monto_tarjeta_credito\n        monto_creditos\n        monto_monedero\n        monto_transferencia\n        monto_cheques\n        monto_vales_despensa\n      }\n      fecha_inicio\n      fecha_fin\n    }\n  }\n"]))),kj=a(842),wj=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"55vh"}}}));function Nj(e){var t=e.obtenerCajasSucursal,a=e.setAlert,n=e.refetch,c=e.isOnline,r=JSON.parse(localStorage.getItem("sesionCafi")),i=wj();return Object(H.jsx)("div",{className:i.root,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Cajas"}),!1===r.accesos.catalogos.cajas.eliminar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:t.map((function(e){return Object(H.jsx)(Ej,{row:e,permisos:r,setAlert:a,refetch:n,isOnline:c},e.numero_caja)}))})]})})})})}var Pj=Object(kj.a)((function(e){return{badge:{color:function(e){return e.props.color},background:function(e){return e.props.color},boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Sc.a),Ej=function(e){var t=e.row,a=e.permisos,n=e.setAlert,c=e.refetch,r=e.isOnline,i={color:t.activa?"#44b700":"red"};return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(Pj,{overlap:"circular",props:i,anchorOrigin:{vertical:"top",horizontal:"left"},variant:"dot"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(O.a,{children:["CAJA ",t.numero_caja," ",t.principal?"PRINCIPAL":""]})]})}),!1===a.accesos.catalogos.cajas.eliminar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(Dj,{isOnline:r,data:t,setAlert:n,refetch:c})})]})},Dj=function(e){var t=e.data,a=e.setAlert,n=e.refetch,c=e.isOnline,r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=function(){return s(!1)},m=Object(w.a)(Aj),O=Object(y.a)(m,1)[0],x=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b(!0),e.next=4,O({variables:{id:t._id}});case 4:n(),a({message:"\xa1Listo!",status:"success",open:!0}),b(!1),p(),e.next=18;break;case 10:if(e.prev=10,e.t0=e.catch(0),b(!1),p(),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{onClick:function(){return s(!0)},color:"secondary",disabled:!c&&t.activa||c&&t.principal,children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:o,onClose:p,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:p,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return x()},startIcon:u?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(zr.a,{}),children:"Eliminar"})]})]})]})};function zj(e){var t=e.isOnline,a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)({message:"",status:"",open:!1}),o=Object(y.a)(i,2),s=o[0],l=o[1],d=JSON.parse(localStorage.getItem("sesionCafi")),b=[],p=Object(w.a)(gj),m=Object(y.a)(p,1)[0],x=Object(rt.b)(vj,{variables:{empresa:d.empresa._id,sucursal:d.sucursal._id}}),h=x.data,_=x.refetch,f=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),e.next=4,m({variables:{input:{usuario_creador:d._id,numero_usuario_creador:d.numero_usuario,nombre_usuario_creador:d.nombre},empresa:d.empresa._id,sucursal:d.sucursal._id}});case 4:_(),l({message:"\xa1Listo!",status:"success",open:!0}),r(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),l({message:"Hubo un error",status:"error",open:!0}),r(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return h&&(b=h.obtenerCajasSucursal),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Y,{alert:s,setAlert:l}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",my:2,children:!1===d.accesos.catalogos.cajas.agregar?null:Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:function(){return f()},disabled:c||!t,startIcon:c?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ut.a,{}),children:"Agregar"})}),Object(H.jsx)(Nj,{obtenerCajasSucursal:b,setAlert:l,refetch:_,isOnline:t})]})}var Tj=a.p+"static/media/cajas.239d1825.svg",$j=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Wj=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Rj(){var e=Object(j.useContext)(be).isOnline,t=$j(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Tj,alt:"icono numero calzado",className:t.icon})}),"Cajas"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:Wj,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Cajas"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado se registran las cajas necesarias para realizar los movimientos operativos de ventas."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(A.a,{maxWidth:"sm",children:Object(H.jsx)(zj,{isOnline:e})})})]})]})}var Vj=[{id:1,label:"No. Usuario",minWidth:100},{id:3,label:"Nombre",minWidth:150},{id:5,label:"Correo",minWidth:150},{id:7,label:"Estado",minWidth:100,align:"right"}],Mj=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Lj=Object(k.a)({root:{width:"100%"},container:{height:"75vh"},avatar:{width:130,height:130}});function Bj(e){var t=e.empresa,a=e.sucursal,n=e.filtro,c=e.isOnline,r=Lj(),i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(j.useContext)(li).update,s=Object(j.useState)({message:"",status:"",open:!1}),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(rt.b)(z,{variables:{empresa:t,sucursal:a,filtro:n,eliminado:!1}}),p=b.loading,m=b.data,x=b.error,h=b.refetch;if(Object(j.useEffect)((function(){h()}),[o,h]),p)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(x)return Object(H.jsx)(bt,{error:x});var _=m.obtenerUsuarios;return Object(H.jsxs)(fn.a,{className:r.root,variant:"outlined",children:[Object(H.jsx)(Y,{alert:d,setAlert:u}),Object(H.jsx)(Na.a,{className:r.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"sticky table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Vj.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,children:e.label},e.id)})),!1===i.accesos.catalogos.usuarios.editar?null:Object(H.jsx)(Da.a,{align:"right",children:"Editar"},9),!1===i.accesos.catalogos.usuarios.eliminar?null:Object(H.jsx)(Da.a,{align:"right",children:"Eliminar"},10)]})}),Object(H.jsx)(za.a,{children:_.map((function(e,t){return Object(H.jsx)(Uj,{datos:e,setAlert:u,isOnline:c},t)}))})]})})]})}var Uj=function(e){var t=e.datos,a=e.setAlert,n=e.isOnline,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(j.useContext)(li),i=r.update,o=r.setUpdate,s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(w.a)(T),p=Object(y.a)(b,1)[0],m=function(){var e=Object(C.a)(Object(v.a)().mark((function e(a){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,p({variables:{input:{estado_usuario:a.target.checked},id:t._id}});case 4:o(!i),u(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),u(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.numero_usuario})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.nombre})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.email})}),Object(H.jsx)(Da.a,{align:"right",children:d?Object(H.jsx)(I.a,{size:30}):Object(H.jsx)(Ll.a,{checked:t.estado_usuario,onChange:m,color:"primary",disabled:!n})}),!1===c.accesos.catalogos.usuarios.editar?null:Object(H.jsx)(Da.a,{width:50,children:Object(H.jsx)(Mi,{accion:"actualizar",datos:t,isOnline:n})}),!1===c.accesos.catalogos.usuarios.eliminar?null:Object(H.jsx)(Da.a,{width:50,children:Object(H.jsx)(qj,{datos:t,setAlert:a,isOnline:n})})]})},qj=function(e){var t=e.datos,a=e.setAlert,n=e.isOnline,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(w.a)(T),l=Object(y.a)(s,1)[0],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useContext)(li),O=m.update,x=m.setUpdate,h=function(){o(!1)},_=function(){var e=Object(C.a)(Object(v.a)().mark((function e(n){var c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,l({variables:{input:{eliminado:!0},id:t._id}});case 4:(c=e.sent)&&(r=c.data.actualizarUsuario.message,a({message:r,status:"success",open:!0})),x(!O),p(!1),h(),e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(1),p(!1),h(),!e.t0.message){e.next=18;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 18:a({message:"Hubo un error",status:"error",open:!0});case 19:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{disabled:!n,color:"secondary",onClick:function(){o(!0)},children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:i,TransitionComponent:Mj,keepMounted:!0,onClose:function(){return h()},"aria-labelledby":"alert-eliminar-usuario",children:[Object(H.jsx)(Bt.a,{id:"alert-eliminar-usuario",children:"\xbfEst\xe1 seguro de eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return h()},color:"inherit",disabled:b,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return _()},color:"secondary",disabled:b,startIcon:b?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})},Jj=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Hj(e){var t=e.isOnline,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(""),o=Object(y.a)(i,2),s=o[0],l=o[1],d=function(){return r(!c)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{disableElevation:!0,color:"inherit",onClick:d,startIcon:Object(H.jsx)(Yl.a,{}),disabled:!t,children:"Usuarios inactivos"}),Object(H.jsxs)(qe.a,{open:c,TransitionComponent:Jj,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&d()},"aria-labelledby":"dialog-usuarios-eliminados",maxWidth:"md",fullWidth:!0,children:[Object(H.jsx)(Bt.a,{id:"dialog-usuarios-eliminados",children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:"Usuarios inactivos"}),Object(H.jsx)(F.a,{variant:"contained",onClick:d,color:"secondary",children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{mb:2,children:Object(H.jsx)(S.a,{variant:"outlined",size:"small",fullWidth:!0,placeholder:"Buscar usuario: No. usuario, email o nombre...",onChange:function(e){return l(e.target.value)},value:s,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(Nc.a,{})})}})}),Object(H.jsx)(Gj,{filter:s})]})]})]})}var Gj=function(e){var t=e.filter,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useContext)(li).update,c=Object(an.useDebounce)(t,800),r=Object(y.a)(c,1)[0],i=Object(rt.b)(z,{variables:{filtro:r||"",empresa:a.empresa._id,eliminado:!0},fetchPolicy:"network-only"}),o=i.loading,s=i.data,l=i.error,d=i.refetch;if(Object(j.useEffect)((function(){d()}),[n,d]),o)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh",children:Object(H.jsx)(I.a,{})});if(l)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh",children:Object(H.jsx)(bt,{error:l})});if(!o&&!l&&!s)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh",children:Object(H.jsx)(L.a,{variant:"h6",children:"No hay usuarios inactivos"})});var u=s.obtenerUsuarios;return Object(H.jsx)(O.a,{height:"60vh",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{"aria-label":"simple table",size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"No. Usuario"}),Object(H.jsx)(Da.a,{children:"Nombre"}),Object(H.jsx)(Da.a,{children:"Correo"}),Object(H.jsx)(Da.a,{align:"right",children:"Restaurar"})]})}),Object(H.jsx)(za.a,{children:u.map((function(e,t){return Object(H.jsx)(Yj,{datos:e},t)}))})]})})})},Yj=function(e){var t=e.datos,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)({message:"",status:"",open:!1}),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useContext)(li),O=m.setUpdate,x=m.update,h=Object(w.a)(T),_=Object(y.a)(h,1)[0],f=function(){var e=Object(C.a)(Object(v.a)().mark((function e(a){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,_({variables:{input:{eliminado:!1},id:t._id}});case 4:l(!1),O(!x),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),l(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){return r(!c)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.numero_usuario})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.nombre})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.email})}),Object(H.jsx)(Da.a,{align:"right",children:Object(H.jsx)(ce.a,{color:"primary",onClick:g,children:Object(H.jsx)(Yl.a,{style:{fontSize:30}})})})]}),Object(H.jsxs)(qe.a,{open:c,onClose:g,"aria-labelledby":"reactivar-usuario-dialog",children:[Object(H.jsx)(Bt.a,{id:"reactivar-usuario-dialog",children:"Se reactivar\xe1 este usuario"}),Object(H.jsx)(Y,{alert:b,setAlert:p}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:g,color:"inherit",disabled:s,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return f()},color:"primary",autoFocus:!0,disabled:s,startIcon:s?Object(H.jsx)(I.a,{color:"inherit",size:20}):null,children:"Restaurar"})]})]})]})},Qj=a.p+"static/media/usuarios.4b684e29.svg",Kj=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{display:"flex",paddingLeft:e.spacing(2)}}})),Xj=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Zj(){var e=Object(j.useContext)(be).isOnline,t=Kj(),a=JSON.parse(localStorage.getItem("sesionCafi")),n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(""),s=Object(y.a)(o,2),l=s[0],d=s[1],b=Object(j.useState)(""),p=Object(y.a)(b,2),m=p[0],x=p[1],h=JSON.parse(localStorage.getItem("sesionCafi")),_=function(){i(!1)};return Object(H.jsx)("div",{children:Object(H.jsxs)(di,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){i(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Qj,alt:"icono numero calzado",className:t.icon})}),"Usuarios"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:r,onClose:_,TransitionComponent:Xj,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Usuarios"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:_,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(O.a,{mt:3,display:"flex",justifyContent:"space-between",children:Object(H.jsxs)(A.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,xs:8,md:6,children:Object(H.jsxs)(fn.a,{className:t.root,children:[Object(H.jsx)(Ml.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return x(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&d(e.target.defaultValue)},value:m}),Object(H.jsx)(ce.a,{onClick:function(){return d(m)},children:Object(H.jsx)(Nc.a,{})})]})}),Object(H.jsx)(Qe.a,{item:!0,xs:4,md:6,children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",children:[!1===a.accesos.catalogos.usuarios.agregar?null:Object(H.jsx)(Hj,{isOnline:e}),Object(H.jsx)(O.a,{mx:1}),!1===a.accesos.catalogos.usuarios.agregar?null:Object(H.jsx)(Mi,{isOnline:e,accion:"registrar",datos:void 0})]})})]}),Object(H.jsx)(O.a,{my:3,children:Object(H.jsx)(Bj,{isOnline:e,sucursal:h.sucursal._id,empresa:h.empresa._id,filtro:l})})]})})]})]})})}var eu=Object(j.createContext)(),tu=function(e){var t=e.children,a=Object(j.useState)({nombre_departamentos:""}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!0),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useState)(!1),f=Object(y.a)(_,2),g=f[0],v=f[1],C=Object(j.useState)(""),A=Object(y.a)(C,2),S=A[0],F=A[1],I=Object(j.useState)({message:"",status:"",open:!1}),k=Object(y.a)(I,2),w=k[0],N=k[1],P=Object(j.useState)(!1),E=Object(y.a)(P,2),D=E[0],z=E[1];return Object(H.jsx)(eu.Provider,{value:{data:c,setData:r,update:s,setUpdate:l,error:b,setError:p,openRegistro:g,setOpenRegistro:v,accion:x,setAccion:h,idDepartamento:S,setIdDepartamento:F,alert:w,setAlert:N,loading:D,setLoading:z},children:t})},au=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"55vh"}}}));function nu(e){var t=e.isOnline,a=au(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=[],r=Object(j.useContext)(eu),i=r.update,o=r.setData,s=Object(rt.b)(mr,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),l=s.data,d=s.loading,u=s.error,b=s.refetch;return Object(j.useEffect)((function(){b()}),[i,b]),d?Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})}):u?Object(H.jsx)(bt,{error:u}):(l&&(c=l.obtenerDepartamentos),Object(H.jsx)("div",{className:a.root,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{className:a.container,children:Object(H.jsxs)($a.a,{className:a.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Departamentos"}),!1===n.accesos.catalogos.departamentos.editar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Editar"}),!1===n.accesos.catalogos.departamentos.eliminar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:c.map((function(e,a){return Object(H.jsx)(cu,{row:e,setData:o,refetch:b,isOnline:t},a)}))})]})})})}))}var cu=function(e){var t=e.row,a=e.setData,n=e.refetch,c=e.isOnline,r=JSON.parse(localStorage.getItem("sesionCafi")),i=Object(j.useContext)(eu),o=i.setAccion,s=i.setIdDepartamento,l=i.idDepartamento;return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,selected:l===t._id,children:[Object(H.jsx)(Da.a,{children:t.nombre_departamentos}),!1===r.accesos.catalogos.departamentos.editar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:l===t._id?Object(H.jsx)(ce.a,{onClick:function(){return s(""),o(!0),void a({nombre_departamentos:""})},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{disabled:!c,onClick:function(){return s(t._id),o(!1),void a({nombre_departamentos:t.nombre_departamentos})},children:Object(H.jsx)(yn.a,{})})}),!1===r.accesos.catalogos.departamentos.eliminar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(ru,{isOnline:c,data:t,refetch:n})})]})},ru=function(e){var t=e.data,a=e.refetch,n=e.isOnline,c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)(),d=Object(y.a)(l,2),u=d[0],b=d[1],p=function(){return s(!o)},m=Object(j.useContext)(eu).setAlert,O=Object(w.a)(hr),x=Object(y.a)(O,1)[0],h=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,x({variables:{id:t._id,empresa:c.empresa._id,sucursal:c.sucursal._id}});case 4:"false"===(n=e.sent).data.eliminarDepartamento.message?m({message:"Departamento eliminado",status:"success",open:!0}):m({message:n.data.eliminarDepartamento.message,status:"error",open:!0}),a(),b(!1),s(!1),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),m({message:"Hubo un error",status:"error",open:!0}),b(!1);case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"secondary",disabled:!n,onClick:function(){p()},children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:o,onClose:p,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:p,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{autoFocus:!0,variant:"contained",onClick:h,startIcon:u?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(zr.a,{}),children:"Eliminar"})]})]})]})};function iu(e){var t=e.isOnline,a=Object(j.useContext)(eu),n=a.data,c=a.setData,r=a.update,i=a.setUpdate,o=a.error,s=a.setError,l=a.accion,d=a.setAccion,u=a.idDepartamento,b=a.setIdDepartamento,p=a.setAlert,x=a.alert,h=JSON.parse(localStorage.getItem("sesionCafi")),_=Object(j.useState)(!1),f=Object(y.a)(_,2),A=f[0],k=f[1],N=Object(w.a)(Or),P=Object(y.a)(N,1)[0],E=Object(w.a)(xr),D=Object(y.a)(E,1)[0],z=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,n.nombre_departamentos){e.next=7;break}return s(!0),e.abrupt("return");case 7:if(k(!0),a=n,!l){e.next=18;break}if(!1!==h.accesos.catalogos.departamentos.agregar){e.next=14;break}return e.abrupt("return",p({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 14:return e.next=16,P({variables:{input:a,empresa:h.empresa._id,sucursal:h.sucursal._id}});case 16:e.next=24;break;case 18:if(!1!==h.accesos.catalogos.departamentos.editar){e.next=22;break}return e.abrupt("return",p({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 22:return e.next=24,D({variables:{input:a,id:u,empresa:h.empresa._id,sucursal:h.sucursal._id}});case 24:i(!r),d(!0),b(""),c({nombre_departamentos:""}),p({message:"\xa1Listo!",status:"success",open:!0}),s(!1),k(!1);case 31:e.next=41;break;case 33:if(e.prev=33,e.t0=e.catch(1),console.log(e.t0),k(!1),!e.t0.message){e.next=40;break}return p({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 40:p({message:"Hubo un error",status:"error",open:!0});case 41:case"end":return e.stop()}}),e,null,[[1,33]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Y,{alert:x,setAlert:p}),Object(H.jsx)("form",{onSubmit:z,children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:[Object(H.jsx)(S.a,{id:"outlined-error-helper-text",label:"Nombre departamento",value:n.nombre_departamentos,name:"nombre_departamentos",variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){c(Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},e.target.name,e.target.value)))},error:o,disabled:A,inputProps:{style:{textTransform:"uppercase"}}}),Object(H.jsx)(O.a,{ml:1}),Object(H.jsx)(F.a,{disabled:!t||A,color:"primary",variant:"contained",size:"large",disableElevation:!0,type:"submit",startIcon:A?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ut.a,{}),children:"Agregar"})]})}),Object(H.jsx)(nu,{isOnline:t})]})}var ou=a.p+"static/media/departamentos.ec6a6954.svg",su=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),lu=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function du(){var e=Object(j.useContext)(be).isOnline,t=su(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsx)("div",{children:Object(H.jsxs)(tu,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:ou,alt:"icono numero calzado",className:t.icon})}),"Departamentos"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:lu,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Departamentos"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado se registran los departamentos que se le podr\xe1 asignar a un producto."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(A.a,{maxWidth:"sm",children:Object(H.jsx)(iu,{isOnline:e,accion:"registrar"})})})]})]})})}var ju=a(30),uu=a(1001),bu=a(963),pu=a(965),mu=a(964),Ou=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},selected:{background:Object(ju.d)(e.palette.secondary.main,.1)}}}));function xu(e){var t=e.isOnline,a=Ou(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(j.useState)(""),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(""),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],x=p[1],h=Object(j.useState)({message:"",status:"",open:!1}),_=Object(y.a)(h,2),f=_[0],g=_[1],A=Object(rt.b)(ur,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id},fetchPolicy:"network-only"}),k=A.loading,N=A.data,P=A.error,E=A.refetch,D=Object(w.a)(sr),z=Object(y.a)(D,1)[0],T=Object(w.a)(dr),$=Object(y.a)(T,1)[0],W=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),i){e.next=3;break}return e.abrupt("return");case 3:if(x(!0),e.prev=4,d){e.next=15;break}if(!1!==n.accesos.catalogos.categorias.agregar){e.next=11;break}return x(!1),e.abrupt("return",g({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 11:return e.next=13,z({variables:{input:{categoria:i,empresa:n.empresa._id,sucursal:n.sucursal._id}}});case 13:e.next=23;break;case 15:if(!1!==n.accesos.catalogos.categorias.editar){e.next=20;break}return x(!1),e.abrupt("return",g({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 20:return a=qa(i),e.next=23,$({variables:{input:{categoria:a},idCategoria:d,empresa:n.empresa._id,sucursal:n.sucursal._id}});case 23:E(),g({message:"\xa1Listo!",status:"success",open:!0}),x(!1),o(""),u(""),e.next=37;break;case 30:if(e.prev=30,e.t0=e.catch(4),x(!1),!e.t0.message){e.next=36;break}return g({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 36:g({message:"Hubo un error",status:"error",open:!0});case 37:case"end":return e.stop()}}),e,null,[[4,30]])})));return function(t){return e.apply(this,arguments)}}();if(k)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(P)return Object(H.jsx)(bt,{error:P});var R=N.obtenerCategorias.map((function(e,a){return Object(H.jsx)(hu,{isOnline:t,categoria:e,setToUpdateID:u,setCategoria:o,refetch:E,toUpdateID:d},a)}));return Object(H.jsxs)("div",{className:a.root,children:[Object(H.jsx)(Y,{alert:f,setAlert:g}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Categoria"})}),Object(H.jsx)("form",{onSubmit:W,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,sm:6,xs:12,children:Object(H.jsx)(S.a,{value:i,variant:"outlined",size:"small",onChange:function(e){o(e.target.value)},fullWidth:!0,inputProps:{style:{textTransform:"uppercase"}},disabled:m})}),Object(H.jsx)(Qe.a,{item:!0,sm:6,xs:12,children:Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,type:"submit",disabled:m||!t,startIcon:m?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ut.a,{}),children:"Guardar"})})]})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(L.a,{variant:"h6",children:"Categorias"})}),Object(H.jsx)(O.a,{mb:5,children:R})]})}var hu=function(e){var t=e.categoria,a=e.setToUpdateID,n=e.setCategoria,c=e.refetch,r=e.toUpdateID,i=e.isOnline,o=Ou(),s=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(j.useState)(""),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useState)(!1),m=Object(y.a)(p,2),x=m[0],h=m[1],_=Object(j.useState)({message:"",status:"",open:!1}),f=Object(y.a)(_,2),g=f[0],A=f[1],k=Object(w.a)(lr),N=Object(y.a)(k,1)[0],P=Object(w.a)(jr),E=Object(y.a)(P,1)[0],D=t.subcategorias.map((function(e){return Object(H.jsx)(_u,{idCategoria:t._id,subcategoria:e,setToUpdateID:a,toUpdateID:r,setSubcategoria:b,setAlert:A,refetch:c,isOnline:i},e._id)})),z=function(){var e=Object(C.a)(Object(v.a)().mark((function e(n){var i,o,l;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),u){e.next=3;break}return e.abrupt("return");case 3:if(h(!0),i="",e.prev=5,r){e.next=18;break}if(!1!==s.accesos.catalogos.categorias.agregar){e.next=12;break}return h(!1),e.abrupt("return",A({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 12:return e.next=14,N({variables:{input:{subcategoria:u},idCategoria:t._id,empresa:s.empresa._id,sucursal:s.sucursal._id}});case 14:o=e.sent,i="false"===o.data.crearSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:o.data.crearSubcategoria.message,status:"error",open:!0};case 16:e.next=28;break;case 18:if(!1!==s.accesos.catalogos.categorias.editar){e.next=23;break}return h(!1),e.abrupt("return",A({message:"Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n",status:"error",open:!0}));case 23:return l=qa(u),e.next=26,E({variables:{input:{subcategoria:l},idCategoria:t._id,idSubcategoria:r,empresa:s.empresa._id,sucursal:s.sucursal._id}});case 26:o=e.sent,i="false"===o.data.actualizarSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:o.data.actualizarSubcategoria.message,status:"error",open:!0};case 28:c(),A(i),h(!1),b(""),a(""),e.next=42;break;case 35:if(e.prev=35,e.t0=e.catch(5),h(!1),!e.t0.message){e.next=41;break}return A({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 41:A({message:"Hubo un error",status:"error",open:!0});case 42:case"end":return e.stop()}}),e,null,[[5,35]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:g,setAlert:A}),Object(H.jsxs)(uu.a,{children:[Object(H.jsx)(bu.a,{style:{height:32},className:r&&r===t._id?o.selected:"",expandIcon:Object(H.jsx)(mu.a,{}),"aria-label":"Expand","aria-controls":"categoria-action-".concat(t._id),id:"categoria-".concat(t._id),children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",width:"100%",children:[Object(H.jsx)(L.a,{children:t.categoria}),Object(H.jsx)("div",{className:o.flexGrow}),!1===s.accesos.catalogos.categorias.editar?null:r&&r===t._id?Object(H.jsx)(ce.a,{onClick:function(e){e.stopPropagation(),a(""),n("")},onFocus:function(e){return e.stopPropagation()},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{onClick:function(e){window.scrollTo(0,0),e.stopPropagation(),a(t._id),n(t.categoria)},onFocus:function(e){return e.stopPropagation()},disabled:!i,children:Object(H.jsx)(yn.a,{})}),!1===s.accesos.catalogos.categorias.eliminar?null:Object(H.jsx)(fu,{idCategoria:t._id,refetch:c,tipo:"categoria",setAlert:A,isOnline:i,sesion:s})]})}),Object(H.jsx)(pu.a,{children:Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(et.a,{}),Object(H.jsx)(O.a,{mb:2}),Object(H.jsx)("form",{onSubmit:z,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,sm:6,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Subcategorias"})}),Object(H.jsx)(S.a,{value:u,variant:"outlined",size:"small",onChange:function(e){b(e.target.value)},fullWidth:!0,inputProps:{style:{textTransform:"uppercase"}},disabled:x})]}),Object(H.jsx)(Qe.a,{item:!0,sm:6,style:{display:"flex",alignItems:"flex-end"},children:Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:z,disabled:x||!i,startIcon:x?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ut.a,{}),children:"Guardar"})})]})}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(L.a,{variant:"h6",children:"Subcategorias"})}),D]})})]})]})},_u=function(e){var t=e.subcategoria,a=e.idCategoria,n=e.toUpdateID,c=e.setToUpdateID,r=e.setSubcategoria,i=e.setAlert,o=e.refetch,s=e.isOnline,l=JSON.parse(localStorage.getItem("sesionCafi")),d=Ou();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",borderRadius:3,px:1,className:n&&n===t._id?d.selected:"",children:[Object(H.jsx)(L.a,{children:t.subcategoria}),Object(H.jsx)("div",{className:d.flexGrow}),!1===l.accesos.catalogos.categorias.editar?null:n&&n===t._id?Object(H.jsx)(ce.a,{onClick:function(e){e.stopPropagation(),c(""),r("")},onFocus:function(e){return e.stopPropagation()},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{onClick:function(e){e.stopPropagation(),c(t._id),r(t.subcategoria)},onFocus:function(e){return e.stopPropagation()},disabled:!s,children:Object(H.jsx)(yn.a,{})}),!1===l.accesos.catalogos.categorias.eliminar?null:Object(H.jsx)(fu,{idCategoria:a,subcategoria:t,refetch:o,tipo:"subcategoria",setAlert:i,isOnline:s,sesion:l})]}),Object(H.jsx)(et.a,{})]})},fu=function(e){var t=e.idCategoria,a=e.subcategoria,n=e.refetch,c=e.tipo,r=e.setAlert,i=e.isOnline,o=e.sesion,s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],O=p[1],x=Object(w.a)(br),h=Object(y.a)(x,1)[0],_=Object(w.a)(pr),f=Object(y.a)(_,1)[0],g=function(e){e.stopPropagation(),u(!1)},A=function(){var e=Object(C.a)(Object(v.a)().mark((function e(i){var s,l,d;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.stopPropagation(),O(!0),s={},e.prev=3,"categoria"===c){e.next=11;break}return e.next=7,f({variables:{idCategoria:t,idSubcategoria:a._id,empresa:o.empresa._id,sucursal:o.sucursal._id}});case 7:l=e.sent,s="false"===l.data.eliminarSubcategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:l.data.eliminarSubcategoria.message,status:"error",open:!0},e.next=15;break;case 11:return e.next=13,h({variables:{idCategoria:t,empresa:o.empresa._id,sucursal:o.sucursal._id}});case 13:d=e.sent,s="false"===d.data.eliminarCategoria.message?{message:"\xa1Listo!",status:"success",open:!0}:{message:d.data.eliminarCategoria.message,status:"error",open:!0};case 15:u(!1),O(!1),r(s),n(),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(3),u(!1),O(!1),r({message:"Hubo un error",status:"error",open:!0});case 26:case"end":return e.stop()}}),e,null,[[3,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{disabled:!i,color:"secondary",onClick:function(e){return t=e,console.log(t),t.stopPropagation(),void u(!0);var t},children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:d,onClose:function(e){return g(e)},children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(e){return g(e)},color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(e){return A(e)},disabled:m,startIcon:m?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(H.Fragment,{}),children:"Eliminar"})]})]})]})},gu=a.p+"static/media/categorias.762c7c94.svg",vu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Cu=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function yu(){var e=Object(j.useContext)(be).isOnline,t=vu(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:gu,alt:"icono numero calzado",className:t.icon})}),"Categorias"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:Cu,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Categorias"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado se registran las categorias que se podr\xe1n asignar a un producto."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(A.a,{maxWidth:"md",children:Object(H.jsx)(xu,{isOnline:e})})})]})]})}var Au=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"60vh"}}}));function Su(e){var t=e.datos,a=e.toUpdate,n=e.setToUpdate,c=e.setValues,r=e.refetch,i=e.isOnline,o=Au(),s=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(j.useState)(""),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useState)([]),m=Object(y.a)(p,2),x=m[0],h=m[1],_=Object(j.useState)({status:"",message:"",open:!1}),f=Object(y.a)(_,2),g=f[0],v=f[1];return Object(j.useEffect)((function(){h(t.filter((function(e){return e.nombre.toLowerCase().includes(u.toLowerCase())})))}),[u,t]),Object(H.jsxs)("div",{className:o.root,children:[Object(H.jsx)(Y,{alert:g,setAlert:v}),Object(H.jsxs)(fn.a,{className:o.paper,children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(S.a,{fullWidth:!0,placeholder:"Buscar...",variant:"outlined",size:"small",onChange:function(e){return b(e.target.value)}})}),Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{className:o.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{padding:"checkbox",children:"Color"}),Object(H.jsx)(Da.a,{children:"Nombre"}),!1===s.accesos.catalogos.colores.editar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Editar"}),!1===s.accesos.catalogos.colores.eliminar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:x.map((function(e,t){return Object(H.jsx)(Fu,{row:e,setAlert:v,toUpdate:a,setToUpdate:n,setValues:c,refetch:r,isOnline:i},t)}))})]})})]})]})}var Fu=function(e){var t=e.row,a=e.setAlert,n=e.toUpdate,c=e.setToUpdate,r=e.setValues,i=e.refetch,o=e.isOnline,s=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useState)(!1),m=Object(y.a)(p,2),x=m[0],h=m[1],_=function(){return b(!u)},f=Object(w.a)(dc),g=Object(y.a)(f,1)[0],A=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h(!0),e.next=4,g({variables:{id:t._id,empresa:s.empresa._id,sucursal:s.sucursal._id}});case 4:n=e.sent,i(i),a({message:n.data.eliminarColor.message,status:"success",open:!0}),h(!1),_(),e.next=18;break;case 11:if(e.prev=11,e.t0=e.catch(0),h(!1),!e.t0.message){e.next=17;break}return a({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 17:a({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),S=function(e){if(!e)return c(""),void r({nombre:"",hex:""});c(e._id),r({nombre:e.nombre,hex:e.hex})};return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,selected:n===t._id,children:[Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(O.a,{width:30,height:25,bgcolor:t.hex,borderRadius:"10%"})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:t.nombre})})}),!1===s.accesos.catalogos.colores.editar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:n===t._id?Object(H.jsx)(ce.a,{onClick:function(){return S()},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{disabled:!o,onClick:function(){return S(t)},children:Object(H.jsx)(yn.a,{})})}),!1===s.accesos.catalogos.colores.eliminar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(Iu,{handleModal:_,openModal:u,handleDelete:A,loading:x,isOnline:o})})]})},Iu=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete,c=e.loading,r=e.isOnline;return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"secondary",onClick:t,disabled:!r,children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:a,onClose:t,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,disabled:c,startIcon:c?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(zr.a,{}),children:"Eliminar"})]})]})]})};function ku(e){var t=e.isOnline,a=Object(j.useState)({}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(""),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)({nombre:"",hex:""}),u=Object(y.a)(d,2),b=u[0],p=u[1],x=Object(j.useState)({message:"",status:"",open:!1}),h=Object(y.a)(x,2),_=h[0],f=h[1],g=JSON.parse(localStorage.getItem("sesionCafi")),A=Object(j.useState)(!1),k=Object(y.a)(A,2),N=k[0],P=k[1],E=Object(j.useState)(!1),D=Object(y.a)(E,2),z=D[0],T=D[1],$=Object(rt.b)(sc,{variables:{empresa:g.empresa._id}}),W=$.loading,R=$.data,V=$.error,M=$.refetch,L=Object(w.a)(oc),B=Object(y.a)(L,1)[0],U=Object(w.a)(lc),q=Object(y.a)(U,1)[0];if(W)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(V)return Object(H.jsx)(bt,{error:V});var J=R.obtenerColores,G=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),b.nombre&&b.hex){e.next=4;break}return P(!0),e.abrupt("return");case 4:if(P(!1),T(!0),e.prev=6,a=b,!s){e.next=19;break}if(!1!==g.accesos.catalogos.colores.editar){e.next=13;break}return e.abrupt("return",f({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 13:return e.next=15,q({variables:{input:{nombre:a.nombre,hex:a.hex},id:s,empresa:g.empresa._id,sucursal:g.sucursal._id}});case 15:c=e.sent,n=c.data.actualizarColor.message;case 17:e.next=26;break;case 19:if(!1!==g.accesos.catalogos.colores.agregar){e.next=23;break}return e.abrupt("return",f({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 23:return e.next=25,B({variables:{input:{nombre:a.nombre,hex:a.hex,empresa:g.empresa._id,sucursal:g.sucursal._id}}});case 25:n="\xa1Listo!. Color creado.";case 26:M(),p({nombre:"",hex:""}),l(""),T(!1),f({message:n,status:"success",open:!0}),e.next=40;break;case 33:if(e.prev=33,e.t0=e.catch(6),T(!1),!e.t0.message){e.next=39;break}return f({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 39:f({message:"Hubo un error",status:"error",open:!0});case 40:case"end":return e.stop()}}),e,null,[[6,33]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{display:"flex",justifyContent:"center",children:[Object(H.jsx)(Y,{alert:_,setAlert:f}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,sm:5,xs:12,style:{display:"flex",justifyContent:"center"},children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(ic.a,{color:c,onChangeComplete:function(e){r(e),p(Object(m.a)(Object(m.a)({},b),{},{hex:e.hex.toUpperCase()}))}}),Object(H.jsxs)(O.a,{my:5,children:[Object(H.jsx)("form",{id:"form-colores",onSubmit:G,children:Object(H.jsx)(S.a,{label:"Nombre del color",variant:"outlined",size:"small",value:b.nombre,onChange:function(e){return p(Object(m.a)(Object(m.a)({},b),{},{nombre:e.target.value}))},inputProps:{style:{textTransform:"uppercase"}},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:b.hex?Object(H.jsx)(O.a,{border:1,borderRadius:2,bgcolor:b.hex,height:20,width:20}):Object(H.jsx)(O.a,{border:1,style:N&&!b.hex?{borderColor:"red"}:{borderColor:"black"},borderRadius:2,height:20,width:20})})},fullWidth:!0,error:!!N&&!b.nombre,disabled:z,helperText:N?b.nombre?"":"Campo obligatorio":""})}),Object(H.jsx)(O.a,{my:1}),Object(H.jsx)(F.a,{disabled:!t||z,color:"primary",variant:"contained",size:"large",fullWidth:!0,type:"submit",form:"form-colores",startIcon:z?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ut.a,{}),children:s?"Actualizar":"Guardar"})]})]})}),Object(H.jsx)(Qe.a,{item:!0,sm:7,xs:12,children:Object(H.jsx)(Su,{datos:J,toUpdate:s,setToUpdate:l,setValues:p,refetch:M,isOnline:t})})]})]})}var wu=a.p+"static/media/colores.cf4ac382.svg",Nu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Pu=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Eu(){var e=Object(j.useContext)(be).isOnline,t=Nu(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:wu,alt:"icono numero calzado",className:t.icon})}),"Colores"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:Pu,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Colores"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado se registran los colores que se le podr\xe1n asignar a un producto."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(O.a,{mt:4,children:Object(H.jsx)(A.a,{maxWidth:"md",children:Object(H.jsx)(ku,{isOnline:e})})})]})]})}var Du=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function zu(e){var t=e.updateData,a=e.toUpdate,n=e.setToUpdate,c=e.setData,r=e.isOnline,i=Du(),o=Object(j.useState)({status:"",message:"",open:!1}),s=Object(y.a)(o,2),l=s[0],d=s[1],u=JSON.parse(localStorage.getItem("sesionCafi")),b=[],p=Object(rt.b)(_r,{variables:{empresa:u.empresa._id}}),m=p.loading,x=p.data,h=p.refetch,_=p.error;return Object(j.useEffect)((function(){h()}),[h,t]),m?Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})}):_?Object(H.jsx)(bt,{error:_}):(x&&(b=x.obtenerMarcas),Object(H.jsxs)("div",{className:i.root,children:[Object(H.jsx)(Y,{alert:l,setAlert:d}),Object(H.jsx)(fn.a,{className:i.paper,children:Object(H.jsx)(Na.a,{style:{height:"72vh"},children:Object(H.jsxs)($a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Marca"}),!1===u.accesos.catalogos.marcas.editar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Editar"}),!1===u.accesos.catalogos.marcas.eliminar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:b.map((function(e,t){return Object(H.jsx)(Tu,{setAlert:d,refetch:h,datos:e,toUpdate:a,setToUpdate:n,setData:c,isOnline:r},t)}))})]})})})]}))}var Tu=function(e){var t=e.datos,a=(e.updateData,e.toUpdate),n=e.setAlert,c=e.setToUpdate,r=e.setData,i=e.refetch,o=e.isOnline,s=JSON.parse(localStorage.getItem("sesionCafi")),l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=function(){return b(!u)},m=Object(w.a)(vr),O=Object(y.a)(m,1)[0],x=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O({variables:{id:t._id,empresa:s.empresa._id,sucursal:s.sucursal._id}});case 3:"false"===(a=e.sent).data.eliminarMarca.message?n({message:"Marca eliminada",status:"success",open:!0}):n({message:a.data.eliminarMarca.message,status:"error",open:!0}),i(),p(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n({message:e.t0.message,status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),h=function(e){if(!e)return c(""),r(""),void i();i(),c(e._id),r(e)};return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:a===t._id,children:[Object(H.jsx)(Da.a,{children:t.nombre_marca}),!1===s.accesos.catalogos.marcas.editar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:a===t._id?Object(H.jsx)(ce.a,{onClick:function(){return h()},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{onClick:function(){return h(t)},disabled:!o,children:Object(H.jsx)(yn.a,{})})}),!1===s.accesos.catalogos.marcas.eliminar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)($u,{handleModal:p,openModal:u,handleDelete:x,isOnline:o})})]})},$u=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete,c=e.isOnline;return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"secondary",onClick:t,disabled:!c,children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:a,onClose:t,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})]})},Wu=Object(j.createContext)(),Ru=function(e){var t=e.children,a=Object(j.useState)({nombre_marca:""}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1];return Object(H.jsx)(Wu.Provider,{value:{datosMarcas:c,setDatosMarcas:r,update:s,setUpdate:l,error:b,setError:p,openRegistro:x,setOpenRegistro:h},children:t})};function Vu(e){var t=e.isOnline,a=Object(j.useState)({message:"",status:"",open:!1}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)({nombre_marca:""}),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(""),u=Object(y.a)(d,2),b=u[0],p=u[1],x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],A=Object(j.useState)(!1),I=Object(y.a)(A,2),k=I[0],N=I[1],P=Object(j.useContext)(Wu),E=P.error,D=P.setError,z=JSON.parse(localStorage.getItem("sesionCafi")),T=Object(w.a)(fr),$=Object(y.a)(T,1)[0],W=Object(w.a)(gr),R=Object(y.a)(W,1)[0],V=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s.nombre_marca){e.next=6;break}return D(!0),e.abrupt("return");case 6:if(!b){e.next=17;break}if(!1!==z.accesos.catalogos.marcas.editar){e.next=11;break}return e.abrupt("return",r({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n !",status:"error",open:!0}));case 11:return t=qa(s),e.next=14,R({variables:{input:{nombre_marca:t.nombre_marca},id:b,empresa:z.empresa._id,sucursal:z.sucursal._id}});case 14:l("");case 15:e.next=25;break;case 17:if(!1!==z.accesos.catalogos.marcas.agregar){e.next=21;break}return e.abrupt("return",r({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n !",status:"error",open:!0}));case 21:return a=s,e.next=24,$({variables:{input:a,empresa:z.empresa._id,sucursal:z.sucursal._id}});case 24:l("");case 25:p(""),N(!k),f(!1),r({message:"\xa1Listo!",status:"success",open:!0}),D(!1);case 30:e.next=40;break;case 32:if(e.prev=32,e.t0=e.catch(0),console.log(e.t0),f(!1),!e.t0.message){e.next=39;break}return r({message:e.t0.message,status:"error",open:!0}),e.abrupt("return");case 39:r({message:"Hubo un error",status:"error",open:!0});case 40:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(st,{loading:_}),Object(H.jsx)(Y,{alert:c,setAlert:r}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",my:2,children:[Object(H.jsx)(S.a,{id:"outlined-error-helper-text",label:"Nombre de marca",value:s.nombre_marca?s.nombre_marca:"",name:"nombre_marca",variant:"outlined",size:"small",fullWidth:!0,inputProps:{style:{textTransform:"uppercase"}},onChange:function(e){l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},e.target.name,e.target.value)))},error:E,onKeyPress:function(e){"Enter"===e.key&&V()}}),Object(H.jsx)(O.a,{ml:1}),Object(H.jsxs)(F.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:V,disabled:!t,children:[Object(H.jsx)(Ut.a,{}),"Guardar"]})]}),Object(H.jsx)(zu,{toUpdate:b,setToUpdate:p,updateData:k,setData:l,isOnline:t})]})}var Mu=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Lu=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}}));function Bu(){var e=Object(j.useContext)(be).isOnline,t=Lu(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsx)("div",{children:Object(H.jsxs)(Ru,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.o,{className:t.icon})}),"Marcas"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:Mu,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Marcas"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado se registran las marcas que se asignar\xe1n a un producto."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(O.a,{mt:4,children:Object(H.jsx)(A.a,{maxWidth:"md",children:Object(H.jsx)(Vu,{isOnline:e})})})]})]})})}function Uu(e){var t=e.cuenta,a=e.refetch,n=e.setAlert,c=e.isOnline,r=u.a.useState(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=u.a.useState(!1),d=Object(y.a)(l,2),b=d[0],p=d[1],m=JSON.parse(localStorage.getItem("sesionCafi")),O=Object(w.a)(so),x=Object(y.a)(O,1)[0],h=function(){s(!1)},_=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,x({variables:{id:t._id,empresa:m.empresa._id,sucursal:m.sucursal._id}});case 4:p(!1),a(),n({message:"\xa1Listo!",status:"success",open:!0}),h(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),p(!1),n({message:"Hubo un error",status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{color:"secondary",onClick:function(e){e.stopPropagation(),s(!0)},onFocus:function(e){return e.stopPropagation()},disabled:!c,children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:o,onClose:h,children:[Object(H.jsx)(Bt.a,{children:"Se eliminar\xe1 esta cuenta"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:h,color:"primary",autoFocus:!0,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return _()},color:"secondary",disabled:b,startIcon:b?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})}function qu(e){var t=e.idCuenta,a=e.subcuenta,n=e.refetch,c=e.setAlert,r=e.isOnline,i=JSON.parse(localStorage.getItem("sesionCafi")),o=u.a.useState(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],b=u.a.useState(!1),p=Object(y.a)(b,2),m=p[0],O=p[1],x=Object(w.a)(lo),h=Object(y.a)(x,1)[0],_=function(){d(!1)},f=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.prev=1,e.next=4,h({variables:{idCuenta:t,idSubcuenta:a._id,empresa:i.empresa._id,sucursal:i.sucursal._id}});case 4:O(!1),n(),c({message:"\xa1Listo!",status:"success",open:!0}),_(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),O(!1),c({message:"Hubo un error",status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{color:"secondary",onClick:function(e){e.stopPropagation(),d(!0)},onFocus:function(e){return e.stopPropagation()},disabled:!r,children:Object(H.jsx)(zr.a,{})}),Object(H.jsxs)(qe.a,{open:l,onClose:_,children:[Object(H.jsx)(Bt.a,{children:"Se eliminar\xe1 esta cuenta"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:_,color:"primary",autoFocus:!0,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return f()},color:"secondary",disabled:m,startIcon:m?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]})]})}var Ju=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},selected:{background:Object(ju.d)(e.palette.secondary.main,.1)}}}));function Hu(e){var t=e.isOnline,a=Ju(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(j.useState)(""),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(""),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],x=p[1],h=Object(j.useState)({message:"",status:"",open:!1}),_=Object(y.a)(h,2),f=_[0],g=_[1],A=Object(rt.b)(oo,{variables:{empresa:n.empresa._id}}),k=A.loading,N=A.data,P=A.error,E=A.refetch,D=Object(w.a)(no),z=Object(y.a)(D,1)[0],T=Object(w.a)(ro),$=Object(y.a)(T,1)[0];if(k)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(P)return Object(H.jsx)(bt,{error:P});var W=N.obtenerCuentas.map((function(e,a){return Object(H.jsx)(Xu,{cuenta:e,setToUpdateID:u,setCuenta:o,refetch:E,toUpdateID:d,isOnline:t},a)})),R=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:if(x(!0),e.prev=3,d){e.next=14;break}if(!1!==n.accesos.catalogos.centro_costos.agregar){e.next=10;break}return x(!1),e.abrupt("return",g({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 10:return e.next=12,z({variables:{input:{cuenta:i,empresa:n.empresa._id,sucursal:n.sucursal._id}}});case 12:e.next=22;break;case 14:if(!1!==n.accesos.catalogos.centro_costos.editar){e.next=19;break}return x(!1),e.abrupt("return",g({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 19:return t=qa(i),e.next=22,$({variables:{input:{cuenta:t},idCuenta:d,empresa:n.empresa._id,sucursal:n.sucursal._id}});case 22:E(),g({message:"\xa1Listo!",status:"success",open:!0}),x(!1),o(""),u(""),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),g({message:"Hubo un error",status:"error",open:!0}),x(!1);case 33:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{className:a.root,children:[Object(H.jsx)(Y,{alert:f,setAlert:g}),Object(H.jsx)(st,{loading:m,setLoading:x}),Object(H.jsx)(L.a,{variant:"h6",children:"Cuentas"}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",mb:2,children:[Object(H.jsx)(S.a,{value:i,variant:"outlined",inputProps:{style:{textTransform:"uppercase"}},size:"small",style:{width:"35%"},onKeyPress:function(e){try{"Enter"===e.key&&R()}catch(P){}},onChange:function(e){o(e.target.value)}}),Object(H.jsx)(O.a,{ml:1}),Object(H.jsxs)(F.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:R,disabled:!t,children:[Object(H.jsx)(Ut.a,{}),"Guardar"]})]}),W]})}var Gu,Yu,Qu,Ku,Xu=function(e){var t=e.cuenta,a=e.setToUpdateID,n=e.setCuenta,c=e.refetch,r=e.toUpdateID,i=e.isOnline,o=JSON.parse(localStorage.getItem("sesionCafi")),s=Ju(),l=Object(j.useState)(""),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useState)(!1),m=Object(y.a)(p,2),x=m[0],h=m[1],_=Object(j.useState)({message:"",status:"",open:!1}),f=Object(y.a)(_,2),g=f[0],A=f[1],I=Object(w.a)(co),k=Object(y.a)(I,1)[0],N=Object(w.a)(io),P=Object(y.a)(N,1)[0],E=null!==t.subcuentas?t.subcuentas.map((function(e){return Object(H.jsx)(Zu,{idCuenta:t._id,subcuenta:e,setToUpdateID:a,toUpdateID:r,setSubcuenta:b,refetch:c,isOnline:i},e._id)})):Object(H.jsx)("div",{}),D=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:if(h(!0),e.prev=3,r){e.next=14;break}if(!1!==o.accesos.catalogos.centro_costos.agregar){e.next=10;break}return h(!1),e.abrupt("return",A({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 10:return e.next=12,k({variables:{input:{subcuenta:u},idCuenta:t._id,empresa:o.empresa._id,sucursal:o.sucursal._id}});case 12:e.next=22;break;case 14:if(!1!==o.accesos.catalogos.centro_costos.editar){e.next=19;break}return h(!1),e.abrupt("return",A({message:"\xa1Lo sentimos no tienes autorizaci\xf3n para esta acci\xf3n!",status:"error",open:!0}));case 19:return n=qa(u),e.next=22,P({variables:{input:{subcuenta:n},idCuenta:t._id,idSubcuenta:r,empresa:o.empresa._id,sucursal:o.sucursal._id}});case 22:c(),A({message:"\xa1Listo!",status:"success",open:!0}),h(!1),b(""),a(""),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(3),A({message:"Hubo un error",status:"error",open:!0}),h(!1);case 33:case"end":return e.stop()}}),e,null,[[3,29]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:g,setAlert:A}),Object(H.jsx)(st,{loading:x,setLoading:h}),Object(H.jsxs)(uu.a,{children:[Object(H.jsx)(bu.a,{className:r&&r===t._id?s.selected:"",expandIcon:Object(H.jsx)(mu.a,{}),"aria-label":"Expand","aria-controls":"cuenta-action-".concat(t._id),id:"cuenta-".concat(t._id),children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",width:"100%",children:[Object(H.jsx)(L.a,{style:{fontSize:15},children:t.cuenta}),Object(H.jsx)("div",{className:s.flexGrow}),r&&r===t._id?Object(H.jsx)(ce.a,{onClick:function(e){e.stopPropagation(),a(""),n("")},onFocus:function(e){return e.stopPropagation()},children:Object(H.jsx)(Gt.a,{})}):!1===o.accesos.catalogos.centro_costos.editar?null:Object(H.jsx)(ce.a,{onClick:function(e){e.stopPropagation(),a(t._id),n(t.cuenta)},onFocus:function(e){return e.stopPropagation()},disabled:!i,children:Object(H.jsx)(yn.a,{})}),!1===o.accesos.catalogos.centro_costos.eliminar?null:Object(H.jsx)(Uu,{cuenta:t,refetch:c,setAlert:A,isOnline:i})]})}),Object(H.jsx)(pu.a,{children:Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(et.a,{}),Object(H.jsx)(O.a,{mb:2}),Object(H.jsxs)(O.a,{ml:5,width:"100%",display:"flex",children:[Object(H.jsx)(L.a,{variant:"h6",style:{fontSize:20},children:"Subcuenta"}),Object(H.jsx)(O.a,{mr:2}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",mb:2,children:[Object(H.jsx)(S.a,{value:u,variant:"outlined",size:"small",onChange:function(e){b(e.target.value)},onKeyPress:function(e){try{"Enter"===e.key&&D()}catch(t){}},inputProps:{style:{textTransform:"uppercase"}}}),Object(H.jsx)(O.a,{ml:1}),Object(H.jsxs)(F.a,{color:"primary",variant:"contained",size:"large",disableElevation:!0,onClick:D,disabled:!i,children:[Object(H.jsx)(Ut.a,{}),"Guardar"]})]})]}),null!==t.subcuentas?Object(H.jsx)(O.a,{ml:5,children:E}):Object(H.jsx)("div",{})]})})]})]})},Zu=function(e){var t=e.idCuenta,a=e.subcuenta,n=e.toUpdateID,c=e.setToUpdateID,r=e.setSubcuenta,i=e.refetch,o=e.isOnline,s=JSON.parse(localStorage.getItem("sesionCafi")),l=Ju(),d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)({message:"",status:"",open:!1}),x=Object(y.a)(m,2),h=x[0],_=x[1];return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:h,setAlert:_}),Object(H.jsx)(st,{loading:b,setLoading:p}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",borderRadius:3,px:1,className:n&&n===a._id?l.selected:"",children:[Object(H.jsx)(L.a,{children:a.subcuenta}),Object(H.jsx)("div",{className:l.flexGrow}),!1===s.accesos.catalogos.centro_costos.editar?null:n&&n===a._id?Object(H.jsx)(ce.a,{onClick:function(e){e.stopPropagation(),c(""),r("")},onFocus:function(e){return e.stopPropagation()},children:Object(H.jsx)(Gt.a,{})}):Object(H.jsx)(ce.a,{onClick:function(e){e.stopPropagation(),c(a._id),r(a.subcuenta)},onFocus:function(e){return e.stopPropagation()},disabled:!o,children:Object(H.jsx)(yn.a,{})}),!1===s.accesos.catalogos.centro_costos.eliminar?null:Object(H.jsx)(qu,{idCuenta:t,subcuenta:a,refetch:i,setAlert:_,isOnline:o})]}),Object(H.jsx)(et.a,{})]})},eb=a.p+"static/media/costos.c06d434a.svg",tb=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),ab=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function nb(){var e=Object(j.useContext)(be).isOnline,t=tb(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:eb,alt:"icono numero calzado",className:t.icon})}),"Centro de costos"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:ab,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Centro de costos"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado podr\xe1s registrar tus cuentas y subcuentas que utilizar\xe1s al momento de llevar tu control financiero. Por ejemplo: Compras, Ventas."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(A.a,{maxWidth:"md",children:Object(H.jsx)(Hu,{isOnline:e})})})]})]})}var cb=Object(P.d)(Gu||(Gu=Object(N.a)(["\n  query ObtenerConceptosAlmacen($empresa: ID!, $sucursal: ID!) {\n    obtenerConceptosAlmacen(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      nombre_concepto\n      destino\n      origen\n      editable\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n    }\n  }\n"]))),rb=Object(P.d)(Yu||(Yu=Object(N.a)(["\n  mutation CrearConceptoAlmacen(\n    $input: ConceptoAlmacenInput\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n  ) {\n    crearConceptoAlmacen(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n    ) {\n      message\n    }\n  }\n"]))),ib=Object(P.d)(Qu||(Qu=Object(N.a)(["\n    mutation ActualizarConceptoAlmacen($input: ConceptoAlmacenInput, $id: ID!, $empresa:ID!, $sucursal:ID!){\n        actualizarConceptoAlmacen(input: $input, id: $id, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),ob=Object(P.d)(Ku||(Ku=Object(N.a)(["\n    mutation EliminarConceptoAlmacen($id: ID!, $empresa:ID!, $sucursal:ID!){\n        eliminarConceptoAlmacen(id: $id, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),sb=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)}}}));function lb(e){var t=e.setData,a=e.setIdConcepto,n=e.idConcepto,c=e.setAccion,r=e.updateData,i=e.setAlert,o=e.isOnline,s=sb(),l=JSON.parse(localStorage.getItem("sesionCafi")),d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=function(){return p(!b)},x=[],h=Object(rt.b)(cb,{variables:{empresa:l.empresa._id,sucursal:l.sucursal._id}}),_=h.loading,f=h.data,g=h.error,A=h.refetch,S=Object(w.a)(ob),F=Object(y.a)(S,1)[0];Object(j.useEffect)((function(){A()}),[r,A]),f&&(x=f.obtenerConceptosAlmacen);var k=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F({variables:{id:n,empresa:l.empresa._id,sucursal:l.sucursal._id}});case 3:A(),i({message:"\xa1Listo!",status:"success",open:!0}),m(),a(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),i({message:e.t0.message,status:"error",open:!0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return g?Object(H.jsx)(bt,{error:g}):_?Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})}):Object(H.jsxs)("div",{className:s.root,children:[Object(H.jsx)(fn.a,{className:s.paper,children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{className:s.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Concepto almac\xe9n"}),Object(H.jsx)(Da.a,{padding:"default",children:"Origen"}),Object(H.jsx)(Da.a,{padding:"default",children:"Destino"}),!1===l.accesos.catalogos.conceptos_almacen.editar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Editar"}),!1===l.accesos.catalogos.conceptos_almacen.eliminar?null:Object(H.jsx)(Da.a,{padding:"default",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:x.map((function(e,n){return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:e.nombre_concepto}),Object(H.jsx)(Da.a,{children:e.origen}),Object(H.jsx)(Da.a,{children:e.destino}),!1===l.accesos.catalogos.conceptos_almacen.editar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(ce.a,{onClick:function(){c(!1),a(e._id),t({nombre_concepto:e.nombre_concepto,origen:e.origen,destino:e.destino})},disabled:!e.editable||!o,children:Object(H.jsx)(yn.a,{})})}),!1===l.accesos.catalogos.conceptos_almacen.eliminar?null:Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(ce.a,{color:"secondary",onClick:function(){a(e._id),m()},disabled:!e.editable||!o,children:Object(H.jsx)(zr.a,{})})})]},e._id)}))})]})})}),Object(H.jsx)(db,{handleModal:m,openModal:b,handleDelete:k})]})}var db=function(e){var t=e.handleModal,a=e.openModal,n=e.handleDelete;return Object(H.jsx)("div",{children:Object(H.jsxs)(qe.a,{open:a,onClose:t,children:[Object(H.jsx)(Bt.a,{children:"Eliminar este concepto afectar\xe1 c\xe1lculos de estados de resultado ,\xbfSeguro que quieres eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,children:"Eliminar"})]})]})})},jb=Object(k.a)((function(e){return{root:{width:"100%"},flexGrow:{flexGrow:1},formControl:{marginLeft:e.spacing(5),marginBottom:e.spacing(3),minWidth:200,maxWidth:200}}})),ub={PaperProps:{style:{maxHeight:908,width:400}}},bb=["SUMA","RESTA","N/A"];function pb(e,t,a){return console.log(t),{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}function mb(e){var t=e.isOnline,a=jb(),n=Object($e.a)(),c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)({nombre_concepto:"",destino:"",origen:""}),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)({message:"",status:"",open:!1}),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useState)(!1),f=Object(y.a)(_,2),A=f[0],I=f[1],k=JSON.parse(localStorage.getItem("sesionCafi")),N=Object(j.useState)(!0),P=Object(y.a)(N,2),E=P[0],D=P[1],z=Object(j.useState)(""),T=Object(y.a)(z,2),$=T[0],W=T[1],R=Object(w.a)(rb),V=Object(y.a)(R,1)[0],M=Object(w.a)(ib),B=Object(y.a)(M,1)[0],U=Object(j.useState)(!1),q=Object(y.a)(U,2),J=q[0],G=q[1],Q=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,G(!1),d.nombre_concepto&&d.origen&&d.destino){e.next=7;break}return I(!0),e.abrupt("return");case 7:if(t=d,!E){e.next=17;break}if(!1!==k.accesos.catalogos.conceptos_almacen.agregar){e.next=13;break}return e.abrupt("return",h({message:"Lo sentimos no tienes los permisos autorizados",status:"error",open:!0}));case 13:return e.next=15,V({variables:{input:t,empresa:k.empresa._id,sucursal:k.sucursal._id,usuario:k._id}});case 15:e.next=24;break;case 17:if(!1!==k.accesos.catalogos.conceptos_almacen.editar){e.next=21;break}return e.abrupt("return",h({message:"Lo sentimos no tienes los permisos autorizados",status:"error",open:!0}));case 21:return e.next=23,B({variables:{input:t,id:$,empresa:k.empresa._id,sucursal:k.sucursal._id}});case 23:D(!0);case 24:h({message:"\xa1Listo!",status:"success",open:!0}),u({nombre_concepto:"",origen:"",destino:""}),I(!1),o(!i),W("");case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),h({message:e.t0.message,status:"error",open:!0});case 34:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(){return e.apply(this,arguments)}}(),K=function(e){var t=e.handleModal,a=e.openModal,n=e.handleSubmit,c=e.isOnline;return Object(H.jsx)("div",{children:Object(H.jsxs)(qe.a,{open:a,onClose:t,children:[Object(H.jsx)(Bt.a,{children:"Editar este concepto afectar\xe1 c\xe1lculos de estados de resultado ,\xbfSeguro que quieres editar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:t,color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:n,disabled:!c,children:"Editar"})]})]})})};return Object(H.jsxs)("div",{className:a.root,children:[Object(H.jsx)(O.a,{flexDirection:"row",children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Y,{alert:x,setAlert:h}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",mb:2,children:[Object(H.jsx)(L.a,{children:"Concepto "}),Object(H.jsx)(S.a,{error:A,id:"outlined-error-helper-text",variant:"outlined",size:"small",name:"nombre_concepto",style:{marginLeft:2},value:d.nombre_concepto,onChange:function(e){u(Object(m.a)(Object(m.a)({},d),{},Object(g.a)({},e.target.name,e.target.value)))},onKeyPress:function(e){"Enter"===e.key&&Q()},inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(ee.a,{className:a.formControl,children:[Object(H.jsx)(te.a,{id:"origen-label",children:"Origen"}),Object(H.jsx)(Nt.a,{error:A,labelId:"origen-label",id:"origen-name",value:d.origen,onChange:function(e){u(Object(m.a)(Object(m.a)({},d),{},{origen:e.target.value}))},input:Object(H.jsx)(_n.a,{}),MenuProps:ub,children:bb.map((function(e){return Object(H.jsx)(Pt.a,{value:e,style:pb(e,d.origen,n),children:e},e)}))})]}),Object(H.jsxs)(ee.a,{className:a.formControl,children:[Object(H.jsx)(te.a,{id:"destino-label",children:"Destino"}),Object(H.jsx)(Nt.a,{error:A,labelId:"destino-label",id:"destino-name",value:d.destino,onChange:function(e){u(Object(m.a)(Object(m.a)({},d),{},{destino:e.target.value}))},input:Object(H.jsx)(_n.a,{}),MenuProps:ub,children:bb.map((function(e){return Object(H.jsx)(Pt.a,{value:e,style:pb(e,d.destino,n),children:e},e)}))})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",mb:2,children:[Object(H.jsx)(O.a,{ml:5}),Object(H.jsxs)(F.a,{color:"primary",variant:"contained",size:"large",onClick:function(){return E?Q():G(!0)},disableElevation:!0,disabled:!t,children:[Object(H.jsx)(Ut.a,{}),"Guardar"]})]})]})}),Object(H.jsx)(lb,{setData:u,idConcepto:$,setIdConcepto:W,setAccion:D,updateData:i,setAlert:h,isOnline:t}),Object(H.jsx)(K,{handleModal:function(){return G(!J)},openModal:J,handleSubmit:Q,isOnline:t})]})}var Ob=a.p+"static/media/conceptosAlmacen.209417b5.svg",xb=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),hb=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function _b(){var e=Object(j.useContext)(be).isOnline,t=xb(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Ob,alt:"icono numero calzado",className:t.icon})}),"Conceptos Almac\xe9n"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:c,onClose:i,TransitionComponent:hb,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Conceptos almac\xe9n"}),Object(H.jsxs)(O.a,{m:1,display:"flex",flexDirection:"row",children:[Object(H.jsx)(Kd,{texto:"En este apartado podr\xe1s registrar los conceptos que definir\xe1n la acci\xf3n para los traspasos entre almacenes."}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})]})}),Object(H.jsx)(O.a,{mt:4,alignSelf:"center",children:Object(H.jsx)(A.a,{children:Object(H.jsx)(mb,{isOnline:e})})})]})]})}function fb(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)(A.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:5,justifyContent:"center",children:[!1===e.accesos.catalogos.clientes.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(ad,{})})}),!1===e.accesos.catalogos.productos.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Md,{})})}),!1===e.accesos.catalogos.tallas_numeros.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(tj,{})})}),!1===e.accesos.catalogos.provedores.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(dj,{})})}),!1===e.accesos.catalogos.cajas.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Rj,{})})}),!1===e.accesos.catalogos.usuarios.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Zj,{})})}),!1===e.accesos.catalogos.departamentos.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(du,{})})}),!1===e.accesos.catalogos.categorias.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(yu,{})})}),!1===e.accesos.catalogos.colores.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Eu,{})})}),!1===e.accesos.catalogos.marcas.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Bu,{})})}),!1===e.accesos.catalogos.centro_costos.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(nb,{})})}),!1===e.accesos.catalogos.conceptos_almacen.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(_b,{})})})]})})}var gb=Object(j.createContext)(),vb=function(e){var t=e.children,a=Object(j.useState)({message:"",status:"",open:!1}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)([]),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)([]),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1];return Object(H.jsx)(gb.Provider,{value:{alert:c,setAlert:r,cuentas:s,setCuentas:l,reload:x,setReload:h,cuenta:b,setCuenta:p},children:t})},Cb=a.p+"static/media/retiro-de-dinero.5d8be2e9.svg",yb=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},formComboBox:{height:"50%"},formControl:{margin:e.spacing(0),minWidth:"96%",maxWidth:"96%"},icon:{width:40}}})),Ab=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Sb={PaperProps:{style:{maxHeight:908,width:400}}},Fb=["CORTE DE CAJA","TRANSFERENCIA DE EFECTIVO","APORTACION SOCIOS"];function Ib(e){e.cuenta;var t=e.setReload,a=e.tipo,n=JSON.parse(localStorage.getItem("sesionCafi")),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=Object(w.a)(ga),i=Object(y.a)(r,1)[0],o=yb(),s=Object(j.useState)({message:"",status:"",open:!1}),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)({}),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useState)(""),f=Object(y.a)(_,2),A=f[0],I=f[1],k=Object(j.useState)({}),N=Object(y.a)(k,2),P=N[0],E=N[1],D=Object(j.useState)({}),T=Object(y.a)(D,2),$=T[0],W=T[1],R=Object(j.useState)({}),V=Object(y.a)(R,2),M=V[0],B=V[1],U=Object(j.useState)(!1),q=Object(y.a)(U,2),J=q[0],G=q[1],Q=Object(j.useState)(""),K=Object(y.a)(Q,2),X=K[0],Z=K[1],ae=[],ne=[],ce=Object(rt.b)(z,{variables:{sucursal:"".concat(n.sucursal._id),empresa:"".concat(n.empresa._id),eliminado:!1},fetchPolicy:"network-only"}),re=Object(rt.b)(vj,{variables:{sucursal:"".concat(n.sucursal._id),empresa:"".concat(n.empresa._id)},fetchPolicy:"network-only"}),ie=function(){G(!J)},oe=function(e){h(Object(m.a)(Object(m.a)({},x),{},Object(g.a)({},e.target.name,e.target.value)))},se={tipo_movimiento:"RETIRO"===x.tipo_movimiento?"CUENTA_RETIRO":"CUENTA_DEPOSITO",id_usuario:n._id,rol_movimiento:"CAJA_PRINCIPAL",numero_usuario_creador:n.numero_usuario.toString(),nombre_usuario_creador:n.nombre,horario_turno:c?c.horario_turno:"",concepto:A,usuario_entrega:P._id,origen_entrega:$._id,fecha_movimiento_entrega:X,hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},montos_en_caja:{monto_efectivo:{monto:"RETIRO"===x.tipo_movimiento?parseFloat(-1*x.cantidad):parseFloat(x.cantidad),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}},comentarios:x.comentarios},le=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"RETIRO"===x.tipo_movimiento){e.next=7;break}if(""!==A&&P&&""!==X&&$&&x.tipo_movimiento&&x.cantidad){e.next=5;break}return u({message:"Por favor complete los datos",status:"error",open:!0}),e.abrupt("return",null);case 5:e.next=10;break;case 7:if(""!==A&&P&&x.tipo_movimiento&&x.cantidad){e.next=10;break}return u({message:"Por favor complete los datos",status:"error",open:!0}),e.abrupt("return",null);case 10:return e.next=12,i({variables:{input:se,empresa:n.empresa._id,sucursal:n.sucursal._id,tipo:a}});case 12:c=e.sent,h({}),ie(),u({message:c.data.crearMovimientoCuenta.message,status:"success",open:!0}),t(!0),e.next=25;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0),u({message:e.t0.message,status:"error",open:!0}),h({}),ie();case 25:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}(),de=function(e){try{var t=e.target.value;I(t)}catch(a){}};if(ce.data)try{ne=ce.data.obtenerUsuarios}catch(je){console.log(je)}if(re.data)try{ae=re.data.obtenerCajasSucursal}catch(je){console.log(je)}return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:d,setAlert:u}),Object(H.jsx)(F.a,{onClick:ie,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"row",children:["Realizar movimiento",Object(H.jsx)(O.a,{display:"flex",alignItems:"flex-end",children:Object(H.jsx)("img",{src:Cb,alt:"icono retiro",className:o.icon})})]})}),Object(H.jsxs)(qe.a,{open:J,TransitionComponent:Ab,maxWidth:"sm",fullWidth:!0,children:[Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{textAlign:"center",p:1,children:Object(H.jsx)(L.a,{variant:"h5",children:"Movimiento en caja principal"})}),Object(H.jsxs)("div",{className:o.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:"Recibe"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",disabled:!0,value:null===n||void 0===n?void 0:n.nombre})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:"Fecha y hora"}),Object(H.jsx)(S.a,{fullWidth:!0,disabled:!0,size:"small",value:Dt()().locale("es-mx").format("D MMMM YYYY, h:mm:ss"),name:"fecha_movimiento",variant:"outlined"})]})]}),Object(H.jsxs)("div",{className:o.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"50%",children:[Object(H.jsx)(L.a,{children:"Movimiento a Realizar"}),Object(H.jsxs)(Nt.a,{className:o.formComboBox,size:"small",variant:"outlined",name:"tipo_movimiento",onChange:oe,fullWidth:!0,children:[Object(H.jsx)(Pt.a,{value:"DEPOSITO",children:"Dep\xf3sito"}),Object(H.jsx)(Pt.a,{value:"RETIRO",children:"Retiro"})]})]}),Object(H.jsxs)(O.a,{width:"50%",children:[Object(H.jsx)(L.a,{children:"Cantidad"}),Object(H.jsx)(S.a,{fullWidth:!0,onChange:oe,size:"small",InputProps:{type:"number"},name:"cantidad",variant:"outlined"})]})]}),x.tipo_movimiento?"DEPOSITO"===x.tipo_movimiento?Object(H.jsxs)("div",{children:[Object(H.jsxs)("div",{className:o.formInputFlex,children:[Object(H.jsx)(O.a,{style:{width:"50%"},children:Object(H.jsxs)(ee.a,{className:o.formControl,children:[Object(H.jsx)(te.a,{id:"concepto-label",children:"Concepto"}),Object(H.jsx)(Nt.a,{labelId:"concepto-label",id:"concepto-name",value:A||"",onChange:de,input:Object(H.jsx)(_n.a,{}),MenuProps:Sb,children:Fb.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e,children:e},t)}))})]})}),Object(H.jsx)(O.a,{style:{width:"50%"},children:Object(H.jsxs)(ee.a,{className:o.formControl,children:[Object(H.jsx)(te.a,{id:"entrega-label",children:"Qui\xe9n entrega"}),Object(H.jsx)(Nt.a,{labelId:"entrega-label",id:"entrega-name",value:P||"",onChange:function(e){try{var t=e.target.value;E(t)}catch(je){}},input:Object(H.jsx)(_n.a,{}),MenuProps:Sb,children:ne.map((function(e){return Object(H.jsx)(Pt.a,{value:e,children:e.nombre},e._id)}))})]})})]}),Object(H.jsxs)("div",{className:o.formInputFlex,children:[Object(H.jsx)(O.a,{style:{width:"50%"},children:Object(H.jsxs)(ee.a,{className:o.formControl,children:[Object(H.jsx)(te.a,{id:"origen-label",children:"Origen"}),Object(H.jsx)(Nt.a,{labelId:"origen-label",id:"origen-name",value:$||"",onChange:function(e){try{var t=e.target.value;W(t)}catch(je){}},input:Object(H.jsx)(_n.a,{}),MenuProps:Sb,children:ae.map((function(e){return Object(H.jsxs)(Pt.a,{value:e,children:["Caja ",e.principal?"principal":e.numero_caja]},e._id)}))})]})}),Object(H.jsxs)(O.a,{style:{width:"50%"},children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Fecha Movimiento :"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,type:"date",onChange:function(e){try{var t=e.target.value;Z(t)}catch(je){}},size:"small",name:"fecha_movimiento",variant:"outlined"})})]})]})]}):Object(H.jsxs)("div",{className:o.formInputFlex,children:[Object(H.jsx)(O.a,{style:{width:"50%"},children:Object(H.jsxs)(ee.a,{className:o.formControl,children:[Object(H.jsx)(te.a,{id:"concepto-label",children:"Concepto"}),Object(H.jsx)(Nt.a,{labelId:"concepto-label",id:"concepto-name",value:A||"",onChange:de,input:Object(H.jsx)(_n.a,{}),MenuProps:Sb,children:Fb.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e,children:e},t)}))})]})}),Object(H.jsx)(O.a,{style:{width:"50%"},children:Object(H.jsxs)(ee.a,{className:o.formControl,children:[Object(H.jsx)(te.a,{id:"origen-label",children:"Destino"}),Object(H.jsxs)(Nt.a,{labelId:"origen-label",id:"origen-name",value:M||"",onChange:function(e){try{var t=e.target.value;B(t)}catch(je){}},input:Object(H.jsx)(_n.a,{}),MenuProps:Sb,children:[Object(H.jsx)(Pt.a,{value:"Cuenta efectivo empresa",children:"Cuenta efectivo empresa"},"cuentaEfectivoEmpresa"),ae.map((function(e){return Object(H.jsxs)(Pt.a,{value:e,children:["Caja ",e.numero_caja]},e._id)}))]})]})})]}):Object(H.jsx)("div",{}),Object(H.jsx)("div",{className:o.formInputFlex,children:Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:"Comentarios"}),Object(H.jsx)(S.a,{className:o.input,fullWidth:!0,onChange:oe,size:"small",multiline:!0,rows:2,name:"monto_movimiento",variant:"outlined"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{color:"secondary",variant:"outlined",onClick:ie,size:"large",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"primary",variant:"outlined",onClick:le,size:"large",children:"Realizar"})]})]})]})}var kb=[{id:"fecha",label:"Fecha",minWidth:100},{id:"tipo",label:"Tipo Movimiento",minWidth:100},{id:"concepto",label:"Concepto",minWidth:150},{id:"cantidad",label:"Cantidad",minWidth:150},{id:"name",label:"Usuario",minWidth:150},{id:"movimiento",label:"Origen Movimiento",minWidth:100}],wb=Object(k.a)((function(e){return{root:{width:"100%",height:"50vh"},container:{minHeight:"40vh"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},formComboBox:{height:"50%"},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}}}));function Nb(e){e.cuenta;var t,a,n=e.tipo,c=e.reload,r=e.setSaldoCaja,i=JSON.parse(localStorage.getItem("sesionCafi"));Dt.a.locale("es");var o=wb(),s=Object(j.useState)([]),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(an.useDebounce)(d,500),p=Object(y.a)(b,1)[0],x=Object(j.useState)(0),h=Object(y.a)(x,2),_=h[0],f=h[1],v=Object(rt.b)(va,{variables:{input:{fecha_inicio:d.fecha_inicio?d.fecha_inicio:"",fecha_fin:d.fecha_fin?d.fecha_fin:"",usuario:p.usuario?p.usuario:"",tipo_movimiento:d.tipo_movimiento?d.tipo_movimiento:""},empresa:i.empresa._id,sucursal:i.sucursal._id,tipo:n,limit:10,offset:_},fetchPolicy:"network-only"}),C=v.data,A=v.loading,F=v.refetch,k=v.error,w=[];C&&(r(C.obtenerHistorialCuenta.saldo_en_caja),w=C.obtenerHistorialCuenta);var N=function(e){u(Object(m.a)(Object(m.a)({},d),{},Object(g.a)({},e.target.name,e.target.value)))};Object(j.useEffect)((function(){F()}),[F]),Object(j.useEffect)((function(){c&&F()}),[c]);return A?Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"65vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h5",children:"Cargando"})]}):k?Object(H.jsx)(bt,{error:k,altura:300}):Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{children:Object(H.jsxs)("div",{className:o.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"25%",children:[Object(H.jsx)(L.a,{children:"Fecha:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",type:"date",name:"fecha_inicio",onChange:N,variant:"outlined"})]}),Object(H.jsxs)(O.a,{width:"25%",children:[Object(H.jsx)(L.a,{children:"Tipo Movimiento:"}),Object(H.jsxs)(Nt.a,{className:o.formComboBox,size:"small",variant:"outlined",name:"tipo_movimiento",onChange:N,fullWidth:!0,children:[Object(H.jsx)(Pt.a,{value:"TODOS",children:"Ninguno"}),Object(H.jsx)(Pt.a,{value:"CUENTA_DEPOSITO",children:"Deposito"}),Object(H.jsx)(Pt.a,{value:"CUENTA_RETIRO",children:"Retiro"})]})]})]})}),Object(H.jsx)(O.a,{p:2,children:Object(H.jsxs)(fn.a,{children:[Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:kb.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:null===(t=w)||void 0===t||null===(a=t.docs)||void 0===a?void 0:a.map((function(e,t){return Object(H.jsx)(Pb,{row:e,loading:A},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:w.totalDocs,rowsPerPage:10,page:_,onPageChange:function(e,t){f(t),F({empresa:i.empresa._id,sucursal:i.sucursal._id,offset:t})}})]})})]})}function Pb(e){var t=e.row;return e.loading?Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:Object(H.jsx)(I.a,{})}):Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",handleClickOpen:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Dt()(null===t||void 0===t?void 0:t.fecha_movimiento.completa).format("D MMMM YYYY")}),Object(H.jsx)(Da.a,{children:"CUENTA_DEPOSITO"===(null===t||void 0===t?void 0:t.tipo_movimiento)||"ABONO_CLIENTE"===(null===t||void 0===t?void 0:t.tipo_movimiento)||"CANCELACION_ABONO_PROVEEDOR"===(null===t||void 0===t?void 0:t.tipo_movimiento)?"DEPOSITO":"RETIRO"}),Object(H.jsx)(Da.a,{children:null===t||void 0===t?void 0:t.concepto}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{style:{fontSize:17},children:["$",Ua(t.montos_en_caja.monto_efectivo.monto)]})}),Object(H.jsx)(Da.a,{children:null===t||void 0===t?void 0:t.nombre_usuario_creador}),Object(H.jsxs)(Da.a,{children:["Caja ",""!==t.numero_caja?t.numero_caja:""]})]})}var Eb=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},buttons:{"& > *":{margin:"0px ".concat(e.spacing(1),"px")}}}})),Db=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function zb(){var e=Eb(),t=u.a.useState(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){return c(!n)},i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(0),b=Object(y.a)(d,2),p=b[0],m=b[1];return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:r,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Cb,alt:"icono retiro",className:e.icon})}),"Caja principal"]})}),Object(H.jsxs)(qe.a,{open:n,TransitionComponent:Db,maxWidth:"lg",fullWidth:!0,children:[Object(H.jsxs)(O.a,{m:1,display:"flex",children:[Object(H.jsx)(O.a,{width:"100%",children:Object(H.jsx)(L.a,{variant:"h5",children:"Caja principal"})}),Object(H.jsx)(F.a,{variant:"contained",display:"flex",justifyContent:"flex-end",color:"secondary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{})})]}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(O.a,{display:"flex",mt:2,children:[Object(H.jsxs)(O.a,{display:"flex",width:"80%",children:[Object(H.jsx)(L.a,{variant:"h5",children:"Efectivo actual"}),Object(H.jsx)(O.a,{ml:2,children:Object(H.jsxs)(L.a,{variant:"h5",children:["$",p]})})]}),Object(H.jsx)(O.a,{children:Object(H.jsx)(Ib,{tipo:!1,setReload:l})})]}),Object(H.jsx)(O.a,{children:Object(H.jsx)(Nb,{tipo:!1,reload:s,setSaldoCaja:m})})]})]})]})}var Tb,$b,Wb,Rb,Vb,Mb,Lb,Bb=[{id:"cantidad",label:"Cantidad",minWidth:80},{id:"cantidadR",label:"Cant. Regalo",minWidth:80},{id:"nombre",label:"Producto",minWidth:80},{id:"precio",label:"Precio",minWidth:80},{id:"total",label:"Total",minWidth:80}],Ub=Object(k.a)((function(e){return{root:{width:"100%",height:"45vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function qb(e){var t=e.productos,a=Ub();return Object(H.jsx)(fn.a,{className:a.root,children:Object(H.jsx)(Na.a,{className:a.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:Bb.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:e.cantidad}),Object(H.jsx)(Da.a,{children:e.cantidad_regalo}),Object(H.jsx)(Da.a,{children:e.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{children:e.costo}),Object(H.jsx)(Da.a,{children:e.total})]},t)}))})]})})})}var Jb=Object(P.d)(Tb||(Tb=Object(N.a)(["\n  query obtenerAbonosProveedores(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtro: String\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerAbonosProveedores(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtro: $filtro\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n      _id\n      estatus_credito\n      usuario {\n        _id\n        numero_usuario\n        nombre\n        estado_usuario\n      }\n      empresa {\n        _id\n        nombre_empresa\n      }\n      sucursal {\n        _id\n        nombre_sucursal\n      }\n      proveedor {\n        id_proveedor {\n          _id\n          numero_cliente\n          clave_cliente\n          nombre_cliente\n          telefono\n          email\n        }\n        numero_cliente\n        clave_cliente\n        nombre_cliente\n      }\n      productos {\n        _id\n        id_compra\n        id_traspaso\n        id_producto\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            granel\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              unidad_mayoreo\n              utilidad\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n          }\n          unidades_de_venta {\n            _id\n            cantidad\n            codigo_barras\n            id_producto\n            precio\n            unidad\n            unidad_principal\n          }\n        }\n        concepto\n        cantidad\n        cantidad_regalo\n        cantidad_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        unidad\n        id_unidad_venta\n        empresa\n        sucursal\n        usuario\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n      }\n      status\n      almacen {\n        id_almacen {\n          _id\n          nombre_almacen\n          id_usuario_encargado {\n            _id\n            numero_usuario\n            nombre\n          }\n        }\n        nombre_almacen\n      }\n      compra_credito\n      credito_pagado\n      saldo_credito_pendiente\n      fecha_vencimiento_credito\n      subtotal\n      impuestos\n      total\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n      folio\n    }\n    totalDocs\n    }\n  }\n"]))),Hb=Object(P.d)($b||($b=Object(N.a)(["\n  query ObtenerHistorialAbonos(\n    $empresa: ID!\n    $sucursal: ID!\n    $input: ObtenerHistorialAbonosInput,\n  ) {\n    obtenerHistorialAbonos(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n    ) {\n      _id\n      numero_caja\n      id_Caja\n      horario_turno\n      tipo_movimiento\n      rol_movimiento\n      fecha_movimiento {\n        completa\n      }\n      numero_usuario_creador\n      status\n      nombre_usuario_creador\n      monto_total_abonado\n      numero_cliente\n      nombre_cliente\n      telefono_cliente\n      email_cliente\n      montos_en_caja {\n        monto_efectivo {\n          monto\n        }\n        monto_tarjeta_credito {\n          monto\n        }\n        monto_tarjeta_debito {\n          monto\n        }\n        monto_creditos {\n          monto\n        }\n        monto_monedero {\n          monto\n        }\n        monto_transferencia {\n          monto\n        }\n        monto_cheques {\n          monto\n        }\n        monto_vales_despensa {\n          monto\n        }\n      }\n    }\n  }\n"]))),Gb=Object(P.d)(Wb||(Wb=Object(N.a)(["\n  query historialVentasACredito(\n    $empresa: ID!\n    $sucursal: ID!\n    $idCliente: ID\n    $limit: Int\n    $offset: Int\n  ) {\n    historialVentasACredito(\n      empresa: $empresa\n      sucursal: $sucursal\n      idCliente: $idCliente\n      limit: $limit\n      offset:  $offset\n    ) {\n      docs {  \n        _id\n        folio\n        facturacion\n        estatus_credito\n        cliente {\n          _id\n          numero_cliente\n          clave_cliente\n          representante\n          nombre_cliente\n          rfc\n          curp\n          telefono\n          celular\n          email\n          numero_descuento\n          limite_credito\n          dias_credito\n          razon_social\n          direccion {\n            calle\n            no_ext\n            no_int\n            codigo_postal\n            colonia\n            municipio\n            localidad\n            estado\n            pais\n          }\n          imagen\n          estado_cliente\n          tipo_cliente\n          eliminado\n          banco\n          numero_cuenta\n          monedero_electronico\n          credito_disponible\n          empresa {\n            _id\n          }\n          sucursal {\n            _id\n          }\n        }\n        descuento\n        ieps\n        impuestos\n        iva\n        monedero\n        subTotal\n        total\n        venta_cliente\n        credito\n        descuento_general_activo\n        id_caja {\n          _id\n          numero_caja\n          activa\n        }\n        fecha_de_vencimiento_credito\n        dias_de_credito_venta\n        saldo_credito_pendiente\n        credito_pagado\n        empresa\n        sucursal\n        usuario {\n          _id\n          numero_usuario\n          nombre\n        }\n        productos {\n          _id\n          producto {\n            _id\n            datos_generales {\n              codigo_barras\n              clave_alterna\n              tipo_producto\n              nombre_comercial\n              nombre_generico\n              descripcion\n              id_categoria\n              categoria\n              subcategoria\n              id_subcategoria\n              id_departamento\n              departamento\n              id_marca\n              marca\n              clave_producto_sat {\n                Name\n                Value\n              }\n              receta_farmacia\n            }\n            precios {\n              ieps\n              ieps_activo\n              inventario {\n                inventario_minimo\n                inventario_maximo\n                unidad_de_inventario\n                codigo_unidad\n              }\n              iva\n              iva_activo\n              monedero\n              monedero_electronico\n              precio_de_compra {\n                precio_con_impuesto\n                precio_sin_impuesto\n                iva\n                ieps\n              }\n              precios_producto {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n              unidad_de_compra {\n                cantidad\n                precio_unitario_con_impuesto\n                precio_unitario_sin_impuesto\n                unidad\n                codigo_unidad\n              }\n              granel\n              litros\n            }\n            imagenes {\n              url_imagen\n              location_imagen\n              key_imagen\n              extencion_imagen\n            }\n            centro_de_costos {\n              cuenta\n              id_cuenta\n              id_subcuenta\n              subcuenta\n            }\n            precio_plazos {\n              precio_cajas {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n              precio_costales {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n              precio_piezas {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n            }\n            unidades_de_venta {\n              _id\n              precio\n              cantidad\n              concepto\n              unidad\n              codigo_unidad\n              unidad_principal\n              codigo_barras\n              codigo_barras\n              id_producto\n              empresa\n              sucursal\n              descuento {\n                cantidad_unidad\n                numero_precio\n                unidad_maxima\n                precio_general\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                utilidad\n                porciento\n                dinero_descontado\n              }\n              descuento_activo\n              default\n              precio_unidad {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n            }\n            inventario_general {\n              _id\n              cantidad_existente\n              unidad_inventario\n              codigo_unidad\n              cantidad_existente_maxima\n              unidad_maxima\n              id_almacen_general\n              eliminado\n            }\n            medidas_producto {\n              _id\n              cantidad\n              cantidad_nueva\n              almacen\n              codigo_barras\n              color {\n                hex\n                nombre\n                _id\n              }\n              descuento {\n                cantidad_unidad\n                numero_precio\n                unidad_maxima\n                precio_general\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                utilidad\n                porciento\n                dinero_descontado\n              }\n              descuento_activo\n              existencia\n              medida {\n                talla\n                tipo\n                _id\n              }\n              nombre_comercial\n              precio\n              precio_unidad {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n            }\n            empresa\n            sucursal\n          }\n          concepto\n          cantidad\n          iva_total\n          ieps_total\n          subtotal\n          impuestos\n          total\n          medida {\n            id_medida\n            medida\n            tipo\n          }\n          color {\n            id_color\n            color\n            hex\n          }\n          cantidad_venta\n          granel_producto {\n            granel\n            valor\n          }\n          precio\n          precio_a_vender\n          precio_actual_producto\n          default\n          unidad\n          codigo_unidad\n          id_unidad_venta {\n            _id\n            precio\n            cantidad\n            concepto\n            unidad\n            codigo_unidad\n            unidad_principal\n            unidad_activa\n            codigo_barras\n            id_producto\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          inventario_general {\n            _id\n            cantidad_existente\n            unidad_inventario\n            codigo_unidad\n            cantidad_existente_maxima\n            unidad_maxima\n            id_almacen_general\n            eliminado\n          }\n          year_registro\n          fecha_registro\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          precio_actual_object {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            unidad_mayoreo\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n        }\n        fecha_registro\n        factura {\n          id_cfdi\n          serie\n          currency\n          expedition_place\n          folio\n          cfdi_type\n          payment_form\n          payment_method\n          logo_url\n          date\n          issuer {\n            FiscalRegime\n            Rfc\n            TaxName\n          }\n          receiver {\n            Rfc\n            Name\n            CfdiUse\n          }\n          items {\n            ProductCode\n            IdentificationNumber\n            Description\n            Unit\n            UnitCode\n            UnitPrice\n            Quantity\n            Subtotal\n            Discount\n            Taxes {\n              Total\n              Name\n              Base\n              Rate\n              IsRetention\n            }\n            Total\n          }\n          original_string\n          sub_total\n          total\n          discount\n          fecha_registro\n          empresa\n          sucursal\n        }\n        montos_en_caja {\n          monto_efectivo {\n            monto\n            metodo_pago\n          }\n          monto_tarjeta_debito {\n            monto\n            metodo_pago\n          }\n          monto_tarjeta_credito {\n            monto\n            metodo_pago\n          }\n          monto_creditos {\n            monto\n            metodo_pago\n          }\n          monto_monedero {\n            monto\n            metodo_pago\n          }\n          monto_transferencia {\n            monto\n            metodo_pago\n          }\n          monto_cheques {\n            monto\n            metodo_pago\n          }\n          monto_vales_despensa {\n            monto\n            metodo_pago\n          }\n        }\n        status\n        abonos {\n          _id\n          numero_caja\n          status\n          id_Caja\n          horario_turno\n          tipo_movimiento\n          rol_movimiento\n          fecha_movimiento {\n            completa\n          }\n          numero_usuario_creador\n          nombre_usuario_creador\n          monto_total_abonado\n          numero_cliente\n          nombre_cliente\n          telefono_cliente\n          email_cliente\n          montos_en_caja {\n            monto_efectivo {\n              monto\n            }\n            monto_tarjeta_credito {\n              monto\n            }\n            monto_tarjeta_debito {\n              monto\n            }\n            monto_creditos {\n              monto\n            }\n            monto_monedero {\n              monto\n            }\n            monto_transferencia {\n              monto\n            }\n            monto_cheques {\n              monto\n            }\n            monto_vales_despensa {\n              monto\n            }\n          }\n          \n        }\n      }\n      totalDocs   \n    }\n  }\n"]))),Yb=Object(P.d)(Rb||(Rb=Object(N.a)(["\n  mutation CrearAbono($empresa: ID!, $sucursal: ID!, $input: CrearAbonoInput) {\n    crearAbono(empresa: $empresa, sucursal: $sucursal, input: $input) {\n      message\n    }\n  }\n"]))),Qb=Object(P.d)(Vb||(Vb=Object(N.a)(["\n  mutation crearAbonoVentaCredito($empresa: ID!, $sucursal: ID!, $input: AbonoVentasCreditoInput) {\n    crearAbonoVentaCredito(empresa: $empresa, sucursal: $sucursal, input: $input) {\n      message\n      pdf\n      xml\n      success\n    }\n  }\n"]))),Kb=Object(P.d)(Mb||(Mb=Object(N.a)(["\n  mutation cancelarAbonoCliente($empresa: ID!, $sucursal: ID!, $input: CancelarAbonoInput) {\n    cancelarAbonoCliente(empresa: $empresa, sucursal: $sucursal, input: $input) {\n      message\n    }\n  }\n"]))),Xb=Object(P.d)(Lb||(Lb=Object(N.a)(["\n  mutation cancelarAbonoProveedor($empresa: ID!, $sucursal: ID!, $input: CancelarAbonoProveedorInput) {\n    cancelarAbonoProveedor(empresa: $empresa, sucursal: $sucursal, input: $input) {\n      message\n    }\n  }\n"]))),Zb=a(476),ep=a.n(Zb),tp=a(131),ap=a.n(tp),np=a(121),cp=a.n(np),rp=a(44),ip=a.n(rp);var op=Object(f.f)((function(e){return Object(H.jsx)(j.Fragment,{children:Object(H.jsx)(Qe.a,{children:Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)(ap.a,{element:Object(H.jsx)(F.a,{variant:"contained",color:"primary",startIcon:Object(H.jsx)(ep.a,{}),children:"Exportar a Excel"}),filename:e.fileName,children:Object(H.jsx)(cp.a,{data:e.data,name:e.fileName,children:e.columnName.map((function(e){return Object(H.jsx)(ip.a,{label:e.label,value:e.id},e.id)}))})})})})})})),sp=[{id:"fecha",label:"Fecha de abono",minWidth:170,align:"center"},{id:"cliente",label:"Nombre",minWidth:170,align:"center"},{id:"abono",label:"Monto",minWidth:100,align:"right"},{id:"cancelar",label:"Cancelar",minWidth:100,align:"center"}],lp=[{id:"fecha_movimiento",label:"Fecha",minWidth:60,widthPx:160},{id:"monto_total_abonado",label:"Cantidad abono",minWidth:170,widthPx:160},{id:"estado",label:"Estado",minWidth:170,widthPx:160}],dp=Object(k.a)((function(e){return{root:{width:"100%",height:"45vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}})),jp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));var up=Object(f.f)((function(e){var t,a,n=JSON.parse(localStorage.getItem("turnoEnCurso")),c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(j.useContext)(gb),i=r.reload,o=r.setReload,s=r.setAlert,l=dp(),d=Object(j.useState)({}),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),x=Object(y.a)(m,2),h=x[0],_=x[1],f=Object(j.useState)(!1),g=Object(y.a)(f,2),A=g[0],S=g[1],k=Object(w.a)(Xb),N=Object(y.a)(k,1)[0],P=[],E=Object(rt.b)(Hb,{variables:{empresa:c.empresa._id,sucursal:c.sucursal._id,input:{fecha_inicio:"",fecha_fin:"",usuario:"",id_cliente:e.cuenta.proveedor.id_proveedor._id,id_egreso:"",rol_movimiento:"ABONO_PROVEEDOR",id_compra:e.cuenta._id}},fetchPolicy:"network-only"}),D=E.data,z=E.refetch,T=[];D&&(T=D.obtenerHistorialAbonos).forEach((function(e){P.push({fecha_movimiento:La(e.fecha_movimiento.completa),monto_total_abonado:e.monto_total_abonado,estado:e.status})})),Object(j.useEffect)((function(){z()}),[i]);var $=function(){_(!_)},W=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var a;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,S(!0),a={tipo_movimiento:"CANCELACION_ABONO_PROVEEDOR",rol_movimiento:n?"CAJA":"CAJA_PRINCIPAL",numero_caja:n?parseInt(n.numero_caja):0,id_Caja:n?n.id_caja:"",fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},monto_abono:b.monto_total_abonado,horario_turno:n?n.horario_en_turno:"",hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},concepto:"CANCELACION_ABONO_PROVEEDOR",id_usuario:c._id,numero_usuario_creador:c.numero_usuario,nombre_usuario_creador:c.nombre,id_proveedor:e.proveedor.id_proveedor._id,clave_proveedor:e.proveedor.id_proveedor.clave_cliente,nombre_proveedor:e.proveedor.id_proveedor.nombre_cliente,telefono_proveedor:e.proveedor.id_proveedor.telefono_cliente,email_proveedor:e.proveedor.id_proveedor.email_cliente,id_abono:b._id,id_compra:e.cuenta._id,metodo_de_pago:"01",caja_principal:c.accesos.tesoreria.caja_principal.ver},t.next=5,N({variables:{empresa:c.empresa._id,sucursal:c.sucursal._id,input:a}});case 5:o(!0),_(!1),S(!1),$(),s({message:"Abono cancelado con \xe9xito.",status:"success",open:!0}),t.next=19;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),t.t0.networkError?console.log(t.t0.networkError.result):t.t0.graphQLErrors&&console.log(t.t0.graphQLErrors),S(!1),$(),s({message:"La cancelaci\xf3n ha fallado.",status:"success",open:!0});case 19:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(){return t.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsxs)(fn.a,{className:l.root,children:[Object(H.jsxs)(qe.a,{open:h,TransitionComponent:jp,keepMounted:!0,onClose:function(){return $()},"aria-labelledby":"alert-eliminar-abono",children:[Object(H.jsx)(Bt.a,{id:"alert-eliminar-abono",children:"\xbfEst\xe1 seguro de eliminar este abono?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return $()},color:"inherit",disabled:A,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return W()},color:"secondary",disabled:A,startIcon:A?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]}),Object(H.jsx)(Na.a,{className:l.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:sp.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:null===(t=T)||void 0===t?void 0:t.map((function(t,a){return Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:Dt()(t.fecha_movimiento.completa).format("D MMMM YYYY")}),Object(H.jsx)(Da.a,{align:"center",children:t.nombre_cliente}),Object(H.jsx)(Da.a,{align:"right",children:Object(H.jsxs)("b",{children:["$",t.monto_total_abonado]})}),"CANCELADO"===t.status?Object(H.jsx)(Da.a,{children:t.status}):Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(F.a,{variant:"text",color:"primary",onClick:function(){return function(t){try{n||c.accesos.tesoreria.caja_principal.ver?(_(!0),p(t)):e.history.push("/ventas/venta-general")}catch(a){console.log(a)}}(t)},size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:22}})})})]},a)}))})]})})]}),(null===(a=T)||void 0===a?void 0:a.length)>0?Object(H.jsx)(O.a,{m:1,mb:1,mrstyle:{backgroundColor:"red",alignContent:"flex-end"},justifyContent:"flex-end",children:Object(H.jsx)(O.a,{children:Object(H.jsx)(op,{fileName:"Historial Abonos",data:P,columnName:lp})})}):Object(H.jsx)("div",{})]})})),bp=a(477),pp=a.n(bp),mp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Op=Object(k.a)((function(e){return{input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"}}}));var xp=Object(f.f)((function(e){var t=Object(w.a)(Yb),a=Object(y.a)(t,1)[0],n=Object(j.useContext)(gb),c=n.setReload,r=n.setAlert,i=JSON.parse(localStorage.getItem("sesionCafi")),o=Op(),s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],x=p[1],h=Object(j.useState)(""),_=Object(y.a)(h,2),f=_[0],g=_[1],A=Object(j.useState)(""),I=Object(y.a)(A,2),k=I[0],N=I[1],P=JSON.parse(localStorage.getItem("turnoEnCurso")),E=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var n;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(x(!0),t.prev=1,n={tipo_movimiento:"ABONO_PROVEEDOR",rol_movimiento:P?"CAJA":"CAJA_PRINCIPAL",horario_turno:P?P.horario_en_turno:"",hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},monto_total_abonado:parseFloat(f),montos_en_caja:{monto_efectivo:{monto:"01"===k?parseFloat(-1*f):0,metodo_pago:"01"},monto_tarjeta_debito:{monto:"28"===k?parseFloat(-1*f):0,metodo_pago:"28"},monto_tarjeta_credito:{monto:"04"===k?parseFloat(-1*f):0,metodo_pago:"04"},monto_creditos:{monto:"99"===k?parseFloat(-1*f):0,metodo_pago:"99"},monto_monedero:{monto:"05"===k?parseFloat(-1*f):0,metodo_pago:"05"},monto_transferencia:{monto:"03"===k?parseFloat(-1*f):0,metodo_pago:"03"},monto_cheques:{monto:"02"===k?parseFloat(-1*f):0,metodo_pago:"02"},monto_vales_despensa:{monto:"08"===k?parseFloat(-1*f):0,metodo_pago:"08"}},metodo_de_pago:{clave:k.Value,metodo:k.Name},numero_caja:P?parseInt(P.numero_caja):0,id_Caja:P?P.id_caja:"",id_usuario:i._id,concepto:"ABONO_PROVEEDOR",numero_usuario_creador:i.numero_usuario,nombre_usuario_creador:i.nombre,id_cliente:e.cuenta.proveedor.id_proveedor._id,numero_cliente:e.cuenta.proveedor.numero_cliente,nombre_cliente:e.cuenta.proveedor.nombre_cliente,telefono_cliente:e.cuenta.proveedor.id_proveedor.telefono,email_cliente:e.cuenta.proveedor.id_proveedor.email,caja_principal:i.accesos.tesoreria.caja_principal.ver,id_compra:e.cuenta._id},""!==f&&""!==k){t.next=7;break}return r({message:"Por favor complete los datos.",status:"error",open:!0}),x(!1),t.abrupt("return");case 7:return t.next=9,a({variables:{empresa:i.empresa._id,sucursal:i.sucursal._id,input:n}});case 9:c(!0),g(""),N(""),r({message:"Abono registrado con \xe9xito",status:"success",open:!0}),D(),x(!1),t.next=24;break;case 17:t.prev=17,t.t0=t.catch(1),D(),x(!1),t.t0.networkError?console.log(t.t0.networkError.result):t.t0.graphQLErrors&&console.log(t.t0.graphQLErrors),console.log(t.t0),r({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 24:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(){return t.apply(this,arguments)}}(),D=function(){P||i.accesos.tesoreria.caja_principal.ver?(c(!0),u(!d)):e.history.push("/ventas/venta-general")};return Object(H.jsxs)(j.Fragment,{children:[e.cuenta.credito_pagado?Object(H.jsx)("div",{}):Object(H.jsx)(F.a,{size:"large",variant:"outlined",fullWidth:!0,color:"primary",startIcon:Object(H.jsx)(pp.a,{style:{fontSize:35}}),onClick:D,children:Object(H.jsx)(L.a,{variant:"h6",children:"Abonar"})}),Object(H.jsxs)(qe.a,{open:d,TransitionComponent:mp,keepMounted:!0,onClose:D,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(st,{loading:m,setLoading:x}),Object(H.jsx)(Bt.a,{id:"alert-dialog-slide-title",children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{p:1,flexGrow:1,children:"Registrar nuevo abono"}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:D,size:"large",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Cantidad a abonar:"})}),Object(H.jsx)(S.a,{fullWidth:!0,className:o.input,onChange:function(e){return g(e.target.value)},value:f,size:"small",name:"abono_recibir",variant:"outlined",type:"number"})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Metodo de pago:"})}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{width:"100%",name:"metodo_pago",variant:"outlined",value:k||"",onChange:function(e){return N(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:e.Name},t)}))]})})]}),Object(H.jsxs)(O.a,{mt:2,display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Total de la cuenta"})}),Object(H.jsx)(L.a,{style:{color:"#9B9B9B"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.cuenta.total)]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Total pagado"})}),Object(H.jsx)(L.a,{style:{color:"green"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.cuenta.total-e.cuenta.saldo_credito_pendiente)]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Total restante"})}),Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.cuenta.saldo_credito_pendiente)]})})]}),Object(H.jsx)(et.a,{}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Nuevo abono"})}),Object(H.jsx)(L.a,{style:{color:"green"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(f)," "]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Nuevo total pagado"})}),Object(H.jsx)(L.a,{style:{color:"green"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.cuenta.total-e.cuenta.saldo_credito_pendiente+f)]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Nuevo restante total"})}),Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.cuenta.saldo_credito_pendiente-f)]})})]})]}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignContent:"center",p:2,children:Object(H.jsx)(F.a,{size:"large",variant:"contained",color:"primary",style:{fontSize:18},onClick:E,children:"Registrar Abono"})})]})]})})),hp=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}}}));function _p(e){var t=JSON.parse(localStorage.getItem("sesionCafi")),a=hp();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Re.a,{className:a.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:a.title,children:"Detalles de cuenta"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:e.handleClick,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsxs)("div",{className:a.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"100%",p:1,children:[Object(H.jsxs)(O.a,{width:"100%",display:"flex",p:.5,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Nombre de proveedor: "})," "]}),Object(H.jsx)(L.a,{style:{paddingLeft:5},children:e.cuenta.proveedor.id_proveedor.nombre_cliente})]}),Object(H.jsxs)(O.a,{width:"100%",display:"flex",p:.5,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Clave proveedor: "})," "]}),Object(H.jsx)(L.a,{style:{paddingLeft:5},children:e.cuenta.proveedor.id_proveedor.clave_cliente})]})]}),Object(H.jsxs)(O.a,{width:"100%",p:1,children:[Object(H.jsxs)(O.a,{width:"100%",display:"flex",p:.5,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Nombre de usuario: "})," "]}),Object(H.jsx)(L.a,{style:{paddingLeft:5},children:e.cuenta.usuario.nombre})]}),Object(H.jsxs)(O.a,{width:"100%",display:"flex",p:.5,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Numero usuario: "})," "]}),Object(H.jsx)(L.a,{style:{paddingLeft:5},children:e.cuenta.usuario.numero_usuario})]})]}),Object(H.jsxs)(O.a,{width:"100%",p:1,children:[Object(H.jsxs)(O.a,{width:"100%",display:"flex",p:.5,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Folio de compra: "})," "]}),Object(H.jsx)(L.a,{style:{paddingLeft:5},children:e.cuenta.folio})]}),Object(H.jsxs)(O.a,{width:"100%",display:"flex",p:.5,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Fecha compra: "})," "]}),Object(H.jsx)(L.a,{style:{paddingLeft:5},children:Dt()(e.cuenta.fecha_registro).format("D MMMM YYYY")})]}),Object(H.jsxs)(O.a,{width:"100%",display:"flex",p:.5,children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Fecha vencimiento: "})," "]}),Object(H.jsx)(L.a,{style:{paddingLeft:5},children:Dt()(e.cuenta.fecha_vencimiento_credito).format("D MMMM YYYY")})]})]}),!1===t.accesos.tesoreria.abonos_proveedores.agregar?null:Object(H.jsx)(O.a,{width:"60%",p:1,display:"flex",alignItems:"center",children:Object(H.jsx)(xp,{cuenta:e.cuenta})})]}),Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsxs)(Qe.a,{item:!0,lg:6,xs:12,children:[Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(L.a,{variant:"h6",children:"Lista de abonos"})}),Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(up,{cuenta:e.cuenta,proveedor:e.cuenta.proveedor,recargar:e.recargar})}),Object(H.jsx)(O.a,{p:0,mr:3,display:"flex",justifyContent:"flex-end",children:Object(H.jsxs)(L.a,{variant:"h6",children:["Total abonado: ",Object(H.jsxs)("b",{style:{color:"#9B9B9B"},children:["$",e.cuenta.total-e.cuenta.saldo_credito_pendiente]})]})}),Object(H.jsx)(O.a,{p:0,mr:3,display:"flex",justifyContent:"flex-end",children:Object(H.jsxs)(L.a,{variant:"h6",children:["Restante: ",Object(H.jsxs)("b",{style:{color:"green"},children:["$",Ua(e.cuenta.saldo_credito_pendiente)]})]})})]}),Object(H.jsxs)(Qe.a,{item:!0,lg:6,xs:12,children:[Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(L.a,{variant:"h6",children:"Lista de compra"})}),Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(qb,{productos:e.cuenta.productos})}),Object(H.jsx)(O.a,{p:1,mr:3,display:"flex",justifyContent:"flex-end",children:Object(H.jsxs)(L.a,{variant:"h6",children:["Total a liquidar: ",Object(H.jsxs)("b",{style:{color:"red"},children:["$",Ua(e.cuenta.total)]})]})})]})]})]})}var fp=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},appBar:{position:"relative"}}}));var gp=Object(f.f)((function(e){var t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(j.useContext)(gb),n=a.setAlert,c=a.setReload,r=JSON.parse(localStorage.getItem("turnoEnCurso")),i=Object(w.a)(Yb),o=Object(y.a)(i,1)[0],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(0),p=Object(y.a)(b,2),m=p[0],x=p[1],h=Object(j.useState)(0),_=Object(y.a)(h,2),f=_[0],g=_[1],A=Object(j.useState)(0),I=Object(y.a)(A,2),k=I[0],N=I[1],P=Object(j.useState)(!1),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(j.useState)(""),$=Object(y.a)(T,2),W=$[0],R=$[1],V=function(){r||t.accesos.tesoreria.caja_principal.ver?(u(!d),g(0),N(0),x(0)):e.history.push("/ventas/venta-general")},M=fp(),B=function(){var a=Object(C.a)(Object(v.a)().mark((function a(){var i;return Object(v.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(z(!0),a.prev=1,i={tipo_movimiento:"ABONO_PROVEEDOR",rol_movimiento:r?"CAJA":"CAJA_PRINCIPAL",horario_turno:r?r.horario_en_turno:"",hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},concepto:"ABONO_PROVEEDOR",monto_total_abonado:parseFloat(e.cuenta.saldo_credito_pendiente),descuento:{porciento_descuento:m,dinero_descontado:k,total_con_descuento:f},montos_en_caja:{monto_efectivo:{monto:"01"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-1*e.cuentaTotalDescuento):0,metodo_pago:"01"},monto_tarjeta_debito:{monto:"28"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-1*e.cuentaTotalDescuento):0,metodo_pago:"28"},monto_tarjeta_credito:{monto:"04"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-1*e.cuentaTotalDescuento):0,metodo_pago:"04"},monto_creditos:{monto:"99"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-1*f):0,metodo_pago:"99"},monto_monedero:{monto:"05"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-1*f):0,metodo_pago:"05"},monto_transferencia:{monto:"03"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-14*e.cuentaTotalDescuento):0,metodo_pago:"03"},monto_cheques:{monto:"02"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-1*e.cuentaTotalDescuento):0,metodo_pago:"02"},monto_vales_despensa:{monto:"08"===W?parseFloat(0===f?-1*e.cuenta.saldo_credito_pendiente:-1*e.cuentaTotalDescuento):0,metodo_pago:"08"}},metodo_de_pago:{clave:"",metodo:""},numero_caja:r?parseInt(r.numero_caja):0,id_Caja:r?r.id_caja:"",numero_usuario_creador:t.numero_usuario,nombre_usuario_creador:t.nombre,id_cliente:e.cuenta.proveedor.id_proveedor._id,numero_cliente:e.cuenta.proveedor.numero_cliente,nombre_cliente:e.cuenta.proveedor.nombre_cliente,telefono_cliente:e.cuenta.proveedor.id_proveedor.telefono,email_cliente:e.cuenta.proveedor.id_proveedor.email,id_compra:e.cuenta._id,caja_principal:t.accesos.tesoreria.caja_principal.ver},""!==W){a.next=7;break}return n({message:"Por favor complete el metodo de pago",status:"error",open:!0}),z(!1),a.abrupt("return");case 7:return a.next=9,o({variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:i}});case 9:c(!0),R(""),n({message:"Cuenta liquidada",status:"success",open:!0}),V(),z(!1),a.next=21;break;case 16:a.prev=16,a.t0=a.catch(1),V(),z(!1),n({message:"Ocurrio un problema en el servidor",status:"error",open:!0});case 21:case"end":return a.stop()}}),a,null,[[1,16]])})));return function(){return a.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{size:"small",variant:"outlined",color:"primary",startIcon:Object(H.jsx)(hn.a,{}),onClick:V,children:"Liquidar"}),Object(H.jsxs)(qe.a,{open:d,fullWidth:!0,maxWidth:"xs",onClose:V,"aria-labelledby":"draggable-dialog-title",children:[Object(H.jsx)(st,{loading:D,setLoading:z}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{flexGrow:1,p:2,children:Object(H.jsx)(L.a,{variant:"h6",className:M.title,children:"Liquidar Cuenta"})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:V,size:"large",children:Object(H.jsx)(Ye.a,{})})})]}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(L.a,{children:"Aplica un descuento por pronto pago a tu cuenta"}),Object(H.jsx)(O.a,{mt:1,textAlign:"center",children:Object(H.jsx)(L.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(H.jsx)("b",{children:"Porcentaje de descuento"})})}),Object(H.jsx)(O.a,{ml:1,mr:1,mb:2,children:Object(H.jsx)(ld.a,{getAriaValueText:function(e){return"".concat(e)},valueLabelFormat:m.toFixed(2),"aria-labelledby":"discrete-slider-small-steps",valueLabelDisplay:"auto",onChange:function(t,a){x(a);var n=parseFloat((100-a).toFixed(2)),c=parseFloat((e.cuenta.saldo_credito_pendiente*n/100).toFixed(2)),r=parseFloat((e.cuenta.saldo_credito_pendiente-c).toFixed(2));g(c),N(r)}})}),Object(H.jsxs)(O.a,{width:"100%",textAlign:"center",children:[Object(H.jsx)(L.a,{id:"discrete-slider-always",gutterBottom:!0,children:Object(H.jsx)("b",{children:"Cantidad a pagar con descuento"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"descuento",variant:"outlined",value:f||0,onChange:function(t){var a=parseFloat(t.target.value),n=parseFloat((100*a/e.cuenta.saldo_credito_pendiente).toFixed(2)),c=parseFloat((e.cuenta.saldo_credito_pendiente-a).toFixed(2));g(a),N(c),x(n)}})]}),Object(H.jsxs)(O.a,{width:"100%",mt:2,textAlign:"center",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Metodo de pago:"})}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{width:"100%",name:"metodo_pago",variant:"outlined",onChange:function(e){return R(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:e.Name},t)}))]})})]}),Object(H.jsxs)(O.a,{display:"flex",mt:2,children:[Object(H.jsx)(O.a,{flexGrow:1,children:Object(H.jsx)(L.a,{children:"Total cuenta: "})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.cuenta.total)]})})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{flexGrow:1,children:Object(H.jsx)(L.a,{children:"Saldo pendiente: "})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.cuenta.saldo_credito_pendiente)]})})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{flexGrow:1,children:Object(H.jsx)(L.a,{children:"Dinero Descontado: "})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:["$",Ua(k)]})})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{flexGrow:1,children:Object(H.jsx)(L.a,{children:"Porciento Descontado: "})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{children:Object(H.jsxs)("b",{children:[Ua(m),"%"]})})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h6",children:"Total a pagar:"})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsxs)("b",{style:{color:"green"},children:["$",Ua(0===f?e.cuenta.saldo_credito_pendiente:e.cuentaTotalDescuento)]})})})]})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:B,color:"primary",variant:"contained",size:"large",children:"Liquidar"})})]})]})})),vp=(a(111),[{id:"folio",label:"Folio",minWidth:100,align:"center"},{id:"fecha",label:"Fecha Compra",minWidth:100,align:"center"},{id:"provedor",label:"Provedor",minWidth:100,align:"center"},{id:"total",label:"Total",minWidth:100,align:"center"},{id:"abonado",label:"Abonado",minWidth:100,align:"center"},{id:"restante",label:"Restante",minWidth:100,align:"center"}]),Cp=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minHeight:"60vh"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},pagada:{backgroundColor:"#EDFFF3","&:hover":{backgroundColor:"#D8FFE5"}},vencidas:{backgroundColor:"#FFF4F4","&:hover":{backgroundColor:"#F5F5F5"}}}})),yp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Ap(e){var t,a=Object(j.useContext)(gb).cuentas,n=Cp();if(e.loading)return Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(H.jsx)(I.a,{})});return console.log(a),Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)("div",{className:n.root,children:[Object(H.jsxs)(O.a,{my:1,m:2,display:"flex",children:[Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{border:1,borderColor:"#58ff8f",bgcolor:"#EDFFF3",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"- Pagadas "})}),Object(H.jsx)(O.a,{mx:2})]}),Object(H.jsx)(O.a,{border:1,borderColor:"#FF8A8A",bgcolor:"#FFF4F4",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"- Compras vencidas "})})]}),Object(H.jsxs)(fn.a,{className:n.paper,children:[Object(H.jsx)(Na.a,{className:n.table,children:Object(H.jsxs)($a.a,{"aria-labelledby":"tableTitle",stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[vp.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)})),Object(H.jsx)(Da.a,{align:"center",style:{minWidth:100},children:"Liquidar"})]})}),Object(H.jsx)(za.a,{children:null===a||void 0===a||null===(t=a.docs)||void 0===t?void 0:t.map((function(t,a){return Object(H.jsx)(Sp,{loading:e.loading,cuentaSelect:t},a)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:null!==a&&void 0!==a&&a.totalDocs?null===a||void 0===a?void 0:a.totalDocs:0,rowsPerPage:e.limit,page:e.page,onPageChange:function(t,a){e.setPage(a)}})]})]})})}function Sp(e){var t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Cp(),o=function(){r(!c)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,onClick:function(e){return function(e){try{clearTimeout(void 0),2===e.detail&&o()}catch(t){}}(e)},className:"PAGADA"===e.cuentaSelect.estatus_credito?i.pagada:"VENCIDA"===e.cuentaSelect.estatus_credito?i.vencidas:i.vencer,children:[Object(H.jsx)(Da.a,{align:"center",children:e.cuentaSelect.folio?e.cuentaSelect.folio:"SIN FOLIO"}),Object(H.jsx)(Da.a,{align:"center",children:Dt()(e.cuentaSelect.fecha_registro).format("D MMMM YYYY")}),Object(H.jsx)(Da.a,{align:"center",children:e.cuentaSelect.proveedor.id_proveedor.nombre_cliente}),Object(H.jsxs)(Da.a,{align:"center",children:["$",Ua(e.cuentaSelect.total)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",Ua(e.cuentaSelect.total-e.cuentaSelect.saldo_credito_pendiente)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",Ua(e.cuentaSelect.saldo_credito_pendiente)]}),!1===t.accesos.tesoreria.abonos_proveedores.editar?Object(H.jsx)(Da.a,{align:"center"}):Object(H.jsx)(Da.a,{align:"center",children:e.cuentaSelect.credito_pagado?Object(H.jsx)("div",{}):Object(H.jsx)(gp,{cuenta:e.cuentaSelect})})]}),Object(H.jsx)(qe.a,{fullScreen:!0,open:c,onClose:o,TransitionComponent:yp,children:Object(H.jsx)(_p,{cuenta:e.cuentaSelect,loading:e.loading,handleClick:o,recargar:e.refetch})})]})}var Fp=a.p+"static/media/salary.50f75166.svg",Ip=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},rootSearch:{display:"flex",paddingLeft:e.spacing(2)}}})),kp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function wp(e){var t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(j.useContext)(gb),n=a.reload,c=a.setReload,r=a.setCuentas,i=Ip(),o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(""),b=Object(y.a)(u,2),p=b[0],m=b[1],x=Object(j.useRef)(null),h=Object(j.useState)(0),_=Object(y.a)(h,2),f=_[0],g=_[1],v=Object(rt.b)(Jb,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,filtro:p,limit:15,offset:f},fetchPolicy:"network-only"}),C=v.loading,A=v.data,I=v.refetch;A&&r(A.obtenerAbonosProveedores),Object(j.useEffect)((function(){I(),c(!1)}),[n,I]),Object(j.useEffect)((function(){try{I({filtro:p,fecha:""})}catch(e){}}),[p]);var k=function(){return d(!l)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:k,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Fp,alt:"icono abono",className:i.icon})}),"Abonos de provedores"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:l,onClose:k,TransitionComponent:kp,children:[Object(H.jsx)(Re.a,{className:i.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:i.title,children:"Abonos a Provedores"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:k,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(O.a,{display:"flex",p:2,children:Object(H.jsx)(O.a,{minWidth:"40%",children:Object(H.jsx)("form",{onSubmit:function(e){return function(e,t){e.preventDefault(),m(t)}(e,e.target[0].value)},children:Object(H.jsx)(S.a,{inputRef:x,fullWidth:!0,size:"small",variant:"outlined",placeholder:"Buscar una compra...",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{type:"submit",color:"primary",size:"medium",children:Object(H.jsx)(Us.a,{})})})}})})})}),Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(Ap,{loading:C,refetch:I,limit:15,setPage:g,page:f})})]})]})}var Np=Object(j.createContext)(),Pp=function(e){var t=e.children,a=Object(j.useState)({message:"",status:"",open:!1}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)([]),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)(!1),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useState)([]),f=Object(y.a)(_,2),g=f[0],v=f[1];return Object(H.jsx)(Np.Provider,{value:{alert:c,setAlert:r,ventas:s,setVentas:l,reload:b,setReload:p,openAbonar:x,setOpenAbonar:h,abonos:g,setAbonos:v},children:t})},Ep=a(479),Dp=a.n(Ep),zp=Object(k.a)({}),Tp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function $p(e){var t,a,n=zp(),c=Object($e.a)(),r=function(){e.setOpenDetalle(!e.openDetalle)};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(qe.a,{open:e.openDetalle,onClose:r,fullWidth:!0,maxWidth:"lg",TransitionComponent:Tp,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{variant:"h6",style:{flexGrow:1},children:"Datos de compra"}),Object(H.jsx)(F.a,{variant:"text",color:"primary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(fn.a,{className:n.root,children:Object(H.jsx)(Na.a,{className:n.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Producto"}),Object(H.jsx)(Da.a,{children:"Medida"}),Object(H.jsx)(Da.a,{children:"Color"}),Object(H.jsx)(Da.a,{children:"Unidad"}),Object(H.jsx)(Da.a,{children:"Cantidad"}),Object(H.jsx)(Da.a,{children:"C. regalo"}),Object(H.jsx)(Da.a,{children:"C. total"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:null===(t=e.datos)||void 0===t||null===(a=t.productos)||void 0===a?void 0:a.map((function(e,t){return Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:e.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{padding:"checkbox",children:e.medida&&e.medida.medida?e.medida.medida:"N/A"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:e.color&&e.color.hex?Object(H.jsx)(gn.a,{label:e.color.color,size:"small",style:{backgroundColor:e.color.hex,color:c.palette.getContrastText(e.color.hex)}}):"N/A"}),Object(H.jsx)(Da.a,{children:e.unidad}),Object(H.jsx)(Da.a,{children:e.cantidad_venta}),Object(H.jsx)(Da.a,{children:e.cantidad_regalo}),Object(H.jsx)(Da.a,{children:e.cantidad_total}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.subtotal)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.impuestos)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(e.total)]})})]},t)}))})]})})})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(Yt.a,{}),onClick:function(){return r()},children:"Aceptar"})})]})})}var Wp=Object(k.a)({}),Rp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Vp=[{id:"fecha_movimiento_credito",label:"Fecha",minWidth:60,widthPx:160},{id:"monto_total_abonado",label:"Cantidad abono",minWidth:170,widthPx:160},{id:"estatus",label:"Estado",minWidth:200,widthPx:200}];var Mp=Object(f.f)((function(e){var t,a,n=Wp(),c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(!1),p=Object(y.a)(b,2),m=p[0],x=p[1],h=JSON.parse(localStorage.getItem("sesionCafi")),_=JSON.parse(localStorage.getItem("turnoEnCurso")),f=Object(w.a)(Kb),g=Object(y.a)(f,1)[0],A=function(){e.setOpenHistorial(!e.openHistorial)},S=[];e.rowSelected.abonos&&e.rowSelected.abonos.forEach((function(e){S.push({fecha_movimiento_credito:La(e.fecha_movimiento.completa),monto_total_abonado:Ua(e.monto_total_abonado),estatus:e.status})}));var k=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var a;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,u(!0),a={tipo_movimiento:"CANCELACION_ABONO_CLIENTE",rol_movimiento:_?"CAJA":"CAJA_PRINCIPAL",numero_caja:_?parseInt(_.numero_caja):0,id_Caja:_?_.id_caja:"",fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},monto_abono:m.monto_total_abonado,horario_turno:_?_.horario_en_turno:"",hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},concepto:"CANCELACION_ABONO_CLIENTE",id_usuario:h._id,numero_usuario_creador:h.numero_usuario,nombre_usuario_creador:h.nombre,id_cliente:e.rowSelected.cliente._id,credito_disponible:e.rowSelected.cliente.credito_disponible,numero_cliente:e.rowSelected.cliente.numero_cliente,nombre_cliente:e.rowSelected.cliente.nombre_cliente,telefono_cliente:e.rowSelected.cliente.telefono,email_cliente:e.rowSelected.cliente.email,id_abono:m._id,id_venta:e.rowSelected._id,metodo_de_pago:"01",caja_principal:h.accesos.tesoreria.caja_principal.ver},t.next=5,g({variables:{empresa:h.empresa._id,sucursal:h.sucursal._id,input:a}});case 5:e.recargar(),o(!1),u(!1),A(),e.setAlert({message:"Abono cancelado con \xe9xito.",status:"success",open:!0}),t.next=20;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),t.t0.networkError?console.log(t.t0.networkError.result):t.t0.graphQLErrors&&console.log(t.t0.graphQLErrors),o(!1),u(!1),A(),e.setAlert({message:"La cancelaci\xf3n ha fallado.",status:"error",open:!0});case 20:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(){return t.apply(this,arguments)}}();return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(qe.a,{open:e.openHistorial,onClose:A,fullWidth:!0,maxWidth:"sm",TransitionComponent:Rp,children:[Object(H.jsxs)(qe.a,{open:i,TransitionComponent:Rp,keepMounted:!0,onClose:function(){return o(!1)},"aria-labelledby":"alert-eliminar-abono",children:[Object(H.jsx)(Bt.a,{id:"alert-eliminar-abono",children:"\xbfEst\xe1 seguro de eliminar este abono?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return o(!1)},color:"inherit",disabled:d,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return k()},color:"secondary",disabled:d,startIcon:d?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Eliminar"})]})]}),Object(H.jsxs)(Bt.a,{children:[Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{variant:"h6",style:{flexGrow:1},children:"Historial de abonos"}),Object(H.jsx)(F.a,{variant:"text",color:"primary",onClick:A,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]}),(null===(t=e.rowSelected.abonos)||void 0===t?void 0:t.length)>0?Object(H.jsx)(O.a,{mr:4,mrstyle:{backgroundColor:"red",alignContent:"flex-end"},justifyContent:"flex-end",children:Object(H.jsx)(O.a,{children:Object(H.jsx)(op,{fileName:"Historial Abonos",data:S,columnName:Vp})})}):Object(H.jsx)("div",{})]}),Object(H.jsx)(He.a,{children:Object(H.jsx)(fn.a,{className:n.root,children:Object(H.jsx)(Na.a,{className:n.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Fecha"}),Object(H.jsx)(Da.a,{children:"Cantidad abono"}),Object(H.jsx)(Da.a,{children:"Cancelar abono"})]})}),Object(H.jsx)(za.a,{children:null===(a=e.rowSelected.abonos)||void 0===a?void 0:a.map((function(t,a){return Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:La(t.fecha_movimiento.completa)}),Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsxs)("b",{children:["$",Ua(t.monto_total_abonado)]})}),"CANCELADO"===t.status?Object(H.jsx)(Da.a,{children:t.status}):Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(F.a,{variant:"text",color:"primary",onClick:function(){return function(t){try{e.rowSelected.facturacion?e.setAlert({message:"No se puede cancelar un abono facturado.",status:"error",open:!0}):_||h.accesos.tesoreria.caja_principal.ver?(o(!0),x(t)):e.history.push("/ventas/venta-general")}catch(a){console.log(a)}}(t)},size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:22}})})})]},a)}))})]})})})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(Yt.a,{}),onClick:function(){return A()},children:"Aceptar"})})]})})})),Lp=a(478),Bp=a.n(Lp),Up=a(266),qp=a.n(Up),Jp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Hp=Object(k.a)({title:{fontSize:16}});var Gp=Object(f.f)((function(e){var t=Hp(),a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useContext)(Np).abonos,o=Object(j.useState)(""),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(0),b=Object(y.a)(u,2),p=b[0],m=b[1],x=Object(j.useState)(0),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useState)(!1),A=Object(y.a)(g,2),I=A[0],k=A[1],N=Object(j.useState)(0),P=Object(y.a)(N,2),E=P[0],D=P[1],z=Object(j.useState)(0),T=Object(y.a)(z,2),$=T[0],W=T[1],R=Object(w.a)(Qb),V=Object(y.a)(R,1)[0],M=JSON.parse(localStorage.getItem("sesionCafi")),B=JSON.parse(localStorage.getItem("turnoEnCurso")),U=function(){B||M.accesos.tesoreria.caja_principal.ver?r(!c):e.history.push("/ventas/venta-general")},q=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var a,n;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,k(!0),a={},Wt.forEach((function(e){l===e.Value&&(a=e)})),n={tipo_movimiento:"ABONO_CLIENTE",rol_movimiento:B?"CAJA":"CAJA_PRINCIPAL",numero_caja:B?parseInt(B.numero_caja):0,id_Caja:B?B.id_caja:"",fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().week().toString(),no_dia_year:Dt()().dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},concepto:"ABONO_CLIENTE",monto_total:e.total_ventas,descuento:{porciento_descuento:p,dinero_descontado:$,total_con_descuento:E},horario_turno:B?B.horario_en_turno:"",hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},metodo_de_pago:{clave:a.Value,metodo:a.Name},id_usuario:M._id,numero_usuario_creador:M.numero_usuario,nombre_usuario_creador:M.nombre,id_cliente:e.cliente._id,credito_disponible:e.cliente.credito_disponible,numero_cliente:e.cliente.numero_cliente,nombre_cliente:e.cliente.nombre_cliente,telefono_cliente:e.cliente.telefono_cliente,email_cliente:e.cliente.email_cliente,ventas:e.isIcon?[{monto_total_abonado:0,id_venta:i[e.index].id_venta,saldo_credito_pendiente:i[e.index].saldo_credito_pendiente}]:i,liquidar:!0,caja_principal:M.accesos.tesoreria.caja_principal.ver},!l){t.next=14;break}return t.next=8,V({variables:{empresa:M.empresa._id,sucursal:M.sucursal._id,input:n}});case 8:e.recargar(),r(!1),k(!1),e.setAlert({message:"Venta liquidada con \xe9xito.",status:"success",open:!0}),t.next=16;break;case 14:k(!1),e.setAlert({message:"Elige un m\xe9todo de pago.",status:"error",open:!0});case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),t.t0.networkError?console.log(t.t0.networkError.result):t.t0.graphQLErrors&&console.log(t.t0.graphQLErrors);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(){return t.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{m:1,children:[e.isIcon?Object(H.jsx)(ce.a,{"aria-label":"liquidar",onClick:U,disabled:"PAGADA"===e.estatus_credito,size:"small",children:Object(H.jsx)(Bp.a,{})}):Object(H.jsx)(F.a,{size:"large",variant:"contained",color:"primary",onClick:U,children:"Liquidar TODAS"}),Object(H.jsxs)(qe.a,{open:c,TransitionComponent:Jp,keepMounted:!0,onClose:U,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(H.jsx)(st,{loading:I,setLoading:k}),Object(H.jsx)(Bt.a,{id:"alert-dialog-slide-title",children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{width:"100%",display:"flex",justifyContent:"flex-start",children:e.isIcon?"Liquidar cuenta":"Liquidar todas las cuentas"}),Object(H.jsx)(O.a,{width:"42%",display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:U,size:"large",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(O.a,{mt:4,children:[Object(H.jsxs)(O.a,{textAlign:"center",children:[Object(H.jsx)(L.a,{style:{fontSize:17},children:Object(H.jsx)("b",{children:"Agregar descuento"})}),Object(H.jsx)(Mt.a,{severity:"info",children:"Aplica un descuento por pronto pago a tu cuenta"})]}),Object(H.jsxs)(O.a,{p:2,children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Porcentaje:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"descuento",id:"form-venta-porsentaje-descuento",variant:"outlined",value:p,onChange:function(t){var a=parseFloat(t.target.value);if(a>=0&&a<=100){m(a);var n=parseFloat((e.total_ventas*a/100).toFixed(2)),c=parseFloat((e.total_ventas-n).toFixed(2));D(n),W(c),f(c)}},type:"number",disabled:!1,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"%"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Dinero a descontar"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",type:"number",name:"precioConDescuento",onChange:function(t){var a=parseFloat(t.target.value);if(a>=0&&a<=e.total_ventas){var n=parseFloat((100*a/e.total_ventas).toFixed(2)),c=parseFloat((e.total_ventas-a).toFixed(2));D(a),W(c),m(n),f(c)}},value:E||0,className:t.input,variant:"outlined"})]})]}),Object(H.jsx)(O.a,{mt:2,display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"text",color:"secondary",size:"medium",onClick:function(){m(""),D(""),W(""),f(e.total_ventas)},startIcon:Object(H.jsx)(qp.a,{}),children:"Quitar descuento"})})]})]}),Object(H.jsxs)(O.a,{width:"65%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"M\xe9todo de pago:"})}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{width:"100%",name:"metodo_pago",variant:"outlined",value:l||"",onChange:function(e){return d(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:e.Name},t)}))]})})]}),Object(H.jsx)(O.a,{width:"100%",p:1,mt:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Nombre de Cliente:"})," ",e.cliente.nombre_cliente]})}),Object(H.jsx)(O.a,{width:"100%",p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Total:"}),"  ",_>0?_:e.total_ventas]})})]}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",alignContent:"center",p:2,children:Object(H.jsx)(F.a,{size:"large",variant:"contained",color:"primary",style:{fontSize:16},onClick:q,children:"Liquidar"})})]})]})})),Yp=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(6),"px ").concat(e.spacing(4),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}})),Qp=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));var Kp=Object(f.f)((function(e){var t=Yp(),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(""),b=Object(y.a)(u,2),p=b[0],m=b[1],x=Object(j.useContext)(Np).abonos,h=Object(j.useState)({}),_=Object(y.a)(h,2),f=_[0],g=_[1],A=Object(j.useState)(""),I=Object(y.a)(A,2),k=(I[0],I[1]),N=JSON.parse(localStorage.getItem("turnoEnCurso")),P=Object(w.a)(Qb),E=Object(y.a)(P,1)[0],D=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var n,c,r;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,d(!0),n={},Wt.forEach((function(e){f===e.Value&&(n=e)})),c={tipo_movimiento:"ABONO_CLIENTE",rol_movimiento:N?"CAJA":"CAJA_PRINCIPAL",numero_caja:N?parseInt(N.numero_caja):0,id_Caja:N?N.id_caja:"",fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},monto_total:e.total_ventas,concepto:"ABONO_CLIENTE",horario_turno:N?N.horario_en_turno:"",hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},metodo_de_pago:{clave:n.Value,metodo:n.Name},id_usuario:a._id,numero_usuario_creador:a.numero_usuario,nombre_usuario_creador:a.nombre,id_cliente:e.cliente._id,credito_disponible:e.cliente.credito_disponible,numero_cliente:e.cliente.numero_cliente,nombre_cliente:e.cliente.nombre_cliente,telefono_cliente:e.cliente.telefono_cliente,email_cliente:e.cliente.email_cliente,ventas:[{monto_total_abonado:parseFloat(p),id_venta:x[e.index].id_venta,saldo_credito_pendiente:x[e.index].saldo_credito_pendiente}],liquidar:!1,facturacion:e.venta.facturacion,caja_principal:a.accesos.tesoreria.caja_principal.ver},!(f&&""!==p&&p>0)){t.next=15;break}return t.next=8,E({variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,input:c}});case 8:t.sent,e.recargar(),i(!1),d(!1),e.setAlert({message:"Abono registrado con \xe9xito.",status:"success",open:!0}),t.next=17;break;case 15:d(!1),e.setAlert({message:"Por favor complete los datos.",status:"error",open:!0});case 17:t.next=25;break;case 19:t.prev=19,t.t0=t.catch(0),console.log(t.t0),r=t.t0,t.t0.networkError?(console.log(t.t0.networkError.result),r=t.t0.networkError.result):t.t0.graphQLErrors&&(console.log(t.t0.graphQLErrors[0].message),r=t.t0.graphQLErrors[0].message),e.setAlert({message:r,status:"error",open:!0});case 25:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(){return t.apply(this,arguments)}}();return Object(j.useEffect)((function(){f&&k(f.name)}),[f]),Object(H.jsxs)(O.a,{m:1,children:[Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(ce.a,{size:"small","aria-label":"detalle",onClick:function(){!function(){try{N||a.accesos.tesoreria.caja_principal.ver?i(!0):e.history.push("/ventas/venta-general")}catch(t){}}()},disabled:"PAGADA"===e.estatus_credito,children:Object(H.jsx)(Ac.a,{})})}),Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(qe.a,{open:r,TransitionComponent:Qp,keepMounted:!0,onClose:function(){i(!1)},fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{id:"alert-dialog-slide-title",children:Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(O.a,{width:"100%",display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return i(!1)},size:"large",children:Object(H.jsx)(Ye.a,{})})})})}),Object(H.jsx)(st,{loading:l,setLoading:d}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Cantidad a abonar:"})}),Object(H.jsx)(S.a,{fullWidth:!0,className:t.input,onChange:function(t){return function(t){try{var a=t.target.value;a>=0&&a<=e.venta.saldo_credito_pendiente&&m(a)}catch(n){console.log(n)}}(t)},value:p,size:"small",name:"abono_recibir",variant:"outlined",type:"number"})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"M\xe9todo de pago:"})}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{width:"100%",name:"metodo_pago",variant:"outlined",value:f||"",onChange:function(e){return g(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:e.Name},t)}))]})})]}),Object(H.jsxs)(O.a,{mt:2,children:[Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Total de la cuenta"})}),Object(H.jsx)(L.a,{style:{color:"#9B9B9B"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.venta.total)]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Total pagado"})}),Object(H.jsx)(L.a,{style:{color:"green"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.venta.total-e.venta.saldo_credito_pendiente)]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Total restante"})}),Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.venta.saldo_credito_pendiente)]})})]}),Object(H.jsx)(et.a,{}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Nuevo abono"})}),Object(H.jsx)(L.a,{style:{color:"green"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(p)," "]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Nuevo total pagado"})}),Object(H.jsx)(L.a,{style:{color:"green"},variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(parseFloat(e.venta.total)-parseFloat(e.venta.saldo_credito_pendiente)+parseFloat(p))]})})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Nuevo restante total"})}),Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsxs)("b",{children:["$",Ua(e.venta.saldo_credito_pendiente-p)]})})]})]})]}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",alignContent:"center",p:2,mt:2,children:Object(H.jsx)(F.a,{size:"large",variant:"contained",color:"primary",style:{fontSize:15},onClick:function(){return D()},children:"Registrar Abono"})})]})})]})})),Xp=a(966),Zp=[],em=[{id:"folio",numeric:!1,disablePadding:!0,label:"Folio"},{id:"fecha",numeric:!1,disablePadding:!0,label:"Fecha"},{id:"fechaVencimiento",numeric:!1,disablePadding:!0,label:"Fecha de vencimiento"},{id:"totalVenta",numeric:!1,disablePadding:!0,label:"Total venta"},{id:"faltaPagar",numeric:!1,disablePadding:!0,label:"Falta por pagar"},{id:"detalle",numeric:!1,disablePadding:!0,label:"Detalles"},{id:"historialAbonos",numeric:!1,disablePadding:!0,label:"Historial"},{id:"abonar",numeric:!1,disablePadding:!0,label:"Abonar"},{id:"liquidar",numeric:!1,disablePadding:!0,label:"Liquidar"}];function tm(e){return Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:em.map((function(e){return Object(H.jsx)(Da.a,{align:e.numeric?"right":"left",children:e.label},e.id)}))})})}var am,nm,cm,rm,im,om,sm,lm,dm,jm,um,bm=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},pagada:{backgroundColor:"#EDFFF3","&:hover":{backgroundColor:"#D8FFE5"}},vencidas:{backgroundColor:"#FFF4F4","&:hover":{backgroundColor:"#F5F5F5"}},vencer:{backgroundColor:"#FFF","&:hover":{backgroundColor:"#F5F5F5"}}}}));function pm(e){var t=bm(),a=Object(j.useState)([]),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)({}),x=Object(y.a)(m,2),h=x[0],_=x[1];return Object(H.jsx)("div",{className:t.root,children:Object(H.jsxs)(fn.a,{className:t.paper,children:[Object(H.jsxs)(O.a,{my:1,m:2,display:"flex",children:[Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{border:1,borderColor:"#58ff8f",bgcolor:"#EDFFF3",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"- Pagadas "})}),Object(H.jsx)(O.a,{mx:2})]}),Object(H.jsx)(O.a,{border:1,borderColor:"#FF8A8A",bgcolor:"#FFF4F4",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"- Ventas vencidas "})})]}),Object(H.jsx)(Na.a,{style:{height:"58vh"},children:Object(H.jsxs)($a.a,{className:t.table,"aria-labelledby":"tableTitle",stickyHeader:!0,size:"small","aria-label":"enhanced table",children:[Object(H.jsx)(tm,{classes:t,numSelected:c.length,onSelectAllClick:function(e){if(e.target.checked){var t=Zp.map((function(e){return e.name}));r(t)}else r([])},rowCount:Zp.length}),Object(H.jsx)(za.a,{children:e.rows.docs.map((function(a,n){var r,i=(r=a,-1!==c.indexOf(r)),o="enhanced-table-checkbox-".concat(n);return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,className:"PAGADA"===a.estatus_credito?t.pagada:"VENCIDA"===a.estatus_credito?t.vencidas:t.vencer,children:[Object(H.jsx)(Da.a,{id:o,children:a.folio}),Object(H.jsx)(Da.a,{children:" ".concat(Ba(a.fecha_registro))}),Object(H.jsx)(Da.a,{children:Ba(a.fecha_de_vencimiento_credito)}),Object(H.jsx)(Da.a,{children:a.total}),Object(H.jsx)(Da.a,{children:a.saldo_credito_pendiente}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(ce.a,{"aria-label":"detalle",onClick:function(){!function(e){l(!0),_(e)}(a)},size:"small",children:Object(H.jsx)(Xp.a,{})})}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(ce.a,{"aria-label":"historial",onClick:function(){!function(e){p(!0),_(e)}(a)},size:"small",children:Object(H.jsx)(Dp.a,{})})}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(Kp,{cliente:e.selectedClient,total_ventas:a.saldo_credito_pendiente,setLoading:e.setLoading,venta:a,setAlert:e.setAlert,index:n,recargar:e.recargar,estatus_credito:a.estatus_credito})}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(Gp,{isIcon:!0,cliente:e.selectedClient,total_ventas:a.saldo_credito_pendiente,setAlert:e.setAlert,index:n,setLoading:e.setLoading,recargar:e.recargar,estatus_credito:a.estatus_credito})})]},n)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:e.rows.totalDocs,rowsPerPage:e.limit,page:e.page,onPageChange:function(t,a){e.setPage(a)}}),Object(H.jsx)($p,{openDetalle:s,setOpenDetalle:l,datos:h}),Object(H.jsx)(Mp,{openHistorial:b,setOpenHistorial:p,rowSelected:h,recargar:e.recargar,setAlert:e.setAlert})]})})}Object(P.d)(am||(am=Object(N.a)(["\n  query ObtenerConsultaGeneralVentas($empresa: ID!, $sucursal: ID!) {\n    obtenerConsultaGeneralVentas(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      descuento {\n        porciento\n        dinero_descontado\n        precio_con_descuento\n      }\n      descuento_activo\n      default\n      id_producto {\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n      }\n    }\n  }\n"])));var mm=Object(P.d)(nm||(nm=Object(N.a)(["\n  query ObtenerUnProductoVentas(\n    $empresa: ID!\n    $sucursal: ID!\n    $datosProductos: ID!\n  ) {\n    obtenerUnProductoVentas(\n      empresa: $empresa\n      sucursal: $sucursal\n      datosProductos: $datosProductos\n    ) {\n      _id\n      precio\n      cantidad\n      concepto\n      unidad\n      unidad_principal\n      codigo_barras\n      codigo_unidad\n      precio_unidad {\n        numero_precio\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        unidad_mayoreo\n        precio_general\n        cantidad_unidad\n        unidad_maxima\n      }\n      descuento {\n        cantidad_unidad\n        numero_precio\n        unidad_maxima\n        precio_general\n        precio_neto\n        precio_venta\n        iva_precio\n        ieps_precio\n        utilidad\n        dinero_descontado\n        porciento\n      }\n      medida {\n        talla\n        tipo\n        _id\n      }\n      color {\n        hex\n        nombre\n        _id\n      }\n      descuento_activo\n      default\n      id_producto {\n        imagenes {\n          url_imagen\n        }\n        _id\n        datos_generales {\n          nombre_comercial\n          codigo_barras\n          tipo_producto\n          clave_alterna\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          ieps\n          ieps_activo\n          inventario {\n            inventario_minimo\n            inventario_maximo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          iva\n          iva_activo\n          monedero\n          monedero_electronico\n          precio_de_compra {\n            precio_con_impuesto\n            precio_sin_impuesto\n            iva\n            ieps\n          }\n          precios_producto {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n            codigo_unidad\n          }\n        }\n      }\n      inventario_general {\n        cantidad_existente\n        unidad_inventario\n        cantidad_existente_maxima\n        unidad_maxima\n        codigo_unidad\n      }\n    }\n  }\n"]))),Om=Object(P.d)(cm||(cm=Object(N.a)(["\n  query ObtenerProductosVentas(\n    $empresa: ID!\n    $sucursal: ID!\n    $input: ObtenerProductosVentasInput\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerProductosVentas(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        precio\n        cantidad\n        concepto\n        unidad\n        unidad_principal\n        codigo_barras\n        codigo_unidad\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        descuento {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          dinero_descontado\n          porciento\n        }\n        medida {\n          talla\n          tipo\n          _id\n        }\n        color {\n          hex\n          nombre\n          _id\n        }\n        descuento_activo\n        default\n        id_producto {\n          imagenes {\n            url_imagen\n          }\n          _id\n          datos_generales {\n            nombre_comercial\n            codigo_barras\n            tipo_producto\n            clave_alterna\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n              codigo_unidad\n            }\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n              codigo_unidad\n            }\n          }\n        }\n        inventario_general {\n          cantidad_existente\n          unidad_inventario\n          cantidad_existente_maxima\n          unidad_maxima\n          codigo_unidad\n          id_almacen_general\n        }\n      }\n      totalDocs\n    }\n  }\n"]))),xm=Object(P.d)(rm||(rm=Object(N.a)(["\n  query ObtenerClientesVentas(\n    $empresa: ID!\n    $sucursal: ID!\n    $limit: Int\n    $offset: Int\n    $filtro: String\n  ) {\n    obtenerClientesVentas(\n      empresa: $empresa\n      sucursal: $sucursal\n      limit: $limit\n      offset: $offset\n      filtro: $filtro\n    ) {\n      docs {\n        _id\n        numero_cliente\n        clave_cliente\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        dias_credito\n        razon_social\n        direccion {\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        banco\n        numero_cuenta\n        monedero_electronico\n        credito_disponible\n      }\n      totalDocs\n    }\n  }\n"]))),hm=Object(P.d)(im||(im=Object(N.a)(["\n  mutation createVenta(\n    $input: CrearVentasInput!\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n    $caja: ID!\n    $isOnline: Boolean!\n  ) {\n    createVenta(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n      caja: $caja\n      isOnline: $isOnline\n    ) {\n      message\n      done\n      datos_to_save_storage{\n        historialCajaInstance{\n          _id\n          montos_en_caja {\n            monto_efectivo{monto metodo_pago}\n            monto_tarjeta_debito{monto metodo_pago}\n            monto_tarjeta_credito{monto metodo_pago}\n            monto_creditos{monto metodo_pago}\n            monto_monedero{monto metodo_pago}\n            monto_transferencia{monto metodo_pago}\n            monto_cheques{monto metodo_pago}\n            monto_vales_despensa{monto metodo_pago}\n          }\n          id_movimiento\n          tipo_movimiento\n          concepto\n          rol_movimiento\n          id_Caja\n          numero_caja\n          horario_turno\n          hora_moviento{\n            hora\n            minutos\n            segundos\n            completa\n          }\n          fecha_movimiento{\n            year\n            mes\n            dia\n            no_semana_year\n            no_dia_year\n            completa\n          }\n          id_User\n          numero_usuario_creador\n          nombre_usuario_creador\n          empresa\n          sucursal\n        }\n        new_venta{\n          _id\n          folio\n          descuento\n          ieps\n          impuestos\n          iva\n          monedero\n          subTotal\n          total\n          venta_cliente\n          status\n          montos_en_caja {\n            monto_efectivo{monto metodo_pago}\n            monto_tarjeta_debito{monto metodo_pago}\n            monto_tarjeta_credito{monto metodo_pago}\n            monto_creditos{monto metodo_pago}\n            monto_monedero{monto metodo_pago}\n            monto_transferencia{monto metodo_pago}\n            monto_cheques{monto metodo_pago}\n            monto_vales_despensa{monto metodo_pago}\n          }\n          credito\n          abono_minimo\n          saldo_credito_pendiente\n          credito_pagado\n          descuento_general_activo\n          descuento_general{ \n            cantidad_descontado\n            porciento\n            precio_con_descuento\n          }\n          id_caja\n          fecha_de_vencimiento_credito\n          dias_de_credito_venta\n          empresa\n          sucursal\n          usuario\n          cliente{\n            _id\n            numero_cliente\n            clave_cliente\n            representante\n            nombre_cliente\n            rfc\n            curp\n            telefono\n            celular\n            email\n            numero_descuento\n            limite_credito\n            credito_disponible\n            dias_credito\n            razon_social\n            direccion {\n              calle\n              no_ext\n              no_int\n              codigo_postal\n              colonia\n              municipio\n              localidad\n              estado\n              pais\n            }\n            imagen\n            estado_cliente\n            tipo_cliente\n            banco\n            numero_cuenta\n            empresa {\n              _id\n              nombre_empresa\n              correo_empresa\n              nombre_dueno\n              telefono_dueno\n              sucursales_activas\n              limite_sucursales\n            }\n            sucursal {\n              _id\n              nombre_sucursal\n              descripcion\n            }\n            monedero_electronico\n            fecha_nacimiento\n            fecha_registro\n            eliminado\n          }\n          year_registro\n          numero_semana_year\n          numero_mes_year\n          fecha_registro\n\n          forma_pago\n          metodo_pago\n          tipo_emision\n          fecha_venta\n          turno\n        }\n        productos_base {\n          _id\n          id_venta\n          id_producto\n          forma_pago\n          producto {\n            almacen_inicial {\n              almacen\n              cantidad\n              fecha_de_expiracion\n              id_almacen\n            }\n            datos_generales {\n              codigo_barras\n              clave_alterna\n              tipo_producto\n              nombre_comercial\n              nombre_generico\n              descripcion\n              id_categoria\n              categoria\n              subcategoria\n              id_subcategoria\n              id_departamento\n              departamento\n              id_marca\n              marca\n              clave_producto_sat {\n                Name\n                Value\n              }\n              receta_farmacia\n            }\n            precios {\n              ieps\n              ieps_activo\n              iva\n              iva_activo\n              monedero\n              monedero_electronico\n              granel\n              inventario {\n                inventario_minimo\n                inventario_maximo\n                unidad_de_inventario\n              }\n              precio_de_compra {\n                precio_con_impuesto\n                precio_sin_impuesto\n                iva\n                ieps\n              }\n              precios_producto {\n                numero_precio\n                precio_neto\n                precio_venta\n                unidad_mayoreo\n                utilidad\n              }\n              unidad_de_compra {\n                cantidad\n                precio_unitario_con_impuesto\n                precio_unitario_sin_impuesto\n                unidad\n              }\n            }\n            unidades_de_venta {\n              _id\n              cantidad\n              codigo_barras\n              id_producto\n              precio\n              unidad\n              unidad_principal\n            }\n          }\n          concepto\n          cantidad\n          cantidad_regalo\n          cantidad_total\n          cantidad_venta\n          costo\n          descuento_porcentaje\n          descuento_precio\n          impuestos\n          mantener_precio\n          subtotal\n          total\n          medida {\n            id_medida\n            medida\n            tipo\n          }\n          color {\n            id_color\n            color\n            hex\n          }\n          unidad\n          id_unidad_venta\n          empresa\n          sucursal\n          usuario\n          year_registro\n          numero_semana_year\n          numero_mes_year\n          fecha_registro\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          subtotal_antes_de_impuestos\n          precio_actual_object{\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            unidad_mayoreo\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          granel_producto{\n            granel\n            valor\n          }\n          precio\n          precio_a_vender\n          precio_actual_producto\n          descuento_activo\n          default\n         \n        }\n      }\n    }\n  }\n"]))),_m=Object(P.d)(om||(om=Object(N.a)(["\n  mutation crearNotaCredito(\n    $input: CrearNotaCreditoInput!\n    $empresa: ID!\n    $sucursal: ID!\n    $turno: turnoVenta\n  ) {\n    crearNotaCredito(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      turno: $turno\n    ) {\n      message\n    }\n  }\n"]))),fm=Object(P.d)(sm||(sm=Object(N.a)(["\n  query obtenerVentasSucursal(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtros: filtrosObtenerVentas\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerVentasSucursal(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtros: $filtros\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        folio\n        cliente {\n          _id\n          numero_cliente\n          clave_cliente\n          representante\n          nombre_cliente\n          rfc\n          curp\n          telefono\n          celular\n          email\n          numero_descuento\n          limite_credito\n          dias_credito\n          razon_social\n          direccion {\n            calle\n            no_ext\n            no_int\n            codigo_postal\n            colonia\n            municipio\n            localidad\n            estado\n            pais\n          }\n          imagen\n          eliminado\n          banco\n          numero_cuenta\n          monedero_electronico\n          credito_disponible\n        }\n        descuento\n        ieps\n        impuestos\n        iva\n        monedero\n        subTotal\n        total\n        venta_cliente\n        credito\n        descuento_general_activo\n        id_caja {\n          _id\n          numero_caja\n          activa\n        }\n        fecha_de_vencimiento_credito\n        dias_de_credito_venta\n        empresa\n        sucursal\n        usuario {\n          _id\n          numero_usuario\n          nombre\n        }\n        productos {\n          _id\n          id_unidad_venta {\n            _id\n            precio\n            cantidad\n            concepto\n            unidad\n            codigo_unidad\n            unidad_principal\n            unidad_activa\n            codigo_barras\n            id_producto\n            empresa\n            sucursal\n            default\n          }\n          id_producto {\n            _id\n            datos_generales {\n              codigo_barras\n              clave_alterna\n              tipo_producto\n              nombre_comercial\n              nombre_generico\n              descripcion\n              id_categoria\n              categoria\n              subcategoria\n              id_subcategoria\n              id_departamento\n              departamento\n              id_marca\n              marca\n              clave_producto_sat {\n                Name\n                Value\n              }\n              receta_farmacia\n            }\n            precios {\n              ieps\n              ieps_activo\n              inventario {\n                inventario_minimo\n                inventario_maximo\n                unidad_de_inventario\n                codigo_unidad\n              }\n              iva\n              iva_activo\n              monedero\n              monedero_electronico\n              precio_de_compra {\n                precio_con_impuesto\n                precio_sin_impuesto\n                iva\n                ieps\n              }\n              precios_producto {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n              unidad_de_compra {\n                cantidad\n                precio_unitario_con_impuesto\n                precio_unitario_sin_impuesto\n                unidad\n                codigo_unidad\n              }\n              granel\n              litros\n            }\n            imagenes {\n              url_imagen\n              location_imagen\n              key_imagen\n              extencion_imagen\n            }\n            centro_de_costos {\n              cuenta\n              id_cuenta\n              id_subcuenta\n              subcuenta\n            }\n            precio_plazos {\n              precio_cajas {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n              precio_costales {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n              precio_piezas {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n            }\n            unidades_de_venta {\n              _id\n              precio\n              cantidad\n              concepto\n              unidad\n              codigo_unidad\n              unidad_principal\n              codigo_barras\n              codigo_barras\n              id_producto\n              empresa\n              sucursal\n              descuento {\n                cantidad_unidad\n                numero_precio\n                unidad_maxima\n                precio_general\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                utilidad\n                porciento\n                dinero_descontado\n              }\n              descuento_activo\n              default\n              precio_unidad {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n            }\n            inventario_general {\n              _id\n              cantidad_existente\n              unidad_inventario\n              codigo_unidad\n              cantidad_existente_maxima\n              unidad_maxima\n              id_almacen_general\n              eliminado\n            }\n            medidas_producto {\n              _id\n              cantidad\n              cantidad_nueva\n              almacen\n              codigo_barras\n              color {\n                hex\n                nombre\n                _id\n              }\n              descuento {\n                cantidad_unidad\n                numero_precio\n                unidad_maxima\n                precio_general\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                utilidad\n                porciento\n                dinero_descontado\n              }\n              descuento_activo\n              existencia\n              medida {\n                talla\n                tipo\n                _id\n              }\n              nombre_comercial\n              precio\n              precio_unidad {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n            }\n            empresa\n            sucursal\n          }\n          concepto\n          cantidad\n          iva_total\n          ieps_total\n          subtotal\n          impuestos\n          total\n          medida {\n            id_medida\n            medida\n            tipo\n          }\n          color {\n            id_color\n            color\n            hex\n          }\n          cantidad_venta\n          granel_producto {\n            granel\n            valor\n          }\n          precio\n          precio_a_vender\n          precio_actual_producto\n          default\n          unidad\n          codigo_unidad\n          id_unidad_venta {\n            _id\n            precio\n            cantidad\n            concepto\n            unidad\n            codigo_unidad\n            unidad_principal\n            unidad_activa\n            codigo_barras\n            id_producto\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          inventario_general {\n            _id\n            cantidad_existente\n            unidad_inventario\n            codigo_unidad\n            cantidad_existente_maxima\n            unidad_maxima\n            id_almacen_general\n            eliminado\n          }\n          year_registro\n          fecha_registro\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          subtotal_antes_de_impuestos\n          descuento_activo\n          descuento_producto {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          precio_actual_object {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            unidad_mayoreo\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n        }\n        fecha_registro\n        factura {\n          id_cfdi\n          serie\n          currency\n          expedition_place\n          folio\n          cfdi_type\n          payment_form\n          payment_method\n          logo_url\n          date\n          issuer {\n            FiscalRegime\n            Rfc\n            TaxName\n          }\n          receiver {\n            Rfc\n            Name\n            CfdiUse\n          }\n          items {\n            ProductCode\n            IdentificationNumber\n            Description\n            Unit\n            UnitCode\n            UnitPrice\n            Quantity\n            Subtotal\n            Discount\n            Taxes {\n              Total\n              Name\n              Base\n              Rate\n              IsRetention\n            }\n            Total\n          }\n          original_string\n          sub_total\n          total\n          discount\n          fecha_registro\n          empresa\n          sucursal\n        }\n        montos_en_caja {\n          monto_efectivo {\n            monto\n            metodo_pago\n          }\n          monto_tarjeta_debito {\n            monto\n            metodo_pago\n          }\n          monto_tarjeta_credito {\n            monto\n            metodo_pago\n          }\n          monto_creditos {\n            monto\n            metodo_pago\n          }\n          monto_monedero {\n            monto\n            metodo_pago\n          }\n          monto_transferencia {\n            monto\n            metodo_pago\n          }\n          monto_cheques {\n            monto\n            metodo_pago\n          }\n          monto_vales_despensa {\n            monto\n            metodo_pago\n          }\n        }\n        status\n        tipo_emision\n        forma_pago\n        metodo_pago\n        abono_minimo\n        cambio\n        nota_credito {\n          _id\n          cliente {\n            _id\n            numero_cliente\n            clave_cliente\n            nombre_cliente\n            representante\n            rfc\n          }\n          generar_cfdi\n          descuento\n          ieps\n          impuestos\n          iva\n          subTotal\n          total\n          id_factura\n          observaciones\n          empresa\n          sucursal\n          usuario {\n            _id\n            numero_usuario\n            nombre\n            email\n          }\n          venta {\n            _id\n          }\n          fecha_registro\n          cambio\n          devolucion_en\n        }\n      }\n      totalDocs\n    }\n  }\n"]))),gm=Object(P.d)(lm||(lm=Object(N.a)(["\n  query obtenerVentasReportes(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtros: filtrosReportesVentas\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerVentasReportes(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtros: $filtros\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        id_compra\n        id_traspaso\n        id_producto\n        id_proveedor\n        id_venta\n        id_almacen\n        almacen {\n          id_almacen\n          nombre_almacen\n        }\n        proveedor {\n          _id\n          clave_cliente\n          numero_cliente\n          nombre_cliente\n        }\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            granel\n            litros\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n              codigo_unidad\n            }\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              unidad\n              codigo_unidad\n            }\n          }\n          unidades_de_venta {\n            cantidad\n            codigo_barras\n            id_producto\n            precio\n            unidad\n            unidad_principal\n            _id\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n        }\n        concepto\n        cantidad\n        cantidad_regalo\n        cantidad_venta\n        unidad_regalo\n        cantidad_total\n        iva_total\n        ieps_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        compra_credito\n        venta_credito\n        forma_pago\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        unidad\n        id_unidad_venta\n        empresa\n        sucursal\n        usuario\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n        factura {\n          id_cfdi\n          serie\n          currency\n          expedition_place\n          folio\n          cfdi_type\n          payment_form\n          payment_method\n          date\n        }\n        nota_credito {\n          id_nota_credito\n          cantidad_devuelta\n          cantidad_vendida\n          total\n        }\n        venta {\n          _id\n          folio\n          cliente {\n            _id\n            numero_cliente\n            clave_cliente\n            nombre_cliente\n          }\n          descuento\n          ieps\n          ieps\n          impuestos\n          iva\n          monedero\n          subTotal\n          total\n          venta_cliente\n          factura {\n            id_cfdi\n            folio\n            serie\n          }\n          status\n          tipo_emision\n          observaciones\n          forma_pago\n          metodo_pago\n          credito\n          descuento_general_activo\n          id_caja {\n            _id\n            numero_caja\n          }\n          usuario {\n            _id\n            numero_usuario\n            nombre\n          }\n          fecha_registro\n          cambio\n        }\n      }\n      totalDocs\n      totalVenta\n    }\n  }\n"]))),vm=Object(P.d)(dm||(dm=Object(N.a)(["\n  query obtenerVentasByVentaReportes(\n    $empresa: ID!\n    $sucursal: ID!\n    $filtros: filtrosReportesVentasByVenta\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerVentasByVentaReportes(\n      empresa: $empresa\n      sucursal: $sucursal\n      filtros: $filtros\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        folio\n        cliente {\n          _id\n          numero_cliente\n          clave_cliente\n          representante\n          nombre_cliente\n          rfc\n          curp\n          telefono\n          celular\n          email\n          numero_descuento\n          limite_credito\n          dias_credito\n          razon_social\n          direccion {\n            calle\n            no_ext\n            no_int\n            codigo_postal\n            colonia\n            municipio\n            localidad\n            estado\n            pais\n          }\n          imagen\n          eliminado\n          banco\n          numero_cuenta\n          monedero_electronico\n          credito_disponible\n        }\n        descuento\n        ieps\n        impuestos\n        iva\n        monedero\n        subTotal\n        total\n        venta_cliente\n        credito\n        descuento_general_activo\n        id_caja {\n          _id\n          numero_caja\n          activa\n        }\n        fecha_de_vencimiento_credito\n        dias_de_credito_venta\n        saldo_credito_pendiente\n        empresa\n        sucursal\n        usuario {\n          _id\n          numero_usuario\n          nombre\n        }\n        productos {\n          _id\n          id_unidad_venta {\n            _id\n            precio\n            cantidad\n            concepto\n            unidad\n            codigo_unidad\n            unidad_principal\n            unidad_activa\n            codigo_barras\n            id_producto\n            empresa\n            sucursal\n            default\n          }\n          id_producto {\n            _id\n            datos_generales {\n              codigo_barras\n              clave_alterna\n              tipo_producto\n              nombre_comercial\n              nombre_generico\n              descripcion\n              id_categoria\n              categoria\n              subcategoria\n              id_subcategoria\n              id_departamento\n              departamento\n              id_marca\n              marca\n              clave_producto_sat {\n                Name\n                Value\n              }\n              receta_farmacia\n            }\n            precios {\n              ieps\n              ieps_activo\n              inventario {\n                inventario_minimo\n                inventario_maximo\n                unidad_de_inventario\n                codigo_unidad\n              }\n              iva\n              iva_activo\n              monedero\n              monedero_electronico\n              precio_de_compra {\n                precio_con_impuesto\n                precio_sin_impuesto\n                iva\n                ieps\n              }\n              precios_producto {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n              unidad_de_compra {\n                cantidad\n                precio_unitario_con_impuesto\n                precio_unitario_sin_impuesto\n                unidad\n                codigo_unidad\n              }\n              granel\n              litros\n            }\n            imagenes {\n              url_imagen\n              location_imagen\n              key_imagen\n              extencion_imagen\n            }\n            centro_de_costos {\n              cuenta\n              id_cuenta\n              id_subcuenta\n              subcuenta\n            }\n            precio_plazos {\n              precio_cajas {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n              precio_costales {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n              precio_piezas {\n                plazo\n                unidad\n                codigo_unidad\n                precio\n              }\n            }\n            unidades_de_venta {\n              _id\n              precio\n              cantidad\n              concepto\n              unidad\n              codigo_unidad\n              unidad_principal\n              codigo_barras\n              codigo_barras\n              id_producto\n              empresa\n              sucursal\n              descuento {\n                cantidad_unidad\n                numero_precio\n                unidad_maxima\n                precio_general\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                utilidad\n                porciento\n                dinero_descontado\n              }\n              descuento_activo\n              default\n              precio_unidad {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n            }\n            inventario_general {\n              _id\n              cantidad_existente\n              unidad_inventario\n              codigo_unidad\n              cantidad_existente_maxima\n              unidad_maxima\n              id_almacen_general\n              eliminado\n            }\n            medidas_producto {\n              _id\n              cantidad\n              cantidad_nueva\n              almacen\n              codigo_barras\n              color {\n                hex\n                nombre\n                _id\n              }\n              descuento {\n                cantidad_unidad\n                numero_precio\n                unidad_maxima\n                precio_general\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                utilidad\n                porciento\n                dinero_descontado\n              }\n              descuento_activo\n              existencia\n              medida {\n                talla\n                tipo\n                _id\n              }\n              nombre_comercial\n              precio\n              precio_unidad {\n                numero_precio\n                precio_neto\n                precio_venta\n                iva_precio\n                ieps_precio\n                unidad_mayoreo\n                utilidad\n                precio_general\n                cantidad_unidad\n                unidad_maxima\n              }\n            }\n            empresa\n            sucursal\n          }\n          concepto\n          cantidad\n          iva_total\n          ieps_total\n          subtotal\n          impuestos\n          total\n          medida {\n            id_medida\n            medida\n            tipo\n          }\n          color {\n            id_color\n            color\n            hex\n          }\n          cantidad_venta\n          granel_producto {\n            granel\n            valor\n          }\n          precio\n          precio_a_vender\n          precio_actual_producto\n          default\n          unidad\n          codigo_unidad\n          id_unidad_venta {\n            _id\n            precio\n            cantidad\n            concepto\n            unidad\n            codigo_unidad\n            unidad_principal\n            unidad_activa\n            codigo_barras\n            id_producto\n            descuento {\n              cantidad_unidad\n              numero_precio\n              unidad_maxima\n              precio_general\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              utilidad\n              porciento\n              dinero_descontado\n            }\n            descuento_activo\n            default\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n          inventario_general {\n            _id\n            cantidad_existente\n            unidad_inventario\n            codigo_unidad\n            cantidad_existente_maxima\n            unidad_maxima\n            id_almacen_general\n            eliminado\n          }\n          year_registro\n          fecha_registro\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n          subtotal_antes_de_impuestos\n          descuento_activo\n          descuento_producto {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          precio_actual_object {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            unidad_mayoreo\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n        }\n        fecha_registro\n        factura {\n          id_cfdi\n          serie\n          currency\n          expedition_place\n          folio\n          cfdi_type\n          payment_form\n          payment_method\n          logo_url\n          date\n          issuer {\n            FiscalRegime\n            Rfc\n            TaxName\n          }\n          receiver {\n            Rfc\n            Name\n            CfdiUse\n          }\n          items {\n            ProductCode\n            IdentificationNumber\n            Description\n            Unit\n            UnitCode\n            UnitPrice\n            Quantity\n            Subtotal\n            Discount\n            Taxes {\n              Total\n              Name\n              Base\n              Rate\n              IsRetention\n            }\n            Total\n          }\n          original_string\n          sub_total\n          total\n          discount\n          fecha_registro\n          empresa\n          sucursal\n        }\n        montos_en_caja {\n          monto_efectivo {\n            monto\n            metodo_pago\n          }\n          monto_tarjeta_debito {\n            monto\n            metodo_pago\n          }\n          monto_tarjeta_credito {\n            monto\n            metodo_pago\n          }\n          monto_creditos {\n            monto\n            metodo_pago\n          }\n          monto_monedero {\n            monto\n            metodo_pago\n          }\n          monto_transferencia {\n            monto\n            metodo_pago\n          }\n          monto_cheques {\n            monto\n            metodo_pago\n          }\n          monto_vales_despensa {\n            monto\n            metodo_pago\n          }\n        }\n        status\n        tipo_emision\n        forma_pago\n        metodo_pago\n        abono_minimo\n        cambio\n        nota_credito {\n          _id\n          cliente {\n            _id\n            numero_cliente\n            clave_cliente\n            nombre_cliente\n            representante\n            rfc\n          }\n          generar_cfdi\n          descuento\n          ieps\n          impuestos\n          iva\n          subTotal\n          total\n          id_factura\n          observaciones\n          empresa\n          sucursal\n          usuario {\n            _id\n            numero_usuario\n            nombre\n            email\n          }\n          venta {\n            _id\n          }\n          fecha_registro\n          cambio\n          devolucion_en\n        }\n      }\n      totalDocs\n      totalVenta\n    }\n  }\n"]))),Cm=Object(P.d)(jm||(jm=Object(N.a)(["\n  mutation cancelarVentasSucursal(\n    $empresa: ID!\n    $sucursal: ID!\n    $folio: String!\n    $input: cancelarVentaInput\n  ) {\n    cancelarVentasSucursal(\n      empresa: $empresa\n      sucursal: $sucursal\n      folio: $folio\n      input: $input\n    ) {\n      message\n    }\n  }\n"]))),ym=Object(P.d)(um||(um=Object(N.a)(["\n  mutation subirVentasCloud(\n  $arrayVentasCloud: [VentasCloudInput]\n \n) {\n  subirVentasCloud(\n    arrayVentasCloud: $arrayVentasCloud\n  ) {\n    message\n    done\n    ventas_fail{\n\n      historialCajaInstance{\n          _id\n          montos_en_caja {\n            monto_efectivo{monto metodo_pago}\n            monto_tarjeta_debito{monto metodo_pago}\n            monto_tarjeta_credito{monto metodo_pago}\n            monto_creditos{monto metodo_pago}\n            monto_monedero{monto metodo_pago}\n            monto_transferencia{monto metodo_pago}\n            monto_cheques{monto metodo_pago}\n            monto_vales_despensa{monto metodo_pago}\n          }\n          id_movimiento\n          tipo_movimiento\n          concepto\n          rol_movimiento\n          id_Caja\n          numero_caja\n          horario_turno\n          hora_moviento{\n            hora\n            minutos\n            segundos\n            completa\n          }\n          fecha_movimiento{\n            year\n            mes\n            dia\n            no_semana_year\n            no_dia_year\n            completa\n          }\n          id_User\n          numero_usuario_creador\n          nombre_usuario_creador\n          empresa\n          sucursal\n      }\n\n      new_venta{\n        _id\n        folio\n        descuento\n        ieps\n        impuestos\n        iva\n        monedero\n        subTotal\n        total\n        venta_cliente\n        status\n        montos_en_caja {\n          monto_efectivo{monto metodo_pago}\n          monto_tarjeta_debito{monto metodo_pago}\n          monto_tarjeta_credito{monto metodo_pago}\n          monto_creditos{monto metodo_pago}\n          monto_monedero{monto metodo_pago}\n          monto_transferencia{monto metodo_pago}\n          monto_cheques{monto metodo_pago}\n          monto_vales_despensa{monto metodo_pago}\n        }\n        credito\n        abono_minimo\n        saldo_credito_pendiente\n        credito_pagado\n        descuento_general_activo\n        descuento_general{ \n          cantidad_descontado\n          porciento\n          precio_con_descuento\n        }\n        id_caja\n        fecha_de_vencimiento_credito\n        dias_de_credito_venta\n        empresa\n        sucursal\n        usuario\n        cliente{\n          _id\n          numero_cliente\n          clave_cliente\n          representante\n          nombre_cliente\n          rfc\n          curp\n          telefono\n          celular\n          email\n          numero_descuento\n          limite_credito\n          credito_disponible\n          dias_credito\n          razon_social\n          direccion {\n            calle\n            no_ext\n            no_int\n            codigo_postal\n            colonia\n            municipio\n            localidad\n            estado\n            pais\n          }\n          imagen\n          estado_cliente\n          tipo_cliente\n          banco\n          numero_cuenta\n          empresa {\n            _id\n            nombre_empresa\n            correo_empresa\n            nombre_dueno\n            telefono_dueno\n            sucursales_activas\n            limite_sucursales\n          }\n          sucursal {\n            _id\n            nombre_sucursal\n            descripcion\n          }\n          monedero_electronico\n          fecha_nacimiento\n          fecha_registro\n          eliminado\n        }\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n        forma_pago\n        metodo_pago\n        tipo_emision\n        fecha_venta\n        turno\n      }\n\n      productos_base {\n        _id\n        id_venta\n        id_producto\n        forma_pago\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            granel\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n            }\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              unidad_mayoreo\n              utilidad\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n            }\n          }\n          unidades_de_venta {\n            _id\n            cantidad\n            codigo_barras\n            id_producto\n            precio\n            unidad\n            unidad_principal\n          }\n        }\n        concepto\n        cantidad\n        cantidad_regalo\n        cantidad_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        unidad\n        id_unidad_venta\n        empresa\n        sucursal\n        usuario\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        subtotal_antes_de_impuestos\n        precio_actual_object{\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          unidad_mayoreo\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n        granel_producto{\n          granel\n          valor\n        }\n        precio\n        precio_a_vender\n        precio_actual_producto\n        descuento_activo\n        default\n      }\n\n      empresa\n      sucursal\n      \n      cliente{\n        _id\n        numero_cliente\n        clave_cliente\n        representante\n        nombre_cliente\n        rfc\n        curp\n        telefono\n        celular\n        email\n        numero_descuento\n        limite_credito\n        dias_credito\n        razon_social\n        direccion{\n          calle\n          no_ext\n          no_int\n          codigo_postal\n          colonia\n          municipio\n          localidad\n          estado\n          pais\n        }\n        imagen\n        estado_cliente\n        tipo_cliente\n        fecha_nacimiento\n        fecha_registro\n        eliminado\n        banco\n        numero_cuenta\n        empresa {\n          _id\n          nombre_empresa\n          correo_empresa\n          nombre_dueno\n          telefono_dueno\n          sucursales_activas\n          limite_sucursales\n        }\n        sucursal {\n          _id\n          nombre_sucursal\n          descripcion\n        }\n        monedero_electronico\n        credito_disponible\n      } \n\n      productos {\n        _id\n        datos_generales {\n          codigo_barras\n          clave_alterna\n          tipo_producto\n          nombre_comercial\n          nombre_generico\n          descripcion\n          id_categoria\n          categoria\n          subcategoria\n          id_subcategoria\n          id_departamento\n          departamento\n          id_marca\n          marca\n          clave_producto_sat {\n            Name\n            Value\n          }\n          receta_farmacia\n        }\n        precios {\n          inventario {\n            inventario_maximo\n            inventario_minimo\n            unidad_de_inventario\n            codigo_unidad\n          }\n          precio_de_compra {\n            ieps\n            iva\n            precio_con_impuesto\n            precio_sin_impuesto\n          }\n          unidad_de_compra {\n            cantidad\n            precio_unitario_con_impuesto\n            precio_unitario_sin_impuesto\n            unidad\n          }\n        }\n        medidas_producto {\n          _id\n          cantidad\n          almacen\n          descuento_activo\n          descuento {\n            cantidad_unidad\n            numero_precio\n            unidad_maxima\n            precio_general\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            utilidad\n            porciento\n            dinero_descontado\n          }\n          codigo_barras\n          color {\n            _id\n            nombre\n            hex\n          }\n          existencia\n          medida {\n            _id\n            talla\n            tipo\n          }\n          nombre_comercial\n          precio\n          precio_unidad {\n            numero_precio\n            precio_neto\n            precio_venta\n            iva_precio\n            ieps_precio\n            unidad_mayoreo\n            utilidad\n            precio_general\n            cantidad_unidad\n            unidad_maxima\n          }\n        }\n        existencia_almacenes {\n          _id {\n            producto\n            almacen {\n              _id\n              nombre_almacen\n            }\n          }\n          unidad_inventario\n          cantidad_existente\n          unidad_maxima\n          cantidad_existente_maxima\n        }\n        empresa\n        sucursal\n      }\n\n      puntos_totales_venta\n      usuario\n      caja\n      credito\n      forma_pago\n      \n      montos_en_caja {\n        monto_efectivo{monto metodo_pago}\n        monto_tarjeta_debito{monto metodo_pago}\n        monto_tarjeta_credito{monto metodo_pago}\n        monto_creditos{monto metodo_pago}\n        monto_monedero{monto metodo_pago}\n        monto_transferencia{monto metodo_pago}\n        monto_cheques{monto metodo_pago}\n        monto_vales_despensa{monto metodo_pago}\n      }\n    }\n  }\n}\n"]))),Am=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},titleSelect:{marginLeft:e.spacing(1),flex:1,fontSize:18},icon:{width:100},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},iconSize:{width:32},borderBotonChico:{minWidth:"100%",minHeight:"100%",border:".6px solid #DBDBDB"}}})),Sm=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Fm(e){var t,a=Am(),n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=JSON.parse(localStorage.getItem("sesionCafi")),s=Object(j.useContext)(Np),l=Object(j.useState)(!1),d=Object(y.a)(l,2),b=d[0],p=d[1],x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useState)(""),A=Object(y.a)(g,2),k=A[0],w=A[1],N=Object(j.useState)({message:"",status:"",open:!1}),P=Object(y.a)(N,2),E=P[0],D=P[1],z=Object(j.useState)(""),T=Object(y.a)(z,2),$=T[0],W=T[1],R=Object(j.useState)(0),V=Object(y.a)(R,2),M=V[0],B=V[1],U=Object(j.useState)(0),q=Object(y.a)(U,2),J=q[0],G=q[1],Q=Object(Fo.a)(),K=Object(j.useState)([]),X=Object(y.a)(K,2),Z=X[0],ee=X[1],te=Object(j.useState)(0),ae=Object(y.a)(te,2),ne=ae[0],ce=ae[1],re=JSON.parse(localStorage.getItem("turnoEnCurso")),ie=Object(j.useState)([]),oe=Object(y.a)(ie,2),se=oe[0],le=oe[1],de={docs:[],totalDocs:0},je=function(){return i(!r)};window.addEventListener("keydown",(function(t){117===t.keyCode&&e.fromVentas&&je()}));var ue=Object(an.useDebounce)(k,500),be=Object(y.a)(ue,1)[0],pe=Object(j.useRef)(null),me=Object(rt.b)(Gb,{variables:{empresa:o.empresa._id,sucursal:o.sucursal._id,idCliente:$._id,limit:6,offset:J},fetchPolicy:"network-only"}),Oe=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a,n,c,r=arguments;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",a=r.length>1&&void 0!==r[1]?r[1]:0,n=r.length>2&&void 0!==r[2]&&r[2],e.prev=3,f(!0),e.next=7,Q.query({query:xm,variables:{empresa:o.empresa._id,sucursal:o.sucursal._id,filtro:t,limit:6,offset:a},fetchPolicy:"network-only"});case 7:c=e.sent,f(!1),c.data&&(ee(t||n?c.data.obtenerClientesVentas.docs:[].concat(Object(Ia.a)(Z),Object(Ia.a)(c.data.obtenerClientesVentas.docs))),ce(c.data.obtenerClientesVentas.totalDocs)),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(3),f(!1),console.log(e.t0),D({message:"Hubo un error al cargar los clientes",status:"error",open:!0});case 17:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}();Object(j.useEffect)((function(){B(0),Oe(be,0,!0)}),[be]),Object(j.useEffect)((function(){p(me.loading)}),[me.loading]),Object(j.useEffect)((function(){try{if(me.data){var e=[],t=0;me.data.historialVentasACredito.docs.length>0&&(me.data.historialVentasACredito.docs.forEach((function(a){t+=a.saldo_credito_pendiente,e.push({id_venta:a._id,monto_total_abonado:0,saldo_credito_pendiente:parseFloat(a.saldo_credito_pendiente)})})),le(parseFloat(t.toFixed(2))),s.setAbonos(e))}}catch(a){console.log(a)}}),[me.data]),me.data&&(de=me.data.historialVentasACredito),me.error&&(console.log(me.error),me.error.networkError.result?console.log(me.error.networkError.result.errors):me.error.graphQLErrors&&console.log(me.error.graphQLErrors.message));return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(st,{loading:b,setLoading:p}),Object(H.jsx)(Y,{alert:E,setAlert:D}),e.fromVentas?Object(H.jsx)(F.a,{className:a.borderBotonChico,onClick:je,disabled:!re,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(We.e,{style:{fontSize:35}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Abonos"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"F6"})})})]})}):Object(H.jsx)(F.a,{fullWidth:!0,onClick:je,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Fp,alt:"icono abono",className:a.icon})}),"Abonos de Clientes"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:r,onClose:je,TransitionComponent:Sm,children:[Object(H.jsx)(Re.a,{className:a.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:a.title,children:"Abonos de Clientes"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:je,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsxs)(Qe.a,{item:!0,md:5,children:[Object(H.jsx)(O.a,{ml:2,mt:1,children:Object(H.jsx)(L.a,{className:a.titleSelect,color:"textPrimary",gutterBottom:!0,children:Object(H.jsx)("b",{children:"Seleccionar cliente "})})}),Object(H.jsx)(O.a,{ml:3,style:{width:"80%"},children:Object(H.jsx)(ka.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,options:Z,loading:_,getOptionLabel:function(e){return e.nombre_cliente?e.nombre_cliente:"N/A"},renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{variant:"outlined",inputRef:pe,onChange:function(e){return w(e.target.value)},value:k,InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsxs)(u.a.Fragment,{children:[_?Object(H.jsx)(I.a,{color:"primary",size:20}):null,e.InputProps.endAdornment]})})}))},onChange:function(e,t){return function(e){e||(B(0),Oe("",0,!0));try{W(null!==e?e:"")}catch(t){console.log(t)}}(t)},getOptionSelected:function(e,t){return e.nombre_cliente===t.nombre_cliente},ListboxProps:{style:{maxHeight:"150px"},onScroll:function(e){var t=e.target,a=t.scrollHeight,n=t.scrollTop,c=t.clientHeight;if(a-parseInt(n+1)===c&&Z.length<ne){console.log("entra");var r=M+1;B(r),Oe("",r,!1)}}},value:$||null})})]}),Object(H.jsx)(Qe.a,{item:!0,md:7,children:Object(H.jsx)(O.a,{mt:3,mr:2,display:"flex",justifyContent:"flex-end",alignContent:"space-between",children:de.length>0&&se>0?Object(H.jsx)(Gp,{cliente:$,total_ventas:se,setAlert:D,liquidarTodas:!0,recargar:me.refetch,setLoading:p}):Object(H.jsx)("div",{})})})]}),null!==(t=de)&&void 0!==t&&t.docs.length?Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(pm,{rows:de,setSelectedClient:W,selectedClient:$,setOpen:i,enviarCantidad:function(e,t,a){var n=Object(Ia.a)(s.abonos);e>0?n.splice(t,1,{id_venta:a,monto_total_abonado:e}):n.splice(t,1),s.setAbonos(n)},setAlert:D,setLoading:p,recargar:me.refetch,limit:6,page:J,setPage:G})}):Object(H.jsx)(O.a,{}),b?Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(H.jsx)(I.a,{})}):Object(H.jsx)("div",{})]})]})}function Im(){var e=Object(j.useContext)(gb),t=e.alert,a=e.setAlert,n=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(A.a,{children:[Object(H.jsx)(Y,{alert:t,setAlert:a}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,justifyContent:"center",children:[!1===n.accesos.tesoreria.cuentas_empresa.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(zb,{})})}),!1===n.accesos.tesoreria.abonos_proveedores.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(wp,{})})}),!1===n.accesos.tesoreria.abonos_clientes.ver?null:Object(H.jsx)(Pp,{children:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Fm,{fromVentas:!1})})})})]})]})}function km(){return Object(H.jsx)(vb,{children:Object(H.jsx)(Im,{})})}var wm=a(967),Nm=Object(j.createContext)(),Pm=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useState)({serie:"",currency:"MXN",expedition_place:"",folio:"",cfdi_type:"I",payment_form:"",payment_method:"",logo_url:a&&a.empresa.imagen?a.empresa.imagen:"",date:"0",issuer:{FiscalRegime:a?a.empresa.regimen_fiscal:"",Rfc:a?a.empresa.rfc:"",Name:a?a.empresa.nombre_fiscal:""},receiver:{Rfc:"",Name:"",CfdiUse:""},items:[],empresa:a?a.empresa._id:"",sucursal:a?a.sucursal._id:""}),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(null),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)([]),b=Object(y.a)(u,2),p=b[0],m=b[1],O=Object(j.useState)(!1),x=Object(y.a)(O,2),h=x[0],_=x[1],f=Object(j.useState)(""),g=Object(y.a)(f,2),v=g[0],C=g[1],A=Object(j.useState)({status:!1,message:""}),S=Object(y.a)(A,2),F=S[0],I=S[1];return Object(H.jsx)(Nm.Provider,{value:{datosFactura:r,setDatosFactura:i,cp_valido:h,setCPValido:_,codigo_postal:v,setCodigoPostal:C,error_validation:F,setError:I,venta_factura:l,setVentaFactura:d,productos:p,setProductos:m},children:t})},Em=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Dm(e){var t=e.productos,a=e.open,n=e.handleClose;return Object(H.jsx)("div",{children:Object(H.jsxs)(qe.a,{open:a,TransitionComponent:Em,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&n()},children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{style:{display:"flex"},children:[Object(H.jsx)(L.a,{variant:"h6",children:"Productos sin CLAVE del catalogo SAT"}),Object(H.jsx)(O.a,{flexGrow:1}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return n()},children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"Hay productos sin clave de catalogo de productos del sat, sin esta clave no puede realizar facturas"}),Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{style:{maxHeight:"40vh"},children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{children:"Clave alterna"}),Object(H.jsx)(Da.a,{children:"Producto"})]})}),Object(H.jsx)(za.a,{children:t.map((function(e,t){var a=e.id_producto.datos_generales;return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:a.codigo_barras})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:a.clave_alterna})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:a.nombre_comercial})})]},t)}))})]})})})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){return n()},color:"inherit",size:"large",children:"Cerrar"})})]})})}var zm=["productos"],Tm=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),$m=Object(k.a)((function(e){return{container:{height:"50vh"}}}));function Wm(){var e=Object(j.useState)(!1),t=Object(y.a)(e,2),a=t[0],n=t[1],c=function(){return n(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{onClick:function(){return n(!0)},size:"small",children:Object(H.jsx)(Nc.a,{})}),Object(H.jsxs)(qe.a,{maxWidth:"lg",fullWidth:!0,open:a,onClose:function(e,t){"backdropClick"!==t&&c()},TransitionComponent:Tm,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{style:{display:"flex"},children:[Object(H.jsx)(L.a,{variant:"h6",children:"Selecionar venta"}),Object(H.jsx)(O.a,{flexGrow:1}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return c()},children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(Rm,{handleClose:c})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){return c()},children:"Cancelar"})})]})]})}var Rm=function(e){var t=e.handleClose,a=Object(j.useState)(""),n=Object(y.a)(a,2),c=n[0],r=n[1],i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)([]),b=Object(y.a)(u,2),p=b[0],m=b[1],x=Object(j.useState)(0),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(an.useDebounce)(c,500),v=Object(y.a)(g,1)[0],C=Dt()(v).isValid(),A=Object(rt.b)(fm,{variables:{empresa:i.empresa._id,sucursal:i.sucursal._id,filtros:{isDate:C,busqueda:v||"",filtro:"",vista:"FACTURACION"},limit:20,offset:v?0:_},fetchPolicy:"network-only"});return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Dm,{productos:p,open:l,handleClose:function(){return d(!1)}}),Object(H.jsx)(O.a,{mb:2,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,sm:8,xs:12,children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",placeholder:"Buscar por: Folio, cliente, clave o nombre",variant:"outlined",onChange:function(e){return r(e.target.value)},value:c})}),Object(H.jsx)(Qe.a,{item:!0,sm:4,xs:12,children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){return r(e.target.value)}})})]})}),Object(H.jsx)(Vm,{resultado_ventas:A,handleClose:t,setProductosSinClave:m,openProductosClaves:function(){return d(!0)},page:_,setPage:f,limit:20})]})},Vm=function(e){var t=e.resultado_ventas,a=e.handleClose,n=e.setProductosSinClave,c=e.openProductosClaves,r=e.page,i=e.setPage,o=e.limit,s=$m(),l=Object(j.useState)(""),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useContext)(Nm),x=p.setVentaFactura,h=p.setProductos,_=p.setDatosFactura,f=p.datosFactura,g=t.loading,v=t.data,C=t.error,A=Object(j.useState)(!1),S=Object(y.a)(A,2),F=S[0],k=S[1];if(g)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(H.jsx)(I.a,{})});if(C)return Object(H.jsx)(bt,{});var w=v.obtenerVentasSucursal;return Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:F,onClose:function(){return k(!1)},message:"Esta venta ya fue facturada",autoHideDuration:3e3}),Object(H.jsx)(Na.a,{className:s.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{padding:"checkbox"}),Object(H.jsx)(Da.a,{children:"Folio"}),Object(H.jsx)(Da.a,{children:"Fecha"}),Object(H.jsx)(Da.a,{children:"Cliente"}),Object(H.jsx)(Da.a,{children:"Usuario"}),Object(H.jsx)(Da.a,{children:"Caja"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:w.docs.map((function(e,t){var r=e.factura.length>0;return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,selected:e.folio===u,onClick:function(t){return function(e,t,r){if(b(t.folio),2===e){if(r)return void k(!0);var i=t.productos.filter((function(e){return!e.id_producto.datos_generales.clave_producto_sat.Value}));if(i.length>0)return n(i),void c();var o=Object(m.a)({},t),s=(o.productos,Object(De.a)(o,zm)),l=Object(Ia.a)(t.productos),d=Object(m.a)(Object(m.a)({},f),{},{payment_form:s.forma_pago,payment_method:s.metodo_pago});t.cliente&&t.cliente.rfc&&(d=Object(m.a)(Object(m.a)({},d),{},{receiver:Object(m.a)(Object(m.a)({},f.receiver),{},{Name:t.cliente.nombre_cliente,Rfc:t.cliente.rfc})})),_(d),x(s),h(l),a()}}(t.detail,e,r)},children:[Object(H.jsx)(Da.a,{children:r?Object(H.jsx)(wm.a,{color:"primary"}):null}),Object(H.jsx)(Da.a,{children:e.folio}),Object(H.jsx)(Da.a,{children:Dt()(e.fecha_registro).format("DD/MM/YYYY")}),Object(H.jsx)(Da.a,{children:null!==e.cliente?e.cliente.nombre_cliente:"-"}),Object(H.jsx)(Da.a,{children:e.usuario.nombre}),Object(H.jsx)(Da.a,{children:e.id_caja.numero_caja}),Object(H.jsxs)(Da.a,{children:["$",e.descuento?Ua(e.descuento):0]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.subTotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.total)]})]},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:w.totalDocs,rowsPerPage:o,page:r,onPageChange:function(e,t){i(t)}})]})};function Mm(){var e=u.a.useState(!1),t=Object(y.a)(e,2),a=t[0],n=t[1],c=u.a.useContext(Nm),r=c.cp_valido,i=c.setCPValido,o=(c.codigo_postal,c.setCodigoPostal),s=c.error_validation,l=u.a.useState(""),d=Object(y.a)(l,2),j=d[0],b=d[1],p=Object(an.useDebounce)(j,500),m=Object(y.a)(p,1)[0],O=u.a.useCallback(function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n(!0),e.next=6,Rc.Catalogs.PostalCodes(t,(function(e){return e}));case 6:(a=e.sent)&&(i(!0),n(!1),o(a[0].Value)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),n(!1),i(!1),o("");case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),[]);return u.a.useEffect((function(){O(m)}),[m]),Object(H.jsx)(u.a.Fragment,{children:Object(H.jsx)("form",{onSubmit:O,children:Object(H.jsx)(S.a,{fullWidth:!0,name:"expedition_place",size:"small",variant:"outlined",value:j,label:"C\xf3digo postal",onChange:function(e){return b(e.target.value)},InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:j?a?Object(H.jsx)(I.a,{size:20}):r?Object(H.jsx)(fl.a,{color:"primary"}):Object(H.jsx)(ys.a,{color:"error"}):Object(H.jsx)("div",{})})},error:!(!s.status||j)||!!j&&!r,helperText:s.status&&!j?s.message:j?r?"":"Introduce un CP valido":""})})})}var Lm=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Bm=Object(k.a)((function(e){return{container:{height:"45vh"}}}));function Um(){var e=Object(j.useState)(!1),t=Object(y.a)(e,2),a=t[0],n=t[1],c=function(){return n(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{onClick:function(){return n(!0)},size:"small",children:Object(H.jsx)(Nc.a,{})}),Object(H.jsxs)(qe.a,{maxWidth:"md",fullWidth:!0,open:a,onClose:function(e,t){"backdropClick"!==t&&c()},TransitionComponent:Lm,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{style:{display:"flex"},children:[Object(H.jsx)(L.a,{variant:"h6",children:"Selecionar cliente"}),Object(H.jsx)(O.a,{flexGrow:1}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return c()},children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(qm,{handleClose:c})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{size:"large",onClick:function(){return c()},children:"Cancelar"})})]})]})}var qm=function(e){var t=e.handleClose,a=Object(j.useState)(""),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=JSON.parse(localStorage.getItem("sesionCafi")),u=Object(Lc.a)(c,500),b=Object(y.a)(u,1)[0],p=Object(j.useState)(0),m=Object(y.a)(p,2),x=m[0],h=m[1],_=Object(rt.b)(Ko,{variables:{tipo:"CLIENTE",filtro:b,empresa:d.empresa._id,eliminado:!1,limit:20,offset:x},fetchPolicy:"network-only"});return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:s,onClose:function(){l(!1)},message:"Debes registrar un RFC y RAZ\xd3N SOCIAL a este cliente.",autoHideDuration:2e3}),Object(H.jsxs)(O.a,{mb:2,display:"flex",alignItems:"center",children:[Object(H.jsx)(S.a,{fullWidth:!0,size:"small",placeholder:"Buscar por: Numero de cliente, clave o nombre",variant:"outlined",onChange:function(e){return r(e.target.value)},value:c}),Object(H.jsx)(ts,{tipo:"CLIENTE",accion:"registrar",refetch:_.refetch})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(Mt.a,{severity:"info",children:"Para seleccionar un cliente haz un doble click!"})}),Object(H.jsx)(Jm,{handleClose:t,resultado_clientes:_,openAlertRFC:function(){l(!0)},page:x,setPage:h,limit:20})]})},Jm=function(e){var t=e.handleClose,a=e.resultado_clientes,n=e.openAlertRFC,c=e.page,r=e.setPage,i=e.limit,o=Bm(),s=Object(j.useState)(""),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useContext)(Nm),p=b.datosFactura,x=b.setDatosFactura,h=a.loading,_=a.data,f=a.error,g=a.refetch;if(h)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(H.jsx)(I.a,{})});if(f)return Object(H.jsx)(bt,{});var v=_.obtenerClientes;return Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{minwidth:"100",children:"No. Cliente"}),Object(H.jsx)(Da.a,{minwidth:"100",children:"Clave"}),Object(H.jsx)(Da.a,{minwidth:"150",children:"Nombre"}),Object(H.jsx)(Da.a,{minwidth:"150",children:"Razon Social"}),Object(H.jsx)(Da.a,{minwidth:"150",children:"RFC"}),Object(H.jsx)(Da.a,{minwidth:"150",children:"Editar Cliente"})]})}),Object(H.jsx)(za.a,{children:v.docs.map((function(e,a){return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(a){return function(e,a){if(u(a.nombre_cliente),2===e){if(!a.rfc)return void n();x(Object(m.a)(Object(m.a)({},p),{},{receiver:Object(m.a)(Object(m.a)({},p.receiver),{},{Name:a.nombre_cliente,Rfc:a.rfc})})),t()}}(a.detail,e)},selected:e.nombre_cliente===d,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:e.numero_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:e.clave_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:e.nombre_cliente})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:e.razon_social})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:e.rfc?e.rfc:Object(H.jsx)(ys.a,{color:"primary"})})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(ts,{tipo:"CLIENTE",accion:"actualizar",datos:e,refetch:g})})]},a)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:v.totalDocs,rowsPerPage:i,page:c,onPageChange:function(e,t){r(t)}})]})};function Hm(e){var t=e.serie_default,a=Object(j.useContext)(Nm),n=a.datosFactura,c=a.setDatosFactura,r=a.error_validation,i=a.venta_factura;Object(j.useEffect)((function(){var e=t[0],a=e.folio,r=e.serie;c(Object(m.a)(Object(m.a)({},n),{},{folio:a.toString(),serie:r}))}),[]);var o=function(e){var t=e.target,a=t.name,r=t.value;console.log(a,r),c(Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a,r)))};return Object(H.jsxs)("div",{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:5,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(O.a,{mb:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Emisor: ".concat(n.issuer.Name)})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{children:"RFC"}),Object(H.jsx)(S.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.issuer.Rfc,disabled:!0,error:r.status&&!n.issuer.Rfc,helperText:r.status&&!n.issuer.Rfc?r.message:""})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{children:"Regimen fiscal"}),Object(H.jsx)(ee.a,{fullWidth:!0,size:"small",variant:"outlined",children:Object(H.jsx)(S.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.issuer.FiscalRegime,disabled:!0,error:r.status&&!n.issuer.FiscalRegime,helperText:r.status&&!n.issuer.FiscalRegime?r.message:""})})]})]})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(O.a,{mb:1,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Receptor"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{children:"Cliente"}),Object(H.jsx)(S.a,{value:n.receiver.Name,placeholder:"Selecciona un cliente",fullWidth:!0,size:"small",variant:"outlined",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(Um,{})}),readOnly:!0,disabled:!0},error:r.status&&!n.receiver.Name,helperText:r.status&&!n.receiver.Name?r.message:""})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{children:"RFC"}),Object(H.jsx)(S.a,{size:"small",variant:"outlined",fullWidth:!0,value:n.receiver.Rfc,disabled:!0,error:r.status&&!n.receiver.Rfc,helperText:r.status&&!n.receiver.Rfc?r.message:""})]})]})]})]}),Object(H.jsxs)(O.a,{mt:1,mb:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Datos factura"})}),Object(H.jsx)(et.a,{})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,xs:12,sm:4,md:3,children:Object(H.jsx)(S.a,{placeholder:"Selecciona venta a facturar",fullWidth:!0,size:"small",label:"Folio Venta",variant:"outlined",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(Wm,{})}),readOnly:!0,disabled:!0},value:i?i.folio:""})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,sm:4,md:1,children:Object(H.jsx)(S.a,{value:n.folio,label:"Folio",fullWidth:!0,size:"small",variant:"outlined",disabled:!0,error:r.status&&!n.folio,helperText:r.status&&!n.folio?r.message:""})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,sm:4,md:1,children:Object(H.jsx)(S.a,{value:n.serie,label:"Serie",fullWidth:!0,size:"small",variant:"outlined",disabled:!0,error:r.status&&!n.serie,helperText:r.status&&!n.serie?r.message:""})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,sm:4,md:2,children:Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"cfdi_type",error:r.status&&!n.cfdi_type,children:[Object(H.jsx)(te.a,{id:"cfdi_type",children:"Tipo de CFDI"}),Object(H.jsxs)(Nt.a,{labelId:"cfdi_type",value:n.cfdi_type,name:"cfdi_type",onChange:o,label:"tipo de CFDI",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Tt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(H.jsx)(wa.a,{children:r.status&&!n.cfdi_type?r.message:""})]})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,sm:4,md:2,children:Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"currency",error:r.status&&!n.currency,children:[Object(H.jsx)(te.a,{id:"moneda",children:"Moneda"}),Object(H.jsxs)(Nt.a,{labelId:"moneda",value:n.currency,name:"currency",onChange:o,label:"moneda",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),$t.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(H.jsx)(wa.a,{children:r.status&&!n.currency?r.message:""})]})}),Object(H.jsx)(Qe.a,{item:!0,xs:12,sm:4,md:3,children:Object(H.jsx)(Mm,{})})]})]})}var Gm=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Ym(e){var t=e.venta,a=e.producto,n=e.index,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useContext)(Nm),l=s.setVentaFactura,d=s.setProductos,u=s.productos,b=Object(j.useState)(Object(m.a)({},a)),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useState)(Object(m.a)({},t)),f=Object(y.a)(_,2),A=f[0],I=f[1],k=Object(j.useState)(x.cantidad_venta),w=Object(y.a)(k,2),N=w[0],P=w[1],E=Object(j.useState)(x.precio_actual_object.precio_neto),D=Object(y.a)(E,2),z=D[0],T=D[1],$=Object(j.useState)(!1),W=Object(y.a)($,2),R=W[0],V=W[1],M=function(){o(!1)},B=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,r,i,o,s,l,d,j,u,b,p,O,_,f,C,y,S,F,k,w,E,D,z;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target,n=a.name,c=a.value,"cantidad_venta"===n?P(c):T(c),c){e.next=4;break}return e.abrupt("return");case 4:return r=Object(m.a)({},A),i=Object(m.a)({},x),o=Object(m.a)({},i),s=o.precio_actual_object,l=o.cantidad_venta,d=o.granel_producto,j=Object(m.a)({},i.id_producto),u=j.precios,e.next=10,Ha({newP:i,cantidad:l,granel:d,precio_boolean:!0,precio:s});case 10:if(b=e.sent,r.iva=r.iva-b.ivaCalculo,r.ieps=r.ieps-b.iepsCalculo,r.impuestos=r.impuestos-b.impuestoCalculo,r.subTotal=r.subTotal-b.subtotalCalculo,r.total=r.total-b.totalCalculo,r.monedero=r.monedero-b.monederoCalculo,"cantidad_venta"!==n){e.next=25;break}return e.next=20,Ha({newP:i,cantidad:parseFloat(c),granel:d,precio_boolean:!0,precio:s});case 20:p=e.sent,i.cantidad_venta=parseFloat(c),h(Object(m.a)(Object(m.a)({},i),{},Object(g.a)({},n,parseFloat(c)))),e.next=46;break;case 25:return O=parseFloat(c),_=u.iva,f=u.ieps,C=parseFloat("0.".concat(_<10?"0".concat(_):_))+parseFloat("0.".concat(f<10?"0".concat(f):f)),y=parseFloat(O/l),S=parseFloat(y/(C+1)),F=parseFloat(S*parseFloat("0.".concat(_<10?"0".concat(_):_))),k=parseFloat(S*parseFloat("0.".concat(f<10?"0".concat(f):f))),w=u.unidad_de_compra.precio_unitario_sin_impuesto,E=parseFloat((S-w)/w*100),D=Object(m.a)({},s),z=k+F,D.ieps_precio=parseFloat(k.toFixed(2)),D.iva_precio=parseFloat(F.toFixed(2)),D.precio_venta=parseFloat(S.toFixed(2)),D.precio_neto=parseFloat(y.toFixed(2)),D.utilidad=parseFloat(E.toFixed(2)),s.unidad_maxima&&(s.precio_general=O),e.next=44,Ha({newP:i,cantidad:l,granel:d,precio_boolean:!0,precio:D});case 44:p=e.sent,h(Object(m.a)(Object(m.a)({},i),{},{precio_actual_object:D,ieps_total:D.ieps_precio*N,iva_total:D.iva_precio*N,precio_a_vender:D.precio_neto*N,precio_actual_producto:D.precio_neto*N,subtotal:D.precio_venta*N,impuestos:z*N,total:D.precio_neto*N}));case 46:r.iva=r.iva+p.ivaCalculo,r.ieps=r.ieps+p.iepsCalculo,r.impuestos=r.impuestos+p.impuestoCalculo,r.subTotal=r.subTotal+p.subtotalCalculo,r.total=r.total+p.totalCalculo,r.monedero=r.monedero+p.monederoCalculo,I(r);case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){V(!e)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{size:"small",onClick:function(){o(!0)},children:Object(H.jsx)(yn.a,{})}),Object(H.jsxs)(qe.a,{open:i,TransitionComponent:Gm,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&M()},fullWidth:!0,maxWidth:"md",children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{style:{display:"flex"},children:[Object(H.jsx)(L.a,{variant:"h6",children:x.id_producto.datos_generales.nombre_comercial}),Object(H.jsx)(O.a,{flexGrow:1}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",size:"large",onClick:function(){return M(),h(a),I(t),P(a.cantidad_venta),void T(a.precio_actual_object.precio_neto)},children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{mb:2,children:Object(H.jsxs)(O.a,{mb:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Producto"})}),Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{width:50},children:"Cantidad"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Precio"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Subtotal"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Impuestos"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Total"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(S.a,{variant:"outlined",size:"small",value:N,type:"number",name:"cantidad_venta",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:x.unidad})},onChange:B,placeholder:a?a.cantidad_venta.toString():"",onBlur:function(e){return U(e.target.value)},error:R&&!N})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(S.a,{variant:"outlined",size:"small",value:z,type:"number",name:"precio_neto",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},onChange:B,placeholder:a.precio_actual_object.precio_neto.toString(),onBlur:function(e){return U(e.target.value)},error:R&&!z})}),Object(H.jsxs)(Da.a,{children:["$",Ua(x.subtotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(x.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(x.total)]})]})})]})})]})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Venta"})})}),Object(H.jsx)(et.a,{}),Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{width:50},children:"IVA"}),Object(H.jsx)(Da.a,{style:{width:50},children:"IEPS"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Subtotal"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Impuestos"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Total"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(A.iva)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(A.ieps)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:[" $",Ua(A.subTotal)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:["$",Ua(A.impuestos)]})}),Object(H.jsx)(Da.a,{children:Object(H.jsxs)("b",{children:[" $",Ua(A.total)]})})]})})]})})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){return function(){if(!R){var e=Object(Ia.a)(u);e.splice(n,1,x),l(A),d(e),M()}}()},variant:"contained",color:"primary",children:"Guardar"})})]})]})}var Qm=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Km(e){var t=e.venta,a=e.producto,n=e.index,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useContext)(Nm),l=s.setVentaFactura,d=s.setProductos,u=s.productos,b=a.id_producto.datos_generales,p=function(){o(!1)},O=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c,r,i,o,s,j,b,O,x,h,_,f,g,C,y,A,S,F;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(m.a)({},t),r=Object(Ia.a)(u),i=a.cantidad_venta,o=a.granel_producto,s=a.precio_actual_object,j=c.iva,b=c.ieps,O=c.impuestos,x=c.subTotal,h=c.total,_=c.monedero,e.next=6,Ha({newP:a,cantidad:i,granel:o,precio_boolean:!0,precio:s});case 6:f=e.sent,console.log(f),g=f.ivaCalculo,C=f.iepsCalculo,y=f.impuestoCalculo,A=f.subtotalCalculo,S=f.totalCalculo,F=f.monederoCalculo,c.iva=j-g,c.ieps=b-C,c.impuestos=O-y,c.subTotal=x-A,c.total=h-S,c.monedero=_-F,r.splice(n,1),l(c),d(r),p();case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{size:"small",onClick:function(){o(!0)},children:Object(H.jsx)(Gt.a,{})}),Object(H.jsxs)(qe.a,{open:i,TransitionComponent:Qm,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&p()},children:[Object(H.jsx)(Bt.a,{children:"\xbfEst\xe1 seguro de eliminar este producto?"}),Object(H.jsx)(He.a,{children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{width:100},children:"Producto"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Cantidad"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Subtotal"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Impuestos"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Total"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:b.nombre_comercial}),Object(H.jsx)(Da.a,{children:a.cantidad_venta}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.subtotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.total)]})]})})]})})}),Object(H.jsxs)(tt.a,{style:{justifyContent:"center"},children:[Object(H.jsx)(F.a,{onClick:function(){return p()},color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return O()},color:"secondary",children:"Eliminar"})]})]})]})}var Xm=Object(k.a)({root:{width:"100%"},container:{height:"36vh"}});function Zm(){var e=Xm(),t=Object(j.useContext)(Nm),a=t.venta_factura,n=t.productos;return a?Object(H.jsxs)(fn.a,{className:e.root,variant:"elevation",children:[Object(H.jsx)(O.a,{textAlign:"center",children:Object(H.jsx)(L.a,{variant:"button",children:"Detalles de Venta"})}),Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{width:250},children:"Folio"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Cliente"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Descuento"}),Object(H.jsx)(Da.a,{style:{width:50},children:"IVA"}),Object(H.jsx)(Da.a,{style:{width:50},children:"IEPS"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Subtotal"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Impuestos"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Total"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Usuario"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Caja"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{style:{width:200},children:a.folio}),Object(H.jsx)(Da.a,{style:{width:50},children:null!==a.cliente?a.cliente.nombre_cliente:"-"}),Object(H.jsxs)(Da.a,{style:{width:200},children:["$",Ua(a.descuento)]}),Object(H.jsxs)(Da.a,{style:{width:200},children:["$",a.iva?Ua(a.iva):0]}),Object(H.jsxs)(Da.a,{style:{width:200},children:["$",a.ieps?Ua(a.ieps):0]}),Object(H.jsxs)(Da.a,{style:{width:200},children:["$",Ua(a.subTotal)]}),Object(H.jsxs)(Da.a,{style:{width:200},children:["$",Ua(a.impuestos)]}),Object(H.jsxs)(Da.a,{style:{width:200},children:["$",Ua(a.total)]}),Object(H.jsx)(Da.a,{style:{width:200},children:a.usuario.nombre}),Object(H.jsx)(Da.a,{style:{width:200},children:a.id_caja.numero_caja})]})})]})}),Object(H.jsx)(O.a,{textAlign:"center",mt:1,children:Object(H.jsx)(L.a,{variant:"button",children:"Productos de Venta"})}),Object(H.jsx)(Na.a,{className:e.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{width:250},children:"Producto"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Cantidad"}),Object(H.jsx)(Da.a,{style:{width:50},children:"IVA"}),Object(H.jsx)(Da.a,{style:{width:50},children:"IEPS"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Subtotal"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Impuestos"}),Object(H.jsx)(Da.a,{style:{width:100},children:"Total"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Modificar"}),Object(H.jsx)(Da.a,{style:{width:50},children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:n.map((function(e,t){return Object(H.jsx)(eO,{venta:a,producto:e,index:t},t)}))})]})})]}):null}var eO=function(e){var t=e.venta,a=e.producto,n=e.index,c=a.id_producto.datos_generales;return Object(H.jsxs)(Ea.a,{tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:c.nombre_comercial}),Object(H.jsx)(Da.a,{children:a.cantidad_venta}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.iva_total)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.ieps_total)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.subtotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(a.total)]}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(Ym,{venta:t,producto:a,index:n})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(Km,{venta:t,producto:a,index:n})})]})},tO=function(e){var t=e.cfdi_type,a=e.currency,n=e.date,c=e.empresa,r=e.expedition_place,i=e.folio,o=e.issuer,s=e.items,l=e.payment_form,d=e.payment_method,j=e.receiver,u=e.serie,b=e.sucursal;return t&&a&&n&&c&&r&&i&&o&&s&&l&&d&&j&&u&&b?[]:[{message:"Campo requerido"}]},aO=JSON.parse(localStorage.getItem("sesionCafi")),nO={serie:"",currency:"MXN",expedition_place:"",folio:"",cfdi_type:"I",payment_form:"",payment_method:"",logo_url:aO&&aO.empresa.imagen?aO.empresa.imagen:"",date:"0",issuer:{FiscalRegime:aO?aO.empresa.regimen_fiscal:"",Rfc:aO?aO.empresa.rfc:"",Name:aO?aO.empresa.nombre_fiscal:""},receiver:{Rfc:"",Name:"",CfdiUse:""},items:[],empresa:aO?aO.empresa._id:"",sucursal:aO?aO.sucursal._id:""},cO=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function rO(e){var t=e.setAlert,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useContext)(Nm),u=d.datosFactura,b=d.setDatosFactura,p=d.codigo_postal,x=d.setCodigoPostal,h=d.productos,_=d.setProductos,f=d.venta_factura,g=d.setVentaFactura,A=d.setError,S=Object(w.a)(Qt),k=Object(y.a)(S,1)[0],N=function(){r(!1)},P=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var a,n,c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l(!0),a=Object(m.a)({},u),n=[],h.forEach((function(e){var t=e.id_producto.precios,a=t.iva,c=t.ieps,r=[];e.iva_total&&r.push({Total:e.iva_total.toFixed(2),Name:"IVA",Base:e.subtotal.toFixed(2),Rate:"0.".concat(a<10?"0".concat(a):a),IsRetention:"false"}),e.ieps_total&&r.push({Total:e.ieps_total.toFixed(2),Name:"IEPS",Base:e.subtotal.toFixed(2),Rate:"0.".concat(c<10?"0".concat(c):c),IsRetention:"true"}),n.push({ProductCode:e.id_producto.datos_generales.clave_producto_sat.Value,IdentificationNumber:e.id_producto._id,Description:e.id_producto.datos_generales.nombre_comercial,UnitCode:e.codigo_unidad,UnitPrice:e.precio_unidad.precio_venta.toFixed(2),Quantity:e.cantidad_venta.toString(),Subtotal:e.subtotal_antes_de_impuestos.toFixed(2),Discount:e.descuento_activo?e.descuento_producto.dinero_descontado.toFixed(2):"0.00",Taxes:r.length?r:null,Total:e.total.toFixed(2)})})),"1"===u.date?a.date=Dt()().subtract(1,"d").format("YYYY-MM-DDTHH:mm:ss"):"2"===u.date?a.date=Dt()().subtract(2,"d").format("YYYY-MM-DDTHH:mm:ss"):a.date=Dt()().locale("es-mx").format("YYYY-MM-DDTHH:mm:ss"),a.items=n,a.expedition_place=p,a.id_venta=f._id,a.folio_venta=f.folio,!(c=tO(a)).length){e.next=15;break}return A({status:!0,message:c[0].message}),l(!1),e.abrupt("return");case 15:return A({status:!1,message:""}),e.next=18,k({variables:{input:a}});case 18:r=e.sent,l(!1),t({message:"\xa1Listo! ".concat(r.data.crearFactura.message),status:"success",open:!0}),b(nO),g(null),_([]),x(""),N(),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(0),console.log(e.t0),l(!1),e.t0.message?t({message:e.t0.message,status:"error",open:!0}):e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 30:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{color:"primary",variant:"contained",startIcon:Object(H.jsx)(hn.a,{}),size:"large",onClick:function(){r(!0)},children:"Guardar"}),Object(H.jsxs)(qe.a,{open:c,TransitionComponent:cO,keepMounted:!0,onClose:function(e,t){"backdropClick"!==t&&N()},fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",m:1,children:Object(H.jsx)(F.a,{onClick:function(){return N()},size:"large",color:"secondary",variant:"contained",disabled:s,children:Object(H.jsx)(Gt.a,{})})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(iO,{})}),Object(H.jsx)(tt.a,{style:{justifyContent:"center"},children:Object(H.jsx)(F.a,{startIcon:s?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Yt.a,{}),onClick:function(){return P()},variant:"contained",color:"primary",disabled:s,children:"Guardar"})})]})]})}var iO=function(){var e=Object(j.useContext)(Nm),t=e.datosFactura,a=e.setDatosFactura,n=e.error_validation,c=function(e){var n=e.target,c=n.name,r=n.value;a(Object(m.a)(Object(m.a)({},t),{},Object(g.a)({},c,r)))};return Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:"Fecha de facturaci\xf3n"}),Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"date",error:n.status&&!t.date,children:[Object(H.jsxs)(Nt.a,{value:t.date,name:"date",onChange:c,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona una fecha"})}),Object(H.jsx)(Pt.a,{value:"0",children:Dt()().locale("es-mx").format("LL")}),Object(H.jsx)(Pt.a,{value:"1",children:Dt()().subtract(1,"d").format("LL")}),Object(H.jsx)(Pt.a,{value:"2",children:Dt()().subtract(2,"d").format("LL")})]}),Object(H.jsx)(wa.a,{children:n.status&&!t.date?n.message:""})]})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:"Forma de pago"}),Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"payment_form",error:n.status&&!t.payment_form,children:[Object(H.jsxs)(Nt.a,{value:t.payment_form,name:"payment_form",onChange:c,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(H.jsx)(wa.a,{children:n.status&&!t.payment_form?n.message:""})]})]}),Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsx)(L.a,{children:"M\xe9todo de pago"}),Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",name:"payment_method",error:n.status&&!t.payment_method,children:[Object(H.jsxs)(Nt.a,{value:t.payment_method,name:"payment_method",onChange:c,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Rt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(H.jsx)(wa.a,{children:n.status&&!t.payment_method?n.message:""})]})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:"Uso de CFDi"}),Object(H.jsxs)(ee.a,{fullWidth:!0,size:"small",variant:"outlined",error:n.status&&!t.receiver.CfdiUse,children:[Object(H.jsxs)(Nt.a,{value:t.receiver.CfdiUse,name:"CfdiUse",onChange:function(e){var n=e.target,c=n.name,r=n.value;a(Object(m.a)(Object(m.a)({},t),{},{receiver:Object(m.a)(Object(m.a)({},t.receiver),{},Object(g.a)({},c,r))}))},children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),zt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]}),Object(H.jsx)(wa.a,{children:n.status&&!t.receiver.CfdiUse?n.message:""})]})]})]})},oO=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function sO(e){var t=e.open,a=e.setOpen,n=e.handleCloseFactura,c=Object(j.useContext)(Nm),r=c.setDatosFactura,i=c.setCodigoPostal,o=c.setProductos,s=c.setVentaFactura,l=c.setCPValido,d=c.setError,u=function(){a(!1)},b=function(){r(nO),s(null),o([]),i(""),l(!1),d({status:!1,message:""}),u(),n()};return Object(H.jsx)("div",{children:Object(H.jsxs)(qe.a,{open:t,TransitionComponent:oO,keepMounted:!0,onClose:function(){return u()},children:[Object(H.jsx)(Bt.a,{children:"\xbfEst\xe1s seguro de cancelar esta factura?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return u()},children:"Cerrar"}),Object(H.jsx)(F.a,{onClick:function(){return b()},color:"primary",children:"Cancelar Factura"})]})]})})}var lO=a.p+"static/media/factura-2.312cbce3.png",dO=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}})),jO=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function uO(){var e=Object(j.useState)(!1),t=Object(y.a)(e,2),a=t[0],n=t[1],c=function(){n(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){n(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(H.jsx)("img",{src:lO,alt:"icono Factura",style:{width:100}})}),"Nuevo CFDI"]})}),Object(H.jsx)(qe.a,{fullScreen:!0,open:a,onClose:function(){return c()},disableEscapeKeyDown:!0,TransitionComponent:jO,children:Object(H.jsx)(Pm,{children:Object(H.jsx)(bO,{handleClose:c})})})]})}var bO=function(e){var t=e.handleClose,a=dO(),n=Object(j.useContext)(Nm).venta_factura,c=u.a.useState(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)({message:"",status:"",open:!1}),l=Object(y.a)(s,2),d=l[0],b=l[1],p=function(){null!==n?o(!0):t()};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Re.a,{className:a.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:a.title,children:"Nuevo CFDI"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",onClick:function(){return p()},color:"secondary",size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(Y,{alert:d,setAlert:b}),Object(H.jsx)(pO,{})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(rO,{setAlert:b})}),Object(H.jsx)(sO,{open:i,setOpen:o,handleCloseFactura:t})]})},pO=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(rt.b)(ea,{variables:{sucursal:e.sucursal._id,empresa:e.empresa._id},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error;if(a)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(c)return Object(H.jsx)(bt,{error:c});var r=n.obtenerSeriesCdfi.seriesCfdi,i=[];return(i=r.filter((function(e){return!0===e.default}))).length||(i=[{folio:"",serie:""}]),Object(H.jsxs)(j.Fragment,{children:[r.length?null:Object(H.jsx)(Mt.a,{severity:"warning",children:"No tienes Series CFDI registradas"}),Object(H.jsx)(O.a,{my:2,children:Object(H.jsx)(Hm,{serie_default:i})}),Object(H.jsx)(Zm,{})]})},mO=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function OO(e){var t=e.refetch,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)({folio:"",serie:"",default:!1}),o=Object(y.a)(i,2),s=o[0],l=o[1],d=JSON.parse(localStorage.getItem("sesionCafi")),u=Object(j.useState)({message:"",status:"",open:!1}),b=Object(y.a)(u,2),p=b[0],x=b[1],h=Object(j.useState)(!1),_=Object(y.a)(h,2),f=_[0],A=_[1],k=Object(w.a)(Kt),N=Object(y.a)(k,1)[0],P=function(){r(!1),l({folio:"",serie:"",default:!1})},E=function(e){var t=e.target,a=t.name,n=t.value;l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},a,n)))},D=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.folio&&s.serie){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,A(!0),e.next=6,N({variables:{input:{serie:s.serie,folio:parseInt(s.folio),default:s.default,empresa:d.empresa._id,sucursal:d.sucursal._id}}});case 6:a=e.sent,x({message:"\xa1Listo! ".concat(a.data.crearSerieCFDI.message),status:"success",open:!0}),t(),A(!1),P(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(2),A(!1),x({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),console.log(e.t0),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:p,setAlert:x}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{onClick:function(){r(!0)},color:"primary",variant:"contained",size:"large",startIcon:Object(H.jsx)(Ut.a,{}),children:"Nueva serie"})}),Object(H.jsxs)(qe.a,{maxWidth:"xs",fullWidth:!0,open:c,onClose:function(){return P()},TransitionComponent:mO,children:[Object(H.jsx)(Bt.a,{children:"Registrar nueva serie"}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:"Serie para CDFI:"}),Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",name:"serie",onChange:E,inputProps:{style:{textTransform:"uppercase"}}})})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:"Folio Inicial:"}),Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",name:"folio",onChange:E})})]}),Object(H.jsx)(Xe.a,{style:{marginTop:8},control:Object(H.jsx)(Ze.a,{checked:s.default,onChange:function(e){var t=e.target,a=t.name,n=t.checked;l(Object(m.a)(Object(m.a)({},s),{},Object(g.a)({},a,n)))},name:"default"}),label:"Serie predeterminada"})]}),Object(H.jsxs)(tt.a,{style:{justifyContent:"center"},children:[Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(Gt.a,{}),onClick:function(){return P()},children:"Cancelar"}),Object(H.jsx)(F.a,{color:"primary",startIcon:f?Object(H.jsx)(I.a,{size:20}):Object(H.jsx)(Yt.a,{}),disabled:!s.serie||!s.folio||f,onClick:function(){return D()},children:"Guardar"})]})]})]})}var xO=a(158),hO=a.n(xO),_O=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),fO=Object(k.a)((function(e){return{container:{height:"80vh"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function gO(e){var t=e.obtenerSeriesCdfi,a=e.refetch,n=fO(),c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)({message:"",status:"",open:!1}),l=Object(y.a)(s,2),d=l[0],u=l[1],b=JSON.parse(localStorage.getItem("sesionCafi")),p=t.seriesCfdi,m=Object(w.a)(Xt),O=Object(y.a)(m,1)[0],x=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t,n){var c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,O({variables:{id:n._id,empresa:b.empresa._id,sucursal:b.sucursal._id}});case 4:c=e.sent,a(),o(!1),u({message:"\xa1Listo! ".concat(c.data.modificarDefaultSerie.message),status:"success",open:!0}),o(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),o(!1),u({message:"Error: ".concat(e.t0.message),status:"success",open:!0});case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,a){return e.apply(this,arguments)}}();return Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(it.a,{className:n.backdrop,open:i,children:Object(H.jsx)(I.a,{color:"inherit"})}),Object(H.jsx)(Y,{alert:d,setAlert:u}),Object(H.jsx)(Na.a,{className:n.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Serie"}),Object(H.jsx)(Da.a,{children:"Folio"}),Object(H.jsx)(Da.a,{children:"Predeterminado"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:p.map((function(e,t){return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:e.serie}),Object(H.jsx)(Da.a,{children:e.folio}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(Ze.a,{checked:e.default,onChange:function(t){return x(t.target.checked,e)},name:"checkedA"})}),Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:!1===b.accesos.facturacion.registro_series_cdfi.eliminar?null:Object(H.jsx)(vO,{row:e,refetch:a,setAlert:u})})]},t)}))})]})})]})}var vO=function(e){var t=e.row,a=e.refetch,n=e.setAlert,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(w.a)(Zt),p=Object(y.a)(b,1)[0],m=function(){return o(!1)},O=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,p({variables:{id:t._id}});case 4:c=e.sent,a(),u(!1),m(),n({message:"\xa1Listo! ".concat(c.data.eliminarSerie.message),status:"success",open:!0}),u(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),u(!1),n({message:"Error: ".concat(e.t0.message),status:"success",open:!0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{"aria-label":"delete",size:"small",onClick:function(){return o(!0)},disabled:t.default,children:Object(H.jsx)(hO.a,{})}),Object(H.jsxs)(qe.a,{open:i,onClose:function(){return m()},TransitionComponent:_O,children:[Object(H.jsx)(Bt.a,{children:"Se eliminara esta serie"}),Object(H.jsxs)(tt.a,{style:{justifyContent:"center"},children:[Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(Gt.a,{}),onClick:function(){return m()},children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",disabled:d,startIcon:d?Object(H.jsx)(I.a,{size:20}):Object(H.jsx)(Yt.a,{}),onClick:function(){return O()},children:"Eliminar"})]})]})]})},CO=a.p+"static/media/factura-1.357d7c56.png",yO=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),AO=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function SO(){JSON.parse(localStorage.getItem("sesionCafi"));var e=yO(),t=Object(j.useState)(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:r,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(H.jsx)("img",{src:CO,alt:"icono Factura",style:{width:100}})}),"Series CFDI"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:AO,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Series para CFDI"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{color:"secondary",variant:"contained",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsx)(FO,{})]})]})}var FO=function(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(rt.b)(ea,{variables:{sucursal:e.sucursal._id,empresa:e.empresa._id},fetchPolicy:"network-only"}),a=t.loading,n=t.data,c=t.error,r=t.refetch;if(a)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(c)return Object(H.jsx)(bt,{error:c});var i=n.obtenerSeriesCdfi;return Object(H.jsxs)(A.a,{maxWidth:"md",children:[Object(H.jsx)(O.a,{my:2,children:!1===e.accesos.facturacion.registro_series_cdfi.agregar?null:Object(H.jsx)(OO,{refetch:r})}),Object(H.jsx)(gO,{obtenerSeriesCdfi:i,refetch:r})]})},IO=a(79),kO=a(480),wO=function(e,t){for(var a=atob(e),n=a.length,c=new Uint8Array(n);n--;)c[n]=a.charCodeAt(n);return new Blob([c],{type:t})};function NO(e){var t=e.factura,a=e.facturaBase64,n=e.setOpen,c=function(){n(!1)};if(e.loading)return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(He.a,{children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"70vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h6",children:"Cargando..."})]})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:c,color:"inherit",startIcon:Object(H.jsx)(Gt.a,{}),children:"Cerrar"}),Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(IO.d,{}),disabled:!0,children:"PDF"}),Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(IO.c,{}),disabled:!0,children:"XML"})]})]});if(!a||!t)return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(He.a,{children:Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"70vh",children:Object(H.jsx)(bt,{})})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:c,color:"inherit",startIcon:Object(H.jsx)(Gt.a,{}),children:"Cerrar"}),Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(IO.d,{}),disabled:!0,children:"PDF"}),Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(IO.c,{}),disabled:!0,children:"XML"})]})]});var r=window.atob(a.htmlBase64),i=wO(a.pdfBase64,"application/pdf"),o=URL.createObjectURL(i),s=wO(a.xmlBase64,"text/plain"),l=URL.createObjectURL(s);return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(He.a,{children:Object(H.jsx)(kO.a,{html:r})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:c,color:"inherit",startIcon:Object(H.jsx)(Gt.a,{}),children:"Cerrar"}),Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(IO.d,{}),download:"CFDI ".concat(t.fecha_registro," ").concat(t.receiver.Name),href:o,children:"PDF"}),Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(IO.c,{}),download:"CFDI ".concat(t.fecha_registro," ").concat(t.receiver.Name,".xml"),href:l,children:"XML"})]})]})}var PO=a(481),EO=a.n(PO),DO=a(482),zO=a.n(DO),TO=a(962),$O=[{label:"Serie",padding:"checkbox"},{label:"Folio",padding:"checkbox"},{label:"Folio venta",minWidth:90},{label:"Fecha",minWidth:90},{label:"Tipo CDFI",minWidth:110},{label:"M. de pago",minWidth:90},{label:"F. de pago",minWidth:110},{label:"Cliente",minWidth:100},{label:"Parcialidad",minWidth:90},{label:"Saldo anterior",minWidth:90},{label:"Cantidad",minWidth:100}],WO=Object(k.a)((function(e){return{root:{"& > *":{borderBottom:"unset"}}}}));function RO(e){var t,a=e.data,n=e.open,c=e.handleSelectFactura,r=WO();return Object(H.jsx)(Ea.a,{children:Object(H.jsx)(Da.a,{style:{paddingBottom:0,paddingTop:0},colSpan:12,children:Object(H.jsx)(TO.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object(H.jsxs)(O.a,{margin:1,children:[Object(H.jsx)(L.a,{variant:"h6",gutterBottom:!0,component:"div",children:"Complementos de pago"}),Object(H.jsxs)($a.a,{size:"small","aria-label":"purchases",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:$O.map((function(e,t){return Object(H.jsx)(Da.a,{padding:e.padding,style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(H.jsx)(za.a,{children:null===(t=a.complementos)||void 0===t?void 0:t.map((function(e,t){var n,i,o,s,l,d,j,u,b,p,m,O,x;return Object(H.jsxs)(Ea.a,{hover:!0,onClick:function(t){return c(t,e)},className:a.complementos.length===t+1?r.root:"",children:[Object(H.jsx)(Da.a,{children:e.serie}),Object(H.jsx)(Da.a,{children:e.folio}),Object(H.jsx)(Da.a,{children:e.folio_venta}),Object(H.jsx)(Da.a,{children:Dt()(e.fecha_registro).format("DD/MM/YYYY")}),Object(H.jsx)(Da.a,{children:e.cfdi_type}),Object(H.jsx)(Da.a,{children:null===(n=e.complement)||void 0===n||null===(i=n.Payments[0])||void 0===i||null===(o=i.RelatedDocuments[0])||void 0===o?void 0:o.PaymentMethod}),Object(H.jsx)(Da.a,{children:null===(s=e.complement)||void 0===s||null===(l=s.Payments[0])||void 0===l?void 0:l.PaymentForm}),Object(H.jsx)(Da.a,{children:e.receiver.Name}),Object(H.jsx)(Da.a,{children:null===(d=e.complement)||void 0===d||null===(j=d.Payments[0])||void 0===j||null===(u=j.RelatedDocuments[0])||void 0===u?void 0:u.PartialityNumber}),Object(H.jsxs)(Da.a,{children:["$",Ua(null===(b=e.complement)||void 0===b||null===(p=b.Payments[0])||void 0===p||null===(m=p.RelatedDocuments[0])||void 0===m?void 0:m.PreviousBalanceAmount)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(null===(O=e.complement)||void 0===O||null===(x=O.Payments[0])||void 0===x?void 0:x.Amount)]})]},t)}))})]})]})})})})}var VO=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),MO=[{label:"expand",padding:"checkbox"},{label:"Serie",padding:"checkbox"},{label:"Folio",padding:"checkbox"},{label:"Folio venta",minWidth:90},{label:"Fecha",minWidth:90},{label:"Tipo CDFI",minWidth:110},{label:"M. de pago",minWidth:90},{label:"F. de pago",minWidth:110},{label:"Cliente",minWidth:100},{label:"Descuento",minWidth:90},{label:"Subtotal",minWidth:90},{label:"Total",minWidth:100}],LO=Object(k.a)((function(e){return{container:{height:"67vh"},root:{"& > *":{borderBottom:"unset"}},notas_credito:{borderLeft:" 6px solid #FFEAAD"},complementos:{borderLeft:"6px solid #C0DEFF"}}}));function BO(e){var t=e.data,a=e.page,n=e.setPage,c=e.refetch,r=e.filtro,i=e.limit,o=LO(),s=Object(j.useState)(),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)(),p=Object(y.a)(b,2),m=p[0],x=p[1],h=Object(j.useState)(!1),_=Object(y.a)(h,2),f=_[0],g=_[1],A=Object(j.useState)(!1),S=Object(y.a)(A,2),F=S[0],I=S[1],k=Object(j.useState)(!1),w=Object(y.a)(k,2),N=w[0],P=w[1],E=JSON.parse(localStorage.getItem("sesionCafi")),D=function(e,t){2===e.detail&&(u(t),g(!0),T(t.id_cfdi))},z=Object(Fo.a)(),T=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I(!0),e.next=4,z.query({query:ca,variables:{id:t},fetchPolicy:"network-only"});case 4:a=e.sent,I(!1),x(a.data.obtenerDocumentCfdi),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),I(!1),P(!0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(qe.a,{open:f,TransitionComponent:VO,keepMounted:!0,onClose:function(){return g(!1)},"aria-labelledby":"detalles-factura-modal-title",fullWidth:!0,maxWidth:"md",children:[Object(H.jsx)(Bt.a,{id:"detalles-factura-modal-title",children:"Detalles factura"}),Object(H.jsx)(NO,{factura:d,facturaBase64:m,setOpen:g,loading:F})]}),Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:N,onClose:function(){return P(!1)},message:"Hubo un error al cargar los productos",autoHideDuration:3e3}),Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:MO.map((function(e,t){return Object(H.jsx)(Da.a,{padding:e.padding,style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){return Object(H.jsx)(UO,{data:e,handleSelectFactura:D},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:i,page:a,onPageChange:function(e,t){n(t),c({empresa:E.empresa._id,sucursal:E.sucursal._id,filtros:r,offset:t})}})]})]})}var UO=function(e){var t=e.data,a=e.handleSelectFactura,n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=t.complementos.length>0,s=LO();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(e){return a(e,t)},className:s.root,children:[Object(H.jsx)(Da.a,{className:"NOTA_CREDITO"===t.tipo?s.notas_credito:o?s.complementos:null,children:o?Object(H.jsx)(ce.a,{"aria-label":"expand row",size:"small",onClick:function(e){e.stopPropagation(),i(!r)},children:r?Object(H.jsx)(EO.a,{style:{fontSize:18}}):Object(H.jsx)(zO.a,{style:{fontSize:18}})}):null}),Object(H.jsx)(Da.a,{children:t.serie}),Object(H.jsx)(Da.a,{children:t.folio}),Object(H.jsx)(Da.a,{children:t.folio_venta}),Object(H.jsx)(Da.a,{children:Dt()(t.fecha_registro).format("DD/MM/YYYY")}),Object(H.jsx)(Da.a,{children:t.cfdi_type}),Object(H.jsx)(Da.a,{children:t.payment_method.split("-")[0]}),Object(H.jsx)(Da.a,{children:t.payment_form.split("-")[0]}),Object(H.jsx)(Da.a,{children:t.receiver.Name}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.discount)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.sub_total)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.total)]})]}),Object(H.jsx)(RO,{data:t,open:r,handleSelectFactura:a})]})},qO=a(968),JO=Hs.a.ExcelFile,HO=Hs.a.ExcelFile.ExcelSheet,GO=Hs.a.ExcelFile.ExcelColumn;function YO(e){var t=e.data,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(0),s=Object(y.a)(o,2),l=s[0],d=s[1],j=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){i(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:r,onClose:j,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Facturas Realizadas"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo: exportar\xe1 todos los registros filtrados"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:l,onChange:function(e){return function(e){d(e),a(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:j,color:"inherit",children:"Cancelar"}),Object(H.jsx)(QO,{datosExcel:t.docs})]})]})]})}var QO=function(e){var t=e.datosExcel.map((function(e){var t=e.serie,a=e.folio,n=e.folio_venta,c=e.fecha_registro,r=e.expedition_place,i=e.cfdi_type,o=e.payment_form,s=e.payment_method,l=e.issuer,d=e.receiver,j=e.taxes,u=e.complement,b=e.sub_total,p=e.total,m=e.discount,O=e.tipo,x=j.filter((function(e){return"IVA"===e.Name})),h=j.filter((function(e){return"IEPS"===e.Name}));return{serie:t,folio:a,folio_venta:n,fecha_registro:c,expedition_place:r,cfdi_type:i,tipo:O,payment_form:o,payment_method:s,issuer:l.TaxName,receiver:d.Name,iva:x.length?x[0].Total:0,ieps:h.length?h[0].Total:0,satCertNumber:u.TaxStamp.SatCertNumber,sub_total:Ua(b),total:Ua(p),discount:Ua(m)}}));return Object(H.jsx)(JO,{element:Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(ll.a,{}),children:"Exportar"}),filename:"Facturas realizadas CAFI",children:Object(H.jsxs)(HO,{data:t,name:"Facturas realizadas CAFI",children:[Object(H.jsx)(GO,{label:"Serie",value:"serie"}),Object(H.jsx)(GO,{label:"Folio",value:"folio"}),Object(H.jsx)(GO,{label:"Folio de venta",value:"folio_venta"}),Object(H.jsx)(GO,{label:"Fecha",value:"fecha_registro"}),Object(H.jsx)(GO,{label:"Lugar de Expedici\xf3n",value:"expedition_place"}),Object(H.jsx)(GO,{label:"tipo de documento",value:"tipo"}),Object(H.jsx)(GO,{label:"tipo de CFDI",value:"cfdi_type"}),Object(H.jsx)(GO,{label:"Metodo de Pago",value:"payment_method"}),Object(H.jsx)(GO,{label:"Forma de pago",value:"payment_form"}),Object(H.jsx)(GO,{label:"Emisor",value:"issuer"}),Object(H.jsx)(GO,{label:"Receptor",value:"receiver"}),Object(H.jsx)(GO,{label:"IVA",value:"iva"}),Object(H.jsx)(GO,{label:"IEPS",value:"ieps"}),Object(H.jsx)(GO,{label:"Num. Certificado SAT",value:"satCertNumber"}),Object(H.jsx)(GO,{label:"Descuento",value:"discount"}),Object(H.jsx)(GO,{label:"Subtotal",value:"sub_total"}),Object(H.jsx)(GO,{label:"Total",value:"total"})]})})};function KO(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(j.useState)(0),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)({fecha:"",metodo_pago:"",forma_pago:"",busqueda:""}),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(rt.b)(na,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtros:{fecha:"",metodo_pago:"",forma_pago:"",busqueda:""},limit:20,offset:0},fetchPolicy:"network-only"}),d=l.loading,u=l.data,b=l.error,p=l.refetch;if(d)return Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h6",children:"Cargando..."})]});if(b)return console.log(b),Object(H.jsx)(bt,{error:b});var m=u.obtenerFacturas;return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(He.a,{children:[Object(H.jsx)(XO,{refetch:p,data:m,filtro:o,setFiltro:s}),Object(H.jsx)(BO,{data:m,page:n,setPage:c,filtro:o,refetch:p,limit:20})]})})}var XO=function(e){var t=e.refetch,a=e.data,n=e.filtro,c=e.setFiltro,r=JSON.parse(localStorage.getItem("sesionCafi")),i=Object(an.useDebounce)(n,800),o=Object(y.a)(i,1)[0],s=function(e){var t=e.target,a=t.name,r=t.value;c(Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a,r)))};Object(j.useEffect)((function(){l(o)}),[o]);var l=function(e){t({empresa:r.empresa._id,sucursal:r.sucursal._id,filtros:e})};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:3,sm:3,children:[Object(H.jsx)(L.a,{children:"Buscar por:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"busqueda",variant:"outlined",placeholder:"Folio CFDi, Folio de venta, Cliente...",onChange:s,value:n.busqueda})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,sm:3,children:[Object(H.jsx)(L.a,{children:"Fecha Factura:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha",variant:"outlined",type:"date",onChange:s,value:n.fecha})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,sm:3,children:[Object(H.jsx)(L.a,{children:"M\xe9todo de pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"metodo_pago",onChange:s,value:n.metodo_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier metodo"})}),Object(H.jsx)(Pt.a,{value:"PPD - Pago en parcialidades \xf3 diferido",children:"Pago en parcialidades \xf3 diferido"}),Object(H.jsx)(Pt.a,{value:"PUE - Pago en una sola exhibici\xf3n",children:"Pago en parcialidades \xf3 diferido"})]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,sm:3,children:[Object(H.jsx)(L.a,{children:"Forma de Pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"forma_pago",onChange:s,value:n.forma_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier forma"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:"".concat(e.Value," - ").concat(e.Name),children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",my:1,children:[Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(qO.a,{}),onClick:function(){c({fecha:"",metodo_pago:"",forma_pago:"",busqueda:""})},children:"Limpiar filtros"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(YO,{data:a,refetch:t}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{border:1,borderColor:"#FFA91C",bgcolor:"#FFEAAD",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Notas de cr\xe9dito"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{border:1,borderColor:"#52A3FF",bgcolor:"#C0DEFF",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Con complementos de pago"})})]})]})},ZO=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}})),ex=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function tx(){var e=ZO(),t=u.a.useState(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){c(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,children:Object(H.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAACAASURBVHic7d19cBz3fd/xz+7e7R2AwyMJEAT4KD6YFBU9MaasWI7C1k4Uy26bTJxmxhkntht57D/cuJ2ppzOdTKf5o7XbZvIwE9upR37oNOOxE6utLbeymsiWZevJskRKfJBISiQBAgQIAgccnm5vb7d/QJIlRSTuDnf324f362+P7mvyePu+3f3uSQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArM8yPUBcfPh7YU9HuHKvZP0jKbxF0i5JfZKyZicD0KjP37lq9PX9QCoHVrDgaalYti4UPX1nac76L7/9S72zRgdDKhAA6/iDB1f3K6x+NrSs35HUaXoeAM1jOgDejhdY4dk567nLnvXJ3zrU+6TpeZBcBMA1fOabYUepc+WPZelfSsqYngdA80UxAF5TCaSTs87fLRZ6/skHR6xl0/MgeWzTA0TRJ76zuq/UtfqULP1rcfAHYEDWlm7ZXP3HN1TnJx84Xjxseh4kDwHwFh//3tJtVTv4sRTeZHoWANjaFfTctiV84n+dLh01PQuShQB4g098Z3WfFVoPSRo0PQsAvKYnG2Zu6a9+/xvHZvligqYhAF71mW+GHVU7/LY4+AOIoJ5skDk0YD/2nYmQm5HRFATAq0qdK3/MaX8AUTbaFfT2LBW/b3oOJAMBoFdX/dbu9geASLtpIHz3g6cX+bzChhEAkhRWPyvu9gcQA5Yl3dRf+a/fPV68wfQsiLfUB8CHvxf2vPqQHwCIhe5s6Gzt1aOm50C8pT4A1h7vyxP+AMTL7u5g9PsvLvw303MgvlIfAGvP9geA+LllU/Xj336++D7TcyCeCIC1H/YBgNjJ2qF1oD98gNVANIIAkHabHgAAGjXcGXaxGohGEABSj+kBAGAjbhoI3/3gycXPmJ4D8UIASK7pAQBgIyxLumlT5T8/8Hxxj+lZEB8EAAAkQHc2dHb06Iem50B8EAAAkBC7u4PR/3ua1UDUhgAAgAS5dZP/Lx54vvirpudA9BEAAJAgriO9oz/8NquBWA8BAAAJw2ogakEAAEACsRqI9RAAAJBArAZiPQQAACQUq4G4HgIAABKM1UBcCwEAAAnHaiDeDgEAAAnHaiDeDgEAACnAaiDeigAAgJRgNRBvRAAAQEqwGog3IgAAIEVYDcRrCAAASBlWAyERAACQSqwGggAAgBRiNRAEAACkFKuB6UYAAECKsRqYXgQAAKQYq4HpRQAAQMqxGphOBAAAgNXAFCIAAACSWA1MGwIAACCJ1cC0IQAAAK9jNTA9CAAAwJuwGpgOBAAA4E1YDUwHAgAA8A+wGph8BAAA4G2xGphsBAAA4JpYDUwuAgAAcE2sBiYXAQAAuC5WA5OJAAAArIvVwOQhAAAA62I1MHkIAABATVgNTBYCAABQM1YDk4MAAADUhdXAZCAAAAB1YTUwGQgAAEDdWA2MPwIAANAQVgPjjQAAADSE1cB4IwAAAA1jNTC+CAAAwIawGhhPBAAAYMNYDYwfAgAAsGGsBsYPAQAAaApWA+OFAAAANA2rgfFBAAAAmobVwPggAAAATcVqYDwQAACApmM1MPoIAABAS7AaGG0EAACgJVgNjDYCAADQMqwGRhcBAABoKVYDo4kAAAC0FKuB0UQAAABajtXA6CEAAABtwWpgtBAAAIC2YTUwOggAAEDbsBoYHQQAAKCtWA2MBgIAANB2rAaaRwAAANqO1UDzMqYHQHv4fqDp2SXNFFdUWixredWXXw0UBKHp0bABtm0p49jqzGfUU8hpU3+Hhga6lHFoe0Tf2mqg9UNJ20zPkkYEQMItrXg6O1bU5NSiqkFgehw0WRCE8oKqvEpVxVJZFycX5Ni2RoYK2rOjT10drukRget6bTXwngM9f2B6lrTha0JCVYNAp16e0aNPj2l8coGDf4pUg0Bjlxf06E/HdPrlq5zlQeSxGmgGAZBASyuefvyzcb08VlQQ8uGfVkEQ6tzYnJ44dkmrXtX0OMA1sRpoBgGQMAuLZf3k2UsqLXmmR0FEzC2s6sc/G1NpkfcEoovVwPYjABJkacXTk8cn5FX4toc3Wy37euqFCZU5E4AIYzWwvQiAhAiCUM+cuMzBH9e0Wvb19PMT3A+CyGI1sL0IgIR48fxVTvtjXfOLZZ27WDQ9BnBN/Gpg+xAACbC04un8+LzpMRATr4wXuRSASONXA9uDAEiAs9ztjzr41UBnLsyaHgO4LlYDW48AiDnfDzQ5tWh6DMTM+FRJfpV7ARBdrAa2HgEQc9OzS9zUhbpVq4GuXF02PQZwXawGthYBEHMzxRXTIyCmZooEAKKP1cDWIQBirrRYNj0CYoqtEcQBq4GtQwDE3PKqb3oExNTyasX0CEBNWA1sDQIg5io+1//RGN47iBNWA5uPAAAAxAKrgc1FAMRcNsNfIRrDewdxw2pgc/EJEHOd+YzpERBTnfms6RGAurEa2DwEQMz1FHKmR0BMdXe5pkcAGsJqYHMQADG3qb/D9AiIqc39nEVFPLEa2BwEQMwNDXTJcfhrRH0cx9bgAAGA+GI1cOM4csRcxrE1MlgwPQZiZnSooAzhiJhjNXBj+ARIgD07+mTblukxEBOWZWnPjn7TYwBNwWpg4wiABOjqcLV7tM/0GIiJG7b1sQGAxGA1sHEEQELs3zWg/p686TEQcX09ee3fNWB6DKCpWA1sDAGQELZt6fChrcrzXABcQ87N6PCNw1wuQiKxGlg/AiBBcq6jI4dGlM8RAXizfD6jIzfz3kBysRpYPwIgYboLrt5zeLsGenk+ANb09eR1123b1cODf5BwrAbWhwBIIDfr6I6bR7Rv5wDPCEix1+72v/OWUeVcx/Q4QFuwGlg7jg4JZduW9u8a0NEjO7VzpJcQSBHHsbVja49+5cgOHdi9iWv+SB1WA2vDBcGEy7mObto3qAM3bNKVq8uaKS6rtORpebUirxIoDEPTI2IDLMuSm7XVmc+qp+BqoK9TQwOdPOQHqfaG1cChD45Yy6bniSoCICUyjq2tQwVtHeKpgQCSb7gz7Lpytfh9SXeZniWq+JoAAEgkVgOvjwAAACQSq4HXRwAAABKL1cBrIwAAAInGauDbIwAAAInHauA/RAAAABLPdaR3DOhvH3kl5FfTXkUAAABSYbgjKASV+b82PUdUEAAAgNS4sT/8Z3/z3NxtpueIAgIAAJAaOSe0BrusvzQ9RxQQAACAVNnTGx75yrNzfabnMI0AAACkSmcmtDe79h+ansM0AgAAkDp9Of2a6RlMIwAAAKnTlwsPmp7BNAIAAJA6nZmwy/QMphEAAIDUKWTDjOkZTCMAAKSWH5ieAKZkOfoRAADSq1w1PQFgDgEAILXmPD4CkV68+wGk1sSSZXoEwBgCAEBqnZnnIxDpxbsfQGqdmrXlBZwFQDoRAABSywssHZtxTI8BGEEAAEi1RyYcVUPTUwDtRwAASLWZFUuPTab+mTBIIQIAQOo9dNHRxUU+DpEuvOMBpJ4fWvra6ayKHjcEIj0IAACQVKpY+sopV/NEAFKCAACAV00uW/qz4zm9vMBHI5KPdzkAvMFiRfryKVcPj2V4RgASjVtfAeAt/EB6eDyjJ6YcvXe7r8ODgVybXUEkCwEAANdQqlh64OWsHjwf6mB/oD29gUa7QvXnAuUdKcM5VMQYAZASvh9oenZJM8UVlRbLWl715VcDBQHfauLMti1lHFud+Yx6Cjlt6u/Q0ECXMg5HpmbyAkvHrjo6dpWnBiI5CICEW1rxdHasqMmpRVWDwPQ4aLIgCOUFVXmVqoqlsi5OLsixbY0MFbRnR5+6OlzTIwKIKAIgoapBoJfOz+r8+LyCkG/5aVINAo1dXtCl6ZJ2j/Zp/64B2TY3swF4MwIggZZWPD1z4rJKS57pUWBQEIQ6Nzan2fkV3X5oq/Iup68B/BwXChNmYbGsnzx7iYM/Xje3sKof/2xMpUXeEwB+jgBIkKUVT08en5BXqZoeBRGzWvb11AsTKnu8NwCsIQASIghCPXPiMgd/XNNq2dfTz09wMygASQRAYrx4/iqn/bGu+cWyzl0smh4DQAQQAAmwtOLp/Pi86TEQE6+MF7kUAIAASIKzY0VW/VAzvxrozIVZ02MAMIwAiDnfDzQ5tWh6DMTM+FRJfpV7AYA0IwBibnp2iZu6ULdqNdCVq8umxwBgEAEQczPFFdMjIKZmigQAkGYEQMyVFsumR0BMsTUCpBsBEHPLq77pERBTy6sV0yMAMIgAiLmKz/V/NIb3DpBuBAAAAClEAMRcNsNfIRrDewdINz4BYq4zzy86ozGd+azpEQAYRADEXE8hZ3oExFR3l2t6BAAGEQAxt6m/w/QIiKnN/Z2mRwBgEAEQc0MDXXIc/hpRH8exNThAAABpxpEj5jKOrZHBgukxEDOjQwVlCEcg1fgESIA9O/pk25bpMRATlmVpz45+02MAMIwASICuDle7R/tMj4GYuGFbHxsAAAiApNi/a0D9PXnTYyDi+nry2r9rwPQYACKAAEgI27Z0+NBW5XkuAK4h52Z0+MZhLhcBkEQAJErOdXTk0IjyOSIAb5bPZ3TkZt4bAH6OAEiY7oKr9xzeroFeng+ANX09ed1123b18OAfAG9AACSQm3V0x80j2rdzgGcEpNhrd/vfecuocq5jehwAEcP5wISybUv7dw1o50ivzlyY1fhUSdUqP/+aBo5ja3SooD07+rnbH8A1EQAJl3Md3bRvUAdu2KQrV5c1U1xWacnT8mpFXiVQGIamR8QGWJYlN2urM59VT8HVQF+nhgY6ecgPgHURACmRcWxtHSpo6xBPDQQAcA8AAACpRAAAAJBCBAAAAClEAAAAkEIEAAAAKUQAAACQQgQAAAApRAAAAJBCBAAAAClEAAAAkEIEAAAAKUQAAACQQgQAAAApRAAAAJBCBAAAACmUMT0AALRa3gl1oD/Q3t5AI12h+txAHa9++q34UtGzNbFk6cy8rdNztspVy+zAQBsQAAASa3M+0NFtgW7dVFXWDt/2f1PISoVsoG1d0pGhqiqBpedmHD0y4WhmhRBAchEAABInY4e6Z0dVdw37sus8hmftUO8c8nX7oK/HJjN66KIjPyQEkDwEAIBE2dwR6iP7PQ13vv03/lo5lnT3iK/dPYG+djqrUoUIQLJwEyCAxBjtCvWpQ+UNH/zfaEch0Kdv9rS1if9NIAoIAACJsLkj1McPllXINv+/3euG+thBT91ZIgDJQQAAiL2MFep393ktOfi/ptcN9dEDnjLXuJkQiBsCAEDs3bOzqpGu1h+YtxVCHR2ptvx1gHYgAADE2uZ8oLuG/ba93t2jVS4FIBEIAACxdnRbUPeq30a4dqj3bm9fcACtQgAAiK28E+rWTe0/JX94MFDO4SwA4o0AABBbB/qDaz7hr5VcO9SBvqDtrws0EwEAILb29po7CJt8baAZCAAAsdWOO/+vZavB1waagQAAEFv9rrlv4QM5zgAg3ggAALGVc8y9dt7gawPNwI8BpYTvB5qeXdJMcUWlxbKWV3351UBBwGnMOLNtSxnHVmc+o55CTpv6OzQ00KWMk462zxj8v2nytYFmIAASbmnF09mxoianFlUNOGWZNEEQyguq8ipVFUtlXZxckGPbGhkqaM+OPnV1uKZHBBBRBEBCVYNAL52f1fnxeQUh3/LTpBoEGru8oEvTJe0e7dP+XQOy2/mkHACxQAAk0NKKp2dOXFZpyTM9CgwKglDnxuY0O7+i2w9tVd7lojWAn+MqVsIsLJb1k2cvcfDH6+YWVvXjn42ptMh7AsDPEQAJsrTi6cnjE/Iq/FoZ3my17OupFyZU9nhvAFhDACREEIR65sRlDv64ptWyr6efn+BmUACSCIDEePH8VU77Y13zi2Wdu1g0PQaACCAAEmBpxdP58XnTYyAmXhkvcikAAAGQBGfHiqz6oWZ+NdCZC7OmxwBgGAEQc74faHJq0fQYiJnxqZL8KvcCAGlGAMTc9OwSN3WhbtVqoCtXl02PAcAgAiDmZoorpkdATM0UCQAgzQiAmCstlk2PgJhiawRINwIg5pZXfdMjIKaWVyumRwBgEAEQcxWf6/9oDO8dIN34MSAAkdbjhtpWCLWtK9CmfKheN1S3K/W65ldfP3/nalP/e9VQWvGlomdrYsnSmXlbp+dslav8miOajwCIuWzG5vG/aEg2E80TgK4d6h19gQ4NBNrbG6gnAgf6dnEsqZCVCtlA27qkI0NVVQJLz804emTC0cwKIYDmIQBirjOfIQDQkM581vQIr7Mt6dBAoF8c9LWvL1TGSs9Bfz1ZO9Q7h3zdPujrscmMHrroyA8JAWwcARBzPYWciiU2AVC/7i7X9AjqykpHhnzduaWqvhwH/etxLOnuEV+7ewJ97XRWpQoRgI0hAGJuU3+HLk4umB4DMbS5v9PYa7t2qLtHq/rlrVXlHA789dhRCPTpmz3df8rV5DIRgMZF8yIgajY00CXH4a8R9XEcW4MD7Q8Ay5LetaWqz97u6X3bfA7+Dep1Q33soKfuLH9+aBxHjpjLOLZGBgumx0DMjA4VlGlzOA7kQ9130NNv3lDhwNUEvW6ojx7wlLH5s0RjCIAE2LOjT7bNqUDUxrIs7dnR377Xk3TncFX/6hZPe3p59kAzbSuEOjrCTcBoDAGQAF0drnaP9pkeAzFxw7a+tm0AZKxQ/3xvRb+xuyKXb6otcfdolTMqaAgBkBD7dw2ovydvegxEXF9PXvt3DbTltXrdUJ+6ydPtg3xDbSXXDvXe7TwSHPUjABLCti0dPrRV+TyLHXh7OTejwzcOt+Vy0XBnqE/f7GlbgW+m7XB4MOAMC+pGACRIznV05NCI8jkiAG+Wz2d05Ob2vDeGO0Pdd2OZ09Jt5NqhDvZzfwXqQwAkTHfB1XsOb9dAb4fpURARfT153XXbdvW04cE/WzoC3XdjWYXoPGQwNfZygyXqRAAkkJt1dMfNI9q3c4BnBKTYa3f733nLqHKu0/LX63FD3XeowsHfkJEuzrigPpwrTijbtrR/14B2jvTqzIVZjU+VVK3yDSENHMfW6FBBe3b0t+9ufzvU772DB9OY1J/j3zfqQwAkXM51dNO+QR24YZOuXF3WTHFZpSVPy6sVeZVAYcgHdpxZliU3a6szn1VPwdVAX6eGBjrb+pAfS9KH9vjazg1/RuVbf5IHCUMApETGsbV1qKCtQzw1EM31ruGqbtvMqh8QN1wgBtCwTflQ9+5kBz0KVmkw1IkAANAQy5I+tIcn/EXFbJmPc9SHdwyAhtwxVNUNPdx4FhUTS/weCOpDAACom2uHeh+Pn42Us/N8nKM+vGMA1I0foIkWL7B0eo6Pc9SHdwyAunRlpV/eyh1nUfLcjC0v4BIA6kMAAKjLHUO+cg7f/qPCD6RHLrHRjfoRAABqZlvSu7bw7T9KfjSZ0dVVvv2jfgQAgJodGgjUl+Pbf1RcKNl6eJxv/2gMAQCgZu8c4s7/qCh6lr7+YlY+m5hoEAEAoCY5J9Re9v4joehZuv+Uq1KFU/9oHOeOANTkQF+gDF8ZjLtQsvX1F7Mc/LFhBACAmtw4wLd/k/xAenQyo/83nuG0P5qCAABQk729HHVM8AJLz16x9YMJ7vZHcxEAANbV44Y8+a8N/GDtV/3myrYuLVk6O2/r9BwP+UFrEAAA1rW9EM2D/+VlS09NZ3SmaGuuLA6UQB0IAADr2tYVrdP/fiB953xWT0w7CqPZJkDkEQAA1rU5H52jrB9I9592+fU7YIP4FwRgXd1udALgf5/PcvAHmoB/RQDW1RuRALi8bOnJacf0GEAiEAAA1tXjmp5gzVPTGa75A01CAAC4LktS1o7GUfdMkbv8gWYhAADExlyZAACahQAAEBsWx3+gaQgAANcVjZP/a/oicjMikAQEAIB1lavR+Oq9r48AAJqFAACwrqj89OyRIV92NEYBYo8AALCu+bLpCdYMd4Z615aq6TGARCAAAKwrKmcAJOkDOyvax08TAxtGAABY15WV6ARAxpY+esDTu4erXA4ANoAfAwKwrktL0fqukLGlf7q7oncN+3pqytGZeUezq/wcMFAPAgDAusYWo3lg3dIR6oO7fEm+kdf3A0tFTyp5luY9SzOrlsaXbI0vWlrwovlnBryGAACwrlJl7YDWwx7+m2TsUJvzb/9zyaWKpbPztk7M2jo9Z3N2ApFDAACoyZl5W4cHuQO/Vt3ZULdtruq2zVX5oaUzRUtPT2d0cs5WQEchAggAADU5MUsANCpjhTrYH+pgv6e5sqUnphw9NZ3RUsX0ZEizaN3ZAyCyXira8kNOY29Ufy7Ur+/w9W9vL+v9O3zlHE4HwAwCAEBNvMDi53ibyLVD/cqor39zm6cjQ1XxJ4t2IwAA1Ozpaa4aNlt3NtRv7anokzd52tzB2QC0DwEAoGYn52zNlfmu2gq7ugP94c0ejzpG2xAAAGoWhNLjU47pMRLLtUP95g0VfXh/RVmbswFoLQIAQF2ens5oNSI/D5xUt2yq6pM3VXjuAlqKAABQl6WK9MMJzgK02rauQJ/+BU9bOvjhI7QGAQCgbj+ccDTPo25brscN9YlDnoY7OROA5iMAANTNDyw9PMZGQDsUstJ9N3rawoYAmowAANCQp684OjfPR0g7FLKh7jvkqZd7AtBE/OsF0JAwlL55LqsyNwS2RXc21O+/w2M7AE1DAABo2FzZ0oMXuBTQLqOFUL+zz+epgWgKAgDAhjw55ejZGbYC2uUXBqq6g4cFoQkIAAAbEkr61tmMxhb5OGmXD+zytTnPpQBsDP9iAWyYH1r66uksq4Ft4tqhfntvRTZ/3NgAAgBAU5Qqlr580tVihaNSO+zqDvSLg1wKQOMIAABNM7Vi6QsvZLXAmYC2+LUdvly2AtAgAgBAU11ZtfVXJ4mAdujOhnrPCGcB0BgCAEDTTa/Y+vPnXW4MbIO7R6rqypqeAnHEv04ALbHgWfrCCVc/nWZFsJXyTqh3Dvqmx0AMEQAAWsYP1p4W+O2XeWJgK905XGUjAHUjAAC03BNTjv7kmKsz/HZAS/TnQh3s52eDUR/+NQJoi7ny2prgt85luEGwBd45xGUA1IeHeANom1DS09MZPTfj6N1bqzo64quDT6Gm2N8bKOeEXGpBzTgDAKDtKoGlH1zK6HPP5vW9CxnNlTlobVTGlvb38UwA1I72BmDMsi/9YCKjRyczOtgf6MiQr319oTIWB7JG3Nhf1fNX+V6H2hAAAIwLQunErK0Ts65cO9T+vkCHBgLt7Q3U6xIDtdrTy42AqB0BACBSvMDSC7OOXphde35AdzbU9kKo0a5AmztC9bqhul2p1w15DO5b9LmhurOhSvweA2pAAACItFLF0sk5SyfnzJ/adu1Q/TlpX9/a5YrhzugFyLZCqFNzBADWZ/5fFADEhBdYmlqx9Nikoz89ntP/fCUrP2Jn3bd1RWwgRBYBAAANCELpJ5cd3X/ajVQEbO6I3lkJRBMBAAAbcHbe1oMXovNrPN1ZAgC1IQAAYIMen3I0tRKN6+69OdMTIC4IAADYoCCUnpqKxq8esjaJWhEAANAEZ+ajEQCsRqJWBAAANMFc2fQEazj8o1YEAAA0QTTuAABqRwAAQBP0ReXmO04BoEYEAAA0wb7equkRJK09rAioBQEAABtkW9KRLdF4GtACvwOAGhEAALBBvzRc1ZaOiARARG5GRPQRAACwAXt7q7p3Z8X0GK/jDABqxa8BAkADbGvtm/+9OytyInTMnYnIEwkRfQQAANTItUMN5Ndu+DuyJYjMaf83Gl/ixC5qQwAAaLq8E+pAf6C9vYFGukL1uYE6MorUN+WkGl/kDxm1IQAANM3mfKCj2wLduqmqLI+kbbuiZ6nEPQCoEQEAYMMydqh7dlR117Avm+OPMWeLnP5H7QgAABuyuSPUR/Z7Gu7kG79pJ4vR+EEixAMBAKBho12hPn6wrELW9CTwA0svzXH6BbXjfBGAhmzu4OAfJS/NWzwGGHUhAADULWOF+t19Hgf/CHlyihO6qA8BAKBu9+ysaqSLa/5RMbtq6UVuAESdeMcAqMvmfKC7hn3TY+ANHp9yFNBjqBMBAKAuR7cFrPpFyIovPTXN6X/UjwAAULO8E+rWTdH43XuseWQioxVOyKABBACAmh3oD3jCX4QseJYem2T3H40hAADUbG9v9H78Js0euujIZ/UPDSIAANSMO/+j4+y8rZ9e4do/GkcAAKhZv8sZgChYrVr61rmsyDFsBAEAoGY5LjdHwnfPZzRX5tQ/NoYAAIAYeeaKo6emKTFsHAEAoGZlNgCNurho62/Pcd0fzUEAAKjZbJmPDFMWPEtffzErP+TUP5qDf80Aaja5zMHHhFLF0pdOZrXg8eeP5iEAANTszDwfGe1Wqlj60omsrqzwZ4/m4h0FoGan52xVePBM28x7awf/aQ7+aAHeVQBqVq5aem6GO9Db4eKirT8/7nLwR8vwzgJQl0cmHFV5Ak1L/eyKoy++kFWpwtkWtA4BAKAuMyuWHptkFa0VVquW/uZcVt84y93+aD3+FQOo20MXHe3uCbSjwKOBm+V8ydY3z2Y1s8qBH+3BGQAAdfNDS187ndU8a2kbtuCtPdf/Cy+4HPzRVpwBANCQUsXS/adcfeygp16XmwLqtVqVfnApox9NOmxWwAgCAEDDJpct/flxV793oMLlgBrNrlp6fMrR09MZLfump0GaEQAANqRUsfTFE66Ojvi6e7Qq1+ZswFv5gaUXi5aens7oVNFWyB8RIoAAALBhfiA9PJ7RE1OO3rvd1+HBIPUhUPQsnS3aOll09OKcxWl+RA4BAKBpShVLD7yc1YPnQx3sD7SnN9BoV6j+XKC8I2USdtux4FRNIgAABTdJREFUF1iaL1ta8Nae2ne1bGl80dbYoqVFdvgRcQQAgKbzAkvHrjo6drW1Tw38/J2rLf3vr+ffPZkz+vrARiSsxwEAQC0IAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAALHlB+l8baAZCAAAsVWumnvtVYOvDTQDAQAgtuY8cx9hs2U+PhFvvIMBxNbEkpXK1waagQAAEFtn5s19hJ01+NpAM/AOBhBbp2ZteUH7v4l7gaXTc3x8It54BwOILS+wdGzGafvrPjdjJjyAZiIAAMTaIxOOqmH7Xs8PpEcuZdr3gkCLEAAAYm1mxdJjk+07IP9oMqOrq3z7R/wRAABi76GLji4utv7j7ELJ1sPjfPtHMhAAAGLPDy197XRWRa9138wXPEv//aUsTwBEYhAAABKhVLH0lVOu5lsQAUXP0pdPuVpoYWAA7UYAAEiMyWVLf3Y8p5cXmvfRdqFk6y+Ou7q8zMEfyUIAAEiUxYr05VOuHh7LbGhVzw+kv7+U0ZdOuipVOPgjebibBUDi+IH08HhGT0w5eu92X4cHA7l2bbuCXmDp2Su2fjDB3f5INgIAQGKVKpYeeDmrB8+HOtgfaE9voNGuUP25QPlXnx+0WpXmyrYuLVk6O2/r9BwP+UE6EAAAEs8LLB276ujY1fY/NRCIKu4BAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAAAAUogAAAAghQgAAABSiAAAACCFCAAAAFKIAAAAIIUIAMkzPQAAoO3KpgcwjQCQFkwPAABou3nTA5hGAEivmB4AANB2L5sewLTUB0AYWs+ZngEA0F6WrGOmZzAt9QFgK/x70zMAANorCMO/Mz2DaakPgGxXx3clLZmeAwDQNku5ro7/Y3oI01IfAH951FqUwm+YngMA0B5haP312md/uqU+ACTJCZzPSaqYngMA0HJeKOs/mR4iCggASV/6YP6MpD81PQcAoOX+5P4P5FO/ASARAK/zOzv+SNITpucAALSIpcc7rI5/b3qMqCAAXvXVo9aqr+A3JI2ZngUA0GSWJjJVfegv3m+l/gmAryEA3uCr9xYuyw4+IGnc9CwAgKYZs8Pgni9+sPOS6UGihAB4iy//euF41areLulR07MAADbI0uO+giN/dW/hedOjRA0B8Da+8v7uKx1Wx69aVvgfxDMCACCOPEvhf+xQx9Gv3lu4bHqYKLJMDxB1v//g4nAmdP5IVvgRSV2m5wEAXNeSLOt/BIH1Oe72vz4CoEafeiQseCsr91qhdTRQeKsl7ZbUJ8k1PRsApJQnqRhKr1iynrUUPpLt7PgeD/kBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKB5/j90b9g9QJoxkgAAAABJRU5ErkJggg==",alt:"icono Factura",style:{width:100}})})}),"CFDis realizados"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:ex,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"CFDis realizados"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(KO,{})]})]})}function ax(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)("div",{children:Object(H.jsx)(A.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,justifyContent:"center",children:[!1===e.accesos.facturacion.generar_cdfi.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(uO,{})})}),!1===e.accesos.facturacion.cdfi_realizados.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(tx,{})})}),!1===e.accesos.facturacion.registro_series_cdfi.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(SO,{})})})]})})})}var nx=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function cx(e){var t=e.datos,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],j=u.a.useState({message:"",status:"",open:!1}),b=Object(y.a)(j,2),p=b[0],m=b[1],O=Object(w.a)(ai),x=Object(y.a)(O,1)[0],h=function(){i(!1)},_=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,x({variables:{id:t._id}});case 4:n=e.sent,d(!1),m({message:n.data.eliminarAlmacen.message,status:"success",open:!0}),a(),h(),e.next=20;break;case 11:if(e.prev=11,e.t0=e.catch(1),d(!1),!e.t0.message){e.next=18;break}return m({message:e.t0.message,status:"error",open:!0}),h(),e.abrupt("return");case 18:m({message:"Hubo un error",status:"error",open:!0}),h();case 20:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"secondary",onClick:function(){i(!0)},disabled:t.default_almacen,children:Object(H.jsx)(zr.a,{})}),Object(H.jsx)(Y,{alert:p,setAlert:m}),Object(H.jsxs)(qe.a,{open:r,TransitionComponent:nx,keepMounted:!0,onClose:h,"aria-labelledby":"eliminarAlmacen-dialog",children:[Object(H.jsx)(Bt.a,{id:"eliminarAlmacen-dialog",children:"\xbfEst\xe1s seguro de eliminar esto?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:h,color:"inherit",disabled:l,children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:_,color:"secondary",disabled:l,startIcon:l?Object(H.jsx)(I.a,{color:"inherit",size:20}):null,children:"Eliminar"})]})]})]})}var rx=Object(k.a)({table:{minWidth:650},root:{width:"100%",heigth:"75%"},container:{maxHeight:"77vh","& ::-webkit-scrollbar":{display:"none"}}}),ix=[{id:1,label:"Nombre",minWidth:100},{id:2,label:"Encargado",minWidth:100},{id:3,label:"Sucursal",minWidth:150},{id:13,label:"Editar",minWidth:50,align:"right"},{id:14,label:"Eliminar",minWidth:50,align:"right"}];function ox(){var e=rx(),t=Object(j.useContext)(Kr).update,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(rt.b)(ei,{variables:{id:a.sucursal._id}}),c=n.loading,r=n.data,i=n.error,o=n.refetch;if(Object(j.useEffect)((function(){o()}),[t,o]),c)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});if(i)return Object(H.jsx)(bt,{error:i});var s=r.obtenerAlmacenes;return Object(H.jsx)(fn.a,{className:e.root,children:Object(H.jsx)(Na.a,{component:fn.a,className:e.container,children:Object(H.jsxs)($a.a,{className:e.table,"aria-label":"a dense table",size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:ix.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:s.map((function(e,t){return Object(H.jsx)(sx,{datos:e,refetch:o},t)}))})]})})})}var sx=function(e){var t=e.datos,a=e.refetch,n=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.nombre_almacen})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.id_usuario_encargado?t.id_usuario_encargado.nombre:"Sin encargado"})}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(L.a,{children:t.id_sucursal.nombre_sucursal})}),Object(H.jsx)(Da.a,{width:50,children:!1===n.accesos.almacenes.almacen.editar?null:Object(H.jsx)(Ji,{accion:"actualizar",datos:t})}),Object(H.jsx)(Da.a,{width:50,children:!1===n.accesos.almacenes.almacen.eliminar?null:Object(H.jsx)(cx,{datos:t,refetch:a})})]})},lx=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}})),dx=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function jx(){var e=lx(),t=u.a.useState(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=JSON.parse(localStorage.getItem("sesionCafi")),i=function(){c(!1)};return Object(H.jsx)("div",{children:Object(H.jsxs)(Xr,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){c(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.n,{className:e.icon})}),"Almacenes"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:i,TransitionComponent:dx,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Agregar almacen"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:i,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(O.a,{m:3,display:"flex",justifyContent:"flex-end",children:!1===r.accesos.almacenes.almacen.agregar?null:Object(H.jsx)(Ji,{accion:"registrar"})}),Object(H.jsx)(O.a,{mx:4,children:Object(H.jsx)(ox,{})})]})]})})}var ux=a(1003),bx=a(969),px=a(994),mx=a(14),Ox=a(1002),xx=a(483),hx=a.n(xx),_x=Object(j.createContext)(),fx=function(e){var t=e.children,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)([]),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useState)([]),f=Object(y.a)(_,2),g=f[0],v=f[1],C=Object(j.useState)([]),A=Object(y.a)(C,2),S=A[0],F=A[1],I=Object(j.useState)([]),k=Object(y.a)(I,2),w=k[0],N=k[1],P=Object(j.useState)([]),E=Object(y.a)(P,2),D=E[0],z=E[1];return Object(H.jsx)(_x.Provider,{value:{update:c,setUpdate:r,error:s,setError:l,openRegistro:b,setOpenRegistro:p,productos:x,setProductos:h,productosTras:w,setProductosTras:N,productosTo:g,setProductosTo:v,productosEmpTo:S,setProductosEmpTo:F,dataExcel:D,setDataExcel:z},children:t})},gx=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(An.fade)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function vx(e){var t=e.productoData,a=e.datos,n=e.setOnUpdate,c=e.onUpdate,r=e.setNew_medidas,i=gx();return Object(H.jsx)("div",{className:i.root,children:Object(H.jsx)(fn.a,{className:i.paper,children:Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Existencia"}),Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{width:200,children:"Nombre"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Medida"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Color"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Precio"}),Object(H.jsx)(j.Fragment,{children:Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cantidad"})}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Editar"})]})}),Object(H.jsx)(za.a,{children:a.map((function(e,i){return Object(H.jsx)(Cx,{productoData:t,producto:e,index:i,datos:a,setNew_medidas:r,setOnUpdate:n,onUpdate:c},i)}))})]})})})})}var Cx=function(e){var t=e.productoData,a=e.producto,n=e.index,c=e.datos,r=e.setNew_medidas,i=(e.from,e.setOnUpdate),o=e.onUpdate,s=(e.withoutPrice,e.onlyPrice,Object(j.useState)(!0)),l=Object(y.a)(s,2),d=l[0],u=l[1],b=gx(),p=Object(j.useRef)(null),x=Object(Ia.a)(c).sort((function(e,t){return function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)}(e,t)})),h=Object(m.a)({},x[n]),_={},f=Object(m.a)({},a),g=function(e){var a=e.target,c=a.name,i=a.value;if("cantidad"===c){if(!i)return h.medida.cantidad="",h.medida.existencia=!1,x.splice(n,1,h),void r(r);h.medida.cantidad=parseFloat(i),h.medida.existencia=!0}else if("nuevaCantidad"===c){if(!i)return h.nuevaCantidad="",h.medida.existencia=f.medida.existencia,x.splice(n,1,h),void r(x);h.nuevaCantidad=parseFloat(i),h.medida.existencia=!0}else if("precio"===c){if(!i)return h.medida.precio=0,x.splice(n,1,h),void r(x);var o=parseFloat(i),s=t.precios,l=s.iva,d=s.ieps,j=parseFloat("0.".concat(l<10?"0".concat(l):l))+parseFloat("0.".concat(d<10?"0".concat(d):d)),u=parseFloat(o/(j+1)),b=parseFloat(u*parseFloat("0.".concat(l<10?"0".concat(l):l))),p=parseFloat(u*parseFloat("0.".concat(d<10?"0".concat(d):d))),m=t.precios.unidad_de_compra.precio_unitario_sin_impuesto,O=parseFloat((u-m)/m*100),g=h.descuento_activo,v=h.descuento;if(g&&!0===g){var C=u*v.porciento/100,y=C+(C*parseFloat("0.".concat(l<10?"0".concat(l):l))+C*parseFloat("0.".concat(d<10?"0".concat(d):d)));_.precio_neto=parseFloat(y.toFixed(2)),h.medida.precio=parseFloat(i),h.medida.descuento=_}else h.medida.precio=parseFloat(i);h.medida.precio_unidad.precio_venta=parseFloat(u.toFixed(2)),h.medida.precio_unidad.precio_neto=parseFloat(o.toFixed(2)),h.medida.precio_unidad.utilidad=parseFloat(O.toFixed(2)),h.medida.precio_unidad.iva_precio=parseFloat(b.toFixed(2)),h.medida.precio_unidad.ieps_precio=parseFloat(p.toFixed(2))}else if("descuento"===c)h.medida.descuento=i;else{if(!i)return h.medida.codigo_barras="",x.splice(n,1,h),void r(x);h.medida.codigo_barras=i}x.splice(n,1,h),r(x)},v=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();h.medida.codigo_barras=t},C=function(){d?(u(!d),i([].concat(Object(Ia.a)(o),[n]))):(f.medida.cantidad||(h.medida.cantidad=0),f.nuevaCantidad||(h.nuevaCantidad=0),f.precio||(h.precio=f.precio),x.splice(n,1,h),r(x),u(!0),o.splice(o.length-1,1),i(Object(Ia.a)(o)))};return Object(H.jsxs)(Ea.a,{hover:!0,selected:!d,className:b.tableRow,children:[Object(H.jsx)(Da.a,{align:"center",padding:"checkbox",children:Object(H.jsx)(Ze.a,{checked:f.medida.existencia,color:"primary"})}),Object(H.jsx)(Da.a,{width:220,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(_n.a,{inputRef:p,onChange:function(e){return g(e)},value:f.medida.codigo_barras,type:"number",name:"codigo_barras",disabled:!(!c.medidas_registradas||f.medida.nuevo)||d}),!c.medidas_registradas&&f.medida.nuevo||c.medidas_registradas&&f.medida.nuevo?Object(H.jsx)(ce.a,{color:"primary",size:"small",onClick:function(){return v()},children:Object(H.jsx)(Ra.a,{})}):null]})}),Object(H.jsx)(Da.a,{width:200,children:f.medida.nombre_comercial}),Object(H.jsx)(Da.a,{padding:"checkbox",children:f.medida.medida._id?Object(H.jsx)(gn.a,{label:f.medida.medida.talla,color:"primary"}):""}),Object(H.jsx)(Da.a,{padding:"checkbox",children:f.medida.color._id?Object(H.jsx)(Ta.a,{title:f.medida.color.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:b.colorContainer,style:{backgroundColor:f.medida.color.hex}})}):null}),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Da.a,{width:110,children:Object(H.jsx)(_n.a,{inputRef:p,inputMode:"numeric",type:"number",onChange:function(e){return g(e)},disabled:d,value:f.medida.precio,name:"precio"})}),Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(_n.a,{inputRef:p,onChange:function(e){return g(e)},disabled:d,value:f.nuevaCantidad,type:"tel",name:"nuevaCantidad"})})]}),Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(ce.a,{size:"small",onClick:function(){return C()},children:d?Object(H.jsx)(yn.a,{}):Object(H.jsx)(Gt.a,{})})})]})},yx=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"}}})),Ax=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function Sx(e){var t=e.producto,a=e.new_medidas,n=e.setNew_medidas,c=e.obtenerConsultasProducto,r=e.refetch,i=Object(j.useState)([]),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)([]),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)([]),x=Object(y.a)(m,2),h=x[0],_=x[1],f=Object(j.useCallback)((function(){var e=[],t=[];Object(Ia.a)(a).forEach((function(a){a.medida.color._id&&e.push(a.medida.color),a.medida.medida._id&&t.push(a.medida.medida)}));var n={},c={},r=e.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t})),i=t.filter((function(e){var t=!c[e._id];return c[e._id]=!0,t}));p(Object(Ia.a)(r)),l(Object(Ia.a)(i))}),[a,p,l]);return Object(j.useEffect)((function(){f()}),[f]),Object(H.jsx)("div",{children:Object(H.jsxs)(O.a,{alignContent:"center",m:5,mt:1,children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:4,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsxs)(O.a,{width:"100%",style:h.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(L.a,{children:"ROPA"===t.datos_generales.tipo_producto?"Talla":"N\xfamero"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(Oc,{tipo_producto:t.datos_generales.tipo_producto,setMedidasSeleccionadas:l,refetch:r})]}),"ROPA"===t.datos_generales.tipo_producto?void 0!==c.tallas?Object(H.jsx)(Qe.a,{container:!0,children:c.tallas.map((function(e,c){return Object(H.jsx)(Fx,{producto:t,talla:e,coloresSeleccionados:b,medidasSeleccionadas:s,setMedidasSeleccionadas:l,datos:a,setNew_medidas:n},c)}))}):Object(H.jsx)("div",{}):void 0!==c.calzados?Object(H.jsx)(Qe.a,{container:!0,children:c.calzados.map((function(e,c){return Object(H.jsx)(Fx,{producto:t,talla:e,coloresSeleccionados:b,medidasSeleccionadas:s,setMedidasSeleccionadas:l,datos:a,setNew_medidas:n},c)}))}):Object(H.jsx)("div",{})]})}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsxs)(O.a,{width:"100%",style:h.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(L.a,{children:"Color"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(jc,{refetch:r})]}),void 0!==c.colores?Object(H.jsx)(Qe.a,{container:!0,children:c.colores.map((function(e,c){return Object(H.jsx)(Ix,{producto:t,color:e,coloresSeleccionados:b,setColoresSeleccionados:p,medidasSeleccionadas:s,datos:a,setNew_medidas:n},c)}))}):Object(H.jsx)("div",{})]})})]}),Object(H.jsx)(O.a,{mt:2}),Object(H.jsx)(vx,{productoData:t,datos:a,setOnUpdate:_,onUpdate:h,setNew_medidas:n})]})})}var Fx=function(e){var t=e.producto,a=e.talla,n=e.coloresSeleccionados,c=e.setMedidasSeleccionadas,r=e.medidasSeleccionadas,i=e.setNew_medidas,o=e.datos,s=yx(),l=Object($e.a)(),d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useCallback)((function(){r.forEach((function(e){e._id===a._id&&p(!0)}))}),[a._id,r]);Object(j.useEffect)((function(){if(o)return m()}),[o,m]);return Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)("div",{className:s.colorContainer,onClick:function(){return function(e){var s=Object(Ia.a)(r);b?s.forEach((function(t,n){t._id===a._id&&(s.splice(n,1),p(e))})):(s.push(a),p(e));var l=[],d=Object(Ia.a)(o),j=t.precios,u=j.iva,m=j.ieps;if(n.length||d.length){if(!n.length&&d.length>0)for(var O=function(e){var a=s[e],n=d.filter((function(e){return e.medida.medida._id===a._id})),c=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))),r=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(m<10?"0".concat(m):m)));n.length?l.push(n[0]):l.push({medida:{existencia:!1,codigo_barras:Ax(),nombre_comercial:t.datos_generales.nombre_comercial,medida:a,color:{nombre:"",hex:""},precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(c.toFixed(2)),ieps_precio:parseFloat(r.toFixed(2)),utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},x=0;x<s.length;x++)O(x);else if(n.length>0&&1===s.length&&e)for(var h=0;h<d.length;h++)for(var _=0;_<s.length;_++)l.push({medida:{existencia:d[h].medida.existencia,codigo_barras:d[h].medida.codigo_barras,nombre_comercial:d[h].medida.nombre_comercial,medida:s[_],color:d[h].medida.color,precio:d[h].medida.precio,cantidad:d[h].medida.cantidad,precio_unidad:d[h].medida.precio_unidad},nuevaCantidad:d[h].nuevaCantidad});else if(n.length>0&&s.length>0)for(var f=function(e){for(var a=s[e],c=function(e){var c=n[e],r=d.filter((function(e){return e.medida.medida._id===a._id&&c._id===e.medida.color._id})),i=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))),o=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(m<10?"0".concat(m):m)));r.length?l.push(r[0]):l.push({medida:{existencia:!1,codigo_barras:Ax(),nombre_comercial:t.datos_generales.nombre_comercial,medida:a,color:c,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(i.toFixed(2)),ieps_precio:parseFloat(o.toFixed(2)),utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},r=0;r<n.length;r++)c(r)},g=0;g<s.length;g++)f(g);else if(n.length>0&&!s.length){var v=d.filter((function(e){return e.medida.medida._id}));if(v.length)for(var C=0;C<d.length;C++){var y=d[C];l.push({medida:{existencia:y.medida.existencia,codigo_barras:y.medida.codigo_barras,nombre_comercial:y.medida.nombre_comercial,medida:y.medida.medida,color:y.medida.color,precio:y.medida.precio,cantidad:y.medida.cantidad,precio_unidad:y.precio_unidad},nuevaCantidad:y.nuevaCantidad})}}}else for(var A=0;A<s.length;A++){var S=s[A],F=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u))),I=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(m<10?"0".concat(m):m)));l.push({medida:{existencia:!1,codigo_barras:Ax(),nombre_comercial:t.datos_generales.nombre_comercial,medida:S,color:{nombre:"",hex:""},precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(F.toFixed(2)),ieps_precio:parseFloat(I.toFixed(2)),utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})}c(Object(Ia.a)(s)),i(l)}(!b)},style:b?{backgroundColor:l.palette.primary.main}:null,children:Object(H.jsx)(Ta.a,{title:a.talla,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)(L.a,{variant:"button",noWrap:!0,style:{color:l.palette.getContrastText(b?l.palette.primary.main:"#FFFFFF"),fontSize:16},children:a.talla})})})})},Ix=function(e){var t=e.producto,a=e.color,n=e.coloresSeleccionados,c=e.setColoresSeleccionados,r=e.medidasSeleccionadas,i=e.datos,o=e.setNew_medidas,s=yx(),l=Object($e.a)(),d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useCallback)((function(){n.forEach((function(e){e._id===a._id&&p(!0)}))}),[a._id,n]);Object(j.useEffect)((function(){if(t)return m()}),[t,m]);return Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)(Ta.a,{title:a.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:s.colorContainer,style:{backgroundColor:a.hex,color:l.palette.getContrastText(a.hex)},onClick:function(){return function(e){b?n.forEach((function(t,c){t._id===a._id&&(n.splice(c,1),p(e))})):(n.push(a),p(e));var s=[],l=Object(Ia.a)(i),d=t.precios,j=d.iva,u=d.ieps;if(r.length||l.length){if(!r.length&&l.length>0)for(var m=function(e){var a=n[e],c=l.filter((function(e){return e.medida.color._id===a._id})),r=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))),i=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u)));c.length?s.push(c[0]):s.push({medida:{existencia:!1,codigo_barras:Ax(),nombre_comercial:t.datos_generales.nombre_comercial,medida:{},color:a,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(r.toFixed(2)),ieps_precio:parseFloat(i.toFixed(2)),utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},O=0;O<n.length;O++)m(O);else if(r.length>0&&1===n.length&&e)for(var x=0;x<l.length;x++)for(var h=0;h<n.length;h++)s.push({medida:{existencia:l[x].medida.existencia,codigo_barras:l[x].medida.codigo_barras,nombre_comercial:l[x].medida.nombre_comercial,medida:l[x].medida.medida,color:n[h],precio:l[x].medida.precio,cantidad:l[x].medida.cantidad,precio_unidad:l[x].medida.precio_unidad},nuevaCantidad:l[x].nuevaCantidad});else if(r.length>0&&n.length>0)for(var _=function(e){for(var a=n[e],c=function(e){var n=r[e],c=l.filter((function(e){return e.medida.medida._id===n._id&&a._id===e.medida.color._id})),i=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))),o=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u)));c.length?s.push(c[0]):s.push({medida:{existencia:!1,codigo_barras:Ax(),nombre_comercial:t.datos_generales.nombre_comercial,medida:n,color:a,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(i.toFixed(2)),ieps_precio:parseFloat(o.toFixed(2)),utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})},i=0;i<r.length;i++)c(i)},f=0;f<n.length;f++)_(f);else if(r.length>0&&!n.length){var g=l.filter((function(e){return e.medida.color._id}));if(g.length)for(var v=0;v<l.length;v++){var C=l[v];s.push({medida:{existencia:C.medida.existencia,codigo_barras:C.medida.codigo_barras,nombre_comercial:C.medida.nombre_comercial,medida:C.medida.medida,color:{nombre:"",hex:""},precio:C.medida.precio,cantidad:C.medida.cantidad,precio_unidad:C.medida.precio_unidad},nuevaCantidad:C.nuevaCantidad})}}}else for(var y=0;y<n.length;y++){var A=n[y],S=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(j<10?"0".concat(j):j))),F=parseFloat(t.precios.precios_producto[0].precio_venta*parseFloat("0.".concat(u<10?"0".concat(u):u)));s.push({medida:{existencia:!1,codigo_barras:Ax(),nombre_comercial:t.datos_generales.nombre_comercial,medida:{},color:A,precio:t.precios.precios_producto[0].precio_neto,cantidad:0,precio_unidad:{numero_precio:1,precio_venta:t.precios.precios_producto[0].precio_venta,precio_neto:t.precios.precios_producto[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(S.toFixed(2)),ieps_precio:parseFloat(F.toFixed(2)),utilidad:t.precios.precios_producto[0].utilidad,unidad_maxima:!1}},nuevaCantidad:0})}c(Object(Ia.a)(n)),o(s)}(!b)},children:b?Object(H.jsx)(Yt.a,{}):null})})})},kx=Object(k.a)((function(e){return{root:{alignSelf:"center",width:"90%",paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:"100%",maxWidth:"100%"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(An.fade)(e.palette.primary.main,.1)}},cell:{align:"center"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function wx(e){var t=e.producto,a=e.setOnUpdate,n=e.onUpdate,c=e.new_medidas,r=e.setNew_medidas,i=kx();return Object(H.jsx)("div",{className:i.root,children:Object(H.jsx)(fn.a,{className:i.paper,children:Object(H.jsx)(Na.a,{style:{height:400},children:Object(H.jsxs)($a.a,{className:i.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Medida"}),Object(H.jsx)(Da.a,{children:"Color"}),Object(H.jsx)(Da.a,{children:"Cantidad existente"}),Object(H.jsx)(Da.a,{children:"Cantidad a traspasar"})]})}),Object(H.jsx)(za.a,{children:t.medidas_producto.map((function(e,i){return Object(H.jsx)(Nx,{idProducto:t._id,medida:e,index:i,setOnUpdate:a,onUpdate:n,new_medidas:c,setNew_medidas:r},i)}))})]})})})})}var Nx=function(e){var t=e.medida,a=e.index,n=(e.setOnUpdate,e.onUpdate,e.new_medidas),c=e.setNew_medidas,r=e.idProducto,i=Object(j.useState)(!0),o=Object(y.a)(i,2),s=o[0],l=(o[1],kx()),d=Object(j.useState)(0),u=Object(y.a)(d,2),b=u[0],p=u[1],O=Object(j.useState)(0),x=Object(y.a)(O,2),h=x[0],_=(x[1],Object(m.a)({},t)),f=Object(j.useContext)(_x).productosTras;Object(j.useEffect)((function(){return f.forEach((function(e){if(e.product_selected._id!==r);else{var a=[],n=null;for(var i in e.new_medidas)Object.hasOwnProperty.call(e.new_medidas,i)&&(n=e.new_medidas[i],a.push(n),t._id===n.medida._id&&p(n.nuevaCantidad));c(e.new_medidas)}})),function(){}}),[f]);return Object(H.jsxs)(Ea.a,{selected:!s,className:l.tableRow,children:[Object(H.jsx)(Da.a,{children:_.medida._id?Object(H.jsx)(gn.a,{label:_.medida.talla,color:"primary"}):""}),Object(H.jsx)(Da.a,{style:{width:"20%"},children:_.color._id?Object(H.jsx)(Ta.a,{title:_.color.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:l.colorContainer,style:{backgroundColor:_.color.hex}})}):null}),Object(H.jsx)(Da.a,{className:l.cell,style:{width:"25%"},children:t.cantidad}),Object(H.jsx)(Da.a,{style:{width:"25%"},children:Object(H.jsx)(S.a,{size:"small",variant:"outlined",InputProps:{inputProps:{min:0}},inputMode:"numeric",type:"number",value:b,onChange:function(e){return function(e){var r=h>0?parseInt(e-h):e;r<=t.cantidad&&(p(e),c(Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a,{medida:t,nuevaCantidad:parseInt(r)}))))}(e.target.value)},name:"nuevaCantidad"})})]})},Px=function(e){var t=e.classes,a=e.order,n=e.orderBy,c=e.onRequestSort,r=e.add?[{id:"codeBarras",numeric:!1,disablePadding:!1,label:"C\xf3digo de barras"},{id:"name",numeric:!1,disablePadding:!0,label:"Nombre"},{id:"tipo",numeric:!0,disablePadding:!1,label:"Tipo"},{id:"cantidad",numeric:!0,disablePadding:!1,label:"Cantidad"}]:[{id:"codeBarras",numeric:!1,disablePadding:!1,label:"C\xf3digo de barras"},{id:"name",numeric:!1,disablePadding:!0,label:"Nombre"},{id:"tipo",numeric:!0,disablePadding:!1,label:"Tipo"},{id:"cantidad",numeric:!0,disablePadding:!1,label:"Cantidad"},{id:"solo",numeric:!0,disablePadding:!1,label:" "}];return Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:r.map((function(e){return Object(H.jsx)(Da.a,{align:"left",sortDirection:n===e.id&&a,children:Object(H.jsxs)(Ox.a,{active:n===e.id,direction:n===e.id?a:"asc",onClick:(r=e.id,function(e){c(e,r)}),children:[e.label,n===e.id?Object(H.jsx)("span",{className:t.visuallyHidden,children:"desc"===a?"sorted descending":"sorted ascending"}):null]})},e.id);var r}))})})},Ex=Object(k.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},input:{width:180},inputCantidad:{width:120,height:10},inputCantidadTable:{width:"20%",height:10},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(ju.f)(e.palette.primary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{fontSize:16,flex:"1",display:"flex",flexWrap:"wrap"}}})),Dx=function(e){var t=Object(j.useState)([]),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useContext)(_x),i=r.setProductosTras,o=r.productosTras,s=function(){try{e.setOpenTallas(),e.setproduct_selected(void 0)}catch(t){}};return Object(j.useEffect)((function(){var t=[];o.forEach((function(a){if(a.product_selected._id===e.product_selected._id){var n=null;for(var c in a.new_medidas)Object.hasOwnProperty.call(a.new_medidas,c)&&(n=a.new_medidas[c],t.push(n))}})),c(t)}),[o,e.product_selected._id]),Object(H.jsxs)(qe.a,{open:e.openTallas,TransitionComponent:zx,fullWidth:!0,maxWidth:"md",children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{width:"88%",children:"Tallas y medidas"}),Object(H.jsx)(O.a,{m:1,display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return s()},size:"large",children:Object(H.jsx)(Ye.a,{})})})]})}),null===e.almacenOrigen?Object(H.jsx)("div",{children:Object(H.jsx)(Sx,{obtenerConsultasProducto:e.obtenerConsultasProducto,refetch:e.refetch,producto:e.product_selected,new_medidas:n,setNew_medidas:c})}):Object(H.jsx)("div",{children:Object(H.jsx)(wx,{producto:e.product_selected,new_medidas:n,setNew_medidas:c,add:e.add})}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",m:1,mr:5,children:Object(H.jsx)(F.a,{variant:"contained",color:"primary",style:{width:"20%"},onClick:function(){var t=n,a=0;try{var r;r=null!==e.almacenOrigen?{_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,medidas_producto:e.product_selected.medidas_producto,inventario_general:e.product_selected.inventario_general,unidades_de_venta:e.product_selected.unidades_de_venta,precios:e.product_selected.precios,empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario}:{_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,precios:e.product_selected.precios,medidas_producto:[],inventario_general:[{unidad_maxima:""}],unidades_de_venta:[],empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario};var l=!1,d=o,j=[];if(t.length>0)if(t.filter((function(e){return e.medida.color._id&&e.medida.medida._id})).length!==t.length)return void e.setError({message:"Faltan medidas o colores en tus presentaciones",status:"error",open:!0});for(var u in t)a+=t[u].nuevaCantidad,j.push(t[u]);if(a>0){if(d.length){if(d.forEach((function(t){if(t.product_selected._id===e.product_selected._id)return l=!0,t.new_medidas=j,void(t.cantidad_total=a)})),!l){var b={product_selected:r,new_medidas:j,cantidad_total:parseInt(a),unidad_maxima:!1};d.push(b)}}else{var p={product_selected:r,new_medidas:j,cantidad_total:parseInt(a),unidad_maxima:!1};d.push(p)}i(Object(Ia.a)(d)),c([]),s()}else e.setError({message:"La cantidad debe ser mayor a 0",status:"error",open:!0})}catch(m){console.log("MANDH",m)}},children:"AGREGAR"})})]})},zx=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Tx=function(e){var t=Ex(),a=Object(j.useState)(""),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=e.product_selected,u=e.setproduct_selected,b=e.tipoPieza,p=e.update,m=Object(j.useContext)(_x),x=m.setProductosTras,h=m.productosTras,_=function(t){try{if(e.setError({error:!1,mensaje:""}),0===t||""===t)return;var a=h.find((function(e){return e.product_selected._id===d._id}));if(a){var n=parseFloat(t);return e.add?void 0!==d.inventario_general?b.piezas?n<=d.inventario_general[0].cantidad_existente?a.cantidad_total=n:e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):n<=d.inventario_general[0].cantidad_existente_maxima?a.cantidad_total=n:e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):a.cantidad_total=n:a.cantidad_total=parseFloat(t),void x(Object(Ia.a)(h))}var c={_id:e.product_selected._id,datos_generales:e.product_selected.datos_generales,inventario_general:e.product_selected.inventario_general,unidades_de_venta:e.product_selected.unidades_de_venta,medidas_producto:e.product_selected.medidas_producto,precios:e.product_selected.precios,empresa:e.product_selected.empresa,sucursal:e.product_selected.sucursal,usuario:e.product_selected.usuario};if(void 0!==d.inventario_general)if(t<=d.inventario_general[0].cantidad_existente){var r={product_selected:c,new_medidas:[],cantidad_total:t,unidad_maxima:b.cajas};x([].concat(Object(Ia.a)(h),[r]))}else e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente."});else{var i={product_selected:c,new_medidas:[],cantidad_total:t,unidad_maxima:b.cajas};x([].concat(Object(Ia.a)(h),[i]))}return void u(void 0)}catch(o){}};Object(j.useEffect)((function(){try{e.add&&e.setOpenTallas(!0),r(e.cant)}catch(t){}}),[d]);var f,v,C=function(){try{var e={Pz:{unidad_maxima:null,unidad_minima:"Pz"},Caja:{unidad_maxima:"Caja",unidad_minima:"Pz"},Kg:{unidad_maxima:null,unidad_minima:"Kg"},Costal:{unidad_maxima:"Costal",unidad_minima:"Kg"},Lt:{unidad_maxima:null,unidad_minima:"Lt"}};return Object(H.jsxs)(O.a,{flexDirection:"row",display:"flex",children:[Object(H.jsxs)(O.a,{flexDirection:"row",children:[Object(H.jsx)(Ze.a,{checked:b.piezas,color:"primary",onChange:function(){p(),r(0)},disabled:null===e[d.precios.unidad_de_compra.unidad].unidad_maxima}),Object(H.jsx)(L.a,{color:"primary",style:{marginLeft:10},children:e[d.precios.unidad_de_compra.unidad].unidad_minima})]}),null!==e[d.precios.unidad_de_compra.unidad].unidad_maxima?Object(H.jsxs)(O.a,{flexDirection:"row",children:[Object(H.jsx)(Ze.a,{checked:b.cajas,color:"primary",onChange:function(){p(),r(0)}}),Object(H.jsxs)(L.a,{color:"primary",style:{marginLeft:10},children:[e[d.precios.unidad_de_compra.unidad].unidad_maxima," "]})]}):Object(H.jsx)("div",{})]})}catch(t){}};return Object(H.jsxs)(Je.a,{className:Object(mx.a)(t.root,Object(g.a)({},t.highlight,void 0!==d&&e.add)),children:[Object(H.jsxs)(Qe.a,{container:!0,children:[void 0!==d&&e.add?Object(H.jsx)(O.a,{style:{width:"100%"},children:Object(H.jsx)(L.a,{className:t.title,color:"inherit",variant:"subtitle2",children:d.datos_generales.nombre_comercial})}):Object(H.jsxs)(O.a,{style:{width:"100%"},flexDirection:"row",display:"flex",children:[Object(H.jsx)(L.a,{className:t.title,variant:"h6",id:"tableTitle",component:"div",children:e.title}),h.length>0&&!e.add?Object(H.jsx)(Ta.a,{title:"Eliminar todos",children:Object(H.jsx)(ce.a,{"aria-label":"delete",onClick:function(){return l(!0)},children:Object(H.jsx)(hO.a,{})})}):Object(H.jsx)("div",{})]}),void 0!==d?Object(H.jsxs)(O.a,{children:[e.error.error?Object(H.jsx)(L.a,{color:"inherit",children:e.error.mensaje}):Object(H.jsx)("div",{}),e.add&&"OTROS"===d.datos_generales.tipo_producto?Object(H.jsxs)(Qe.a,{container:!0,justifyContent:"space-evenly",ml:1,children:[null===e.almacenOrigen?Object(H.jsx)(C,{}):Object(H.jsxs)(O.a,{flexDirection:"row",display:"flex",children:[Object(H.jsxs)(O.a,{flexDirection:"row",children:[Object(H.jsx)(Ze.a,{checked:b.piezas,color:"primary",onChange:function(){p(),r(0)},disabled:null===e.product_selected.inventario_general[0].cantidad_existente_maxima}),Object(H.jsx)(L.a,{color:"primary",style:{marginLeft:10},children:e.product_selected.inventario_general[0].unidad_inventario})]}),null!==e.product_selected.inventario_general[0].unidad_maxima?Object(H.jsxs)(O.a,{flexDirection:"row",children:[Object(H.jsx)(Ze.a,{checked:b.cajas,color:"primary",onChange:function(){p(),r(0)}}),Object(H.jsxs)(L.a,{color:"primary",style:{marginLeft:10},children:[""+e.product_selected.inventario_general[0].unidad_maxima," "]})]}):Object(H.jsx)("div",{})]}),Object(H.jsxs)(O.a,{width:"180px",ml:2,children:[Object(H.jsx)(L.a,{color:"primary",children:"Cantidad"}),Object(H.jsx)(S.a,{className:t.inputCantidad,size:"small",name:"cantidad",variant:"outlined",type:"number",InputProps:{inputProps:{min:0}},value:c,onKeyPress:function(e){try{"Enter"===e.key&&_(parseFloat(e.target.value))}catch(t){}},onChange:function(t){return function(t){e.setError({error:!1,mensaje:""});var a=""!==t?parseFloat(t):0;try{return null!==e.almacenOrigen?b.piezas?a<=d.inventario_general[0].cantidad_existente?void r(0!==a?a:""):void e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente."}):a<=d.inventario_general[0].cantidad_existente_maxima?void r(0!==a?a:""):void e.setError({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente."}):void r(a)}catch(n){}}(t.target.value)}}),Object(H.jsx)(Ta.a,{title:"Agregar",children:Object(H.jsx)(ce.a,{"aria-label":"add",onClick:function(){return _(c)},children:Object(H.jsx)(Ac.a,{})})})]}),e.almacenOrigen?Object(H.jsx)(O.a,{width:"150px",children:null!==e.product_selected.inventario_general[0].cantidad_existente_maxima?Object(H.jsx)(L.a,{color:"primary",style:{flexWrap:"wrap"},children:(f=e.product_selected.inventario_general[0].cantidad_existente_maxima,v=e.product_selected.inventario_general[0].unidad_maxima,{Caja:"Cantidad existente en cajas: "+f,Costal:"Cantidad existente en costales: "+f}[v])}):Object(H.jsx)("div",{})}):Object(H.jsx)("div",{})]}):Object(H.jsx)("div",{children:Object(H.jsx)(Dx,{openTallas:e.openTallas,setOpenTallas:e.setOpenTallas,setproduct_selected:u,product_selected:d,almacenOrigen:e.almacenOrigen,obtenerConsultasProducto:e.obtenerConsultasProducto,refetch:e.refetch,setError:e.setError})})]}):Object(H.jsx)("div",{}),Object(H.jsx)(Y,{alert:e.error,setAlert:e.setError})]}),Object(H.jsxs)(qe.a,{open:s,onClose:function(){return l(!1)},children:[Object(H.jsx)(Bt.a,{children:"\xbfEst\xe1 seguro de realizar esta acci\xf3n?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return l(!1)},color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return function(){try{u(void 0),x([]),l(!1)}catch(e){}}()},children:"Eliminar"})]})]})]})},$x=Object(k.a)((function(e){return{root:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},paper:{width:"100%",marginBottom:e.spacing(2)},table:{},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Wx(e){var t=$x(),a=Object(j.useState)("asc"),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)("calories"),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(void 0),u=Object(y.a)(d,2),b=u[0],p=u[1],x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useState)([]),v=Object(y.a)(g,2),C=v[0],A=v[1],F=Object(j.useState)(0),k=Object(y.a)(F,2),w=k[0],N=k[1],P=Object(j.useState)({error:!1,mensaje:""}),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(j.useState)({piezas:!0,cajas:!1}),$=Object(y.a)(T,2),W=$[0],R=$[1],V=JSON.parse(localStorage.getItem("sesionCafi")),M=Object(j.useContext)(_x),L=M.productosTras,B=M.productosTo,U=M.productosEmpTo,q=M.setProductosTras,J=Object(rt.b)(Xn,{variables:{empresa:V.empresa._id,sucursal:V.sucursal._id},fetchPolicy:"network-only"});Object(j.useEffect)((function(){A(e.add?e.almacenOrigen?B:U:L)}),[U,B,L]);var G=function(t,a,n){if(z({error:!1,mensaje:""}),"OTROS"===a.datos_generales.tipo_producto){var c=0;L.forEach((function(e){e.product_selected._id===a._id&&(c=e.cantidad_total)})),N(e.add?c:n)}if(void 0!==b){var r=b._id===a._id;p(r?void 0:a)}else p(a)},Y=function(t,a){try{var n=L.find((function(e){return e.product_selected._id===a._id}));if(0===t||""===t)return void(n.cantidad_total=0);if(n){var c=parseFloat(t+n.cantidad_total);return e.add?void 0!==a.inventario_general?W.piezas?c<=a.inventario_general[0].cantidad_existente?n.cantidad_total=c:z({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):c<=a.inventario_general[0].cantidad_existente_maxima?n.cantidad_total=c:z({error:!0,mensaje:"La cantidad ingresada sobrepasa la cantidad existente del producto seleccionado."}):n.cantidad_total=c:n.cantidad_total=parseFloat(t),void q(Object(Ia.a)(L))}return}catch(D){}};if(e.loading&&e.add)return Object(H.jsx)("div",{className:t.root,children:Object(H.jsx)(O.a,{mt:5,style:{display:"flex",justifyContent:"center"},children:Object(H.jsx)(I.a,{})})});var Q=e.add?null===C||void 0===C?void 0:C.docs:C;return Object(H.jsx)("div",{className:t.root,children:Object(H.jsxs)(fn.a,{className:t.paper,children:[Object(H.jsx)(Tx,{product_selected:b,setproduct_selected:p,openTallas:_,setOpenTallas:f,error:D,setError:z,title:e.title,add:e.add,almacenOrigen:e.almacenOrigen,productosTras:L,tipoPieza:W,update:function(){R(Object(m.a)(Object(m.a)({},W),{},{piezas:!W.piezas,cajas:!W.cajas}))},cant:w,obtenerConsultasProducto:J.data?J.data.obtenerConsultasProducto:[],refetch:J.refetch?J.refetch:null}),Object(H.jsx)(Na.a,{style:{height:"38vh"},children:Object(H.jsxs)($a.a,{"aria-labelledby":"tableTitle",size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Px,{classes:t,product_selected:b,add:e.add,order:c,orderBy:s,handleSelectAllClick:function(e){e.target.checked?p(e.target.checked):p([])},onRequestSort:function(e,t){r(s===t&&"asc"===c?"desc":"asc"),l(t)}}),Object(H.jsx)(za.a,{children:null===Q||void 0===Q?void 0:Q.map((function(t,a){var n,c=(n=!0===e.add?t._id:t.product_selected._id,void 0!==b&&!(b._id!==n)),r="enhanced-table-checkbox-".concat(a);return e.add?e.almacenOrigen?Object(H.jsxs)(Ea.a,{hover:!0,onClick:function(e){return G(0,t)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(H.jsx)(Da.a,{id:r,scope:"row",children:null==t.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.datos_generales.codigo_barras}),Object(H.jsx)(Da.a,{component:"th",id:r,scope:"row",children:t.datos_generales.nombre_comercial}),Object(H.jsxs)(Da.a,{align:"left",children:[" ",t.datos_generales.tipo_producto]}),Object(H.jsxs)(Da.a,{align:"left",children:[" ",t.inventario_general[0].cantidad_existente,"  ",t.inventario_general[0].unidad_inventario," "]})]},!0===e.add?t._id:t.product_selected._id):Object(H.jsxs)(Ea.a,{hover:!0,onClick:function(e){return G(0,t)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(H.jsx)(Da.a,{id:r,scope:"row",children:null==t.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.datos_generales.codigo_barras}),Object(H.jsx)(Da.a,{component:"th",id:r,scope:"row",children:t.datos_generales.nombre_comercial}),Object(H.jsxs)(Da.a,{align:"left",children:[" ",t.datos_generales.tipo_producto]}),Object(H.jsx)(Da.a,{align:"left",children:" N/A"})]},t._id):Object(H.jsxs)(Ea.a,{hover:!0,onClick:function(e){return G(0,t.product_selected,t.cantidad_total)},role:"checkbox","aria-checked":c,tabIndex:-1,selected:c,children:[Object(H.jsx)(Da.a,{id:r,component:"th",width:100,children:null==t.product_selected.datos_generales.codigo_barras?"SIN C\xd3DIGO":t.product_selected.datos_generales.codigo_barras}),Object(H.jsx)(Da.a,{id:r,width:200,children:t.product_selected.datos_generales.nombre_comercial}),Object(H.jsxs)(Da.a,{align:"left",children:[" ",t.product_selected.datos_generales.tipo_producto]}),"OTROS"===t.product_selected.datos_generales.tipo_producto?Object(H.jsx)(Da.a,{align:"left",width:20,children:Object(H.jsx)(S.a,{size:"small",name:"cantidad",variant:"outlined",type:"number",InputProps:{inputProps:{min:0}},value:t.cantidad_total,onChange:function(a){return function(t,a){if(z({error:!1,mensaje:""}),""!==t){var n=parseFloat(t);try{if(null===e.almacenOrigen)return void Y(n,a);if(W.piezas){if(n<=a.inventario_general[0].cantidad_existente)return void Y(n,a)}else if(n<=a.inventario_general[0].cantidad_existente_maxima)return void Y(n,a)}catch(D){console.log(D)}}else Y("",a)}(a.target.value,t.product_selected)}})}):Object(H.jsxs)(Da.a,{align:"left",children:[" ",t.cantidad_total]}),Object(H.jsx)(Da.a,{align:"left",width:10,children:Object(H.jsxs)(O.a,{flexDirection:"row",display:"flex",style:{width:75},children:["OTROS"!==t.product_selected.datos_generales.tipo_producto?Object(H.jsx)(Ta.a,{title:"Editar",children:Object(H.jsx)(ce.a,{"aria-label":"edit",onClick:function(){return function(e){try{"OTROS"!==e.datos_generales.tipo_producto&&(f(!0),J.refetch())}catch(D){}}(t.product_selected)},children:Object(H.jsx)(hx.a,{})})}):Object(H.jsx)("div",{}),Object(H.jsx)(Ta.a,{title:"Eliminar",children:Object(H.jsx)(ce.a,{"aria-label":"delete",onClick:function(){return function(e){try{var t=[];L.length&&(t=L),q(t.filter((function(t){return t.product_selected._id!==e._id})))}catch(D){}}(t.product_selected)},children:Object(H.jsx)(hO.a,{})})})]})})]},!0===e.add?t._id:t.product_selected._id)}))})]})}),e.add?Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:null===C||void 0===C?void 0:C.totalDocs,rowsPerPage:e.limit,page:e.almacenOrigen?e.pageAlm:e.page,onPageChange:function(t,a){e.almacenOrigen?e.setPageAlm(a):e.setPage(a)}}):Object(H.jsx)("div",{})]})})}var Rx=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:50},imagen:{width:50},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},"& span":{color:"red"}},subtitle:{marginLeft:"10px",width:"50%"},boxUpData:{height:80},formControl:{margin:e.spacing(1),minWidth:300,maxWidth:300},selected2:{width:"50%",height:50},selected:{width:"50%",height:50},input:{width:"100%"},inputBox:{margin:20,marginTop:5,marginBottom:10},button:{margin:e.spacing(3),marginTop:e.spacing(2),marginBottom:e.spacing(0)},boxControl:{margin:e.spacing(2.5),marginTop:0,minWidth:"20%",maxWidth:"20%",minHeight:20},centerControl:{marginTop:10}}}));function Vx(e,t,a){return{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}var Mx=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Lx={PaperProps:{style:{maxHeight:908,width:400}}},Bx=["Barco","Moto","Carro","Camioneta"],Ux=["Datos traspaso","Seleccionar productos"];function qx(e){var t=Rx(),a=Object($e.a)(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(j.useContext)(_x),r=c.setProductos,i=c.setProductosTras,o=c.setProductosTo,s=c.setProductosEmpTo,l=c.productosTras,d=Object(j.useState)({message:"",status:"",open:!1}),u=Object(y.a)(d,2),b=u[0],p=u[1],x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=Object(j.useState)(!1),A=Object(y.a)(g,2),I=A[0],k=A[1],N=Object(j.useState)(""),P=Object(y.a)(N,2),E=P[0],D=P[1],z=Object(Lc.a)(E,700),T=Object(y.a)(z,1)[0],$=Object(j.useState)(!1),W=Object(y.a)($,2),R=W[0],V=W[1],M=Object(j.useState)(null),B=Object(y.a)(M,2),U=B[0],q=B[1],J=Object(j.useState)(!1),G=Object(y.a)(J,2),Q=G[0],K=G[1],X=Object(j.useState)(!1),Z=Object(y.a)(X,2),re=Z[0],ie=Z[1],oe=Object(j.useState)(null),se=Object(y.a)(oe,2),le=se[0],de=se[1],je=Object(j.useState)(null),ue=Object(y.a)(je,2),be=ue[0],pe=ue[1],me=Object(j.useState)([]),Oe=Object(y.a)(me,2),xe=Oe[0],he=Oe[1],_e=Object(j.useState)(""),fe=Object(y.a)(_e,2),ge=fe[0],ve=fe[1],Ce=Object(j.useState)(""),ye=Object(y.a)(Ce,2),Ae=ye[0],Se=ye[1],Fe=Object(j.useState)(""),Ie=Object(y.a)(Fe,2),ke=Ie[0],we=Ie[1],Ne=Object(j.useState)(0),Pe=Object(y.a)(Ne,2),Ee=Pe[0],De=Pe[1],ze=Object(j.useState)(new Set),Te=Object(y.a)(ze,2),Ve=Te[0],Me=Te[1],Le=Object(j.useState)(!1),Be=Object(y.a)(Le,2),Ue=Be[0],He=Be[1],Ge=Object(w.a)(ri),Ye=Object(y.a)(Ge,1)[0],Ke=[],Xe=[],Ze=Object(rt.b)(ei,{variables:{id:n.sucursal._id},fetchPolicy:"network-only"}),at=Object(rt.b)(cb,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id},fetchPolicy:"network-only"}),nt=Object(rt.b)(ci,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id},fetchPolicy:"network-only"}),ct=Object(rt.b)(ec,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,filtro:T,almacen:le?le._id:"",existencias:!0,limit:e.limit,offset:e.pageAlm},fetchPolicy:"network-only"}),it=Object(rt.b)(ii,{variables:{empresa:n.empresa._id,filtro:T,limit:e.limit,offset:e.page},fetchPolicy:"network-only"}),ot=Object(j.useCallback)(Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{ct.refetch()}catch(t){}case 1:case"end":return e.stop()}}),e)}))),[ct]);Object(j.useEffect)((function(){le&&(he(Ze.data.obtenerAlmacenes.filter((function(e){return e._id!==le._id}))),ot())}),[le]);var lt=Object(j.useCallback)(Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{it.refetch()}catch(t){console.log("errorObtenerProductosEmpresa",t)}case 1:case"end":return e.stop()}}),e)}))),[it]);Object(j.useEffect)((function(){try{null!==U&&("N/A"===U.origen?lt():ot())}catch(e){console.log("conceptoTraspaso",e)}}),[U]),Object(j.useEffect)((function(){null!==U&&("N/A"===U.destino?V(null!==le):"N/A"===U.origen?V(null!==be):V(null!==le&&null!==be))}),[U,le,be]),Object(j.useEffect)((function(){it.data&&s(it.data.obtenerProductosPorEmpresa)}),[it.data,s]),Object(j.useEffect)((function(){ct.data&&(r(ct.data.obtenerProductos),o(ct.data.obtenerProductos))}),[ct]),Object(j.useEffect)((function(){k(!0),nt.refetch(),k(!1)}),[nt]);var dt=function(){f(!1),i([]),de(null),pe(null),q(null),e.setPage(0),e.setPageAlm(0);var t=Ve;jt(Ee)&&(t=new Set(t.values())).delete(Ee),De((function(e){return 0}))},jt=function(e){return Ve.has(e)},ut=function(){e.setPage(0),e.setPageAlm(0),De((function(e){return e-1}))};at.data&&(Ke=at.data.obtenerConceptosAlmacen),Ze.data&&(Xe=Ze.data.obtenerAlmacenes);var bt=function(){He(!Ue)},pt=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var a,c;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!l.length){t.next=11;break}return He(!1),k(!0),a={variables:{input:{concepto_traspaso:{_id:U._id,nombre_concepto:U.nombre_concepto,destino:U.destino,origen:U.origen,editable:U.editable},almacen_origen:null!==le?{_id:le._id,nombre_almacen:le.nombre_almacen,default_almacen:le.default_almacen}:{_id:"",nombre_almacen:"",default_almacen:!1},almacen_destino:null!==be?{_id:be._id,nombre_almacen:be.nombre_almacen,default_almacen:be.default_almacen}:{_id:"",nombre_almacen:"",default_almacen:!1},productos:l,datos_transporte:{transporte:ge,placas:Ae,nombre_encargado:ke},sucursalOrigen:n.sucursal._id,sucursalDestino:n.sucursal._id,fecha_registro:Dt()().locale("es-mx").format()},usuario:n._id,empresa:n.empresa._id}},t.next=7,Ye(a);case 7:"error"!==(c=t.sent).data.crearTraspaso.resp&&(e.productosAlmacenQuery.refetch(),p({message:c.data.crearTraspaso.message,status:c.data.crearTraspaso.resp,open:!0}),i([]),de(null),pe(null),q(null),ut()),t.next=12;break;case 11:p({message:"No es posible realizar un traspaso sin agregar productos.",status:"error",open:!0});case 12:k(!1),t.next=21;break;case 15:t.prev=15,t.t0=t.catch(0),k(!1),He(!1),void 0!==t.t0.networkError?console.log("traspaso networkError",t.t0.networkError.result):void 0!==t.t0.graphQLErrors&&console.log("traspaso graphQLErrors",t.t0.graphQLErrors),p({message:"Ocurri\xf3 un error al realizar el traspaso...",status:"error",open:!0});case 21:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(){return t.apply(this,arguments)}}();return Object(H.jsx)(H.Fragment,{children:Object(H.jsxs)(O.a,{sx:{width:"100%"},children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){f(!0),it.refetch(),ct.refetch(),at.refetch(),Ze.refetch(),e.productosAlmacenQuery.refetch()},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsxs)(Qe.a,{container:!0,justifyContent:"center",children:[Object(H.jsx)(Qe.a,{item:!0,xs:12,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.a,{className:t.icon})})}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Ai,alt:"icono almacen",className:t.imagen})})}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Ai,alt:"icono almacen",className:t.imagen})})})]}),"Traspasos"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:_,onClose:dt,TransitionComponent:Mx,children:[Object(H.jsx)(st,{loading:I,setLoading:k}),Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Traspasos"}),Object(H.jsx)(O.a,{mx:3,children:Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:dt,children:Object(H.jsx)(Gt.a,{style:{fontSize:30}})})})})]})}),Object(H.jsx)(O.a,{style:{width:"50%",alignSelf:"center",alignContent:"center",alignItems:"center"},children:Object(H.jsx)(ux.a,{activeStep:Ee,children:Ux.map((function(e,t){var a={};return jt(t)&&(a.completed=!1),Object(H.jsx)(bx.a,Object(m.a)(Object(m.a)({},a),{},{children:Object(H.jsx)(px.a,Object(m.a)(Object(m.a)({},{}),{},{children:e}))}),e)}))})}),Object(H.jsxs)(O.a,{children:[0===Ee?Object(H.jsx)(Qe.a,{container:!0,justify:"center",children:Object(H.jsx)(Qe.a,{item:!0,lg:7,children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{className:t.subtitle,children:Object(H.jsx)("b",{children:"Datos traspaso"})}),Object(H.jsx)(et.a,{}),Object(H.jsxs)(O.a,{mt:2,style:{display:"flex",width:"100%",justifyContent:"center"},children:[Object(H.jsxs)(O.a,{m:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Usuario"})}),Object(H.jsxs)(L.a,{children:[" ",n.nombre," "]})]}),Object(H.jsxs)(O.a,{m:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Sucursal"})}),Object(H.jsxs)(L.a,{children:[" ",n.sucursal.nombre_sucursal," "]})]}),Object(H.jsxs)(O.a,{m:2,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Fecha"})}),Object(H.jsxs)(L.a,{children:["  ",Dt()().locale("es-mx").format("MM/DD/YYYY")," "]})]})]}),Object(H.jsxs)(O.a,{m:1,style:{width:"100%",justifyContent:"center"},children:[Object(H.jsx)(O.a,{style:{width:"100%"},children:Object(H.jsxs)(ee.a,{className:t.formControl,children:[Object(H.jsx)(te.a,{id:"concepto-label",children:"Concepto traspaso"}),Object(H.jsx)(Nt.a,{labelId:"concepto-label",id:"concepto-name",value:U||"",onChange:function(e){try{var t=e.target.value;he([]),Xe=[],de(null),pe(null),"N/A"===t.origen?he(Ze.data.obtenerAlmacenes):he([]),K("N/A"!==t.origen),ie("N/A"!==t.destino),q(t)}catch(a){}},input:Object(H.jsx)(_n.a,{}),MenuProps:Lx,children:Ke.map((function(e){return Object(H.jsx)(Pt.a,{value:e,children:e.nombre_concepto},e._id)}))})]})}),null!==U?Object(H.jsxs)(O.a,{style:{display:"flex"},children:[Q?Object(H.jsx)(O.a,{children:Object(H.jsxs)(ee.a,{className:t.formControl,children:[Object(H.jsx)(te.a,{id:"almacen-origen-label",children:"Almac\xe9n origen"}),Object(H.jsx)(Nt.a,{labelId:"almacen-origen-label",id:"almacen-origen-name",value:le||"",onChange:function(e){de(e.target.value),i([])},input:Object(H.jsx)(_n.a,{}),MenuProps:Lx,children:Xe.map((function(e){return Object(H.jsx)(Pt.a,{value:e,children:e.nombre_almacen},e._id)}))})]})}):Object(H.jsx)(H.Fragment,{}),re?Object(H.jsxs)(ee.a,{className:t.formControl,children:[Object(H.jsx)(te.a,{id:"almacen-destino-label",children:"Almac\xe9n destino"}),Object(H.jsx)(Nt.a,{labelId:"almacen-destino-label",id:"almacen-destino-name",value:be||"",onChange:function(e){pe(e.target.value),i([])},input:Object(H.jsx)(_n.a,{}),MenuProps:Lx,children:xe.map((function(e){return Object(H.jsx)(Pt.a,{value:e,children:e.nombre_almacen},e._id)}))})]}):Object(H.jsx)(H.Fragment,{})]}):Object(H.jsx)(H.Fragment,{})]})]}),Object(H.jsxs)(O.a,{className:t.centerControl,style:{width:"100%"},children:[Object(H.jsx)(L.a,{className:t.subtitle,children:Object(H.jsx)("b",{children:"Datos transporte traspaso"})}),Object(H.jsx)(et.a,{}),Object(H.jsxs)(Qe.a,{justify:"center",children:[Object(H.jsxs)(ee.a,{className:t.formControl,style:{marginTop:15},children:[Object(H.jsx)(te.a,{id:"transporte-label",children:"Transporte"}),Object(H.jsx)(Nt.a,{labelId:"transporte-label",id:"transporte-name",value:ge,onChange:function(e){ve(e.target.value)},input:Object(H.jsx)(_n.a,{}),MenuProps:Lx,children:Bx.map((function(e){return Object(H.jsx)(Pt.a,{value:e,style:Vx(e,ge,a),children:e},e)}))})]}),Object(H.jsxs)(O.a,{justify:"center",children:[Object(H.jsxs)(ee.a,{className:t.formControl,children:[Object(H.jsx)(L.a,{children:"Placas"}),Object(H.jsx)(S.a,{fullWidth:!0,className:t.input,type:"text",size:"small",name:"placas",variant:"outlined",value:Ae.toUpperCase(),onChange:function(e){return Se(e.target.value)}})]}),Object(H.jsxs)(ee.a,{className:t.formControl,children:[Object(H.jsx)(L.a,{children:"Nombre de encargado de transporte"}),Object(H.jsx)(S.a,{fullWidth:!0,className:t.input,type:"text",size:"small",name:"nombreQuien",variant:"outlined",value:ke,onChange:function(e){return we(e.target.value)}})]})]})]})]})]})})}):Object(H.jsx)(O.a,{children:Object(H.jsxs)(O.a,{ml:1,style:{width:"100%"},children:[Object(H.jsxs)(O.a,{ml:2,children:[Object(H.jsx)(L.a,{className:t.subtitle,children:Object(H.jsx)("b",{children:"Buscar producto"})}),Object(H.jsx)(O.a,{style:{width:"48%"},children:Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsx)(ae.a,{id:"search-producto",type:"text",value:E,onChange:function(t){return a=t.target.value,D(a),void e.setPage(0);var a},endAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(ce.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(H.jsx)(Nc.a,{})})})})})})]}),Object(H.jsx)(O.a,{mt:1,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,style:{width:"100%"},children:[Object(H.jsx)(Qe.a,{item:!0,md:6,children:Q?Object(H.jsx)(Wx,{title:"Productos",add:!0,almacenOrigen:le,refetch:ct.refetch,loading:ct.loading,setAlert:p,pageAlm:e.pageAlm,setPageAlm:e.setPageAlm,limit:e.limit}):Object(H.jsx)(Wx,{title:"Productos",add:!0,almacenOrigen:null,refetch:ct.refetch,setAlert:p,page:e.page,loading:ct.loading,setPage:e.setPage,limit:e.limit})}),Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsx)(Wx,{title:"Productos a traspasar",add:!1,almacenOrigen:le,refetch:ct.refetch,setAlert:p})})]})})]})}),Object(H.jsx)(tt.a,{style:{justifyContent:"center"},children:Object(H.jsxs)(O.a,{sx:{flexDirection:"row",alignSelf:"center",width:"30%",display:"flex",pt:0},children:[Object(H.jsx)(F.a,{color:"primary",variant:"contained",disabled:0===Ee,onClick:ut,style:{width:"43%"},sx:{mr:1},children:"Atr\xe1s"}),Object(H.jsx)(O.a,{style:{flex:"1 1 auto"}}),Object(H.jsx)(F.a,{color:"primary",variant:"contained",style:{width:"43%"},disabled:!R,onClick:function(){return Ee<Ux.length-1?function(){var e=Ve;jt(Ee)&&(e=new Set(e.values())).delete(Ee),De((function(e){return e+1})),Me(e)}():bt()},children:Ee<Ux.length-1?"Siguiente":"Terminar"})]})})]}),Object(H.jsxs)(qe.a,{open:Ue,onClose:bt,children:[Object(H.jsx)(Bt.a,{children:"\xbfEst\xe1 seguro de realizar este traspaso?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return bt()},color:"primary",children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",autoFocus:!0,variant:"contained",onClick:function(){return pt()},children:"Traspasar"})]})]}),Object(H.jsx)(Y,{alert:b,setAlert:p})]})]})})}var Jx=Object(k.a)({root:{width:"100%",height:"48vh"},container:{maxHeight:"74vh"},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}});function Hx(e){var t=Jx();return Object(H.jsx)("div",{className:t.root,children:Object(H.jsx)(fn.a,{children:Object(H.jsx)(Na.a,{style:{height:"45vh"},children:Object(H.jsxs)($a.a,{className:t.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Medida"}),Object(H.jsx)(Da.a,{children:"Color"}),Object(H.jsx)(Da.a,{children:"Cantidad existente"})]})}),Object(H.jsx)(za.a,{children:e.producto.medidas_producto.map((function(t,a){return Object(H.jsx)(Gx,{item:t,almacenSeleccionado:e.almacen},a)}))})]})})})})}var Gx=function(e){var t=e.item,a=e.almacenSeleccionado,n=Jx();try{var c=Object(H.jsx)("div",{});return a._id===t.almacen&&(c=Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.medida.talla}),Object(H.jsx)(Da.a,{children:Object(H.jsx)(Ta.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(H.jsx)("div",{className:n.colorContainer,style:{backgroundColor:t.color.hex}})})}),Object(H.jsx)(Da.a,{children:t.cantidad})]})),c}catch(r){console.log(r)}},Yx={PaperProps:{style:{maxHeight:908,width:400}}},Qx=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"100%"},formControl:{margin:e.spacing(1),minWidth:300,maxWidth:300}}})),Kx=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Xx(e){var t=Qx(),a=Object(j.useState)({}),n=Object(y.a)(a,2),c=n[0],r=n[1];return Object(H.jsxs)(qe.a,{open:e.medidasAlmacen.open,TransitionComponent:Kx,fullWidth:!0,maxWidth:"sm",children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{width:"88%",children:"Tallas y medidas"}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){e.setMedidasAlmacen({open:!1,producto:{}}),r({})},size:"large",children:Object(H.jsx)(Gt.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(O.a,{mx:3,children:Object(H.jsxs)(ee.a,{className:t.formControl,children:[Object(H.jsx)(te.a,{id:"almacen-label",children:"Almac\xe9n"}),Object(H.jsx)(Nt.a,{labelId:"almacen-label",id:"almacen",value:c?c.nombre_almacen:"",onChange:function(e){try{r(e.target.value)}catch(t){}},input:Object(H.jsx)(_n.a,{}),MenuProps:Yx,children:e.obtenerAlmacenes.map((function(e){return Object(H.jsx)(Pt.a,{value:e,children:e.nombre_almacen},e._id)}))})]})}),e.medidasAlmacen.open?Object(H.jsx)(O.a,{height:"100%",mx:3,mt:2,children:Object(H.jsx)(Hx,{producto:e.medidasAlmacen.producto,almacen:c})}):Object(H.jsx)("div",{})]})}var Zx=Object(k.a)({root:{width:"100%"},container:{maxHeight:"76vh"}});function eh(e){var t=Zx(),a=Object(j.useState)({open:!1,producto:{}}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(e){try{"OTROS"!==e.datos_generales.tipo_producto&&r({open:!0,producto:e})}catch(t){console.log(t)}};return e.loading?Object(H.jsx)(st,{loading:e.loading}):Object(H.jsxs)(fn.a,{className:t.root,children:[Object(H.jsx)(Na.a,{className:t.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:e.columns.map((function(e,t){return Object(H.jsx)(Da.a,{align:e.align,style:{textAlign:t>1?"center":"left",minWidth:e.minWidth,width:e.minWidth},children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:e.productos.docs.map((function(t,a){var n=a;return Object(H.jsx)(th,{producto:t,index:n,productosLength:e.productos.totalDocs,dataExcel:e.dataExcel,setDataExcel:e.setDataExcel,obtenerAlmacenes:e.obtenerAlmacenes,toShowMedidasAlmacen:i},a)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:e.productos.totalDocs,rowsPerPage:e.limit,page:e.page,onPageChange:function(t,a){e.setPage(a)}}),Object(H.jsx)(Xx,{medidasAlmacen:c,setMedidasAlmacen:r,obtenerAlmacenes:e.obtenerAlmacenes})]})}var th=function(e){var t=Object(j.useContext)(_x),a=t.dataExcel,n=t.setDataExcel,c=Object(j.useState)([]),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)([]),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)({codigo_barras:e.producto.datos_generales.codigo_barras,nombre_comercial:e.producto.datos_generales.nombre_comercial,style:{font:{sz:"12"},alignment:{wrapText:!0,horizontal:"center",vertical:"top"},border:{bottom:{style:"thin",color:{rgb:"000000"}}}}}),p=Object(y.a)(b,2),O=p[0],x=p[1],h=Object(j.useState)(0),_=Object(y.a)(h,2),f=_[0],v=_[1],C=Object(j.useState)(""),A=Object(y.a)(C,2),S=A[0],F=A[1];Object(j.useEffect)((function(){try{var t=0,n=O,c=a,r="pz",i=[];e.obtenerAlmacenes.forEach((function(a){var c=e.producto.existencia_almacenes.filter((function(e){return e._id.almacen._id===a._id}));c.length>0?(null!==c[0].unidad_maxima?c[0].unidad_maxima===e.producto.precios.inventario.unidad_de_inventario?(i.push(c[0].cantidad_existente_maxima),t+=c[0].cantidad_existente_maxima,r=e.producto.existencia_almacenes[0].unidad_maxima):(t+=c[0].cantidad_existente,i.push(c[0].cantidad_existente),r=e.producto.existencia_almacenes[0].unidad_inventario):(r=e.producto.existencia_almacenes[0].unidad_inventario,t+=c[0].cantidad_existente,i.push(c[0].cantidad_existente)),F(r),n=Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a._id,c[0].cantidad_existente+" "+r))):(i.push(0),n=Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a._id,0)))})),n=Object(m.a)(Object(m.a)({},n),{},{costo_producto:I(),costo_total_produc:k(t),total:t+" "+r}),u(i),v(t),x(n),c.push(n),o(c),e.index===e.productosLength-1&&console.log("dataExcelHere",c)}catch(s){console.log(s)}}),[e.producto]),Object(j.useEffect)((function(){i&&n(i)}),[i]);var I=function(){try{var t=0;return t=e.producto.precios.unidad_de_compra.precio_unitario_con_impuesto,e.producto.existencia_almacenes.length>0&&null!==e.producto.existencia_almacenes[0].unidad_maxima&&e.producto.existencia_almacenes[0].unidad_maxima===e.producto.precios.inventario.unidad_de_inventario&&(t=e.producto.precios.precio_de_compra.precio_con_impuesto),Ua(t)}catch(a){console.log(a)}},k=function(t){try{var a=0;return a=e.producto.precios.unidad_de_compra.precio_unitario_con_impuesto*t,e.producto.existencia_almacenes.length>0&&null!==e.producto.existencia_almacenes[0].unidad_maxima&&e.producto.existencia_almacenes[0].unidad_maxima===e.producto.precios.inventario.unidad_de_inventario&&(a=e.producto.precios.precio_de_compra.precio_con_impuesto*t),Ua(a)}catch(n){console.log(n)}};return Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(){return e.toShowMedidasAlmacen(e.producto)},children:[Object(H.jsx)(Da.a,{style:{minWidth:60},children:e.producto.datos_generales.codigo_barras}),Object(H.jsx)(Da.a,{style:{minWidth:170},children:e.producto.datos_generales.nombre_comercial}),Object(H.jsxs)(Da.a,{style:{textAlign:"center",minWidth:60},children:["$",I()]}),Object(H.jsxs)(Da.a,{style:{textAlign:"center",minWidth:80},children:["$",function(){try{var t=0;return t=e.producto.precios.unidad_de_compra.precio_unitario_con_impuesto*f,e.producto.existencia_almacenes.length>0&&null!==e.producto.existencia_almacenes[0].unidad_maxima&&e.producto.existencia_almacenes[0].unidad_maxima===e.producto.precios.inventario.unidad_de_inventario&&(t=e.producto.precios.precio_de_compra.precio_con_impuesto*f),Ua(t)}catch(a){console.log(a)}}()]}),d.map((function(e,t){return Object(H.jsx)(Da.a,{style:{backgroundColor:"rgba(255, 253, 150, 0.1)",color:"black",fontSize:17,textAlign:"center",minWidth:60},children:e+" "+S},t)})),Object(H.jsx)(Da.a,{style:{backgroundColor:"rgba(255, 253, 150, 0.1)",color:"black",fontSize:18,fontWeight:"bold",textAlign:"center",minWidth:60},children:f+" "+S})]},e.producto._id)},ah=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},boxControl:{margin:e.spacing(2.5),marginTop:0,minWidth:"20%",maxWidth:"20%"},icon:{fontSize:100},imagen:{width:100},inputBox:{margin:20},button:{margin:e.spacing(3)}}})),nh=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function ch(e){var t=ah(),a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1];return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){e.productosAlmacenQuery.refetch(),r(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Ob,alt:"icono almacen",className:t.imagen})}),"Inventario por almacen"]})}),Object(H.jsx)(rh,{open:c,productos:e.productos,productosAlmacenQuery:e.productosAlmacenQuery,handleClose:function(){r(!1)},page:e.page,setPage:e.setPage,limit:e.limit})]})}var rh=function(e){var t,a=ah(),n=Object(j.useState)(!0),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(""),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useContext)(_x),b=u.dataExcel,p=u.setDataExcel,m=Object(j.useState)([]),x=Object(y.a)(m,2),h=x[0],_=x[1],f=Object(Lc.a)(l,700),g=Object(y.a)(f,1)[0],v=JSON.parse(localStorage.getItem("sesionCafi")),C=Object(j.useState)([]),A=Object(y.a)(C,2),S=A[0],k=A[1],w=Object(rt.b)(ci,{variables:{empresa:v.empresa._id,sucursal:v.sucursal._id},fetchPolicy:"network-only"}),N=Object(rt.b)(ei,{variables:{id:v.sucursal._id},fetchPolicy:"network-only"});return Object(j.useEffect)((function(){try{e.open&&(p([]),N.refetch())}catch(t){console.log(t)}}),[e.open]),Object(j.useEffect)((function(){""!==g&&(e.productosAlmacenQuery.refetch({input:{empresa:v.empresa._id,sucursal:v.sucursal._id,filtro:g},limit:10,offset:0}),e.setPage(0))}),[g]),Object(j.useEffect)((function(){if(N.data){var e=[{id:"codigo_barras",label:"C\xf3digo de barras",minWidth:60,widthPx:160},{id:"nombre_comercial",label:"Nombre comercial",minWidth:170,widthPx:160},{id:"costo_producto",label:"Costo producto",minWidth:60,widthPx:100},{id:"costo_total_produc",label:"Costo total productos",minWidth:60,widthPx:100}],t=N.data.obtenerAlmacenes;t.forEach((function(t){e.push({id:t._id,label:t.nombre_almacen,minWidth:60,widthPx:160})})),e.push({id:"total",label:"Total existencias",minWidth:60,widthPx:160}),_(t),k(e)}}),[N.data]),Object(H.jsxs)(qe.a,{fullScreen:!0,open:e.open,onClose:e.handleClose,TransitionComponent:nh,children:[Object(H.jsx)(Re.a,{className:a.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:a.title,children:"Inventario por almac\xe9n"}),Object(H.jsx)(O.a,{mx:3,children:Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){i(!0),e.handleClose()},size:"large",children:Object(H.jsx)(Gt.a,{style:{fontSize:30}})})})}),Object(H.jsx)(ce.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"})]})}),Object(H.jsxs)(O.a,{mt:2,children:[Object(H.jsx)(O.a,{ml:4,children:Object(H.jsx)(L.a,{className:a.subtitle,children:Object(H.jsx)("b",{children:"Buscar producto"})})}),Object(H.jsxs)(O.a,{ml:4,display:"flex",children:[Object(H.jsx)(O.a,{style:{width:"35%"},children:Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsx)(ae.a,{id:"search-producto",type:"text",value:l,onChange:function(e){return d(e.target.value)},endAdornment:Object(H.jsx)(ne.a,{position:"start",children:Object(H.jsx)(ce.a,{type:"submit","aria-label":"search producto",edge:"end",children:Object(H.jsx)(Nc.a,{})})})})})}),(null===(t=e.productos.docs)||void 0===t?void 0:t.length)>0?Object(H.jsx)(O.a,{ml:4,mrstyle:{backgroundColor:"red",alignContent:"flex-end"},justifyContent:"flex-end",alignItems:"center",children:Object(H.jsx)(O.a,{children:Object(H.jsx)(op,{fileName:"Inventarios almacen",data:b,columnName:S})})}):Object(H.jsx)("div",{})]})]}),r&&0===e.productos.length?Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})}):e.productosAlmacenQuery.error||w.error?Object(H.jsx)(bt,{error:e.productosAlmacenQuery.error}):e.open?Object(H.jsx)(O.a,{mx:5,mt:1,children:Object(H.jsx)(eh,{productos:e.productos,obtenerAlmacenes:h,columns:S,page:e.page,setPage:e.setPage,limit:e.limit,loading:e.productosAlmacenQuery.loading})}):Object(H.jsx)(I.a,{})]})};function ih(){var e=Object(j.useState)([]),t=Object(y.a)(e,2),a=t[0],n=t[1],c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(j.useState)(0),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useState)(0),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(rt.b)(ni,{variables:{input:{empresa:c.empresa._id,sucursal:c.sucursal._id,filtro:""},limit:10,offset:o},fetchPolicy:"network-only"});return Object(j.useEffect)((function(){try{p.data&&n(p.data.obtenerProductosAlmacenes)}catch(e){}}),[p.data]),Object(H.jsx)(A.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:3,justifyContent:"center",alignItems:"center",children:[!1===c.accesos.almacenes.almacen.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(jx,{})})}),!1===c.accesos.almacenes.traspasos.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(fx,{children:Object(H.jsx)(qx,{productosAlmacenQuery:p,page:o,setPage:s,limit:10,pageAlm:u,setPageAlm:b})})})}),!1===c.accesos.almacenes.inventario_almacen.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(fx,{children:Object(H.jsx)(ch,{productos:a,productosAlmacenQuery:p,setProductos:n,page:o,setPage:s,limit:10})})})})]})})}var oh=[{id:"fecha",label:"Fecha",minWidth:100},{id:"hora",label:"Hora",minWidth:100},{id:"movimiento",label:"Movimiento",minWidth:100},{id:"usuario",label:"Usuario",minWidth:100},{id:"hTurno",label:"Horario Turno",minWidth:100},{id:"concepto",label:"Concepto",minWidth:100}],sh=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"70vh"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function lh(e){var t=e.loading,a=e.historial,n=e.page,c=e.setPage,r=sh();if(t)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});return Object(H.jsx)(O.a,{children:Object(H.jsxs)(fn.a,{className:r.root,children:[Object(H.jsx)(Na.a,{className:r.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:oh.map((function(e,t){return Object(H.jsx)(Da.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(H.jsx)(za.a,{children:a.docs.map((function(e,t){return Object(H.jsx)(dh,{datos:e},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:a.totalDocs,rowsPerPage:20,page:n,onPageChange:function(e,t){c(t)}})]})})}function dh(e){var t=e.datos,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){return r(!c)},o=sh();return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",onClick:i,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:Ba(t.fecha_movimiento.completa)}),Object(H.jsx)(Da.a,{align:"center",children:t.hora_moviento.completa}),Object(H.jsx)(Da.a,{align:"center",children:t.tipo_movimiento}),Object(H.jsx)(Da.a,{align:"center",children:t.nombre_usuario_creador}),Object(H.jsx)(Da.a,{align:"center",children:t.horario_turno}),Object(H.jsx)(Da.a,{align:"center",children:t.concepto})]}),Object(H.jsx)(qe.a,{fullWidth:!0,maxWidth:"xs",open:c,onClose:i,children:Object(H.jsx)(He.a,{children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,lg:12,xs:12,children:Object(H.jsx)(O.a,{textAlign:"center",p:2,children:Object(H.jsx)(L.a,{variant:"h6",children:"Informaci\xf3n de movimiento"})})}),Object(H.jsxs)(Qe.a,{item:!0,lg:12,xs:12,children:[Object(H.jsx)(O.a,{display:"flex",textAlign:"left",p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Fecha Movimiento: "})," ",Dt()(t.fecha_movimiento.completa).format("YYYY-MM-DD")]})}),Object(H.jsx)(O.a,{display:"flex",textAlign:"left",p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Hora Movimiento: "})," ",t.hora_moviento.completa]})}),Object(H.jsx)(O.a,{display:"flex",textAlign:"left",p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Usuario: "})," ",t.nombre_usuario_creador]})}),Object(H.jsx)(O.a,{display:"flex",textAlign:"left",p:1,children:Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Horario en Turno: "})})}),Object(H.jsx)(O.a,{display:"flex",textAlign:"left",p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Tipo Movimiento: "})," ",t.tipo_movimiento]})}),Object(H.jsx)(O.a,{display:"flex",textAlign:"left",p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Concepto: "})," ",t.concepto]})}),Object(H.jsx)(O.a,{display:"flex",textAlign:"left",p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Caja: "})," ",t.numero_caja]})}),Object(H.jsx)(fn.a,{className:o.root,children:Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{align:"center",style:{minWidth:100},children:"Concepto"}),Object(H.jsx)(Da.a,{align:"center",style:{minWidth:100},children:"Monto depositado"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"Monto Total Efectivo:"})}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsxs)("b",{children:["$",Math.abs(t.montos_en_caja.monto_efectivo.monto)]})})]})})]})})})]})]})})})]})}function jh(e){var t=e.props,a=e.datos,n=e.refetch,c=u.a.useState(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=u.a.useState(0),l=Object(y.a)(s,2),d=l[0],j=l[1],b=function(){o(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){o(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:i,onClose:b,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Reportes Historial caja"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo:exportar\xe1 la pagina actual"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:d,onChange:function(e){return function(e){j(e),n(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:b,color:"inherit",children:"Cancelar"}),Object(H.jsx)(uh,{props:t,datosExcel:a,refetch:n})]})]})]})}var uh=function(e){var t=e.props,a=e.datosExcel.map((function(e){return{fecha:e.fecha_movimiento.completa,hora_movimiento:e.hora_moviento.completa,nombre:e.nombre_usuario_creador,horario_turno:e.horario_turno,tipo_movimiento:e.tipo_movimiento,concepto:e.concepto,caja:e.numero_caja,monto_efectivo:e.montos_en_caja.monto_efectivo.monto,monto_creditos:e.montos_en_caja.monto_creditos.monto,monto_tarjeta_debito:e.montos_en_caja.monto_tarjeta_debito.monto,monto_tarjeta_credito:e.montos_en_caja.monto_tarjeta_credito.monto,monto_monedero:e.montos_en_caja.monto_monedero.monto,monto_cheques:e.montos_en_caja.monto_cheques.monto,monto_transferencia:e.montos_en_caja.monto_transferencia.monto,monto_vales_despensa:e.montos_en_caja.monto_vales_despensa.monto}}));return Object(H.jsx)(ap.a,{element:Object(H.jsx)(F.a,{color:"primary",children:"Exportar"}),filename:"Reporte de Historial de Caja ".concat(t.cajaSelected.numero_caja),children:Object(H.jsxs)(cp.a,{data:a,name:"Reporte de Historial de Caja ".concat(t.cajaSelected.numero_caja),children:[Object(H.jsx)(ip.a,{label:"Usuario",value:"nombre"}),Object(H.jsx)(ip.a,{label:"Fecha Movimiento",value:"fecha"}),Object(H.jsx)(ip.a,{label:"Hora Movimiento",value:"hora_movimiento"}),Object(H.jsx)(ip.a,{label:"Horario en Turno",value:"horario_turno"}),Object(H.jsx)(ip.a,{label:"Concepto",value:"concepto"}),Object(H.jsx)(ip.a,{label:"Tipo Movimiento",value:"tipo_movimiento"}),Object(H.jsx)(ip.a,{label:"No. de Caja",value:"caja"}),Object(H.jsx)(ip.a,{label:"M. en Efectivo",value:"monto_efectivo"}),Object(H.jsx)(ip.a,{label:"M. en Creditos",value:"monto_creditos"}),Object(H.jsx)(ip.a,{label:"M. en Tarjeta Debito",value:"monto_tarjeta_debito"}),Object(H.jsx)(ip.a,{label:"M. en Tarjeta Credito",value:"monto_tarjeta_credito"}),Object(H.jsx)(ip.a,{label:"M. en monedero",value:"monto_monedero"}),Object(H.jsx)(ip.a,{label:"M. en Cheques",value:"monto_cheques"}),Object(H.jsx)(ip.a,{label:"M. en Transferencia",value:"monto_transferencia"}),Object(H.jsx)(ip.a,{label:"M. en Vale Despensa",value:"monto_vales_despensa"})]})})},bh=Object(k.a)((function(e){return{title:{marginLeft:e.spacing(2),flex:1},appBar:{position:"relative"},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}},icon:{fontSize:40,width:40},iconSave:{zIndex:10,position:"fixed",bottom:e.spacing(2),right:e.spacing(10)}}})),ph=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),mh=["TODOS","COMPRA","VENTA","DEPOSITO","RETIRO","CUENTA_RETIRO","CUENTA_DEPOSITO","ABONO_CLIENTE","ABONO_PROVEEDOR","TRANSFERENCIA"];function Oh(e){var t=bh(),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useState)([]),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(an.useDebounce)(r,500),s=Object(y.a)(o,1)[0],l=Object(j.useState)(0),d=Object(y.a)(l,2),u=d[0],b=d[1],p=[],x=Object(rt.b)(yj,{variables:{id_Caja:e.cajaSelected._id,empresa:a.empresa._id,sucursal:a.sucursal._id,input:{tipo_movimiento:r.tipo_movimiento?r.tipo_movimiento:"",fecha_incio:r.fecha_incio?r.fecha_incio:"",fecha_fin:r.fecha_fin?r.fecha_fin:"",usuario:s.usuario?s.usuario:""},limit:20,offset:u}}),h=x.data,_=x.refetch,f=x.loading;Object(j.useEffect)((function(){_()}),[_]),h&&(p=h.obtenerHistorialCaja);var v=function(e){i(Object(m.a)(Object(m.a)({},r),{},Object(g.a)({},e.target.name,e.target.value)))};return Object(H.jsxs)(qe.a,{fullScreen:!0,open:e.open,onClose:function(){e.handleClose()},TransitionComponent:ph,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsxs)(L.a,{variant:"h5",className:t.title,children:["Caja ",e.cajaSelected.numero_caja]}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){e.handleClose()},size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Movimiento"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"tipo_movimiento",onChange:v,value:r.tipo_movimiento?r.tipo_movimiento:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),mh.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e,children:e},t)}))]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Fecha inicio:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_incio",variant:"outlined",type:"date",value:r.fecha_incio?r.fecha_incio:"",onChange:v})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Fecha fin:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",value:r.fecha_fin?r.fecha_fin:"",onChange:v})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Usuario:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",value:r.usuario?r.usuario:"",onChange:v})]}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",height:"100%",children:[Object(H.jsx)(F.a,{color:"primary",size:"large",variant:"text",startIcon:Object(H.jsx)(Gt.a,{}),onClick:function(){i([])},children:"Limpiar"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(jh,{datos:p.docs,props:e,refetch:_})]})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(lh,{loading:f,historial:p,page:u,setPage:b})})]})]})}var xh=a(15),hh=a(970),_h=a(971),fh=a(274),gh=Object(xh.a)((function(e){return{badge:{color:function(e){return e.props.color},background:function(e){return e.props.color},boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Sc.a),vh=Object(k.a)((function(e){return{root:{minWidth:230,maxWidth:230,margin:5},media:{height:0,paddingTop:"56.25%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{color:fh.a[500]},textActive:{position:"relative",bottom:8}}}));function Ch(e){var t={color:e.activa?"#44b700":"red"},a=vh();return Object(H.jsx)("div",{children:Object(H.jsxs)(hh.a,{className:a.root,children:[Object(H.jsx)(_h.a,{color:"secondary",avatar:Object(H.jsx)(gh,{overlap:"circular",props:t,anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",badgeContent:"",children:Object(H.jsx)(Ke.a,{alt:"Cajero X",src:"/static/images/avatar/1.jpg"})})}),Object(H.jsx)(O.a,{m:1,mb:2,children:Object(H.jsxs)(L.a,{variant:"h4",color:"textSecondary",component:"p",children:["Caja ",e.name]})})]})})}var yh=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}})),Ah=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Sh(){var e,t=yh(),a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=u.a.useState(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=u.a.useState(!1),b=Object(y.a)(d,2),p=b[0],m=b[1],x=Object(j.useState)({message:"",status:"",open:!1}),h=Object(y.a)(x,2),_=h[0],f=h[1],g=u.a.useState({name:""}),v=Object(y.a)(g,2),C=v[0],A=v[1],S=JSON.parse(localStorage.getItem("sesionCafi")),I=[],k=Object(rt.b)(vj,{variables:{empresa:S.empresa._id,sucursal:S.sucursal._id}}),w=k.data,N=k.refetch;Object(j.useEffect)((function(){r(!0),N(),r(!1)}),[N]),w&&(I=w.obtenerCajasSucursal);var P=function(){m(!0)},E=function(){l(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:_,setAlert:f}),Object(H.jsx)(st,{loading:c,setLoading:r}),Object(H.jsx)(F.a,{fullWidth:!0,onClick:function(){l(!0)},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Tj,alt:"icono numero calzado",className:t.icon})}),"Historial de Cajas"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:s,onClose:E,TransitionComponent:Ah,children:[Object(H.jsx)(Re.a,{className:t.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:t.title,children:"Historial de Cajas"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:E,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(Qe.a,{container:!0,spacing:1,justifyContent:"center",children:null===(e=I)||void 0===e?void 0:e.map((function(e,t){return Object(H.jsx)(F.a,{onClick:function(){P(),A(e)},children:Object(H.jsx)(Ch,{name:e.numero_caja,activa:e.activa,cantidad_efectivo_actual:e.cantidad_efectivo_actual})},t)}))})]}),Object(H.jsx)(Oh,{open:p,fetchCajas:N,handleClickOpen:P,cajaSelected:C,handleClose:function(){m(!1)},obtenerCajasSucursal:I})]})}var Fh=a(502),Ih=[{id:"fecha",label:"Fecha",minWidth:100},{id:"hora",label:"Hora",minWidth:100},{id:"usuario",label:"Usuario",minWidth:100},{id:"hTurno",label:"Horario Turno",minWidth:100},{id:"concepto",label:"Concepto",minWidth:100},{id:"caja",label:"Caja",minWidth:100}],kh=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"68vh"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function wh(e){var t=e.loading,a=e.turnos,n=e.page,c=e.setPage,r=kh();if(t)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})});return Object(H.jsx)(O.a,{children:Object(H.jsxs)(fn.a,{className:r.root,children:[Object(H.jsx)(Na.a,{className:r.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:Ih.map((function(e,t){return Object(H.jsx)(Da.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(H.jsx)(za.a,{children:a.docs.map((function(e,t){return Object(H.jsx)(Nh,{turno:e},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:a.totalDocs,rowsPerPage:20,page:n,onPageChange:function(e,t){c(t)}})]})})}function Nh(e){var t=e.turno,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=kh(),o=function(){return r(!c)};return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",onClick:o,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:Ba(t.fecha_movimiento)}),Object(H.jsx)(Da.a,{align:"center",children:"ABRIR TURNO"===t.concepto?Object(H.jsx)(H.Fragment,{children:t.hora_entrada.completa}):Object(H.jsx)(H.Fragment,{children:t.hora_salida.completa})}),Object(H.jsx)(Da.a,{align:"center",children:t.usuario_en_turno.nombre}),Object(H.jsx)(Da.a,{align:"center",children:t.horario_en_turno}),Object(H.jsx)(Da.a,{align:"center",children:t.concepto}),Object(H.jsx)(Da.a,{align:"center",children:t.numero_caja})]},t._id),Object(H.jsx)(qe.a,{fullWidth:!0,maxWidth:"md",open:c,onClose:o,children:Object(H.jsx)(He.a,{children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,lg:12,xs:12,children:Object(H.jsx)(O.a,{textAlign:"center",p:2,children:Object(H.jsx)(L.a,{variant:"h6",children:"Informaci\xf3n del turno"})})}),Object(H.jsxs)(Qe.a,{item:!0,lg:6,xs:12,children:[Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Usuario"}),": ",t.usuario_en_turno.nombre]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Numero de caja"}),": ",t.numero_caja]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Moviento de turno"}),": ",t.concepto]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Horario de turno"}),": ",t.horario_en_turno]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsx)(L.a,{children:"ABRIR TURNO"===t.concepto?Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)("b",{children:"Hora de Entrada de turno: "}),t.hora_entrada.completa]}):Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)("b",{children:"Hora de Salida de turno: "}),t.hora_salida.completa]})})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Comentarios"}),": ",t.comentarios]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Fecha de movimiento"}),": ",t.fecha_movimiento]})})]}),Object(H.jsx)(Qe.a,{item:!0,lg:6,xs:12,children:Object(H.jsx)(fn.a,{className:i.root,children:Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{align:"center",style:{minWidth:100},children:"Concepto"}),Object(H.jsx)(Da.a,{align:"center",style:{minWidth:100},children:"Monto depositado"})]})}),Object(H.jsxs)(za.a,{children:[Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"Monto Total Efectivo:"})}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsxs)("b",{children:["$",t.montos_en_caja.monto_efectivo.monto]})})]}),Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:"Creditos"}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto]})]}),Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:"Tarjeta Debito"}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto]})]}),Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:"Tarjeta Credito"}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto]})]}),Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:"Monedero"}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto]})]}),Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:"Cheques"}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto]})]}),Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:"Transferencias"}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto]})]}),Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:"Vales de despensa"}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto]})]})]})]})})})})]})})})]})}function Ph(e){var t=e.datosExcel,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(0),s=Object(y.a)(o,2),l=s[0],d=s[1],j=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){i(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:r,onClose:j,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Reportes Historial caja"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo: exportar\xe1 la pagina actual"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:l,onChange:function(e){return function(e){d(e),a(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:j,color:"inherit",children:"Cancelar"}),Object(H.jsx)(Eh,{datosExcel:t,refetch:a})]})]})]})}var Eh=function(e){var t=e.datosExcel.map((function(e){return{fecha:e.fecha_movimiento,nombre:e.usuario_en_turno.nombre,numero_usuario:e.usuario_en_turno.numero_usuario,fecha_entrada:e.fecha_entrada.completa,fecha_salida:e.fecha_salida.completa,hora_entrada:e.hora_entrada.completa,hora_salida:e.hora_salida.completa,horario_en_turno:e.horario_en_turno,concepto:e.concepto,caja:e.numero_caja}}));return Object(H.jsx)(ap.a,{element:Object(H.jsx)(F.a,{color:"primary",children:"Exportar"}),filename:"Reporte de Turnos Usuarios",children:Object(H.jsxs)(cp.a,{data:t,name:"Reporte de Turnos Usuarios",children:[Object(H.jsx)(ip.a,{label:"No. Usuario",value:"numero_usuario"}),Object(H.jsx)(ip.a,{label:"Usuario",value:"nombre"}),Object(H.jsx)(ip.a,{label:"Fecha Movimiento",value:"fecha"}),Object(H.jsx)(ip.a,{label:"Fecha Entrada",value:"fecha_entrada"}),Object(H.jsx)(ip.a,{label:"Fecha Salida",value:"fecha_salida"}),Object(H.jsx)(ip.a,{label:"Hora Entrada",value:"hora_entrada"}),Object(H.jsx)(ip.a,{label:"Hora Salida",value:"hora_salida"}),Object(H.jsx)(ip.a,{label:"Horario en Turno",value:"horario_en_turno"}),Object(H.jsx)(ip.a,{label:"Concepto",value:"concepto"}),Object(H.jsx)(ip.a,{label:"No. de Caja",value:"caja"})]})})},Dh=a.p+"static/media/shift.20c89466.svg",zh=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Th=Object(Fh.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}}));function $h(){var e=Object(j.useState)(!1),t=Object(y.a)(e,2),a=t[0],n=t[1],c=function(){n(!a)},r=Th();return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:c,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Dh,alt:"icono caja",style:{width:100}})}),"Turnos de usuarios"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:a,onClose:c,TransitionComponent:zh,children:[Object(H.jsx)(Re.a,{className:r.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:r.title,children:"Reportes turnos de usuarios"}),Object(H.jsx)(O.a,{m:1,display:"flex",children:Object(H.jsx)(O.a,{p:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:c,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(Rh,{})})]})]})}var Wh,Rh=function(){var e,t,a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(j.useState)([]),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(Lc.a)(r,500),s=Object(y.a)(o,1)[0],l=Object(j.useState)(0),d=Object(y.a)(l,2),u=d[0],b=d[1],p=[],x=Object(rt.b)(vj,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id}}),h=Object(rt.b)(ue,{variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,input:{horario_en_turno:r.horario_turno?r.horario_turno:"",usuario_en_turno:s.usuario_en_turno?s.usuario_en_turno:"",numero_caja:r.numero_caja?r.numero_caja:"",fechaInicio:r.fechaInicio?r.fechaInicio:"",fechaFin:r.fechaFin?r.fechaFin:""},limit:20,offset:u},fetchPolicy:"network-only"}),_=h.loading,f=h.data,v=h.error,C=h.refetch;Object(j.useEffect)((function(){C()}),[C]);var A=function(e){i(Object(m.a)(Object(m.a)({},r),{},Object(g.a)({},e.target.name,e.target.value.toString())))};if(f&&!1===x.loading&&(p=f.obtenerFiltroTurnos),v)return Object(H.jsx)(bt,{error:v});return Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Fecha inicio:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fechaInicio",variant:"outlined",type:"date",onChange:A,value:r.fechaInicio?r.fechaInicio:""})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Fecha fin:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fechaFin",variant:"outlined",type:"date",onChange:A,value:r.fechaFin?r.fechaFin:""})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Usuario:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario_en_turno",value:r.usuario_en_turno?r.usuario_en_turno:"",variant:"outlined",onChange:A})]}),Object(H.jsxs)(Qe.a,{item:!0,md:1,xs:12,children:[Object(H.jsx)(L.a,{children:"Caja:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"numero_caja",onChange:A,value:r.numero_caja?r.numero_caja:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),null===(e=x.data)||void 0===e||null===(t=e.obtenerCajasSucursal)||void 0===t?void 0:t.map((function(e,t){return Object(H.jsxs)(Pt.a,{value:e.numero_caja,children:["Caja ",e.numero_caja]},t)}))]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:1,xs:12,children:[Object(H.jsx)(L.a,{children:"Turno:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"horario_turno",value:r.horario_turno?r.horario_turno:"",onChange:A,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Object(H.jsx)(Pt.a,{value:"VESPERTINO",children:"Vespertino"}),Object(H.jsx)(Pt.a,{value:"MATUTINO",children:"Matutino"})]})})]}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",height:"100%",children:[Object(H.jsx)(F.a,{color:"primary",size:"large",variant:"text",onClick:function(){i([])},startIcon:Object(H.jsx)(Gt.a,{}),children:"Limpiar"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(Ph,{datosExcel:p.docs,refetch:C})]})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(wh,{loading:_,turnos:p,page:u,setPage:b})})]})},Vh=[{label:"Nombre producto",minWidth:300},{label:"Fecha de Compra",minWidth:160},{label:"Almacen",minWidth:100},{label:"Proveedor",minWidth:150},{label:"M. pago",minWidth:100},{label:"F. pago",minWidth:130},{label:"Cantidad",minWidth:90},{label:"Fecha l\xedmite cr\xe9dito",minWidth:170},{label:"Saldo pendiente",minWidth:150},{label:"Descuento",minWidth:120},{label:"Subtotal",minWidth:120},{label:"Impuestos",minWidth:120},{label:"Total",minWidth:120}],Mh=Object(k.a)((function(e){return{container:{height:"60vh"}}}));function Lh(e){var t=e.data,a=e.page,n=e.setPage,c=e.refetch,r=e.filtro,i=e.limit,o=Mh(),s=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)(O.a,{my:2,children:Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(Na.a,{className:o.container,children:Object(H.jsxs)($a.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:Vh.map((function(e,t){return Object(H.jsx)(Da.a,{style:{minWidth:e.minWidth},children:e.label},t)}))})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){var a=Wt.filter((function(t){return t.Value===e.forma_pago}))[0];return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:e.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{children:Ba(e.fecha_registro)}),Object(H.jsx)(Da.a,{children:e.almacen.nombre_almacen}),Object(H.jsx)(Da.a,{children:e.proveedor.nombre_cliente}),Object(H.jsx)(Da.a,{children:e.compra_credito?"Cr\xe9dito":"Contado"}),Object(H.jsx)(Da.a,{children:"".concat(a.Value,"-").concat(a.Name)}),Object(H.jsx)(Da.a,{children:"".concat(e.cantidad_total," - ").concat(e.unidad)}),Object(H.jsx)(Da.a,{children:Ba(e.compra.fecha_vencimiento_credito)}),Object(H.jsx)(Da.a,{children:Ua(e.compra.saldo_credito_pendiente)}),Object(H.jsx)(Da.a,{children:"%".concat(e.descuento_porcentaje," - $").concat(e.descuento_precio?Ua(e.descuento_precio):0)}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.subtotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.total)]})]},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:i,page:a,onPageChange:function(e,t){n(t),c({empresa:s.empresa._id,sucursal:s.sucursal._id,filtros:r,offset:t})}})]})})}var Bh=Object(P.d)(Wh||(Wh=Object(N.a)(["\n  query obtenerProductoMovimientos(\n    $empresa: ID!\n    $sucursal: ID\n    $input: ObteneReportesCompras\n    $limit: Int\n    $offset: Int\n  ) {\n    obtenerProductoMovimientos(\n      empresa: $empresa\n      sucursal: $sucursal\n      input: $input\n      limit: $limit\n      offset: $offset\n    ) {\n      docs {\n        _id\n        id_compra\n        id_traspaso\n        id_producto\n        id_proveedor\n        id_almacen\n        almacen {\n          id_almacen\n          nombre_almacen\n        }\n        proveedor {\n          _id\n          clave_cliente\n          numero_cliente\n          nombre_cliente\n        }\n        producto {\n          almacen_inicial {\n            almacen\n            cantidad\n            fecha_de_expiracion\n            id_almacen\n          }\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n          precios {\n            ieps\n            ieps_activo\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            granel\n            litros\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n              codigo_unidad\n            }\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              unidad\n              codigo_unidad\n            }\n          }\n          unidades_de_venta {\n            cantidad\n            codigo_barras\n            id_producto\n            precio\n            unidad\n            unidad_principal\n            _id\n            precio_unidad {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n          }\n        }\n        concepto\n        cantidad\n        cantidad_regalo\n        unidad_regalo\n        cantidad_total\n        iva_total\n        ieps_total\n        costo\n        descuento_porcentaje\n        descuento_precio\n        compra_credito\n        forma_pago\n        impuestos\n        mantener_precio\n        subtotal\n        total\n        medida {\n          id_medida\n          medida\n          tipo\n        }\n        color {\n          id_color\n          color\n          hex\n        }\n        unidad\n        id_unidad_venta\n        empresa\n        sucursal\n        usuario\n        year_registro\n        numero_semana_year\n        numero_mes_year\n        fecha_registro\n        compra {\n        _id\n        folio\n        usuario {\n          _id\n          numero_usuario\n          nombre\n        }\n        proveedor {\n          id_proveedor {\n            _id\n          }\n          nombre_cliente\n          numero_cliente\n          clave_cliente\n        }\n        en_espera\n        almacen {\n          id_almacen {\n            _id\n            nombre_almacen\n            default_almacen\n          }\n          nombre_almacen\n          default_almacen\n        }\n        compra_credito\n        fecha_vencimiento_credito\n        credito_pagado\n        saldo_credito_pendiente\n        forma_pago\n        descuento_aplicado\n        descuento {\n          porcentaje\n          cantidad_descontada\n          precio_con_descuento\n        }\n        subtotal\n        impuestos\n        total\n        fecha_registro\n        estatus_credito\n        status\n      }\n      }\n      totalDocs\n    }\n  }\n"]))),Uh=Hs.a.ExcelFile,qh=Hs.a.ExcelFile.ExcelSheet,Jh=Hs.a.ExcelFile.ExcelColumn;function Hh(e){var t=e.data,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(0),s=Object(y.a)(o,2),l=s[0],d=s[1],j=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){i(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:r,onClose:j,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Reportes de compras"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo: exportar\xe1 todos los registros filtrados"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:l,onChange:function(e){return function(e){d(e),a(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:j,color:"inherit",children:"Cancelar"}),Object(H.jsx)(Gh,{datosExcel:t.docs})]})]})]})}var Gh=function(e){var t=e.datosExcel.map((function(e){var t=e.producto,a=e.fecha_registro,n=e.almacen,c=e.proveedor,r=e.color,i=e.medida,o=e.cantidad,s=e.unidad,l=e.unidad_regalo,d=e.cantidad_regalo,j=e.cantidad_total,u=e.compra_credito,b=e.costo,p=e.descuento_porcentaje,m=e.descuento_precio,O=(e.iva_precio,e.ieps_precio),x=e.subtotal,h=e.impuestos,_=e.total,f=Wt.filter((function(t){return t.Value===e.forma_pago}))[0];return{producto:t.datos_generales.nombre_comercial,fecha_registro:Ba(a),almacen:n.nombre_almacen,proveedor:c.nombre_cliente,color:r?r.color:"N/A",medida:i?"".concat(i.medida,"/").concat(i.tipo):"N/A",cantidad:o,unidad:s,unidad_regalo:l,cantidad_regalo:d,cantidad_total:j,compra_credito:!0===u?"Credito":"Contado",forma_pago:"".concat(f.Value," - ").concat(f.Name),costo:"$".concat(b?Ua(b):0),descuento_porcentaje:"%".concat(p),descuento_precio:"$".concat(m?Ua(m):0),iva_precio:"$".concat(O?Ua(O):0),subtotal:"$".concat(x?Ua(x):0),impuestos:"$".concat(h?Ua(h):0),total:"$".concat(_?Ua(_):0)}}));return Object(H.jsx)(Uh,{element:Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(ll.a,{}),children:"Exportar a Excel"}),filename:"Reporte de compras",children:Object(H.jsxs)(qh,{data:t,name:"Reporte de compras",children:[Object(H.jsx)(Jh,{label:"Producto",value:"producto"}),Object(H.jsx)(Jh,{label:"Fecha de compra",value:"fecha_registro"}),Object(H.jsx)(Jh,{label:"Almacen",value:"almacen"}),Object(H.jsx)(Jh,{label:"Proveedor",value:"proveedor"}),Object(H.jsx)(Jh,{label:"Color",value:"color"}),Object(H.jsx)(Jh,{label:"Medida",value:"medida"}),Object(H.jsx)(Jh,{label:"Cantidad",value:"cantidad"}),Object(H.jsx)(Jh,{label:"Unidad",value:"unidad"}),Object(H.jsx)(Jh,{label:"Unidad de Regalo",value:"unidad_regalo"}),Object(H.jsx)(Jh,{label:"Cantidad de Regalo",value:"cantidad_regalo"}),Object(H.jsx)(Jh,{label:"Cantidad Total",value:"cantidad_total"}),Object(H.jsx)(Jh,{label:"Metodo de Pago",value:"compra_credito"}),Object(H.jsx)(Jh,{label:"Forma de pago",value:"forma_pago"}),Object(H.jsx)(Jh,{label:"Costo",value:"costo"}),Object(H.jsx)(Jh,{label:"Descuento en Porcentaje",value:"descuento_porcentaje"}),Object(H.jsx)(Jh,{label:"Descuento en Cantidad",value:"descuento_precio"}),Object(H.jsx)(Jh,{label:"IVA",value:"iva_precio"}),Object(H.jsx)(Jh,{label:"IEPS",value:"ieps_precio"}),Object(H.jsx)(Jh,{label:"Subtotal",value:"subtotal"}),Object(H.jsx)(Jh,{label:"Impuestos",value:"impuestos"}),Object(H.jsx)(Jh,{label:"Total",value:"total"})]})})};function Yh(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(j.useState)(0),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)({fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:"",vencidas:!1,vigentes:!1,liquidadas:!1}),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(rt.b)(Bh,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,input:{fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:"",vencidas:!1,vigentes:!1,liquidadas:!1},limit:20,offset:0},fetchPolicy:"network-only"}),d=l.loading,u=l.data,b=l.error,p=l.refetch;if(d)return Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h6",children:"Cargando..."})]});if(b)return Object(H.jsx)(bt,{error:b});var m=u.obtenerProductoMovimientos;return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(He.a,{children:[Object(H.jsx)(Qh,{refetch:p,data:m,filtro:o,setFiltro:s}),Object(H.jsx)(Lh,{data:m,page:n,setPage:c,filtro:o,refetch:p,limit:20})]})})}var Qh=function(e){var t=e.refetch,a=e.data,n=e.filtro,c=e.setFiltro,r=JSON.parse(localStorage.getItem("sesionCafi")),i=Object(an.useDebounce)(n,800),o=Object(y.a)(i,1)[0],s=function(e){var t=e.target,a=t.name,r=t.value;c(Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a,r)))},l=function(e){var t,a=e.target,r=a.name,i=a.checked;if("vencidas"===r)c(Object(m.a)(Object(m.a)({},n),{},(t={},Object(g.a)(t,r,i),Object(g.a)(t,"vigentes",!1),Object(g.a)(t,"liquidadas",!1),t)));else if("liquidadas"===r){var o;c(Object(m.a)(Object(m.a)({},n),{},(o={},Object(g.a)(o,r,i),Object(g.a)(o,"vencidas",!1),Object(g.a)(o,"vigentes",!1),o)))}else{var s;c(Object(m.a)(Object(m.a)({},n),{},(s={},Object(g.a)(s,r,i),Object(g.a)(s,"vencidas",!1),Object(g.a)(s,"liquidadas",!1),s)))}};Object(j.useEffect)((function(){d(o)}),[o]);var d=function(e){t({empresa:r.empresa._id,sucursal:r.sucursal._id,input:e})};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Fecha compra inicio:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:s,value:n.fecha_inicio})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Fecha compra fin:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:s,value:n.fecha_fin})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Proveedor:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"proveedor",variant:"outlined",placeholder:"Nombre, Clave o numero",onChange:s,value:n.proveedor})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"M\xe9todo de pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"metodo_pago",onChange:s,value:n.metodo_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier metodo"})}),Object(H.jsx)(Pt.a,{value:"CREDITO",children:"Cr\xe9dito"}),Object(H.jsx)(Pt.a,{value:"CONTADO",children:"Contado"})]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Forma de Pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"forma_pago",onChange:s,value:n.forma_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier forma"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Producto:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:s,value:n.producto})]}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:n.vencidas,onChange:l,name:"vencidas",color:"default"}),label:"Vencidas"})}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:n.vigentes,onChange:l,name:"vigentes",color:"default"}),label:"Vigentes"})}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:n.liquidadas,onChange:l,name:"liquidadas",color:"default"}),label:"Pagadas"})}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(qO.a,{}),onClick:function(){c({fecha_inicio:"",fecha_fin:"",proveedor:"",metodo_pago:"",forma_pago:"",producto:"",vencidas:!1,vigentes:!1,liquidadas:!1})},children:"Limpiar filtros"})}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(Hh,{data:a,refetch:t})})]})})},Kh=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Xh=Object(Fh.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function Zh(){var e=Xh(),t=Object(j.useState)(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(H.jsxs)(O.a,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:r,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.m,{fontSize:100})}),"Reportes Compras"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:Kh,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Reportes Compras"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(Yh,{})]})]})}var e_=[{label:"Folio venta",minWidth:100},{label:"Cliente",minWidth:180},{label:"Clave cliente",minWidth:100},{label:"Usuario en caja",minWidth:180},{label:"Caja",minWidth:50},{label:"Art\xedculo",minWidth:200},{label:"Medida",minWidth:100},{label:"Color",minWidth:100},{label:"Fecha venta",minWidth:120},{label:"M. pago",minWidth:90,padding:"checkbox"},{label:"F. pago",minWidth:100,padding:"checkbox"},{label:"Cantidad",minWidth:90,padding:"checkbox"},{label:"Unidad",minWidth:90,padding:"checkbox"},{label:"Desc.",minWidth:100,padding:"checkbox"},{label:"Subtotal",minWidth:90},{label:"Impuestos",minWidth:90},{label:"Total",minWidth:100},{label:"Regres\xf3"},{label:"Cant. venta",minWidth:120},{label:"Total"}],t_=Object(k.a)((function(e){return{container:{height:"55vh"},normal_color:{borderLeft:"6px solid #FFF"},notas_credito:{borderLeft:" 6px solid #FFEAAD"},cancelada:{borderLeft:" 6px solid #FF8A8A"}}}));function a_(e){var t=e.data,a=e.page,n=(e.filtro,e.refetch,e.setPage),c=e.limit,r=t_();return Object(H.jsx)(O.a,{my:2,children:Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(Na.a,{className:r.container,children:Object(H.jsxs)($a.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:e_.map((function(e,t){return Object(H.jsx)(Da.a,{style:{minWidth:e.minWidth},padding:e.checkbox,children:e.label},t)}))})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){var a="-";e.forma_pago&&(a=Wt.filter((function(t){return t.Value===e.forma_pago}))[0]);return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{className:e.nota_credito?r.notas_credito:"CANCELADO"===e.venta.status?r.cancelada:r.normal_color,children:e.venta.folio}),Object(H.jsx)(Da.a,{children:null!==e.venta.cliente?e.venta.cliente.nombre_cliente:"P\xfablico General"}),Object(H.jsx)(Da.a,{children:null!==e.venta.cliente?e.venta.cliente.clave_cliente:"-"}),Object(H.jsx)(Da.a,{children:e.venta.usuario.nombre}),Object(H.jsx)(Da.a,{children:e.venta.id_caja.numero_caja}),Object(H.jsx)(Da.a,{children:e.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{children:null!==e.medida.medida?e.medida.medida:"-"}),Object(H.jsx)(Da.a,{children:null!==e.color.color?e.color.color:"-"}),Object(H.jsx)(Da.a,{children:Dt()(e.fecha_registro).format("DD/MM/YYYY")}),Object(H.jsx)(Da.a,{children:e.venta_credito?"Cr\xe9dito":"Contado"}),Object(H.jsx)(Da.a,{children:"".concat(a.Name)}),Object(H.jsx)(Da.a,{children:e.cantidad_venta}),Object(H.jsx)(Da.a,{children:e.unidad}),Object(H.jsx)(Da.a,{children:"$".concat(e.descuento_precio?Ua(e.descuento_precio):0)}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.subtotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.total)]}),Object(H.jsxs)(Da.a,{style:{backgroundColor:"#FFFAEC"},align:"center",children:[" ",e.nota_credito?e.nota_credito.cantidad_devuelta:""]}),Object(H.jsx)(Da.a,{style:{backgroundColor:"#FFFAEC"},align:"center",children:e.nota_credito?e.nota_credito.cantidad_vendida:""}),Object(H.jsx)(Da.a,{style:{backgroundColor:"#FFFAEC"},children:e.nota_credito?"$".concat(Ua(e.nota_credito.total)):""})]},t)}))})]})}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",mr:3,children:Object(H.jsxs)(L.a,{variant:"h6",children:["Total: $ ",Ua(t.totalVenta)]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:c,page:a,onPageChange:function(e,t){n(t)}})]})})}var n_=Hs.a.ExcelFile,c_=Hs.a.ExcelFile.ExcelSheet,r_=Hs.a.ExcelFile.ExcelColumn;function i_(e){var t=e.data,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(0),s=Object(y.a)(o,2),l=s[0],d=s[1],j=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){i(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:r,onClose:j,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Reportes de ventas"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo: exportar\xe1 todos los registros filtrados"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:l,onChange:function(e){return function(e){d(e),a(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:j,color:"inherit",children:"Cancelar"}),Object(H.jsx)(o_,{datosExcel:t.docs})]})]})]})}var o_=function(e){var t=e.datosExcel.map((function(e){var t=e.producto,a=e.fecha_registro,n=e.color,c=e.medida,r=e.cantidad_venta,i=e.unidad,o=e.venta_credito,s=e.descuento_porcentaje,l=e.descuento_precio,d=e.iva_total,j=e.ieps_total,u=e.subtotal,b=e.impuestos,p=e.total,m=e.nota_credito,O=e.factura,x=e.venta,h="";e.forma_pago&&(h=Wt.filter((function(t){return t.Value===e.forma_pago}))[0]);return{folio_venta:x.folio,cliente_venta:null!==x.cliente?x.cliente.nombre_cliente:"Publico general",clave_cliente:null!==x.cliente?x.cliente.clave_cliente:"-",usuario:x.usuario.nombre,caja:x.id_caja.numero_caja,tipo_emision:x.tipo_emision,producto:t.datos_generales.nombre_comercial,codigo_barras:t.datos_generales.codigo_barras,clave_alterna:t.datos_generales.clave_alterna,fecha_registro:Ba(a),color:n.color?n.color:"N/A",medida:c.medida?"".concat(c.medida,"/").concat(c.tipo):"N/A",cantidad_venta:r,unidad:i,venta_credito:!0===o?"Credito":"Contado",forma_pago:"".concat(h.Value," - ").concat(h.Name),nota_credito:m?"SI":"NO",facturada:O&&O.length>0?"SI":"NO",descuento_porcentaje:"%".concat(s||0),descuento_precio:"$".concat(l?Ua(l):0),iva_total:"$".concat(d?Ua(d):0),ieps_total:"$".concat(j?Ua(j):0),subtotal:"$".concat(u?Ua(u):0),impuestos:"$".concat(b?Ua(b):0),total:"$".concat(p?Ua(p):0),cantidad_regresada:m?m.cantidad_devuelta:"",cantidad_vendida:m?m.cantidad_vendida:"",total_nota:m?Ua(m.total):""}}));return Object(H.jsx)(n_,{element:Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(ll.a,{}),children:"Exportar a Excel"}),filename:"Reporte de compras",children:Object(H.jsxs)(c_,{data:t,name:"Reporte de compras",children:[Object(H.jsx)(r_,{label:"Folio de venta",value:"folio_venta"}),Object(H.jsx)(r_,{label:"Cliente venta",value:"cliente_venta"}),Object(H.jsx)(r_,{label:"Clave cliente",value:"clave_cliente"}),Object(H.jsx)(r_,{label:"Usuario en caja",value:"usuario"}),Object(H.jsx)(r_,{label:"Caja",value:"caja"}),Object(H.jsx)(r_,{label:"Tipo de emision",value:"tipo_emision"}),Object(H.jsx)(r_,{label:"Producto",value:"producto"}),Object(H.jsx)(r_,{label:"C\xf3digo_barras",value:"codigo_barras"}),Object(H.jsx)(r_,{label:"Clave alterna",value:"clave_alterna"}),Object(H.jsx)(r_,{label:"Fecha de compra",value:"fecha_registro"}),Object(H.jsx)(r_,{label:"Color",value:"color"}),Object(H.jsx)(r_,{label:"Medida",value:"medida"}),Object(H.jsx)(r_,{label:"Cantidad",value:"cantidad_venta"}),Object(H.jsx)(r_,{label:"Unidad",value:"unidad"}),Object(H.jsx)(r_,{label:"Metodo de Pago",value:"venta_credito"}),Object(H.jsx)(r_,{label:"Forma de pago",value:"forma_pago"}),Object(H.jsx)(r_,{label:"Facturada",value:"facturada"}),Object(H.jsx)(r_,{label:"Nota de cr\xe9dito",value:"nota_credito"}),Object(H.jsx)(r_,{label:"Descuento en Porcentaje",value:"descuento_porcentaje"}),Object(H.jsx)(r_,{label:"Descuento en Cantidad",value:"descuento_precio"}),Object(H.jsx)(r_,{label:"IVA",value:"iva_total"}),Object(H.jsx)(r_,{label:"IEPS",value:"ieps_total"}),Object(H.jsx)(r_,{label:"Subtotal",value:"subtotal"}),Object(H.jsx)(r_,{label:"Impuestos",value:"impuestos"}),Object(H.jsx)(r_,{label:"Total",value:"total"}),Object(H.jsx)(r_,{label:"Cantidad regresada(NOTA C.)",value:"cantidad_regresada"}),Object(H.jsx)(r_,{label:"Cantidad vendida(NOTA C.)",value:"cantidad_vendida"}),Object(H.jsx)(r_,{label:"Total(NOTA C.)",value:"total_nota"})]})})};function s_(e){var t=e.setFiltro,a=e.filtro,n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(rt.b)(vj,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),r=c.data,i=c.error,o=c.loading;c.refetch;if(o)return Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsx)(Nt.a,{children:Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cargando..."})})})});if(i)return console.log(i.networkError.result),Object(H.jsx)(bt,{error:i});var s=r.obtenerCajasSucursal;return Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{children:"Caja:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"caja",onChange:function(e){var n=e.target,c=n.name,r=n.value;t(Object(m.a)(Object(m.a)({},a),{},Object(g.a)({},c,r.toString())))},value:a.caja,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona una"})}),s.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.numero_caja,children:e.numero_caja},t)}))]})})]})}var l_=Object(xh.a)((function(e){return{root:{color:"#FF8A8A","& > .MuiIconButton-label":{backgroundColor:"#FFF4F4"},"&$checked":{color:"#FF8A8A"}},checked:{}}}))(Ze.a),d_=Object(xh.a)((function(e){return{root:{color:"#FCCF53","& > .MuiIconButton-label":{backgroundColor:"#FFFAEC"},"&$checked":{color:"#FCCF53"}},checked:{}}}))(Ze.a),j_=(Object(xh.a)((function(e){return{root:{color:"#FFA367","& > .MuiIconButton-label":{backgroundColor:"#FFEBDE"},"&$checked":{color:"#FFA367"}},checked:{}}}))(Ze.a),{fecha_inicio:"",fecha_fin:"",metodo_pago:"",forma_pago:"",producto:"",cliente:"",usuario:"",folio:"",caja:"",canceladas:!1,facturadas:!1,notas_credito:!1,vencidas:!1,vigentes:!1,liquidadas:!1});function u_(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(j.useState)(0),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(j_),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(rt.b)(gm,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtros:j_,limit:20,offset:n},fetchPolicy:"network-only"}),d=l.loading,u=l.data,b=l.error,p=l.refetch;if(d)return Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h6",children:"Cargando..."})]});if(b)return console.log(b),Object(H.jsx)(bt,{error:b});var m=u.obtenerVentasReportes;return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(He.a,{children:[Object(H.jsx)(b_,{refetch:p,data:m,filtro:o,setFiltro:s}),Object(H.jsx)(a_,{data:m,page:n,setPage:c,filtro:o,refetch:p,limit:20})]})})}var b_=function(e){var t=e.refetch,a=e.data,n=e.filtro,c=e.setFiltro,r=JSON.parse(localStorage.getItem("sesionCafi")),i=Object(an.useDebounce)(n,500),o=Object(y.a)(i,1)[0],s=function(e){var t=e.target,a=t.name,r=t.value;c(Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a,r)))},l=function(e){var t=e.target,a=t.name,r=t.checked;c(Object(m.a)(Object(m.a)({},n),{},Object(g.a)({},a,r)))},d=function(e){var t,a=e.target,r=a.name,i=a.checked;if("vencidas"===r)c(Object(m.a)(Object(m.a)({},n),{},(t={},Object(g.a)(t,r,i),Object(g.a)(t,"vigentes",!1),Object(g.a)(t,"liquidadas",!1),t)));else if("liquidadas"===r){var o;c(Object(m.a)(Object(m.a)({},n),{},(o={},Object(g.a)(o,r,i),Object(g.a)(o,"vencidas",!1),Object(g.a)(o,"vigentes",!1),o)))}else{var s;c(Object(m.a)(Object(m.a)({},n),{},(s={},Object(g.a)(s,r,i),Object(g.a)(s,"vencidas",!1),Object(g.a)(s,"liquidadas",!1),s)))}};Object(j.useEffect)((function(){u(o)}),[o]);var u=function(e){t({empresa:r.empresa._id,sucursal:r.sucursal._id,filtros:e})};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Fecha venta inicio:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:s,value:n.fecha_inicio}),Object(H.jsx)(L.a,{children:"Fecha venta fin:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:s,value:n.fecha_fin})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"M\xe9todo de pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"metodo_pago",onChange:s,value:n.metodo_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier metodo"})}),Object(H.jsx)(Pt.a,{value:"CREDITO",children:"Cr\xe9dito"}),Object(H.jsx)(Pt.a,{value:"CONTADO",children:"Contado"})]})}),Object(H.jsx)(L.a,{children:"Forma de Pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"forma_pago",onChange:s,value:n.forma_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier forma"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Cliente venta:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"cliente",variant:"outlined",placeholder:"Nombre, clave...",onChange:s,value:n.cliente}),Object(H.jsx)(L.a,{children:"Usuario:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",placeholder:"Nombre, numero de usuario...",onChange:s,value:n.usuario})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Folio venta:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"folio",variant:"outlined",placeholder:"Nombre, clave...",onChange:s,value:n.folio}),Object(H.jsx)(s_,{setFiltro:c,filtro:n})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,children:[Object(H.jsx)(L.a,{children:"Producto:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:s,value:n.producto}),Object(H.jsxs)(O.a,{display:"flex",flexWrap:"wrap",alignItems:"flex-end",height:"62px",children:[Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:n.vencidas,onChange:d,name:"vencidas",color:"default"}),label:"Vencidas"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:n.vigentes,onChange:d,name:"vigentes",color:"default"}),label:"Vigentes"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:n.liquidadas,onChange:d,name:"liquidadas",color:"default"}),label:"Pagadas"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(l_,{checked:n.canceladas,onChange:l,name:"canceladas"}),label:"Canceladas"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(d_,{checked:n.notas_credito,onChange:l,name:"notas_credito"}),label:"Notas cr\xe9dito"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:n.facturadas,onChange:l,name:"facturadas"}),label:"Facturadas"})]})]})]}),Object(H.jsx)(O.a,{mt:1,display:"flex",alignItems:"center",justifyContent:"space-between",children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",position:"absolute",top:70,right:10,children:[Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(qO.a,{}),onClick:function(){c(j_)},children:"Limpiar filtros"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(i_,{refetch:t,data:a}),Object(H.jsx)(O.a,{mx:1})]})})]})},p_=[{label:"Folio",minWidth:100},{label:"Fecha",minWidth:90},{label:"Cliente",minWidth:180},{label:"Clave Cliente",minWidth:120},{label:"Usuario venta",minWidth:180},{label:"Caja",minWidth:50,padding:"checkbox"},{label:"T. emisi\xf3n",minWidth:110},{label:"F. pago",minWidth:110,padding:"checkbox"},{label:"M. pago",minWidth:100,padding:"checkbox"},{label:"Pendiente",minWidth:100},{label:"F. l\xedmite cr\xe9dito",minWidth:140},{label:"Descuento",minWidth:100},{label:"Subtotal",minWidth:90},{label:"Impuestos",minWidth:90},{label:"Total",minWidth:100}],m_=Object(k.a)((function(e){return{container:{height:"55vh"},normal_color:{borderLeft:"6px solid #FFF"},notas_credito:{borderLeft:" 6px solid #FFEAAD"},cancelada:{borderLeft:" 6px solid #FF8A8A"}}}));function O_(e){var t=e.data,a=e.page,n=e.setPage,c=e.limit,r=m_();return Object(H.jsx)(O.a,{my:2,children:Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(Na.a,{className:r.container,children:Object(H.jsxs)($a.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:p_.map((function(e,t){return Object(H.jsx)(Da.a,{style:{minWidth:e.minWidth},padding:e.checkbox,children:e.label},t)}))})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){var a="-";e.forma_pago&&(a=Wt.filter((function(t){return t.Value===e.forma_pago}))[0]);return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{className:e.nota_credito.length?r.notas_credito:"CANCELADO"===e.status?r.cancelada:r.normal_color,children:e.folio}),Object(H.jsx)(Da.a,{children:Dt()(e.fecha_registro).format("DD/MM/YYYY")}),Object(H.jsx)(Da.a,{children:null!==e.cliente?e.cliente.nombre_cliente:"P\xfablico general"}),Object(H.jsx)(Da.a,{children:null!==e.cliente?e.cliente.clave_cliente:"N/A"}),Object(H.jsx)(Da.a,{children:e.usuario.nombre}),Object(H.jsx)(Da.a,{children:e.id_caja.numero_caja}),Object(H.jsx)(Da.a,{children:e.tipo_emision}),Object(H.jsx)(Da.a,{children:"".concat(a.Name)}),Object(H.jsx)(Da.a,{children:"".concat(e.credito?"Credito":"Contado")}),Object(H.jsx)(Da.a,{children:"$".concat(e.credito?Ua(e.saldo_credito_pendiente):0)}),Object(H.jsx)(Da.a,{children:e.credito?Dt()(e.fecha_de_vencimiento_credito).format("DD/MM/YYYY"):"-"}),Object(H.jsx)(Da.a,{children:"$".concat(e.descuento?Ua(e.descuento):0)}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.subTotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.total)]})]},t)}))})]})}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",mr:3,children:Object(H.jsxs)(L.a,{variant:"h6",children:["Total: $ ",Ua(t.totalVenta)]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:c,page:a,onPageChange:function(e,t){n(t)}})]})})}var x_=Hs.a.ExcelFile,h_=Hs.a.ExcelFile.ExcelSheet,__=Hs.a.ExcelFile.ExcelColumn;function f_(e){var t=e.filtros,a=JSON.parse(localStorage.getItem("sesionCafi")),n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],j=u.a.useState(!1),b=Object(y.a)(j,2),p=b[0],m=b[1],O=Object(Fo.a)(),x=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(!0),e.next=4,O.query({query:vm,variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,filtros:t,limit:0,offset:0},fetchPolicy:"network-only"});case 4:n=e.sent,i(!1),n.data&&(m(n.data.obtenerVentasByVentaReportes.docs),document.getElementById("export-excel-button").click()),n.error&&d(!0),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),i(!1),d(!0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return r?Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(I.a,{size:20,color:"inherit"}),children:"Exportar PDF"}):l?Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(wo.a,{}),children:"Exportar PDF"}):Object(H.jsx)("div",{children:p?Object(H.jsx)(g_,{datosExcel:p}):Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){x()},children:"Exportar Excel"})})}var g_=function(e){var t=e.datosExcel.map((function(e){var t=e.folio,a=e.fecha_registro,n=e.cliente,c=e.id_caja,r=e.tipo_emision,i=e.saldo_credito_pendiente,o=e.credito,s=e.fecha_de_vencimiento_credito,l=e.usuario,d=e.status,j=e.factura,u=e.nota_credito,b=e.descuento,p=e.iva,m=e.ieps,O=e.subTotal,x=e.impuestos,h=e.total,_="";if(e.forma_pago&&e.metodo_pago){var f=Wt.filter((function(t){return t.Value===e.forma_pago})),g=Rt.filter((function(t){return t.Value===e.metodo_pago}));_=f[0],g[0]}return{folio_venta:t,fecha_registro:Ba(a),nombre_cliente:null!==n?n.nombre_cliente:"Publico general",clave_cliente:null!==n?n.clave_cliente:"-",numero_cliente:null!==n?n.numero_cliente:"-",caja:c.numero_caja,usuario_caja:l.nombre,tipo_emision:r,venta_credito:o?"SI ":"NO",saldo_credito_pendiente:"$".concat(i?Ua(i):0),fecha_de_vencimiento_credito:Ba(s),forma_pago:"".concat(_.Value," - ").concat(_.Name),metodo_pago:o?"Cr\xe9dito":"Contado",nota_credito:u.length?"SI":"NO",facturada:j.length?"SI":"NO",status:d,descuento:"$".concat(b?Ua(b):0),iva:"$".concat(p?Ua(p):0),ieps:"$".concat(m?Ua(m):0),subtotal:"$".concat(O?Ua(O):0),impuestos:"$".concat(x?Ua(x):0),total:"$".concat(h?Ua(h):0)}}));return Object(H.jsx)(x_,{element:Object(H.jsx)(F.a,{id:"export-excel-button",color:"primary",startIcon:Object(H.jsx)(ll.a,{}),children:"Exportar a Excel"}),filename:"Reporte de compras",children:Object(H.jsxs)(h_,{data:t,name:"Reporte de compras",children:[Object(H.jsx)(__,{label:"Folio de venta",value:"folio_venta"}),Object(H.jsx)(__,{label:"Cliente",value:"nombre_cliente"}),Object(H.jsx)(__,{label:"N\xfamero cliente",value:"numero_cliente"}),Object(H.jsx)(__,{label:"Clave cliente",value:"clave_cliente"}),Object(H.jsx)(__,{label:"Caja",value:"caja"}),Object(H.jsx)(__,{label:"Usuario en caja",value:"usuario_caja"}),Object(H.jsx)(__,{label:"Tipo de emision",value:"tipo_emision"}),Object(H.jsx)(__,{label:"Venta a cr\xe9dito",value:"venta_credito"}),Object(H.jsx)(__,{label:"Saldo cr\xe9dito pendiente",value:"saldo_credito_pendiente"}),Object(H.jsx)(__,{label:"Fecha vencimiento cr\xe9dito",value:"fecha_de_vencimiento_credito"}),Object(H.jsx)(__,{label:"Forma pago",value:"forma_pago"}),Object(H.jsx)(__,{label:"Metodo pago",value:"metodo_pago"}),Object(H.jsx)(__,{label:"Facturada",value:"facturada"}),Object(H.jsx)(__,{label:"Nota de cr\xe9dito",value:"nota_credito"}),Object(H.jsx)(__,{label:"Descuento",value:"descuento"}),Object(H.jsx)(__,{label:"IVA",value:"iva"}),Object(H.jsx)(__,{label:"IEPS",value:"ieps"}),Object(H.jsx)(__,{label:"Subtotal",value:"subtotal"}),Object(H.jsx)(__,{label:"Impuestos",value:"impuestos"}),Object(H.jsx)(__,{label:"Total",value:"total"})]})})},v_=a(972),C_=a(973),y_=a(209),A_=a.n(y_),S_=a(210),F_=(a(821),Object(k.a)((function(e){return{textTable:{fontSize:"12px"}}})));function I_(e){var t=e.filtros,a=JSON.parse(localStorage.getItem("sesionCafi")),n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],j=u.a.useState(!1),b=Object(y.a)(j,2),p=b[0],m=b[1],x=u.a.useState(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=u.a.useState(!1),A=Object(y.a)(g,2),S=A[0],k=A[1],w=Object(Fo.a)(),N=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d(!0),e.next=4,w.query({query:vm,variables:{empresa:a.empresa._id,sucursal:a.sucursal._id,filtros:t,limit:0,offset:0},fetchPolicy:"network-only"});case 4:n=e.sent,d(!1),n.data&&(f(n.data.obtenerVentasByVentaReportes),i(!0)),n.error&&m(!0),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),d(!1),m(!0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),P=function(){i(!1)};return l?Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(I.a,{size:20,color:"inherit"}),children:"Exportar PDF"}):p?Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(wo.a,{}),children:"Exportar PDF"}):Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(IO.d,{}),onClick:function(){N()},children:"Exportar PDF"}),Object(H.jsxs)(qe.a,{open:r,onClose:P,fullWidth:!0,maxWidth:"xl",children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"flex-end",children:[Object(H.jsx)(F.a,{startIcon:S?Object(H.jsx)(I.a,{size:20,color:"inherit"}):Object(H.jsx)(IO.d,{}),color:"primary",onClick:function(){return function(){k(!0);var e=document.getElementById("filtros-reporte-ventas-container");A_()(e).then((function(e){var t=new S_.default("p","mm","letter"),a=e.toDataURL("image/png"),n=t.getImageProperties(a),c=t.internal.pageSize.getWidth()-5,r=n.height*c/n.width;t.addImage(a,"JPEG",5,0,c,r),t.autoTable({html:"#tabla-reporte-ventas",theme:"plain",margin:{left:2,right:1,top:37},styles:{fontSize:8},didDrawPage:function(e){console.log(e);var a="Pagina ".concat(e.pageNumber);t.setFontSize(10),t.text(a,195,275)}}),t.save("Reporte de ventas.pdf"),k(!1)}))}()},children:"Exportar PDF"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(F.a,{startIcon:Object(H.jsx)(Gt.a,{}),onClick:P,children:"Cerrar"})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(k_,{data:_,filtros:t})})]})]})}var k_=function(e){var t=e.data,a=e.filtros,n=F_(),c=0;return t.docs.forEach((function(e){c+=e.total})),Object(H.jsxs)(O.a,{id:"reporte-ventas-pdf-container",children:[Object(H.jsx)(w_,{filtros:a}),Object(H.jsx)(O.a,{mt:2,pb:5,children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",stickyHeader:!0,"aria-label":"a dense table",id:"tabla-reporte-ventas",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Folio"}),Object(H.jsx)(Da.a,{children:"Fecha"}),Object(H.jsx)(Da.a,{width:100,children:"Cliente"}),Object(H.jsx)(Da.a,{children:"Usuario"}),Object(H.jsx)(Da.a,{children:"Caja"}),Object(H.jsx)(Da.a,{children:"F. Pago"}),Object(H.jsx)(Da.a,{children:"M. Pago"}),Object(H.jsx)(Da.a,{children:"Cred. Pendiente"}),Object(H.jsx)(Da.a,{children:"F. lim. cred."}),Object(H.jsx)(Da.a,{children:"Desc."}),Object(H.jsx)(Da.a,{children:"SubTotal"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsxs)(za.a,{children:[t.docs.map((function(e,t){var a="-";e.forma_pago&&(a=Wt.filter((function(t){return t.Value===e.forma_pago}))[0]);return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{className:n.textTable,children:e.folio}),Object(H.jsx)(Da.a,{className:n.textTable,children:Dt()(e.fecha_registro).format("DD/MM/YYYY")}),Object(H.jsx)(Da.a,{className:n.textTable,children:null!==e.cliente?e.cliente.nombre_cliente:"P\xfablico general"}),Object(H.jsx)(Da.a,{className:n.textTable,children:e.usuario.nombre}),Object(H.jsx)(Da.a,{className:n.textTable,children:e.id_caja.numero_caja}),Object(H.jsx)(Da.a,{className:n.textTable,children:"".concat(a.Name)}),Object(H.jsx)(Da.a,{className:n.textTable,children:"".concat(e.credito?"Credito":"Contado")}),Object(H.jsx)(Da.a,{className:n.textTable,children:"$".concat(e.credito?Ua(e.saldo_credito_pendiente):0)}),Object(H.jsx)(Da.a,{className:n.textTable,children:e.credito?Dt()(e.fecha_de_vencimiento_credito).format("DD/MM/YYYY"):"-"}),Object(H.jsx)(Da.a,{className:n.textTable,children:"$".concat(e.descuento?Ua(e.descuento):0)}),Object(H.jsxs)(Da.a,{className:n.textTable,children:["$",Ua(e.subTotal)]}),Object(H.jsxs)(Da.a,{className:n.textTable,children:["$",Ua(e.total)]})]},t)})),Object(H.jsxs)(Ea.a,{children:[[1,2,3,4,5,6,7,8,9,10].map((function(e){return Object(H.jsx)(Da.a,{},e)})),Object(H.jsx)(Da.a,{children:"Total"}),Object(H.jsxs)(Da.a,{children:["$",Ua(c)]})]})]})]})})})]})},w_=function(e){var t=e.filtros,a=t.fecha_inicio,n=t.fecha_fin,c=t.usuario,r=t.cliente,i=t.caja,o=t.publico_general,s=t.metodo_pago,l=t.forma_pago,d=t.canceladas,j=t.facturadas,u=t.notas_credito,b=t.vigentes,p=t.vencidas,m=t.liquidadas,x=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(O.a,{mx:2,id:"filtros-reporte-ventas-container",children:[Object(H.jsxs)(O.a,{display:"flex",style:{height:80},alignItems:"center",mb:2,children:[Object(H.jsx)("img",{src:x.empresa.imagen?x.empresa.imagen:le,alt:"cafi punto de venta",height:"100%"}),Object(H.jsx)(O.a,{mx:2}),Object(H.jsx)(L.a,{variant:"h6",children:"Reporte de ventas"})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:4,children:[Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Fecha Inicio:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:a&&n?Ba(a):"-"})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Fecha Fin:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:n&&a?Ba(n):"-"})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Vendedor:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:c||"todos"})]})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Cliente:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:o?"P\xfablico general":r||"todos"})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Caja:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:i||"todas"})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Sucursal:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:x.sucursal.nombre_sucursal})]})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"M\xe9todo de pago:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:s?"PPD"===s?"cr\xe9dito":"Contado":"todos"})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Forma de pago:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:function(){var e="todas";l&&(e=Wt.filter((function(e){return e.Value===l}))[0].Name);return e}()})]})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsxs)(O.a,{display:"flex",children:[d?Object(H.jsx)(v_.a,{}):Object(H.jsx)(C_.a,{}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Canceladas"})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[j?Object(H.jsx)(v_.a,{}):Object(H.jsx)(C_.a,{}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Facturadas"})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[u?Object(H.jsx)(v_.a,{}):Object(H.jsx)(C_.a,{}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Notas cr\xe9dito"})})]})]}),Object(H.jsxs)(Qe.a,{item:!0,children:[Object(H.jsxs)(O.a,{display:"flex",children:[b?Object(H.jsx)(v_.a,{}):Object(H.jsx)(C_.a,{}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Vigentes"})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[p?Object(H.jsx)(v_.a,{}):Object(H.jsx)(C_.a,{}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Vencidas"})})]}),Object(H.jsxs)(O.a,{display:"flex",children:[m?Object(H.jsx)(v_.a,{}):Object(H.jsx)(C_.a,{}),Object(H.jsx)(O.a,{mx:.5}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Pagadas"})})]})]})]})]})},N_={fecha_inicio:"",fecha_fin:"",metodo_pago:"",forma_pago:"",cliente:"",usuario:"",folio:"",caja:"",tipo_emision:"",canceladas:!1,facturadas:!1,notas_credito:!1,publico_general:!1,vencidas:!1,vigentes:!1,liquidadas:!1};function P_(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=Object(j.useState)(0),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(N_),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(an.useDebounce)(o,500),d=Object(y.a)(l,1)[0],u=Object(rt.b)(vm,{variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtros:d,limit:20,offset:n},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),b=u.loading,p=u.data,m=u.error,x=u.refetch;if(b)return Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"80vh",children:[Object(H.jsx)(I.a,{}),Object(H.jsx)(L.a,{variant:"h6",children:"Cargando..."})]});if(m)return console.log(m),Object(H.jsx)(bt,{error:m});var h=p.obtenerVentasByVentaReportes;return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(He.a,{children:[Object(H.jsx)(E_,{refetch:x,data:h,filtro:o,setFiltro:s,loading:b}),Object(H.jsx)(O_,{data:h,page:n,setPage:c,filtro:o,refetch:x,limit:20})]})})}var E_=function(e){e.refetch,e.data;var t=e.filtro,a=e.setFiltro,n=(e.loading,function(e){var n=e.target,c=n.name,r=n.value;a(Object(m.a)(Object(m.a)({},t),{},Object(g.a)({},c,r)))}),c=function(e){var n,c=e.target,r=c.name,i=c.checked;"publico_general"!==r?a(Object(m.a)(Object(m.a)({},t),{},Object(g.a)({},r,i))):a(Object(m.a)(Object(m.a)({},t),{},(n={},Object(g.a)(n,r,i),Object(g.a)(n,"cliente",""),n)))},r=function(e){var n,c=e.target,r=c.name,i=c.checked;if("vencidas"===r)a(Object(m.a)(Object(m.a)({},t),{},(n={},Object(g.a)(n,r,i),Object(g.a)(n,"vigentes",!1),Object(g.a)(n,"liquidadas",!1),n)));else if("liquidadas"===r){var o;a(Object(m.a)(Object(m.a)({},t),{},(o={},Object(g.a)(o,r,i),Object(g.a)(o,"vencidas",!1),Object(g.a)(o,"vigentes",!1),o)))}else{var s;a(Object(m.a)(Object(m.a)({},t),{},(s={},Object(g.a)(s,r,i),Object(g.a)(s,"vencidas",!1),Object(g.a)(s,"liquidadas",!1),s)))}};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Desde:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",type:"date",onChange:n,value:t.fecha_inicio}),Object(H.jsx)(L.a,{children:"Hasta:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_fin",variant:"outlined",type:"date",onChange:n,value:t.fecha_fin})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"M\xe9todo de pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"metodo_pago",onChange:n,value:t.metodo_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier metodo"})}),Object(H.jsx)(Pt.a,{value:"PPD",children:"PPD(Cr\xe9dito)"}),Object(H.jsx)(Pt.a,{value:"PUE",children:"PUE(Contado)"})]})}),Object(H.jsx)(L.a,{children:"Forma de pago:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{name:"forma_pago",onChange:n,value:t.forma_pago,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Cualquier forma"})}),Wt.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.Value,children:"".concat(e.Value," - ").concat(e.Name)},t)}))]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Cliente:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"cliente",variant:"outlined",placeholder:"Nombre cliente, clave cliente...",onChange:n,value:t.cliente}),Object(H.jsx)(L.a,{children:"Usuario en caja:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",placeholder:"Nombre usuario, n\xfamero usuario...",onChange:n,value:t.usuario})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,children:[Object(H.jsx)(L.a,{children:"Folio venta:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"folio",variant:"outlined",placeholder:"folio de la venta",onChange:n,value:t.folio}),Object(H.jsx)(s_,{setFiltro:a,filtro:t})]}),Object(H.jsx)(Qe.a,{item:!0,md:4,style:{display:"flex",alignItems:"center"},children:Object(H.jsxs)(O.a,{display:"flex",flexWrap:"wrap",children:[Object(H.jsx)(Xe.a,{control:Object(H.jsx)(l_,{checked:t.canceladas,onChange:c,name:"canceladas",color:"default"}),label:"Canceladas"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(d_,{checked:t.notas_credito,onChange:c,name:"notas_credito",color:"default"}),label:"Notas cr\xe9dito"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:t.facturadas,onChange:c,name:"facturadas",color:"default"}),label:"Facturadas"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:t.vencidas,onChange:r,name:"vencidas",color:"default"}),label:"Vencidas"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:t.vigentes,onChange:r,name:"vigentes",color:"default"}),label:"Vigentes"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:t.liquidadas,onChange:c,name:"liquidadas",color:"default"}),label:"Pagadas"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:t.publico_general,onChange:c,name:"publico_general",color:"default"}),label:"P\xfablico general"})]})})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",position:"absolute",top:70,right:10,children:[Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(qO.a,{}),onClick:function(){a(N_)},children:"Limpiar filtros"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(f_,{filtros:t}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(I_,{filtros:t})]})]})},D_=["children","value","index"],z_=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function T_(e){var t=e.children,a=e.value,n=e.index,c=Object(De.a)(e,D_);return Object(H.jsx)("div",Object(m.a)(Object(m.a)({role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},c),{},{children:a===n&&Object(H.jsx)(O.a,{children:t})}))}function $_(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var W_=Object(Fh.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},root:{margin:"0px 24px"}}}));function R_(){var e=W_(),t=Object(j.useState)(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(0),i=Object(y.a)(r,2),o=i[0],s=i[1],l=function(){c(!n)};return Object(H.jsxs)(O.a,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:l,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Ii,alt:"icono ventas",style:{width:100}})}),"Reportes Ventas"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:l,TransitionComponent:z_,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Reportes Ventas"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:l,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)("div",{className:e.root,children:Object(H.jsxs)(Ve.a,{value:o,onChange:function(e,t){s(t)},"aria-label":"simple tabs example",indicatorColor:"primary",textColor:"primary",children:[Object(H.jsx)(Me.a,Object(m.a)({label:"Reporte por ventas"},$_(0))),Object(H.jsx)(Me.a,Object(m.a)({label:"Reporte por productos"},$_(1)))]})}),Object(H.jsx)(T_,{value:o,index:0,children:Object(H.jsx)(P_,{})}),Object(H.jsx)(T_,{value:o,index:1,children:Object(H.jsx)(u_,{})})]})]})}var V_=Hs.a.ExcelFile,M_=Hs.a.ExcelFile.ExcelSheet,L_=Hs.a.ExcelFile.ExcelColumn;function B_(e){var t=e.data,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(0),s=Object(y.a)(o,2),l=s[0],d=s[1],j=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",size:"large",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){i(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:r,onClose:j,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Reportes de almacen"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo: exportar\xe1 todos los registros filtrados"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:l,onChange:function(e){return function(e){d(e),a(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:j,color:"inherit",children:"Cancelar"}),Object(H.jsx)(U_,{datosExcel:t.docs})]})]})]})}var U_=function(e){var t=e.datosExcel.map((function(e){return{producto:e.producto.datos_generales.nombre_comercial,cantidad:e.cantidad,unidad:e.unidad,fecha:Ba(e.id_traspaso.fecha_registro),concepto:e.id_traspaso.concepto_traspaso.nombre_concepto,almacen_origen:null!==e.id_traspaso.almacen_origen?e.id_traspaso.almacen_origen.nombre_almacen:"",almacen_destino:null!==e.id_traspaso.almacen_destino?e.id_traspaso.almacen_destino.nombre_almacen:""}}));return Object(H.jsx)(V_,{element:Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(ll.a,{}),children:"Exportar a Excel"}),filename:"Reporte de traspasos",children:Object(H.jsxs)(M_,{data:t,name:"Reporte de traspasos",children:[Object(H.jsx)(L_,{label:"Producto",value:"producto"}),Object(H.jsx)(L_,{label:"Cantidad",value:"cantidad"}),Object(H.jsx)(L_,{label:"Unidad",value:"unidad"}),Object(H.jsx)(L_,{label:"Fecha",value:"fecha"}),Object(H.jsx)(L_,{label:"Concepto",value:"concepto"}),Object(H.jsx)(L_,{label:"Almac\xe9n Origen",value:"almacen_origen"}),Object(H.jsx)(L_,{label:"Almac\xe9n Destino",value:"almacen_destino"})]})})},q_=[{id:"producto",label:"Producto",minWidth:200},{id:"cantidad",label:"Cantidad",minWidth:50},{id:"unidad",label:"Unidad",minWidth:50},{id:"fecha",label:"Fecha ",minWidth:50},{id:"concepto",label:"Concepto ",minWidth:100},{id:"almacen_origen",label:"Almac\xe9n Origen",minWidth:100},{id:"almacen_destino",label:"Almac\xe9n Destino",minWidth:100}],J_=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"60vh"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function H_(e){var t=e.data,a=e.page,n=e.setPage,c=e.limit,r=J_();JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsxs)(fn.a,{className:r.root,children:[Object(H.jsx)(Na.a,{className:r.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:q_.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,children:[Object(H.jsx)(Da.a,{children:e.producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{children:e.cantidad}),Object(H.jsx)(Da.a,{children:e.unidad}),Object(H.jsx)(Da.a,{children:Ba(e.id_traspaso.fecha_registro)}),Object(H.jsx)(Da.a,{children:e.id_traspaso.concepto_traspaso.nombre_concepto}),Object(H.jsx)(Da.a,{children:null!==e.id_traspaso.almacen_origen?e.id_traspaso.almacen_origen.nombre_almacen:" - "}),Object(H.jsx)(Da.a,{children:null!==e.id_traspaso.almacen_destino?e.id_traspaso.almacen_destino.nombre_almacen:" - "})]},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:c,page:a,onPageChange:function(e,t){n(t)}})]})}var G_=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Y_=Object(Fh.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},CircularProgress:{width:"100%",height:200,marginTop:100,display:"flex",justifyContent:"center"}}}));function Q_(){var e=Y_(),t=Object(j.useState)(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=function(){c(!n)};return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:r,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Ai,alt:"icono almacen",style:{width:100}})}),"Reportes Almacen"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:n,onClose:r,TransitionComponent:G_,children:[Object(H.jsx)(Re.a,{className:e.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:e.title,children:"Reportes Almacen"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:r,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(K_,{})]})]})}var K_=function(){var e=Y_(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(j.useState)(null),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)(null),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],x=Object(j.useState)({empresa:t.empresa._id,sucursal:t.sucursal._id,producto:"",fecha_inicio:"",fecha_final:"",usuario:""}),h=Object(y.a)(x,2),_=h[0],f=h[1],v=Object(j.useState)(0),C=Object(y.a)(v,2),A=C[0],k=C[1],w=Object(j.useState)(""),N=Object(y.a)(w,2),P=N[0],E=N[1],D=Object(Lc.a)(_,1e3),T=Object(y.a)(D,1)[0],$=[],W={docs:[],totalDocs:0},R=[],V=Object(rt.b)(ei,{variables:{id:t.sucursal._id},fetchPolicy:"network-only"}),M=Object(rt.b)(z,{variables:{empresa:"".concat(t.empresa._id),sucursal:"".concat(t.sucursal._id),eliminado:!1},fetchPolicy:"network-only"}),B=Object(rt.b)(oi,{variables:{input:T,limit:20,offset:A},fetchPolicy:"network-only"});V.data&&($=V.data.obtenerAlmacenes);var U=function(e){var t,a=Object(m.a)(Object(m.a)({},_),{},(t={},Object(g.a)(t,e.target.name,e.target.value),Object(g.a)(t,"almacen_destino",s),Object(g.a)(t,"almacen_origen",c),t));f(a)};if(B.data)try{W=B.data.obtenerTraspasos}catch(q){}if(M.data)try{R=M.data.obtenerUsuarios}catch(q){}return Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Fecha inicio:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_inicio",variant:"outlined",value:_.fecha_inicio,type:"date",onChange:function(e){return U(e)}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Fecha fin:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_final",variant:"outlined",type:"date",onChange:function(e){return U(e)},value:_.fecha_final})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Encargado"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(ka.a,{id:"encargado",size:"small",options:R,getOptionLabel:function(e){return e.nombre?"".concat(e.nombre):""},fullWidth:!0,renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{variant:"outlined",InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsx)(j.Fragment,{children:e.InputProps.endAdornment})})}))},renderOption:function(e){return Object(H.jsx)(j.Fragment,{children:"".concat(e.nombre)})},onChange:function(e,t){return function(e){try{var t=null!==s?s._id:"",a=null!==c?c._id:"",n=""!==e?e._id:"",r=Object(m.a)(Object(m.a)({},_),{},{usuario:n,almacen_destino:t,almacen_origen:a});B.refetch({input:r}),E(e),p(!1)}catch(q){}}(t)},getOptionSelected:function(e,t){return e.nombre===t.nombre},value:P.nombre?P:null})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Producto:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"producto",variant:"outlined",placeholder:"Nombre, c\xf3digo, clave...",onChange:function(e){return U(e)},value:_.producto})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Almacen origen:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{id:"form-almacen-origen",name:"almacen_origen",onChange:function(e){return function(e){var t=null!==s?s._id:"";if(""!==e._id){p(!0);var a=Object(m.a)(Object(m.a)({},_),{},{almacen_origen:e._id,almacen_destino:t});B.refetch({input:a})}r(e),p(!1)}(e.target.value)},value:null!==c?c:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Ninguno"})}),$.map((function(e){return Object(H.jsx)(Pt.a,{value:e,children:e.nombre_almacen},e._id)}))]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:"Almacen destino:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{id:"form-almacen-destino",name:"almacen_destino",onChange:function(e){return function(e){var t=null!==c?c._id:"";if(""!==e._id){var a=Object(m.a)(Object(m.a)({},_),{},{almacen_origen:t,almacen_destino:e._id});p(!0),B.refetch({input:a})}l(e),p(!1)}(e.target.value)},value:null!==s?s:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Ninguno"})}),$.map((function(e){return Object(H.jsx)(Pt.a,{value:e,children:e.nombre_almacen},e._id)}))]})})]}),Object(H.jsxs)(O.a,{display:"flex",mb:2,children:[Object(H.jsx)(F.a,{color:"primary",startIcon:Object(H.jsx)(qO.a,{}),onClick:function(){return function(){try{var e={empresa:t.empresa._id,sucursal:t.sucursal._id,producto:"",fecha_inicio:"",fecha_final:"",usuario:""};f(e),p(!0),B.refetch({input:e}),E(""),r(null),l(null),p(!1)}catch(q){}}()},children:"Limpiar filtros"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(B_,{data:W,refetch:B.refetch})]})]}),Object(H.jsx)(O.a,{children:B.loading||b?Object(H.jsx)("div",{className:e.CircularProgress,children:Object(H.jsx)(I.a,{})}):Object(H.jsx)(H_,{data:W,page:A,setPage:k,limit:20})})]})},X_=a(267),Z_=a.n(X_),ef=a(133),tf=a(208),af={AccionWrite:"write",AccionCut:"cut",AccionCash:"cash",AccionCutPartial:"cutpartial",AccionAlign:"align",AccionFontSize:"fontsize",AccionFont:"font",AccionEmphasize:"emphasize",AccionFeed:"feed",AccionQr:"qr",AlineacionCentro:"center",AlineacionDerecha:"right",AlineacionIzquierda:"left",FuenteA:"A",FuenteB:"B",AccionBarcode128:"barcode128",AccionBarcode39:"barcode39",AccionBarcode93:"barcode93",AccionBarcodeEAN:"barcodeEAN",AccionBarcodeTwoOfFiveSinInterleaved:"barcodeTwoOfFive",AccionBarcodeTwoOfFiveInterleaved:"barcodeTwoOfFiveInterleaved",AccionBarcodeCodabar:"barcodeCodabar",AccionBarcodeUPCA:"barcodeUPCA",AccionBarcodeUPCE:"barcodeUPCE",Medida80:80,Medida100:100,Medida156:156,Medida200:200,Medida300:300,Medida350:350},nf="http://localhost:8000",cf=Object(ef.a)((function e(t,a){Object(tf.a)(this,e),this.accion=t+"",this.datos=a+""})),rf=function(){function e(t){Object(tf.a)(this,e),t||(t=nf),this.ruta=t,this.operaciones=[]}return Object(ef.a)(e,[{key:"cut",value:function(){this.operaciones.push(new cf(af.AccionCut,""))}},{key:"cash",value:function(){this.operaciones.push(new cf(af.AccionCash,""))}},{key:"cutPartial",value:function(){this.operaciones.push(new cf(af.AccionCutPartial,""))}},{key:"setFontSize",value:function(e,t){this.operaciones.push(new cf(af.AccionFontSize,"".concat(e,",").concat(t)))}},{key:"setFont",value:function(e){if(e!==af.FuenteA&&e!==af.FuenteB)throw Error("Fuente inv\xe1lida");this.operaciones.push(new cf(af.AccionFont,e))}},{key:"setEmphasize",value:function(e){if(isNaN(parseInt(e))||parseInt(e)<0)throw Error("Valor inv\xe1lido");this.operaciones.push(new cf(af.AccionEmphasize,e))}},{key:"setAlign",value:function(e){if(e!==af.AlineacionCentro&&e!==af.AlineacionDerecha&&e!==af.AlineacionIzquierda)throw Error("Alineaci\xf3n ".concat(e," inv\xe1lida"));this.operaciones.push(new cf(af.AccionAlign,e))}},{key:"write",value:function(e){this.operaciones.push(new cf(af.AccionWrite,e))}},{key:"feed",value:function(e){if(!parseInt(e)||parseInt(e)<0)throw Error("Valor para feed inv\xe1lido");this.operaciones.push(new cf(af.AccionFeed,e))}},{key:"end",value:function(){return fetch(this.ruta+"/imprimir",{method:"POST",body:JSON.stringify(this.operaciones)}).then((function(e){return e.json()}))}},{key:"imprimirEnImpresora",value:function(e){var t={operaciones:this.operaciones,impresora:e};return fetch(this.ruta+"/imprimir_en",{method:"POST",body:JSON.stringify(t)}).then((function(e){return e.json()}))}},{key:"qr",value:function(e){this.operaciones.push(new cf(af.AccionQr,e))}},{key:"validarMedida",value:function(e){if((e=parseInt(e))!==af.Medida80&&e!==af.Medida100&&e!==af.Medida156&&e!==af.Medida200&&e!==af.Medida300&&e!==af.Medida350)throw Error("Valor para medida del barcode inv\xe1lido")}},{key:"validarTipo",value:function(e){if(-1===[af.AccionBarcode128,af.AccionBarcode39,af.AccionBarcode93,af.AccionBarcodeEAN,af.AccionBarcodeTwoOfFiveInterleaved,af.AccionBarcodeTwoOfFiveSinInterleaved,af.AccionBarcodeCodabar,af.AccionBarcodeUPCA,af.AccionBarcodeUPCE].indexOf(e))throw Error("Tipo de c\xf3digo de barras no soportado")}},{key:"barcode",value:function(e,t,a){this.validarMedida(t),this.validarTipo(a);var n=e.concat(",").concat(t.toString());this.operaciones.push(new cf(a,n))}},{key:"imprimirEnImpresoraConNombreEIp",value:function(e,t){var a={operaciones:this.operaciones,impresora:e,ip:t};return fetch(this.ruta+"/imprimir_y_reenviar",{method:"POST",body:JSON.stringify(a)}).then((function(e){return e.json()}))}}],[{key:"setImpresora",value:function(e,t){return t&&(nf=t),fetch(nf+"/impresora",{method:"PUT",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(t){return t===e}))}},{key:"setImpresoraSilencioso",value:function(e,t){return t&&(nf=t),fetch(nf+"/impresora_silencioso",{method:"PUT",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(t){return t===e}))}},{key:"getImpresora",value:function(e){return e&&(nf=e),fetch(nf+"/impresora").then((function(e){return e.json()}))}},{key:"getImpresoras",value:function(e){return e&&(nf=e),fetch(nf+"/impresoras").then((function(e){return e.json()}))}},{key:"getImpresorasRemotas",value:function(e){return fetch(nf+"/impresoras_remotas?ip="+e).then((function(e){return e.json()}))}}]),e}(),of=a(148),sf=a.n(of),lf=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t,a,n,c){var r,i,o,s,l,d,j,u,b,p,m,O;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.montos_en_caja,i=r.monto_efectivo,o=r.monto_tarjeta_debito,s=r.monto_tarjeta_credito,l=r.monto_transferencia,d=r.monto_monedero,j=r.monto_creditos,u=r.monto_cheques,b=r.monto_vales_despensa,p=sf()([["Concepto","     ","Caja","   ","Sistema","Diferencia"]]),m=sf()([["EFECTIVO ","".concat(Ua(i.monto))," ".concat(Ua(a.monto_efectivo)),"".concat(Ua(i.monto-a.monto_efectivo))],["T. DEBITO","".concat(Ua(o.monto)),"".concat(Ua(a.monto_tarjeta_debito)),"".concat(Ua(o.monto-a.monto_tarjeta_debito))],["T. CREDITO","".concat(Ua(s.monto)),"".concat(Ua(a.monto_tarjeta_credito)),"".concat(Ua(s.monto-a.monto_tarjeta_credito))],["TRANSFERENCIAS","".concat(Ua(l.monto)),"".concat(Ua(a.monto_transferencia))," ".concat(Ua(l.monto-a.monto_transferencia))],["MONEDERO","".concat(Ua(d.monto)),"".concat(Ua(a.monto_monedero)),"".concat(Ua(d.monto-a.monto_monedero))],["CREDITOS","".concat(Ua(j.monto)),"".concat(Ua(a.monto_creditos)),"".concat(Ua(j.monto-a.monto_creditos))],["CHEQUES","".concat(Ua(u.monto)),"".concat(Ua(a.monto_cheques)),"".concat(Ua(u.monto-a.monto_cheques))],["VALES DESP.","".concat(Ua(b.monto)),"".concat(Ua(a.monto_vales_despensa)," "),"".concat(Ua(b.monto-a.monto_vales_despensa))]]),e.prev=3,(O=new rf("http://localhost:8000")).cut(),O.setFontSize(1,1),O.setEmphasize(0),O.setAlign("center"),O.write("Punto de venta CAFI\n"),O.write("****CORTE CAJA****\n"),O.write("Fecha y hora\n"),O.write("Del ".concat(Dt()(n).locale("es-mx").format("lll"),"\n")),O.write("Al ".concat(Dt()(c).locale("es-mx").format("lll"),"\n")),O.feed(1),O.write("Usuario: ".concat(t.usuario_en_turno.nombre,"\n")),O.write("No. usuario: ".concat(t.usuario_en_turno.numero_usuario," Caja: ").concat(t.numero_caja,"\n")),O.write("Turno: ".concat(t.horario_en_turno,"\n")),O.write("Sucursal: ".concat(t.sucursal.nombre_sucursal,"\n")),O.feed(1),O.setFontSize(2,1),O.write("Montos\n"),O.feed(1),O.setFontSize(1,1),O.setAlign("left"),O.write("".concat(p,"\n")),O.write("________________________________________________\n"),O.write("".concat(m,"\n")),O.feed(3),O.cut(),O.cutPartial(),e.next=33,O.end();case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(3),console.log(e.t0);case 38:case"end":return e.stop()}}),e,null,[[3,35]])})));return function(t,a,n,c){return e.apply(this,arguments)}}(),df=[{label:"Fecha Corte",minWidth:100},{label:"Hora Corte",minWidth:100},{label:"Usuario",minWidth:100},{label:"Turno Horario",minWidth:100},{label:"Caja",minWidth:100},{label:"Sucursal",minWidth:100}],jf=Object(k.a)((function(e){return{root:{width:"100%"},container:{height:"65vh","& ::-webkit-scrollbar":{display:"none"}},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function uf(e){var t=e.loading,a=e.cortes,n=e.page,c=e.setPage,r=e.limit,i=jf();return t?Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})}):Object(H.jsx)(O.a,{children:Object(H.jsxs)(fn.a,{className:i.root,children:[Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:df.map((function(e){return Object(H.jsx)(Da.a,{align:"center",style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:a.docs.map((function(e){return Object(H.jsx)(bf,{corte:e},e._id)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:a.totalDocs,rowsPerPage:r,page:n,onPageChange:function(e,t){c(t)}})]})})}function bf(e){var t=e.corte,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=JSON.parse(localStorage.getItem("sesionCafi")),o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(gl.a)(Ij,{variables:{sucursal:i.sucursal._id,empresa:i.empresa._id,input:{usuario:i._id,caja:t.id_caja,token_turno_user:t.token_turno_user,number_user:i.numero_usuario}},fetchPolicy:"network-only"}),b=Object(y.a)(u,2),p=b[0],m=b[1],O=m.data,x=(m.error,m.loading),h=[],_="",f="";O&&(h=O.obtenerCorteCaja.montos_en_sistema,_=O.obtenerCorteCaja.fecha_inicio,f=O.obtenerCorteCaja.fecha_fin);var g=function(){r(!c),p()},A=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,lf(t,h,_,f);case 3:d(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",handleClickOpen:!0,onClick:g,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:Ba(t.fecha_salida.completa)}),Object(H.jsx)(Da.a,{align:"center",children:t.hora_salida.completa}),Object(H.jsx)(Da.a,{align:"center",children:t.usuario_en_turno.nombre}),Object(H.jsx)(Da.a,{align:"center",children:t.horario_en_turno}),Object(H.jsx)(Da.a,{align:"center",children:t.numero_caja}),Object(H.jsx)(Da.a,{align:"center",children:t.sucursal.nombre_sucursal})]},t._id),Object(H.jsxs)(qe.a,{fullWidth:!0,maxWidth:"lg",open:c,onClose:g,children:[Object(H.jsx)(He.a,{children:Object(H.jsx)(pf,{corte:t,montos_sistema:h,loading:x,fechaInicio:_,fechaFin:f})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{color:"primary",size:"small",variant:"contained",onClick:function(){return A()},disabled:l,startIcon:l?Object(H.jsx)(I.a,{size:20,color:"inherit"}):Object(H.jsx)(Z_.a,{}),children:"Imprimir Ticket"})})]})]})}function pf(e){var t=e.corte,a=e.montos_sistema,n=e.loading,c=e.fechaInicio,r=e.fechaFin,i=jf();return n?Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"30vh",children:Object(H.jsx)(I.a,{})}):Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)(Qe.a,{item:!0,lg:12,md:12,xs:12,children:[Object(H.jsx)(O.a,{p:1,textAlign:"center",children:Object(H.jsx)(L.a,{variant:"h5",children:Object(H.jsx)("b",{children:"Reporte de Corte de Caja"})})}),Object(H.jsx)(O.a,{p:1,textAlign:"center",children:Object(H.jsx)(L.a,{variant:"h6",children:"Del ".concat(Dt()(c).locale("es-mx").format("LLL")," al ").concat(Dt()(r).locale("es-mx").format("LLL"))})})]}),Object(H.jsx)(Qe.a,{item:!0,lg:12,md:12,xs:12,children:Object(H.jsxs)(O.a,{p:2,display:"flex",justifyContent:"center",children:[Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Usuario: "})," ",t.usuario_en_turno.nombre]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"No. de usuario: "}),t.usuario_en_turno.numero_usuario]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Horario en turno: "}),t.horario_en_turno]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Numero de caja: "}),t.numero_caja]})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Sucursal: "}),t.sucursal.nombre_sucursal]})})]})}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(fn.a,{className:i.root,children:Object(H.jsx)(Na.a,{className:i.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:"CONCEPTO"}),Object(H.jsx)(Da.a,{align:"center",children:"CAJERO"}),Object(H.jsx)(Da.a,{align:"center",children:"SISTEMA"}),Object(H.jsx)(Da.a,{align:"center",children:"DIFERENCIA"})]})}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO EFECTIVO"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_efectivo.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_efectivo.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_efectivo.monto-a.monto_efectivo).toFixed(2)]})]}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO TARJETA DEBITO"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_debito.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_tarjeta_debito.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_tarjeta_debito.monto-a.monto_tarjeta_debito).toFixed(2)]})]}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO TARJETA DE CREDITO"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_tarjeta_credito.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_tarjeta_credito.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_tarjeta_credito.monto-a.monto_tarjeta_credito).toFixed(2)]})]}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO TRANSFERENCIAS"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_transferencia.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_transferencia.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_transferencia.monto-a.monto_transferencia).toFixed(2)]})]}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO EN MONEDERO"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_monedero.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_monedero.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_monedero.monto-a.monto_monedero).toFixed(2)]})]}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO EN CREDITOS"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_creditos.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_creditos.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_creditos.monto-a.monto_creditos).toFixed(2)]})]}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO EN CHEQUES"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_cheques.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_cheques.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_cheques.monto-a.monto_cheques).toFixed(2)]})]}),Object(H.jsxs)(za.a,{children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)("b",{children:"MONTO EN VALE DE DESPENSA"})}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.montos_en_caja.monto_vales_despensa.monto.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",a.monto_vales_despensa.toFixed(2)]}),Object(H.jsxs)(Da.a,{align:"center",children:["$",(t.montos_en_caja.monto_vales_despensa.monto-a.monto_vales_despensa).toFixed(2)]})]})]})})})})]})}function mf(e){var t=e.historialCortes,a=e.refetch,n=u.a.useState(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=u.a.useState(0),s=Object(y.a)(o,2),l=s[0],d=s[1],j=function(){i(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{variant:"text",color:"primary",startIcon:Object(H.jsx)(ll.a,{}),onClick:function(){i(!0)},children:"Exportar Excel"}),Object(H.jsxs)(qe.a,{open:r,onClose:j,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Exportar Reporte de cortes de caja"}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(ia.a,{children:"-Exportar pagina actual: exportar\xe1 la pagina actual"}),Object(H.jsx)(ia.a,{children:"-Exportar todo: exportar\xe1 todos los registros filtrados"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:l,onChange:function(e){return function(e){d(e),a(e?{limit:0,offset:0}:{limit:20,offset:0})}(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:0,children:"Contenido Actual"}),Object(H.jsx)(Pt.a,{value:1,children:"Todos los registros"})]})})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:j,color:"inherit",children:"Cancelar"}),Object(H.jsx)(Of,{datosExcel:t.docs})]})]})]})}var Of=function(e){var t=e.datosExcel.map((function(e){return{fecha:e.fecha_salida.completa,hora_movimiento:e.hora_salida.completa,horario_turno:e.horario_en_turno,sucursal:e.sucursal.nombre_sucursal,nombre:e.usuario_en_turno.nombre,numero_usuario:e.usuario_en_turno.numero_usuario,concepto:"Corte Caja",caja:e.numero_caja,monto_efectivo:e.montos_en_caja.monto_efectivo.monto,monto_creditos:e.montos_en_caja.monto_creditos.monto,monto_tarjeta_debito:e.montos_en_caja.monto_tarjeta_debito.monto,monto_tarjeta_credito:e.montos_en_caja.monto_tarjeta_credito.monto,monto_monedero:e.montos_en_caja.monto_monedero.monto,monto_cheques:e.montos_en_caja.monto_cheques.monto,monto_transferencia:e.montos_en_caja.monto_transferencia.monto,monto_vales_despensa:e.montos_en_caja.monto_vales_despensa.monto}}));return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(ap.a,{element:Object(H.jsx)(F.a,{variant:"text",color:"primary","aria-label":"Guardar",startIcon:Object(H.jsx)(ll.a,{}),children:"Exportar"}),filename:"Reporte de Historial de Cortes",children:Object(H.jsxs)(cp.a,{data:t,name:"Reporte de Historial de Cortes",children:[Object(H.jsx)(ip.a,{label:"Usuario",value:"nombre"}),Object(H.jsx)(ip.a,{label:"No. Usuario",value:"numero_usuario"}),Object(H.jsx)(ip.a,{label:"Sucursal",value:"sucursal"}),Object(H.jsx)(ip.a,{label:"Fecha Corte",value:"fecha"}),Object(H.jsx)(ip.a,{label:"Hora Corte",value:"hora_movimiento"}),Object(H.jsx)(ip.a,{label:"Horario Turno",value:"horario_turno"}),Object(H.jsx)(ip.a,{label:"Concepto",value:"concepto"}),Object(H.jsx)(ip.a,{label:"No. de Caja",value:"caja"}),Object(H.jsx)(ip.a,{label:"M. en Efectivo",value:"monto_efectivo"}),Object(H.jsx)(ip.a,{label:"M. en Creditos",value:"monto_creditos"}),Object(H.jsx)(ip.a,{label:"M. en Tarjeta Debito",value:"monto_tarjeta_debito"}),Object(H.jsx)(ip.a,{label:"M. en Tarjeta Credito",value:"monto_tarjeta_credito"}),Object(H.jsx)(ip.a,{label:"M. en Monedero",value:"monto_monedero"}),Object(H.jsx)(ip.a,{label:"M. en Cheques",value:"monto_cheques"}),Object(H.jsx)(ip.a,{label:"M. en Transferencia",value:"monto_transferencia"}),Object(H.jsx)(ip.a,{label:"M. en Vale Despensa",value:"monto_vales_despensa"})]})})})},xf=a(268),hf=a.n(xf),_f=a(484),ff=a.n(_f),gf=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=new rf("http://localhost:8000")).feed(1),t.setAlign("center"),t.write("***Ticket de prueba***"),t.feed(3),t.cut(),e.next=9,t.end();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();function vf(e){var t=e.handleClose,a=e.setPrint,n=e.print,c=u.a.useState([]),r=Object(y.a)(c,2),i=r[0],o=r[1],s=u.a.useState(!1),l=Object(y.a)(s,2),d=l[0],j=l[1],b=u.a.useState(!1),p=Object(y.a)(b,2),m=p[0],x=p[1],h=u.a.useState({message:"",status:"",open:!1}),_=Object(y.a)(h,2),f=_[0],g=_[1];return u.a.useEffect((function(){x(!0),rf.getImpresoras().then((function(e){x(!1),o(e)})).catch((function(e){x(!1),a(null),g({message:"Hubo error al cargar las impresoras",status:"error",open:!0})}))}),[]),Object(H.jsxs)("div",{children:[Object(H.jsx)(Y,{alert:f,setAlert:g}),Object(H.jsx)(He.a,{children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"center",children:[Object(H.jsxs)(ee.a,{variant:"outlined",style:{width:220},children:[Object(H.jsx)(te.a,{htmlFor:"print-list",children:"Selecciona impresora"}),Object(H.jsxs)(Nt.a,{labelId:"print-list",id:"print-list-select",value:n||"",onChange:function(e){return t=e.target.value,void a(t);var t},label:"Selecciona impresora",startAdornment:Object(H.jsx)(ne.a,{position:"start",children:m?Object(H.jsx)(I.a,{size:20,color:"primary"}):Object(H.jsx)("div",{})}),children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona una"})}),i.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e,children:e},t)}))]})]}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(F.a,{variant:"outlined",onClick:function(){return gf()},disabled:!n,startIcon:Object(H.jsx)(hf.a,{}),children:"Prueba"})]})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return t()},color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return j(!0),void rf.setImpresora(n).then((function(e){j(!1),e?(localStorage.setItem("cafiTicketPrint",n),g({message:"Impresora ".concat(n," establecida correctamente"),status:"success",open:!0}),t()):g({message:"No se pudo establecer la impresora con el nombre ".concat(n),status:"error",open:!0})})).catch((function(e){j(!1),console.log(e)}))},color:"primary",disabled:d,startIcon:d?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Seleccionar"})]})]})}function Cf(e){var t=e.turnoEnCurso,a=e.icon,n=e.text,c=u.a.useState(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=u.a.useState(localStorage.getItem("cafiTicketPrint")),l=Object(y.a)(s,2),d=l[0],j=l[1],b=function(){o(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{onClick:function(){o(!0)},startIcon:Object(H.jsx)(Sc.a,{badgeContent:1,variant:"dot",color:d?"default":"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:a?Object(H.jsx)(ff.a,{style:{fontSize:20}}):Object(H.jsx)(hf.a,{style:{fontSize:20}})}),style:t?null:{color:"white",borderColor:"white"},children:n||"Impresora"}),Object(H.jsxs)(qe.a,{open:i,onClose:function(){return b()},"aria-labelledby":"select-printer",fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{id:"select-printer",children:"Configuraci\xf3n impresora de tickets"}),Object(H.jsx)(vf,{handleClose:b,print:d,setPrint:j})]})]})}var yf=a.p+"static/media/cash-register.063f45da.svg",Af=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Sf=Object(Fh.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100}}}));function Ff(){var e,t=JSON.parse(localStorage.getItem("sesionCafi")),a=Sf(),n=Object(j.useState)(0),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)([]),b=Object(y.a)(u,2),p=b[0],x=b[1],h=Object(an.useDebounce)(p,500),_=Object(y.a)(h,1)[0],f=[],v=[],C=Object(rt.b)(vj,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id}}),A=Object(rt.b)(Fj,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:{fecha_consulta:p.fecha_consulta?p.fecha_consulta:"",usuario:_.usuario?_.usuario:"",numero_caja:p.numero_caja?parseInt(p.numero_caja):null},limit:20,offset:r},fetchPolicy:"network-only"}),I=A.loading,k=A.data,w=(A.error,A.refetch);!1===C.loading&&!1===I&&(f=C.data.obtenerCajasSucursal,v=k.obtenerCortesDeCaja);var N=function(){d(!l)},P=function(e){x(Object(m.a)(Object(m.a)({},p),{},Object(g.a)({},e.target.name,e.target.value)))};return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{fullWidth:!0,onClick:N,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:yf,alt:"icono caja",style:{width:100}})}),"Reportes cortes de caja"]})}),Object(H.jsxs)(qe.a,{fullScreen:!0,open:l,onClose:N,TransitionComponent:Af,children:[Object(H.jsx)(Re.a,{className:a.appBar,children:Object(H.jsxs)(Je.a,{children:[Object(H.jsx)(L.a,{variant:"h6",className:a.title,children:"Reportes cortes de caja"}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:N,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:3,children:[Object(H.jsx)(Qe.a,{item:!0,md:7,xs:12,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{children:"Fecha de corte:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"fecha_consulta",variant:"outlined",type:"date",onChange:P,value:p.fecha_consulta?p.fecha_consulta:""})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{children:"Usuario:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"usuario",variant:"outlined",onChange:P,value:p.usuario?p.usuario:""})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{children:"Caja:"}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"numero_caja",onChange:P,value:p.numero_caja?p.numero_caja:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),null===(e=f)||void 0===e?void 0:e.map((function(e){return Object(H.jsxs)(Pt.a,{value:e.numero_caja,children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]})]})}),Object(H.jsx)(Qe.a,{item:!0,md:5,xs:12,style:{display:"flex",justifyContent:"flex-end"},children:Object(H.jsxs)(O.a,{height:"100%",display:"flex",alignItems:"flex-end",children:[Object(H.jsx)(F.a,{color:"primary",variant:"text",onClick:function(){x([])},startIcon:Object(H.jsx)(Ye.a,{}),children:"Limpiar Filtro"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(mf,{historialCortes:v,refetch:w}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(Cf,{turnoEnCurso:!0,icon:"config"})]})}),Object(H.jsx)(Qe.a,{item:!0,lg:12,md:12,xs:12,children:Object(H.jsx)(uf,{cortes:v,loading:I,page:r,setPage:i,limit:20})})]})})]})]})}var If,kf,wf=a(494);a(974),Object(P.d)(If||(If=Object(N.a)(["\n    query ObtenerHistorialEgresos($input: ObtenerHistorialEgresosInput, $empresa: ID!, $sucursal: ID!){\n        obtenerHistorialEgresos(input: $input, empresa: $empresa, sucursal: $sucursal){\n            folio_egreso\n            folio_factura\n            empresa_distribuidora\n            provedor\n            productos {\n                cantidad_productos\n                precio_unitario\n                producto\n                total\n            }\n            categoria\n            subCategoria\n            metodo_pago\n            fecha_compra\n            fecha_registro\n            fecha_vencimiento\n            observaciones\n            compra_credito\n            credito_pagado\n            saldo_credito_pendiente\n            saldo_total\n            numero_usuario_creador\n            nombre_usuario_creador\n            id_user\n            empresa\n            sucursal         \n        }\n    }\n"]))),Object(P.d)(kf||(kf=Object(N.a)(["\n    mutation CrearEgreso($input: CrearEgresosInput, $empresa: ID!, $sucursal: ID!){\n        crearEgreso(input: $input, empresa: $empresa, sucursal: $sucursal){\n            message\n        }\n    }\n"]))),Object(k.a)((function(e){return{root:{width:"100%",height:"70vh"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}}}));function Nf(e,t,a,n){return{name:e,code:t,population:a,size:n,density:a/n}}Nf("India","IN",1324171354,3287263),Nf("China","CN",1403500365,9596961),Nf("Italy","IT",60483973,301340),Nf("United States","US",327167434,9833520),Nf("Canada","CA",37602103,9984670),Nf("Australia","AU",25475400,7692024),Nf("Germany","DE",83019200,357578),Nf("Ireland","IE",4857e3,70273),Nf("Mexico","MX",126577691,1972550),Nf("Japan","JP",126317e3,377973),Nf("France","FR",67022e3,640679),Nf("United Kingdom","GB",67545757,242495),Nf("Russia","RU",146793744,17098246),Nf("Nigeria","NG",200962417,923768),Nf("Brazil","BR",210147125,8515767),Object(k.a)((function(e){return{root:{width:"100%"},container:{maxHeight:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{width:100},root:{flexGrow:1,width:"100%",height:"100vh",backgroundColor:e.palette.background.paper},rootBusqueda:{display:"flex",paddingLeft:e.spacing(2)}}}));function Pf(){var e=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)(A.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:3,justifyContent:"center",children:[!1===e.accesos.reportes.reporte_historial_cajas.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Sh,{})})}),!1===e.accesos.reportes.reporte_turnos.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)($h,{})})}),!1===e.accesos.reportes.reporte_compras.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Zh,{})})}),!1===e.accesos.reportes.reporte_ventas.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(R_,{})})}),!1===e.accesos.reportes.rerporte_almacen.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Q_,{})})}),!1===e.accesos.reportes.reporte_corte_caja.ver?null:Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(Ff,{})})})]})})}var Ef=["children","value","index"];function Df(e){var t=e.children,a=e.value,n=e.index,c=Object(De.a)(e,Ef);return Object(H.jsx)("div",Object(m.a)(Object(m.a)({role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},c),{},{children:a===n&&Object(H.jsx)(O.a,{p:3,my:6,minHeight:"50vh",children:t})}))}function zf(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}var Tf=Object(k.a)((function(e){return{root:{flexGrow:1,width:"100%",height:"94vh",backgroundColor:e.palette.background.paper},icon:{fontSize:100},iconSvg:{width:100},iconSvgVenta:{width:90}}}));var $f=Object(f.f)((function(e){var t=Tf(),a=Object($e.a)(),n=u.a.useState(0),c=Object(y.a)(n,2),r=c[0],i=c[1];return Object(H.jsx)("div",{className:t.root,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Re.a,{position:"static",color:"default",elevation:0,children:Object(H.jsxs)(Ve.a,{value:r,onChange:function(e,t){i(t)},indicatorColor:"primary",textColor:"primary",centered:!0,scrollButtons:"on",children:[Object(H.jsx)(Me.a,Object(m.a)({label:"Mi empresa",icon:Object(H.jsx)(We.r,{className:t.icon})},zf(0))),Object(H.jsx)(Me.a,Object(m.a)({label:"Catalogos",icon:Object(H.jsx)(We.j,{className:t.icon})},zf(1))),Object(H.jsx)(Me.a,Object(m.a)({label:"Almacenes",icon:Object(H.jsx)("img",{src:Ai,alt:"icono almacen",className:t.iconSvg})},zf(2))),Object(H.jsx)(Me.a,Object(m.a)({label:"Compras",icon:Object(H.jsx)(We.m,{className:t.icon})},zf(3))),Object(H.jsx)(Me.a,Object(m.a)({label:"Reportes",icon:Object(H.jsx)(We.s,{className:t.icon})},zf(4))),Object(H.jsx)(Me.a,Object(m.a)({label:"Tesoreria",icon:Object(H.jsx)("img",{src:Si,alt:"icono money",className:t.iconSvg})},zf(5))),Object(H.jsx)(Me.a,Object(m.a)({label:"Facturaci\xf3n",icon:Object(H.jsx)("img",{src:Fi,alt:"icono factura",className:t.iconSvg})},zf(6)))]})}),Object(H.jsxs)(Te.a,{axis:"rtl"===a.direction?"x-reverse":"x",index:r,onChangeIndex:function(e){i(e)},children:[Object(H.jsx)(Df,{value:r,index:0,children:Object(H.jsx)(Fa,{})}),Object(H.jsx)(Df,{value:r,index:1,children:Object(H.jsx)(fb,{})}),Object(H.jsx)(Df,{value:r,index:2,children:Object(H.jsx)(ih,{})}),Object(H.jsx)(Df,{value:r,index:3,children:Object(H.jsx)(Vl,{})}),Object(H.jsx)(Df,{value:r,index:4,children:Object(H.jsx)(Pf,{})}),Object(H.jsx)(Df,{value:r,index:5,children:Object(H.jsx)(km,{})}),Object(H.jsx)(Df,{value:r,index:6,children:Object(H.jsx)(ax,{})})]})]})})})),Wf=a(342),Rf=a.n(Wf),Vf=a(273),Mf=a(979),Lf=a(977),Bf=a(978),Uf=a(975),qf=Object(j.createContext)(),Jf=function(e){var t=e.children,a=Object(j.useState)({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)({_id:null,cantidad:null,codigo_barras:null,concepto:null,default:null,descuento:null,descuento_activo:null,id_producto:{},precio:null,unidad:null,unidad_principal:null}),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)([]),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)({productos:[],cliente:{},subtotal:0,impuestos:0,total:0,usuario:{}}),O=Object(y.a)(m,2),x=O[0],h=O[1],_=Object(j.useState)({}),f=Object(y.a)(_,2),g=f[0],v=f[1],C=Object(j.useState)([]),A=Object(y.a)(C,2),S=A[0],F=A[1],I=Object(j.useState)([]),k=Object(y.a)(I,2),w=k[0],N=k[1],P=Object(j.useState)(),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(j.useState)(""),$=Object(y.a)(T,2),W=$[0],R=$[1],V=Object(j.useState)(!1),M=Object(y.a)(V,2),L=M[0],B=M[1],U=Object(j.useState)(!1),q=Object(y.a)(U,2),J=q[0],G=q[1],Y=Object(j.useState)({message:"",status:"",open:!1}),Q=Object(y.a)(Y,2),K=Q[0],X=Q[1],Z=Object(j.useState)(!1),ee=Object(y.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(j.useState)(!1),ce=Object(y.a)(ne,2),re=ce[0],ie=ce[1],oe=Object(j.useState)(null),se=Object(y.a)(oe,2),le=se[0],de=se[1],je=Object(j.useState)(!1),ue=Object(y.a)(je,2),be=ue[0],pe=ue[1],me=Object(j.useState)(!1),Oe=Object(y.a)(me,2),xe=Oe[0],he=Oe[1],_e=Object(j.useState)(!1),fe=Object(y.a)(_e,2),ge=fe[0],ve=fe[1],Ce=Object(j.useState)(!1),ye=Object(y.a)(Ce,2),Ae=ye[0],Se=ye[1];return Object(H.jsx)(qf.Provider,{value:{alert:K,setAlert:X,update:L,setUpdate:B,error:J,setError:G,datosProductoVentas:s,setDatosProductoVentas:l,productosVentas:b,setProductosVentas:p,datosVentas:x,setDatosVentas:h,abrirTurnosDialog:te,setAbrirTurnosDialog:ae,setUpdateClientVenta:ie,updateClientVenta:re,setProductoCambioPrecio:v,productoCambioPrecio:g,setPrecioSelectProductoVenta:F,precioSelectProductoVenta:S,setUpdateTablaVentas:he,updateTablaVentas:xe,setOpen:pe,open:be,clientesVentas:w,setClientesVentas:N,turnoActivo:D,setTurnoActivo:z,ubicacionTurno:W,setUbicacionTurno:R,DatosVentasActual:c,setDatosVentasActual:r,setOpenBackDrop:ve,openBackDrop:ge,venta_retomada:le,setVentaRetomada:de,openBuscarProducto:Ae,setOpenBuscarProducto:Se},children:t})};function Hf(e){var t=e.isOnline,a=e.classes,n=e.empresa,c=e.sucursal,r=Object(j.useState)({message:"",status:"",open:!1}),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(w.a)(R),d=Object(y.a)(l,1)[0],u=Object(j.useContext)(qf).setOpenBackDrop,b=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,d({variables:{empresa:n._id,sucursal:c._id}});case 4:t=e.sent,a=t.data.actualizarBDLocal.message,console.log(t),u(!1),s({message:a,status:"success",open:!0}),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message),u(!1);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Y,{alert:o,setAlert:s}),t?Object(H.jsx)(F.a,{onClick:function(){return b()},startIcon:Object(H.jsx)(Uf.a,{htmlColor:"black",style:{fontSize:20}}),className:a.buttonIcon,style:{color:"black",borderColor:"white"},children:"Actualizar base de datos local"}):Object(H.jsx)("div",{})]})}function Gf(e){var t=e.isOnline,a=e.classes,n=e.empresa,c=e.sucursal,r=Object(j.useState)({message:"",status:"",open:!1}),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(w.a)(R),d=Object(y.a)(l,1)[0],u=Object(j.useContext)(be).setLoadingPage,b=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,d({variables:{empresa:n._id,sucursal:c._id}});case 4:t=e.sent,a=t.data.actualizarBDLocal.message,u(!1),s({message:a,status:"success",open:!0}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0),u(!1),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Y,{alert:o,setAlert:s}),t?Object(H.jsx)(F.a,{onClick:function(){return b()},startIcon:Object(H.jsx)(Uf.a,{htmlColor:"black",style:{fontSize:20}}),className:a.buttonIcon,style:{color:"black",borderColor:"white"},children:"Actualizar base de datos local"}):Object(H.jsx)("div",{})]})}var Yf=a(976);function Qf(e){var t=e.ventasToCloud,a=e.isOnline,n=e.classes,c=Object(j.useState)({message:"",status:"",open:!1}),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(w.a)(ym),l=Object(y.a)(s,1)[0],d=Object(j.useContext)(be),u=d.removeStorageVentas,b=d.saveVentasToCloudFail,p=Object(j.useContext)(qf).setOpenBackDrop,m=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var a,n,c,r,i;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,p(!0),e.next=4,l({variables:{arrayVentasCloud:t}});case 4:a=e.sent,n=a.data.subirVentasCloud,c=n.message,r=n.done,i=n.ventas_fail,r?u():(console.log(a.data.subirVentasCloud),b(i)),p(!1),o({message:c,status:r?"success":"error",open:!0}),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),p(!1),console.log(e.t0),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Y,{alert:i,setAlert:o}),Object(H.jsx)(F.a,{onClick:function(){return m()},className:n.buttonIcon,startIcon:t.length?Object(H.jsx)(Sc.a,{badgeContent:1,variant:"dot",color:"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:Object(H.jsx)(Yf.a,{style:{fontSize:20}})}):Object(H.jsx)(Yf.a,{style:{fontSize:20}}),disabled:!(t.length>0&&a),style:t.ventasToCloud?{color:"white",borderColor:"white"}:null,children:"Guardar ventas en la nube"})]})}function Kf(e){var t=e.isOnline,a=e.classes,n=e.ventasToCloud,c=e.sesion,r=e.fromVentas,i=Object(j.useState)(null),o=Object(y.a)(i,2),s=o[0],l=o[1],d=function(){l(null)};return Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(F.a,{onClick:function(e){l(e.currentTarget)},className:a.buttonIcon,style:{color:"white",borderColor:"white"},children:t?n.length?Object(H.jsx)(Sc.a,{badgeContent:1,variant:"dot",color:"secondary",anchorOrigin:{vertical:"top",horizontal:"left"},children:Object(H.jsx)(Lf.a,{htmlColor:"#81c784",style:{fontSize:20}})}):Object(H.jsx)(Lf.a,{htmlColor:"#81c784",style:{fontSize:20}}):Object(H.jsx)(Bf.a,{htmlColor:"#bdbdbd",style:{fontSize:20}})}),r?Object(H.jsxs)(wf.a,{id:"simple-menu",anchorEl:s,keepMounted:!0,open:s,onClose:d,children:[Object(H.jsx)(Pt.a,{onClick:d,children:Object(H.jsx)(Qf,{ventasToCloud:n,isOnline:t,classes:a})}),Object(H.jsx)(Pt.a,{onClick:d,children:Object(H.jsx)(Hf,{isOnline:t,classes:a,empresa:c.empresa,sucursal:c.sucursal})})]}):Object(H.jsx)(wf.a,{id:"simple-menu",anchorEl:s,keepMounted:!0,open:s,onClose:d,children:Object(H.jsx)(Pt.a,{onClick:d,children:Object(H.jsx)(Gf,{isOnline:t,classes:a,empresa:c.empresa,sucursal:c.sucursal})})})]})}var Xf=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Zf=Object(k.a)((function(e){return{appbar:{backgroundColor:e.palette.navbar,color:Vf.a[800],height:"5vh"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,marginLeft:e.spacing(2)},avatar:{height:24,width:24}}}));var eg=function(e){var t=e.signOut,a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Zf(),o=function(){r(!1)};return Object(H.jsxs)("div",{children:[Object(H.jsx)(F.a,{color:"secondary",size:"medium",className:i.menuButton,startIcon:Object(H.jsx)(Rf.a,{}),variant:"text",onClick:function(){r(!0)},children:"Cerrar sesi\xf3n"}),Object(H.jsxs)(qe.a,{open:c,TransitionComponent:Xf,keepMounted:!0,onClose:o,children:[Object(H.jsx)(Bt.a,{children:"\xbfSeguro que deseas cerrar sesi\xf3n?"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:o,color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:t,color:"secondary",variant:"contained",children:"Cerrar sesi\xf3n"})]})]})]})},tg=Object(f.f)((function(e){var t,a=Zf(),n=localStorage.getItem("sesionCafi"),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=JSON.parse(localStorage.getItem("sesionCafi")),i=u.a.useState(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useContext)(be),b=d.isOnline,p=d.ventasToCloud,m=d.loadingPage,x=d.setLoadingPage;return null!==n&&(t=JSON.parse(localStorage.getItem("sesionCafi"))),Object(H.jsxs)(Qe.a,{container:!0,alignItems:"center",children:[Object(H.jsx)(Qe.a,{item:!0,md:6,children:Object(H.jsxs)(O.a,{display:"flex",mx:1,children:[Object(H.jsx)(Ke.a,{alt:"Remy Sharp",className:a.avatar,src:t.imagen}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{color:"textSecondary",children:["Bienvenido ","".concat(t.nombre)]})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:6,style:{display:"flex",justifyContent:"flex-end"},children:[Object(H.jsx)(Kf,{isOnline:b,classes:a,ventasToCloud:p,sesion:r,fromVentas:!1}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(F.a,{onClick:function(){return l(!0),void window.location.reload()},startIcon:s?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ra.a,{})}),Object(H.jsx)(F.a,{component:_.b,to:"/ventas/venta-general",size:"medium",className:a.menuButton,startIcon:Object(H.jsx)(Mf.a,{}),children:"Panel de venta"}),!0===r.turno_en_caja_activo&&c?Object(H.jsx)(F.a,{color:"secondary",size:"medium",className:a.menuButton,variant:"text",disabled:!0,startIcon:Object(H.jsx)(Rf.a,{}),children:"TURNO ACTIVO"}):Object(H.jsx)(eg,{signOut:function(){localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("ListaEnEspera"),e.history.push("/")}})]})]}),Object(H.jsx)(st,{loading:m,setLoading:x})]})}));var ag=a(980),ng=Object(k.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"white"},drawer:{width:"22%",flexShrink:0,backgroundColor:"white"},drawerColor:{height:"95vh",backgroundColor:"white"},drawerPaper:{width:"22%",backgroundColor:e.palette.navbar},root:{display:"flex",flexDirection:"column",height:"100%"},navigationTop:{height:"100%"},iconSizeSuperior:{fontSize:30,color:e.palette.info.main},iconSizeSecondSuperior:{width:20},iconSizeInferior:{fontSize:50,color:e.palette.info.main},iconSizeSecondInferior:{width:40},iconSizeSecondInferiorGrande:{width:100},iconSizeInferiorGrande:{fontSize:110,color:e.palette.info.main},avatar:{width:e.spacing(3),height:e.spacing(3),marginRight:e.spacing(1),marginLeft:e.spacing(1)},borderBoton:{minWidth:"100%",height:"50%",border:".6px solid #DBDBDB"},borderBotonChico:{minWidth:"100%",border:".6px solid #DBDBDB"},buttonIcon:{minWidth:"100%"}}})),cg=a(1004),rg=a(991),ig=Object(k.a)((function(e){return{root:{marginTop:e.spacing(2)},rootPrecioProductos:{minHeight:"40vh"},containerImage:{maxWidth:100,maxHeight:100,display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"ceter"},imagen:{maxWidth:"100%",maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"ceter"},rootBusqueda:{height:35,display:"flex",padding:e.spacing(1)},rootBusquedaProductos:{height:35,display:"flex",padding:e.spacing(1)},rootFecha:{height:40,maxWidth:150,display:"flex"},formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"},titulos:{fontWeight:500,"& .obligatorio":{color:"red"}},formInput:{},iconSize:{width:28},iconSizeDialogs:{width:50},iconSizeDialogsPequeno:{width:50},containerImagenesProducto:{height:"150px",display:"flex",justifyContent:"center",alignItems:"center"},imagenProducto:{maxHeight:"100%",maxWidth:"100%"},borderBoton:{minWidth:"100%",height:"50%",border:".6px solid #DBDBDB"},borderBotonChico:{minWidth:"100%",height:"100%",border:".6px solid #DBDBDB"},input:{"& input[type=number]":{"-moz-appearance":"textfield"},"& input[type=number]::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}}}})),og=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function sg(e){var t=e.refetch,a=u.a.useState(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=u.a.useState(""),o=Object(y.a)(i,2),s=o[0],l=o[1],d=u.a.useState(!1),j=Object(y.a)(d,2),b=j[0],p=j[1],m=u.a.useState({message:"",status:"",open:!1}),O=Object(y.a)(m,2),x=O[0],h=O[1],_=JSON.parse(localStorage.getItem("sesionCafi")),f=Object(w.a)(no),g=Object(y.a)(f,1)[0],A=function(){r(!1)},k=function(){var e=Object(C.a)(Object(v.a)().mark((function e(a){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),s){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,p(!0),e.next=7,g({variables:{input:{cuenta:s,empresa:_.empresa._id,sucursal:_.sucursal._id}}});case 7:h({message:"Guardado",status:"success",open:!0}),p(!1),t(),A(),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(3),p(!1),e.t0.message&&h({message:e.t0.message,status:"error",open:!0}),h({message:"Hubo un error",status:"error",open:!0});case 18:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"primary",onClick:function(){r(!0)},children:Object(H.jsx)(Ut.a,{})}),Object(H.jsx)(Y,{alert:x,setAlert:h}),Object(H.jsxs)(qe.a,{open:c,TransitionComponent:og,keepMounted:!0,onClose:A,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Nueva cuenta"}),Object(H.jsx)(He.a,{children:Object(H.jsx)("form",{id:"crear-cuenta-form",onSubmit:k,children:Object(H.jsx)(S.a,{label:"Cuenta",variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){return t=e.target.value,l(t);var t},value:s})})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:A,color:"inherit",disabled:b,children:"Cancelar"}),Object(H.jsx)(F.a,{form:"crear-cuenta-form",type:"submit",color:"primary",startIcon:b?Object(H.jsx)(I.a,{size:20,color:"inherit"}):Object(H.jsx)(hn.a,{}),disabled:b,children:"Guardar"})]})]})]})}var lg=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function dg(e){var t=e.cuenta,a=e.refetch,n=e.setCuenta,c=e.datosMovimiento,r=e.setDatosMovimiento,i=u.a.useState(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=u.a.useState(""),j=Object(y.a)(d,2),b=j[0],p=j[1],O=u.a.useState(!1),x=Object(y.a)(O,2),h=x[0],_=x[1],f=JSON.parse(localStorage.getItem("sesionCafi")),g=u.a.useState({message:"",status:"",open:!1}),A=Object(y.a)(g,2),k=A[0],N=A[1],P=Object(w.a)(co),E=Object(y.a)(P,1)[0],D=function(){l(!1),p("")},z=function(){var e=Object(C.a)(Object(v.a)().mark((function e(i){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.preventDefault(),console.log("algo"),b){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,_(!0),e.next=8,E({variables:{input:{subcuenta:b},empresa:f.empresa._id,sucursal:f.sucursal._id,idCuenta:t.cuenta._id}});case 8:N({message:"Guardado",status:"success",open:!0}),n(Object(m.a)(Object(m.a)({},t),{},{subcuentas:[].concat(Object(Ia.a)(t.subcuentas),[{_id:"",subcuenta:b.toUpperCase()}])})),r(Object(m.a)(Object(m.a)({},c),{},{concepto:b.toUpperCase()})),_(!1),a(),D(),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(4),_(!1),e.t0.message&&N({message:e.t0.message,status:"error",open:!0}),N({message:"Hubo un error",status:"error",open:!0});case 21:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(ce.a,{color:"primary",onClick:function(){l(!0)},disabled:!t.cuenta,children:Object(H.jsx)(Ut.a,{})}),Object(H.jsx)(Y,{alert:k,setAlert:N}),Object(H.jsxs)(qe.a,{open:s,TransitionComponent:lg,keepMounted:!0,onClose:function(){return D()},fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:"Nueva Subcuenta"}),Object(H.jsx)(He.a,{children:Object(H.jsx)("form",{id:"crear-subcuenta-form",onSubmit:z,children:Object(H.jsx)(S.a,{id:"subcuenta-venta",label:"Subcuenta",variant:"outlined",size:"small",fullWidth:!0,onChange:function(e){return t=e.target.value,p(t);var t},value:b,inputProps:{style:{textTransform:"uppercase"}}})})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:function(){return D()},color:"inherit",disabled:h,children:"Cancelar"}),Object(H.jsx)(F.a,{form:"crear-subcuenta-form",type:"submit",color:"primary",startIcon:h?Object(H.jsx)(I.a,{size:20,color:"inherit"}):Object(H.jsx)(hn.a,{}),disabled:h,children:"Guardar"})]})]})]})}var jg=a.p+"static/media/cash-register2.6e732a6a.svg",ug=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function bg(){var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=JSON.parse(localStorage.getItem("sesionCafi")),a=Object(w.a)(Cj),n=Object(y.a)(a,1)[0];Dt.a.locale("es");var c=ig(),r=Object(j.useContext)(qf).setAlert,i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useState)(!1),u=Object(y.a)(d,2),b=u[0],p=u[1],x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],A=Object(j.useState)({tipo_movimiento:"DEPOSITO"}),k=Object(y.a)(A,2),N=k[0],P=k[1],E=Object(j.useState)({cuenta:"",subcuentas:[]}),D=Object(y.a)(E,2),z=D[0],T=D[1],$=Object(rt.b)(oo,{variables:{empresa:t.empresa._id}}),W=$.loading,R=$.data,V=$.error,M=$.refetch,B={horario_en_turno:"ABRIR TURNO",id_caja:e?e.id_caja:"",id_usuario:t._id,token_turno_user:e?e.token_turno_user:""},U=Object(rt.b)(Sj,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:B}}),q=function(){l(!s),U.refetch()},J=0;if(!R||!U.data)return Object(H.jsx)(pg,{});if(J=U.data.obtenerPreCorteCaja.monto_efectivo_precorte,W||V||U.loading||U.error)return Object(H.jsx)(pg,{});window.addEventListener("keydown",(function(e){e.altKey&&68===e.keyCode&&q()}));var G=function(e){var t=e.target,a=t.value,n=t.name;P(Object(m.a)(Object(m.a)({},N),{},Object(g.a)({},n,a)))},Y=function(){var a=Object(C.a)(Object(v.a)().mark((function a(){var c;return Object(v.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(f(!0),a.prev=1,e||!1!==(null===t||void 0===t?void 0:t.turno_en_caja_activo)){a.next=8;break}return f(!1),r({message:"Por el momento no hay ningun turno activo.",status:"error",open:!0}),a.abrupt("return",null);case 8:if(N.tipo_movimiento&&N.monto_efectivo&&N.concepto){a.next=15;break}return p(!0),f(!1),r({message:"Por favor complete los datos.",status:"error",open:!0}),a.abrupt("return",null);case 15:if(!("RETIRO"===N.tipo_movimiento&&J<parseFloat(N.monto_efectivo))){a.next=19;break}return f(!1),r({message:"Lo sentimos no hay dinero suficiente en la caja para esta acci\xf3n.",status:"error",open:!0}),a.abrupt("return",null);case 19:return c={tipo_movimiento:N.tipo_movimiento,concepto:N.concepto,numero_caja:parseInt(e.numero_caja),id_Caja:e.id_caja,horario_turno:e.horario_en_turno,rol_movimiento:"CAJA",hora_moviento:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},fecha_movimiento:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("DD"),dia:Dt()().locale("es-mx").format("MM"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format()},id_User:t._id,numero_usuario_creador:t.numero_usuario,nombre_usuario_creador:t.nombre,montos_en_caja:{monto_efectivo:{monto:parseFloat(N.monto_efectivo),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}},empresa:t.empresa._id,sucursal:t.sucursal._id},a.next=22,n({variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:c}});case 22:r({message:"Nuevo movimiento registrado",status:"success",open:!0}),q(),f(!1);case 25:a.next=32;break;case 27:a.prev=27,a.t0=a.catch(1),f(!1),r({message:"Error: ".concat(a.t0.message),status:"error",open:!0}),q();case 32:case"end":return a.stop()}}),a,null,[[1,27]])})));return function(){return a.apply(this,arguments)}}();return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{onClick:function(){q()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!e,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:jg,alt:"icono caja",style:{width:20}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Deposito/Retiro"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + D"})})})]})}),Object(H.jsxs)(qe.a,{open:s,onClose:function(e,t){"backdropClick"!==t&&q()},TransitionComponent:ug,children:[Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(O.a,{display:"flex",textAlign:"center",children:[Object(H.jsxs)(O.a,{display:"flex",justifyContent:"center",flexGrow:1,children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:jg,alt:"icono caja",className:c.iconSizeDialogs})}),Object(H.jsx)(O.a,{m:2,children:Object(H.jsx)(et.a,{orientation:"vertical"})}),Object(H.jsxs)(O.a,{mt:1,children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Deposito/Retiro Caja"})}),Object(H.jsxs)(O.a,{display:"flex",textAlign:"right",children:[Object(H.jsx)(O.a,{textAlign:"right",children:Object(H.jsx)(L.a,{variant:"caption",children:Dt()().locale("es-mx").format("MM/DD/YYYY")})}),Object(H.jsx)(O.a,{textAlign:"right",ml:2,children:Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsxs)("b",{children:[Dt()().locale("es-mx").format("h:mm")," hrs."]})})}),Object(H.jsx)(O.a,{textAlign:"right",ml:2,children:Object(H.jsxs)(L.a,{variant:"caption",children:[Object(H.jsx)("b",{children:"Caja: "}),null===e||void 0===e?void 0:e.numero_caja]})})]})]})]}),Object(H.jsx)(O.a,{ml:10,mb:7,display:"flex",alignItems:"center",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:q,size:"large",disabled:_,children:Object(H.jsx)(Ye.a,{})})})]}),Object(H.jsx)(O.a,{m:2,children:!0===t.turno_en_caja_activo?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{width:"100%",children:Object(H.jsx)(ee.a,{component:"fieldset",children:Object(H.jsxs)(cg.a,{row:!0,"aria-label":"position",name:"position",value:N.tipo_movimiento,onChange:function(e,t){P(Object(m.a)(Object(m.a)({},N),{},{tipo_movimiento:t}))},children:[Object(H.jsx)(Xe.a,{value:"DEPOSITO",control:Object(H.jsx)(rg.a,{color:"primary"}),label:"Deposito"}),Object(H.jsx)(Xe.a,{value:"RETIRO",control:Object(H.jsx)(rg.a,{color:"primary"}),label:"Retiro"})]})})}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:"Monto:"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",type:"number",name:"monto_efectivo",onChange:G,id:"form-producto-codigo-barras",variant:"outlined",error:b&&!N.monto_efectivo})})]}),Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(L.a,{children:"Concepto de Movimiento:"})}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",mb:2,children:[Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",error:b&&!N.concepto,children:[Object(H.jsx)(te.a,{id:"label-select-cuenta",children:"Cuenta"}),Object(H.jsxs)(Nt.a,{id:"concepto-deposito-cuenta",onChange:function(e,t){var a=t.props.cuenta;T({cuenta:a,subcuentas:a.subcuentas})},name:"cuenta",labelId:"label-select-cuenta",label:"Cuenta",value:z.cuenta.cuenta?z.cuenta.cuenta:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),null===R||void 0===R?void 0:R.obtenerCuentas.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.cuenta,cuenta:e,children:e.cuenta},t)}))]})]}),Object(H.jsx)(sg,{refetch:M})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",error:b&&!N.concepto,children:[Object(H.jsx)(te.a,{id:"label-select-subcuenta",children:"Subcuenta"}),Object(H.jsxs)(Nt.a,{id:"concepto-deposito-subcuenta",onChange:G,name:"concepto",labelId:"label-select-subcuenta",label:"Subcuenta",value:N.concepto?N.concepto:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),z.subcuentas.map((function(e,t){return Object(H.jsx)(Pt.a,{value:e.subcuenta,children:e.subcuenta},t)}))]})]}),Object(H.jsx)(dg,{cuenta:z,refetch:M,setCuenta:T,datosMovimiento:N,setDatosMovimiento:P})]})]})]}):Object(H.jsx)(O.a,{textAlign:"center",p:2,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Por el momento no hay un turno en sesi\xf3n"})})})})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:Y,variant:"contained",color:"primary",size:"large",disabled:_,startIcon:_?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Yt.a,{}),children:"Guardar"})})]})]})}var pg=function(){return Object(H.jsx)(F.a,{disabled:!0,style:{textTransform:"none",height:"100%",width:"100%",pointerEvents:"none",opacity:.5},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:jg,alt:"icono caja",style:{width:20}})}),Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Deposito/Retiro"})}),Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + D"})})]})})};Dt.a.locale("es");var mg=Object(f.f)((function(e){var t=e.handleClickOpen,a=e.setLoading,n=e.loading,c=Object(w.a)(de),r=Object(y.a)(c,1)[0],i=Object(j.useContext)(qf),o=i.setAlert,s=i.ubicacionTurno,l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=JSON.parse(localStorage.getItem("sesionCafi")),x=JSON.parse(localStorage.getItem("turnoEnCurso")),h=ig(),_=Object(j.useState)([]),f=Object(y.a)(_,2),A=f[0],k=f[1],N=Object(j.useState)([]),P=Object(y.a)(N,2),E=P[0],D=P[1],z=Object(j.useState)(0),T=Object(y.a)(z,2),$=T[0],W=T[1],R=Object(j.useState)(0),V=Object(y.a)(R,2),M=V[0],B=V[1],U=Object(j.useState)(0),q=Object(y.a)(U,2),J=q[0],G=q[1],Y=function(e){var t=Object(m.a)(Object(m.a)({},A),{},Object(g.a)({},e.target.name,e.target.value));k(t);var a=0;for(var n in t)a+=parseFloat(t[n]);G(a)},Q=function(e){D(Object(m.a)(Object(m.a)({},E),{},Object(g.a)({},e.target.name,e.target.value)))},K={horario_en_turno:E.horario_en_turno,concepto:"CERRAR TURNO",token_turno_user:x?x.token_turno_user:"",numero_caja:x?null===x||void 0===x?void 0:x.numero_caja.toString():"",comentarios:E.comentarios,id_caja:x?x.id_caja:"",empresa:p.empresa._id,sucursal:p.sucursal._id,id_usuario:p._id,usuario_en_turno:{nombre:p.nombre,telefono:p.telefono,numero_usuario:p.numero_usuario,email:p.email},hora_entrada:{hora:"",minutos:"",segundos:"",completa:""},hora_salida:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},fecha_entrada:{year:"",mes:"",dia:"",no_semana_year:"",no_dia_year:"",completa:""},fecha_salida:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format("YYYY-MM-DD")},fecha_movimiento:Dt()().locale("es-mx").format(),montoRetiro:M,montos_en_caja:{monto_efectivo:{monto:parseFloat($),metodo_pago:"01"},monto_tarjeta_debito:{monto:parseFloat(A.monto_tarjeta_debito?A.monto_tarjeta_debito:0),metodo_pago:"28"},monto_tarjeta_credito:{monto:parseFloat(A.monto_tarjeta_credito?A.monto_tarjeta_credito:0),metodo_pago:"04"},monto_creditos:{monto:parseFloat(A.monto_creditos?A.monto_creditos:0),metodo_pago:"99"},monto_monedero:{monto:parseFloat(A.monto_puntos?A.monto_puntos:0),metodo_pago:"05"},monto_transferencia:{monto:parseFloat(A.monto_transferencia?A.monto_transferencia:0),metodo_pago:"03"},monto_cheques:{monto:parseFloat(A.monto_cheques?A.monto_cheques:0),metodo_pago:"02"},monto_vales_despensa:{monto:parseFloat(A.monto_vales_despensa?A.monto_vales_despensa:0),metodo_pago:"08"}}},X={accesos:p.accesos,email:p.email,empresa:p.empresa,estado:p.estado,exp:p.exp,iat:p.iat,imagen:p.imagen,nombre:p.nombre,numero_usuario:p.numero_usuario,sucursal:p.sucursal,telefono:p.telefono,turno_en_caja_activo:!1,_id:p._id},Z=function(t){"SESION"===t?(localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("ListaEnEspera"),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),e.history.push("/")):(localStorage.setItem("sesionCafi",JSON.stringify(X)),localStorage.removeItem("DatosVentas"),localStorage.removeItem("ListaEnEspera"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("VentaOriginal"))},te=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(!0),e.prev=1,E.horario_en_turno){e.next=9;break}return b(!0),a(!1),o({message:"Por favor elija que turno est\xe1 cerrando",status:"error",open:!0}),e.abrupt("return");case 9:return e.next=11,r({variables:{activa:!1,input:K,isOnline:!0}});case 11:o({message:"Turno cerrado",status:"success",open:!0}),Z(s),window.location.reload();case 14:e.next=21;break;case 16:e.prev=16,e.t0=e.catch(1),o({message:"Error: ".concat(e.t0.message),status:"error",open:!0}),a(!1),t();case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{mb:2,children:Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Montos a Depositar"})})}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(L.a,{className:h.titulos,children:[" ","Monto Efectivo:"]}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_efectivo",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:function(e){Y(e),W(parseFloat(e.target.value))}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:h.titulos,children:" Creditos:"}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_creditos",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:Y})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(L.a,{className:h.titulos,children:[" ","Tarjetas y Transferencias:"]}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_tarjeta_debito",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:Y})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:h.titulos,children:"Monedero:"}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_puntos",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:Y})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:h.titulos,children:"Cheques:"}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_cheques",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:Y})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{className:h.titulos,children:"Vales de despensa:"}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_vales_despensa",variant:"outlined",size:"small",inputProps:{min:0},type:"number",placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:Y})]})]}),Object(H.jsxs)(O.a,{mt:2,display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Monto total efectivo: "})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{children:["$",Ua(A.monto_efectivo)]})]}),Object(H.jsxs)(O.a,{mb:2,display:"flex",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Montos totales: "})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{children:["$",Ua(J)]})]}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,xs:12,children:[Object(H.jsxs)(L.a,{className:h.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "})," Turno:"]}),Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",error:u&&!E.horario_en_turno,children:Object(H.jsxs)(Nt.a,{onChange:Q,id:"form-producto-tipo",name:"horario_en_turno",value:E.horario_en_turno?E.horario_en_turno:"",children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Object(H.jsx)(Pt.a,{value:"MATUTINO",children:"Matutino"}),Object(H.jsx)(Pt.a,{value:"VESPERTINO",children:"Vespertino"})]})})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:6,style:{display:"none"},children:[Object(H.jsx)(L.a,{className:h.titulos,children:"Mantener en caja:"}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_reguardo",variant:"outlined",size:"small",inputProps:{min:0},type:"number",value:$,placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:function(e){var t=parseFloat(A.monto_efectivo),a=parseFloat(e.target.value),n=t-a;-1!==Math.sign(n)&&W(a)}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:6,style:{display:"none"},children:[Object(H.jsx)(L.a,{className:h.titulos,children:"Retirar de caja:"}),Object(H.jsx)(S.a,{fullWidth:!0,name:"monto_transferencia",variant:"outlined",size:"small",inputProps:{min:0},type:"number",value:M,placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},color:"primary",onChange:function(e){var t=parseFloat(A.monto_efectivo),a=parseFloat(e.target.value),n=t-a;-1!==Math.sign(n)&&B(a)}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,children:[Object(H.jsx)(L.a,{className:h.titulos,children:"Comentarios:"}),Object(H.jsx)(S.a,{fullWidth:!0,multiline:!0,onChange:Q,rows:2,size:"small",name:"comentarios",id:"form-producto-codigo-barras",variant:"outlined"})]})]})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(O.a,{display:"flex",alignItems:"flex-end",children:Object(H.jsx)(F.a,{onClick:te,variant:"contained",color:"primary",size:"large",disabled:n,startIcon:n?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Aceptar"})})})]})}));Dt.a.locale("es");var Og=Object(k.a)((function(e){return{iconSvg:{width:50}}})),xg=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function hg(){var e=Object(j.useContext)(qf),t=e.abrirTurnosDialog,a=e.setAbrirTurnosDialog,n=JSON.parse(localStorage.getItem("turnoEnCurso")),c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Og(),l=function(){a(!t)};return window.addEventListener("keydown",(function(e){e.altKey&&85===e.keyCode&&l()})),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{onClick:function(){return l()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!n,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",style:{height:"100%",width:"100%"},children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Dh,alt:"icono caja",style:{width:20}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Cerrar turno"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + U"})})})]})}),Object(H.jsxs)(qe.a,{maxWidth:"sm",fullWidth:!0,open:t,onClose:function(e,t){"backdropClick"!==t&&l()},TransitionComponent:xg,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)("img",{src:Dh,alt:"icono almacen",className:s.iconSvg}),Object(H.jsx)(O.a,{m:2,children:Object(H.jsx)(et.a,{orientation:"vertical"})}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Cerrar turno"})}),Object(H.jsxs)(O.a,{display:"flex",textAlign:"right",children:[Object(H.jsx)(O.a,{textAlign:"right",children:Object(H.jsx)(L.a,{variant:"caption",children:Dt()().locale("es-mx").format("MM/DD/YYYY")})}),Object(H.jsx)(O.a,{textAlign:"right",ml:2,children:Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsxs)("b",{children:[Dt()().locale("es-mx").format("h:mm")," hrs."]})})}),Object(H.jsx)(O.a,{textAlign:"right",ml:2,children:Object(H.jsxs)(L.a,{variant:"caption",children:[Object(H.jsx)("b",{children:"Caja: "}),null===n||void 0===n?void 0:n.numero_caja]})})]})]})]}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:l,size:"large",disabled:i,children:Object(H.jsx)(Ye.a,{})})]})}),Object(H.jsx)(mg,{setLoading:o,loading:i,handleClickOpen:l})]})]})}var _g=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.monto,n=t.turno,c=t.sesion,(r=new rf("http://localhost:8000")).setFontSize(1,1),r.setEmphasize(0),r.setAlign("center"),r.write("Punto de venta CAFI\n"),r.write("****PRE CORTE CAJA****\n"),r.feed(1),r.write("Caja ".concat(n.numero_caja,"\n")),r.write("Usuario: ".concat(c.nombre,"\n")),r.write("Fecha: ".concat(Dt()().locale("es-mx").format("DD/MM/YYYY")," Hora: ").concat(Dt()().locale("es-mx").format("LTS"),"\n")),r.feed(1),r.setFontSize(2,1),r.write("Monto total en caja\n"),r.setFontSize(2,2),r.write("$ ".concat(Ua(a),"\n")),r.setFontSize(1,1),r.feed(3),r.cut(),r.cutPartial(),e.next=23,r.end();case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(t){return e.apply(this,arguments)}}();Dt.a.locale("es");var fg=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function gg(){var e,t,a=JSON.parse(localStorage.getItem("turnoEnCurso")),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(j.useContext)(be),r=c.reloadVerPreCorte,i=c.setReloadVerPreCorte,o=c.setAbrirPanelAcceso,s=c.abrirPanelAcceso,l=c.setDepartamentos,d={horario_en_turno:"ABRIR TURNO",id_caja:a?a.id_caja:"",id_usuario:n._id,token_turno_user:a?a.token_turno_user:""},u=Object(rt.b)(Sj,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id,input:d}}),b=u.loading,p=u.error,m=u.data,x=u.refetch,h=ig(),_=Object(j.useState)(!1),f=Object(y.a)(_,2),g=f[0],A=f[1],S=Object(j.useState)(!1),k=Object(y.a)(S,2),w=k[0],N=k[1],P=function(){!0===n.accesos.ventas.pre_corte.ver?A(!g):(o(!s),l({departamento:"ventas",subDepartamento:"pre_corte",tipo_acceso:"ver"}))};if(Object(j.useEffect)((function(){!0===r&&(A(!g),i(!1))}),[r]),!m||p||b)return Object(H.jsx)(vg,{});window.addEventListener("keydown",(function(e){e.altKey&&79===e.keyCode&&(P(),x())}));var E=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),r={turno:a,sesion:n,monto:null!==m&&void 0!==m&&null!==(t=m.obtenerPreCorteCaja)&&void 0!==t&&t.monto_efectivo_precorte?null===m||void 0===m||null===(c=m.obtenerPreCorteCaja)||void 0===c?void 0:c.monto_efectivo_precorte:0},e.next=4,_g(r);case 4:N(!0),A(!g);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{onClick:function(){P(),x()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!a,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:yf,alt:"icono caja",style:{width:20}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Pre corte caja"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + O"})})})]})}),Object(H.jsxs)(qe.a,{maxWidth:"lg",open:g,onClose:function(){return A(!g)},TransitionComponent:fg,children:[Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,lg:10,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:yf,alt:"icono caja",className:h.iconSizeDialogs})}),Object(H.jsxs)(O.a,{ml:2,children:[Object(H.jsx)(O.a,{textAlign:"left",children:Object(H.jsx)(L.a,{variant:"h6",children:"Pre-Corte de Caja"})}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{textAlign:"right",children:Object(H.jsx)(L.a,{variant:"caption",children:Dt()().locale("es-mx").format("MM/DD/YYYY")})}),Object(H.jsx)(O.a,{textAlign:"right",ml:2,children:Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsxs)("b",{children:[Dt()().locale("es-mx").format("h:mm")," hrs."]})})})]})]})]})}),Object(H.jsx)(Qe.a,{item:!0,lg:2,children:Object(H.jsx)(O.a,{ml:4,display:"flex",alignItems:"center",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return A(!g)},size:"large",children:Object(H.jsx)(Ye.a,{})})})})]}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(O.a,{p:2,children:!0===n.turno_en_caja_activo&&a?Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(O.a,{children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:[Object(H.jsx)("b",{children:"Usuario: "})," ",n.nombre]})}),Object(H.jsx)(O.a,{children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:[Object(H.jsx)("b",{children:"Caja: "})," ",a?a.numero_caja:""]})}),Object(H.jsxs)(O.a,{children:[Object(H.jsx)(L.a,{variant:"subtitle1",children:Object(H.jsx)("b",{children:"Fecha y hora al precorte: "})}),Object(H.jsx)(L.a,{variant:"subtitle1",children:Dt()().locale("es-mx").format("MMMM D YYYY, h:mm:ss a")})]}),Object(H.jsxs)(O.a,{textAlign:"center",p:2,children:[Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Monto total en efectivo: "})}),Object(H.jsx)(L.a,{variant:"h3",style:{color:"green"},children:Object(H.jsxs)("b",{children:["$",null!==m&&void 0!==m&&null!==(e=m.obtenerPreCorteCaja)&&void 0!==e&&e.monto_efectivo_precorte?Ua(null===m||void 0===m||null===(t=m.obtenerPreCorteCaja)||void 0===t?void 0:t.monto_efectivo_precorte):0]})})]})]}):Object(H.jsx)(O.a,{textAlign:"center",p:2,children:Object(H.jsx)(L.a,{variant:"h6",children:Object(H.jsx)("b",{children:"Por el momento no hay un turno en sesi\xf3n"})})})})})]}),Object(H.jsx)(tt.a,{children:!0===n.turno_en_caja_activo&&a?Object(H.jsx)(F.a,{onClick:function(){return E()},color:"primary",variant:"contained",size:"large",autoFocus:!0,disabled:w,startIcon:w?Object(H.jsx)(I.a,{size:20,color:"inherit"}):Object(H.jsx)(Z_.a,{}),children:"Imprimir"}):null})]})]})}var vg=function(){return Object(H.jsx)(F.a,{style:{textTransform:"none",height:"100%",width:"100%"},disabled:!0,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:yf,alt:"icono caja",style:{width:20}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Pre corte caja"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + O"})})})]})})};function Cg(){var e=Object(j.useContext)(qf),t=e.updateTablaVentas,a=e.setUpdateTablaVentas,n=e.setDatosVentasActual,c=Object(j.useContext)(Po),r=c.updateClientVenta,i=c.setUpdateClientVenta,o=JSON.parse(localStorage.getItem("turnoEnCurso")),s=JSON.parse(localStorage.getItem("DatosVentas")),l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=function(){b(!u)},m=function(){var e=JSON.parse(localStorage.getItem("DatosVentas")),t=localStorage.getItem("ListaEnEspera");if(null!==e)if(null===t)localStorage.setItem("ListaEnEspera",JSON.stringify([{datosVenta:e,fecha:Dt()().locale("es-mx").format("MM/DD/YYYY")}])),x(),p();else{var a=JSON.parse(t);a.push({datosVenta:e,fecha:Dt()().locale("es-mx").format("MM/DD/YYYY")}),localStorage.setItem("ListaEnEspera",JSON.stringify(a)),x(),p()}},x=function(){localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),a(!t),i(!r),n({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0})};return window.addEventListener("keydown",(function(e){e.altKey&&69===e.keyCode&&m()})),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{onClick:function(){return m()},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!o||!s||s&&s.nota_credito,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.f,{style:{fontSize:25}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"En espera"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + E"})})})]})}),Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:u,autoHideDuration:3e3,onClose:p,message:"Compra agregada en espera",action:Object(H.jsx)(ce.a,{size:"small","aria-label":"close",color:"inherit",onClick:p,children:Object(H.jsx)(Gt.a,{fontSize:"small"})})})]})}Dt.a.locale("es");var yg=Object(k.a)((function(e){return{titulos:{fontWeight:500,"& .obligatorio":{color:"red"}}}}));function Ag(e){var t=e.setAbrirTallaColor,a=e.setCantidad,n=e.cantidad,c=e.obtenerConsultasProducto,r=e.refetch,i=Object(j.useContext)(Pe),o=i.datos_generales,s=i.precios,l=i.setPrecios,d=i.setDatosGenerales,u=i.validacion,b=Object(j.useContext)(Pe),p=b.unidadVentaXDefecto,x=b.setUnidadVentaXDefecto,h=b.setUnidadVentaSecundaria,_=b.unidadVentaSecundaria,f=b.update,v=function(e){"codigo_barras"===e.target.name&&x(Object(m.a)(Object(m.a)({},p),{},{codigo_barras:e.target.value})),d(Object(m.a)(Object(m.a)({},o),{},Object(g.a)({},e.target.name,e.target.value))),"CALZADO"!==e.target.value&&"ROPA"!==e.target.value||t(!0)},C=yg();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{mb:2,children:Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Informaci\xf3n General"})})}),Object(H.jsx)(et.a,{}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:3,xs:12,children:Object(H.jsxs)(ee.a,{variant:"outlined",size:"small",name:"codigo_barras",fullWidth:!0,children:[Object(H.jsx)(L.a,{className:C.titulos,children:"C\xf3digo de barras"}),Object(H.jsx)(ae.a,{disabled:f&&o.codigo_barras,style:{padding:0},id:"form-producto-codigo-barras",name:"codigo_barras",value:o.codigo_barras?o.codigo_barras:"",onChange:v,endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(F.a,{disabled:f&&o.codigo_barras,onClick:function(){return function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();d(Object(m.a)(Object(m.a)({},o),{},{codigo_barras:t})),x(Object(m.a)(Object(m.a)({},p),{},{codigo_barras:t}))}()},color:"primary",variant:"outlined",size:"large",children:"Generar"})})})]})}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:C.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Clave alterna"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:u.error&&!o.clave_alterna,name:"clave_alterna",id:"form-producto-clave-alterna",variant:"outlined",value:o.clave_alterna?o.clave_alterna:"",helperText:u.message,onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsxs)(L.a,{className:C.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Nombre comercial"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:u.error&&!o.nombre_comercial,name:"nombre_comercial",id:"form-producto-nombre-comercial",variant:"outlined",value:o.nombre_comercial?o.nombre_comercial:"",helperText:u.message,onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsx)(Qe.a,{item:!0,md:3,xs:12,children:Object(H.jsx)(qc,{refetch:r,codigos:c.codigos})}),Object(H.jsxs)(Qe.a,{item:!0,md:"OTROS"===o.tipo_producto?4:8,xs:12,children:[Object(H.jsxs)(L.a,{className:C.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Nombre gen\xe9rico"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:u.error&&!o.nombre_generico,name:"nombre_generico",id:"form-producto-nombre-generico",variant:"outlined",value:o.nombre_generico?o.nombre_generico:"",helperText:u.message,onChange:v,inputProps:{style:{textTransform:"uppercase"}}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:"OTROS"===o.tipo_producto?2:4,xs:12,children:[Object(H.jsxs)(L.a,{className:C.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Tipo de producto"]}),Object(H.jsxs)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",error:u.error&&!o.tipo_producto,children:[Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"tipo_producto",value:o.tipo_producto?o.tipo_producto:"",onChange:v,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Object(H.jsx)(Pt.a,{value:"ROPA",children:"ROPA"}),Object(H.jsx)(Pt.a,{value:"CALZADO",children:"CALZADO"}),Object(H.jsx)(Pt.a,{value:"OTROS",children:"OTROS"})]}),Object(H.jsx)(wa.a,{children:u.message})]})]}),"OTROS"===o.tipo_producto?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsxs)(L.a,{className:C.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Cantidad en Almacen"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",error:u.error&&!n,name:"cantidad",type:"number",id:"form-producto-nombre-generico",variant:"outlined",value:n||"",helperText:u.message,onChange:function(e){return a(parseInt(e.target.value))}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{className:C.titulos,children:"Granel"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{onChange:function(e){var t,a;"granel"===e.target.name&&e.target.checked?(l(Object(m.a)(Object(m.a)({},s),{},(t={},Object(g.a)(t,e.target.name,e.target.checked),Object(g.a)(t,"inventario",Object(m.a)(Object(m.a)({},s.inventario),{},{unidad_de_inventario:"Kg",codigo_unidad:"KGM"})),Object(g.a)(t,"unidad_de_compra",Object(m.a)(Object(m.a)({},s.unidad_de_compra),{},{unidad:"Kg",codigo_unidad:"KGM"})),t))),x(Object(m.a)(Object(m.a)({},p),{},{unidad:"Kg",codigo_unidad:"KGM"})),h(Object(m.a)(Object(m.a)({},_),{},{unidad:"Costal",codigo_unidad:"KGM"}))):(l(Object(m.a)(Object(m.a)({},s),{},(a={},Object(g.a)(a,e.target.name,e.target.checked),Object(g.a)(a,"inventario",Object(m.a)(Object(m.a)({},s.inventario),{},{unidad_de_inventario:"Pz",codigo_unidad:"H87"})),Object(g.a)(a,"unidad_de_compra",Object(m.a)(Object(m.a)({},s.unidad_de_compra),{},{unidad:"Pz",codigo_unidad:"H87"})),a))),x(Object(m.a)(Object(m.a)({},p),{},{unidad:"Pz",codigo_unidad:"H87"})),h(Object(m.a)(Object(m.a)({},_),{},{unidad:"Caja",codigo_unidad:"XBX"})))},name:"granel"}),label:"Vender a granel"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{className:C.titulos,children:"Medicamento"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{onChange:function(e){d(Object(m.a)(Object(m.a)({},o),{},{receta_farmacia:e.target.checked}))},name:"receta_farmacia"}),label:"Necesita receta",name:"receta_farmacia"})]})]}):null]})]})}var Sg=function(e,t){if(e.medida.talla&&t.medida.talla)return e.medida.talla.localeCompare(t.medida.talla)},Fg=Object(k.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},container:{maxHeight:"65vh"},tableRow:{"&.Mui-selected, &.Mui-selected:hover":{backgroundColor:Object(An.fade)(e.palette.primary.main,.1)}},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},colorContainer:{border:"1px solid rgba(0,0,0, .3)",height:30,width:30,borderRadius:"15%"}}}));function Ig(e){var t=e.from,a=e.setOnUpdate,n=e.onUpdate,c=Fg(),r=Object(j.useContext)(Pe).presentaciones,i=Object(Ia.a)(r).sort((function(e,t){return Sg(e,t)}));return Object(H.jsx)("div",{className:c.root,children:Object(H.jsx)(fn.a,{className:c.paper,children:Object(H.jsx)(Na.a,{className:c.container,children:Object(H.jsxs)($a.a,{className:c.table,"aria-labelledby":"tableTitle",size:"small","aria-label":"enhanced table",stickyHeader:!0,children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Existencia"}),Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{width:200,children:"Nombre"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Medida"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Color"}),Object(H.jsx)(Da.a,{children:"Precio"}),t&&"compra"===t?Object(H.jsx)(Da.a,{padding:"checkbox",children:"Existente"}):null,Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cantidad"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Editar"})]})}),Object(H.jsx)(za.a,{children:i.map((function(e,c){return Object(H.jsx)(kg,{producto:e,index:c,from:t,setOnUpdate:a,onUpdate:n},c)}))})]})})})})}var kg=function(e){var t=e.producto,a=e.index,n=e.from,c=e.setOnUpdate,r=e.onUpdate,i=Object(j.useContext)(Pe),o=i.presentaciones,s=i.setPresentaciones,l=i.preciosP,d=i.precios,u=Object(j.useState)(!0),b=Object(y.a)(u,2),p=b[0],x=b[1],h=Fg(),_=Object(j.useRef)(null),f=Object(Ia.a)(o).sort((function(e,t){return Sg(e,t)})),g=Object(m.a)({},f[a]),v=Object(m.a)({},t);n&&"compra"===n&&(v.cantidad=0);var C=function(e){var t=e.target,n=t.value,c=t.name;if(console.log(c),"cantidad"===c){if(!n)return g.cantidad="",g.existencia=!1,f.splice(a,1,g),void s(f);g.cantidad=parseFloat(n),g.existencia=!0}else if("precio"===c){var r=d.iva,i=d.ieps;if(!n)return g.precio="",f.splice(a,1,g),void s(f);var o=parseFloat(n),l=r<10?"0".concat(r):r,j=i<10?"0".concat(i):i,u=parseFloat("0.".concat(l))+parseFloat("0.".concat(j)),b=parseFloat(o/(u+1)),p=parseFloat(b*parseFloat("0.".concat(l))),m=parseFloat(b*parseFloat("0.".concat(j))),O=d.unidad_de_compra.precio_unitario_sin_impuesto,x=parseFloat((b-O)/O*100);g.precio_unidad.precio_venta=parseFloat(b.toFixed(2)),g.precio_unidad.precio_neto=parseFloat(o.toFixed(2)),g.precio_unidad.utilidad=parseFloat(x.toFixed(2)),g.precio_unidad.iva_precio=parseFloat(p.toFixed(2)),g.precio_unidad.ieps_precio=parseFloat(m.toFixed(2)),g.precio=parseFloat(n)}else{if(!n)return g.codigo_barras="",f.splice(a,1,g),void s(f);g.codigo_barras=n}f.splice(a,1,g),s(f)},A=function(){var e=1e11,t=Math.floor(9e11*Math.random()+e).toString();g.codigo_barras=t,f.splice(a,1,g),s(f)},S=function(){p?(x(!p),c([].concat(Object(Ia.a)(r),[a]))):(v.cantidad||(g.cantidad=0),v.precio||(g.precio=l[0].precio_neto),f.splice(a,1,g),s(f),x(!0),r.splice(r.length-1,1),c(Object(Ia.a)(r)))};return Object(H.jsxs)(Ea.a,{hover:!0,selected:!p,className:h.tableRow,children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(Ze.a,{checked:v.existencia,color:"primary"})}),Object(H.jsx)(Da.a,{width:220,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(_n.a,{inputRef:_,onChange:function(e){return C(e)},value:v.codigo_barras,type:"number",name:"precio",disabled:!v.nuevo||p}),v.nuevo||v.nuevo?Object(H.jsx)(ce.a,{color:"primary",size:"small",onClick:function(){return A()},children:Object(H.jsx)(Ra.a,{})}):null]})}),Object(H.jsx)(Da.a,{width:200,children:v.nombre_comercial}),Object(H.jsx)(Da.a,{padding:"checkbox",children:v.medida._id?Object(H.jsx)(gn.a,{label:v.medida.talla,color:"primary"}):""}),Object(H.jsx)(Da.a,{padding:"checkbox",children:v.color._id?Object(H.jsx)(Ta.a,{title:v.color.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:h.colorContainer,style:{backgroundColor:v.color.hex}})}):null}),Object(H.jsx)(Da.a,{width:110,children:Object(H.jsx)(_n.a,{inputRef:_,onChange:function(e){return C(e)},disabled:p,value:v.precio,type:"tel",name:"precio"})}),n&&"compra"===n?Object(H.jsx)(Da.a,{padding:"checkbox",children:t.cantidad}):null,Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(_n.a,{inputRef:_,onChange:function(e){return C(e)},disabled:p,value:v.cantidad,type:"tel",name:"cantidad"})}),Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(ce.a,{size:"small",onClick:function(){return S()},children:p?Object(H.jsx)(yn.a,{}):Object(H.jsx)(Gt.a,{})})})]})},wg=Object(k.a)((function(e){return{colorContainer:{border:"1px solid rgba(0,0,0, .3)",display:"flex",justifyContent:"center",alignItems:"center",height:50,width:50,margin:1,borderRadius:"15%",cursor:"pointer"}}})),Ng=function(){return Math.floor(9e11*Math.random()+1e11).toString()};function Pg(e){var t=e.obtenerConsultasProducto,a=e.refetch,n=(e.datos,e.from),c=Object(j.useContext)(Pe),r=c.presentaciones,i=c.datos_generales,o=t.colores,s=t.tallas,l=t.calzados,d=Object(j.useState)([]),u=Object(y.a)(d,2),b=u[0],p=u[1],m=Object(j.useState)([]),x=Object(y.a)(m,2),h=x[0],_=x[1],f="ROPA"===i.tipo_producto?Object(Ia.a)(s):Object(Ia.a)(l),g=Object(j.useState)([]),v=Object(y.a)(g,2),C=v[0],A=v[1],S=Object(j.useCallback)((function(){var e=[],t=[];Object(Ia.a)(r).forEach((function(a){a.color._id&&e.push(a.color),a.medida._id&&t.push(a.medida)}));var a={},n={},c=e.filter((function(e){var t=!a[e._id];return a[e._id]=!0,t})),i=t.filter((function(e){var t=!n[e._id];return n[e._id]=!0,t}));_(Object(Ia.a)(c)),p(Object(Ia.a)(i))}),[r]);return Object(j.useEffect)((function(){S()}),[S]),Object(H.jsx)("div",{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:9,children:Object(H.jsx)(Ig,{from:n,setOnUpdate:A,onUpdate:C})}),Object(H.jsxs)(Qe.a,{item:!0,md:3,children:[Object(H.jsxs)(O.a,{width:"100%",my:2,style:C.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsx)(L.a,{children:"ROPA"===i.tipo_producto?"Talla":"N\xfamero"}),Object(H.jsx)(Oc,{setMedidasSeleccionadas:p,refetch:a}),Object(H.jsx)(Qe.a,{container:!0,children:f.map((function(e,t){return Object(H.jsx)(Eg,{talla:e,coloresSeleccionados:h,medidasSeleccionadas:b,setMedidasSeleccionadas:p},t)}))})]}),Object(H.jsx)(et.a,{}),Object(H.jsxs)(O.a,{width:"100%",mt:1,style:C.length>0?{pointerEvents:"none",opacity:.4}:null,children:[Object(H.jsx)(L.a,{children:"Color"}),Object(H.jsx)(jc,{refetch:a}),Object(H.jsx)(Qe.a,{container:!0,children:o.map((function(e,t){return Object(H.jsx)(Dg,{color:e,coloresSeleccionados:h,setColoresSeleccionados:_,medidasSeleccionadas:b},t)}))})]})]})]})})}var Eg=function(e){var t=e.talla,a=e.coloresSeleccionados,n=e.medidasSeleccionadas,c=e.setMedidasSeleccionadas,r=wg(),i=Object($e.a)(),o=Object(j.useContext)(Pe),s=o.setPresentaciones,l=o.presentaciones,d=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=Object(j.useState)(!1),x=Object(y.a)(O,2),h=x[0],_=x[1];return Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)("div",{className:r.colorContainer,onClick:function(){return function(e){var r=Object(Ia.a)(n);h?r.forEach((function(a,n){a._id===t._id&&(r.splice(n,1),_(e),l.forEach((function(e){e.nuevo||e.medida._id===a._id&&m([].concat(Object(Ia.a)(p),[e]))})))})):(r.push(t),_(e));var i=[],o=Object(Ia.a)(l),j=b.iva,O=b.ieps;if(a.length||o.length){if(!a.length&&o.length>0)for(var x=function(e){var t=r[e],a=o.filter((function(e){return e.medida._id===t._id})),n=j<10?"0".concat(j):j,c=O<10?"0".concat(O):O,s=parseFloat(u[0].precio_venta*parseFloat("0.".concat(n))),l=parseFloat(u[0].precio_venta*parseFloat("0.".concat(c)));a.length?i.push(a[0]):i.push({_id:"",existencia:!1,codigo_barras:Ng(),nombre_comercial:d.nombre_comercial,medida:t,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(s.toFixed(2)),ieps_precio:parseFloat(l.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},f=0;f<r.length;f++)x(f);else if(a.length>0&&1===r.length&&e)for(var g=0;g<o.length;g++)for(var v=0;v<r.length;v++)i.push({_id:"",existencia:o[g].existencia,codigo_barras:o[g].codigo_barras,nombre_comercial:o[g].nombre_comercial,medida:r[v],color:o[g].color,precio:o[g].precio,cantidad:o[g].cantidad,nuevo:!0,precio_unidad:o[g].precio_unidad});else if(a.length>0&&r.length>0)for(var C=function(e){for(var t=r[e],n=function(e){var n=a[e],c=o.filter((function(e){return e.medida._id===t._id&&n._id===e.color._id})),r=j<10?"0".concat(j):j,s=O<10?"0".concat(O):O,l=parseFloat(u[0].precio_venta*parseFloat("0.".concat(r))),b=parseFloat(u[0].precio_venta*parseFloat("0.".concat(s)));c.length?i.push(c[0]):i.push({_id:"",existencia:!1,codigo_barras:Ng(),nombre_comercial:d.nombre_comercial,medida:t,color:n,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(l.toFixed(2)),ieps_precio:parseFloat(b.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},c=0;c<a.length;c++)n(c)},y=0;y<r.length;y++)C(y);else if(a.length>0&&!r.length&&o.filter((function(e){return e.medida._id})).length)for(var A=0;A<o.length;A++){var S=o[A];i.push({_id:S._id,existencia:S.existencia,codigo_barras:S.codigo_barras,nombre_comercial:S.nombre_comercial,medida:{},color:S.color,precio:S.precio,cantidad:S.cantidad,nuevo:!0,precio_unidad:S.precio_unidad})}}else for(var F=0;F<r.length;F++){var I=r[F],k=j<10?"0".concat(j):j,w=O<10?"0".concat(O):O,N=parseFloat(u[0].precio_venta*parseFloat("0.".concat(k))),P=parseFloat(u[0].precio_venta*parseFloat("0.".concat(w)));i.push({_id:"",existencia:!1,codigo_barras:Ng(),nombre_comercial:d.nombre_comercial,medida:I,color:{nombre:"",hex:""},precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(N.toFixed(2)),ieps_precio:parseFloat(P.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})}c(Object(Ia.a)(r)),s(i)}(!h)},style:h?{backgroundColor:i.palette.primary.main}:null,children:Object(H.jsx)(L.a,{variant:"button",style:{color:i.palette.getContrastText(h?i.palette.primary.main:"#FFFFFF"),fontSize:16},children:t.talla})})})},Dg=function(e){var t=e.color,a=e.coloresSeleccionados,n=e.setColoresSeleccionados,c=e.medidasSeleccionadas,r=(e.datos,wg()),i=Object($e.a)(),o=Object(j.useContext)(Pe),s=o.presentaciones,l=o.setPresentaciones,d=o.datos_generales,u=o.preciosP,b=o.precios,p=o.presentaciones_eliminadas,m=o.setPresentacionesEliminadas,O=Object(j.useState)(!1),x=Object(y.a)(O,2),h=x[0],_=x[1];return Object(H.jsx)(Qe.a,{item:!0,children:Object(H.jsx)(Ta.a,{title:t.nombre,placement:"top",arrow:!0,TransitionComponent:vn.a,children:Object(H.jsx)("div",{className:r.colorContainer,style:{backgroundColor:t.hex,color:i.palette.getContrastText(t.hex)},onClick:function(){return function(e){h?a.forEach((function(n,c){n._id===t._id&&(a.splice(c,1),_(e),s.forEach((function(e){e.nuevo||e.color._id===n._id&&m([].concat(Object(Ia.a)(p),[e]))})))})):(a.push(t),_(e));var r=[],i=Object(Ia.a)(s),o=b.iva,j=b.ieps;if(c.length||i.length){if(!c.length&&i.length>0)for(var O=function(e){var t=a[e],n=i.filter((function(e){return e.color._id===t._id})),c=o<10?"0".concat(o):o,s=j<10?"0".concat(j):j,l=parseFloat(u[0].precio_venta*parseFloat("0.".concat(c))),b=parseFloat(u[0].precio_venta*parseFloat("0.".concat(s)));n.length?r.push(n[0]):r.push({_id:"",existencia:!1,codigo_barras:Ng(),nombre_comercial:d.nombre_comercial,medida:{},color:t,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(l.toFixed(2)),ieps_precio:parseFloat(b.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},x=0;x<a.length;x++)O(x);else if(c.length>0&&1===a.length&&e)for(var f=0;f<i.length;f++)for(var g=0;g<a.length;g++)r.push({_id:"",existencia:i[f].existencia,codigo_barras:i[f].codigo_barras,nombre_comercial:i[f].nombre_comercial,medida:i[f].medida,color:a[g],precio:i[f].precio,cantidad:i[f].cantidad,nuevo:!0,precio_unidad:i[f].precio_unidad});else if(c.length>0&&a.length>0)for(var v=function(e){for(var t=a[e],n=function(e){var a=c[e],n=i.filter((function(e){return e.medida._id===a._id&&t._id===e.color._id})),s=o<10?"0".concat(o):o,l=j<10?"0".concat(j):j,b=parseFloat(u[0].precio_venta*parseFloat("0.".concat(s))),p=parseFloat(u[0].precio_venta*parseFloat("0.".concat(l)));n.length?r.push(n[0]):r.push({_id:"",existencia:!1,codigo_barras:Ng(),nombre_comercial:d.nombre_comercial,medida:a,color:t,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(b.toFixed(2)),ieps_precio:parseFloat(p.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})},s=0;s<c.length;s++)n(s)},C=0;C<a.length;C++)v(C);else if(c.length>0&&!a.length&&i.filter((function(e){return e.color._id})).length)for(var y=0;y<i.length;y++){var A=i[y];r.push({_id:A._id,existencia:A.existencia,codigo_barras:A.codigo_barras,nombre_comercial:A.nombre_comercial,medida:A.medida,color:{nombre:"",hex:""},precio:A.precio,cantidad:A.cantidad,nuevo:!0,precio_unidad:A.precio_unidad})}}else for(var S=0;S<a.length;S++){var F=a[S],I=o<10?"0".concat(o):o,k=j<10?"0".concat(j):j,w=parseFloat(u[0].precio_venta*parseFloat("0.".concat(I))),N=parseFloat(u[0].precio_venta*parseFloat("0.".concat(k)));r.push({_id:"",existencia:!1,codigo_barras:Ng(),nombre_comercial:d.nombre_comercial,medida:{},color:F,precio:u[0].precio_neto,cantidad:0,nuevo:!0,precio_unidad:{numero_precio:1,precio_venta:u[0].precio_venta,precio_neto:u[0].precio_neto,unidad_mayoreo:0,iva_precio:parseFloat(w.toFixed(2)),ieps_precio:parseFloat(N.toFixed(2)),utilidad:u[0].utilidad,unidad_maxima:!1}})}n(Object(Ia.a)(a)),l(r)}(!h)},children:h?Object(H.jsx)(Yt.a,{}):null})})})},zg=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),Tg=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px")},"& .obligatorio":{color:"red"},paddingTop:0,alignItems:"center",justifyItems:"center"}}}));function $g(){var e=Tg(),t=Object(Fo.a)(),a=Object(j.useContext)(qf).setAlert,n=Object(j.useContext)(be),c=n.departamentos,r=n.abrirPanelAcceso,i=n.setAbrirPanelAcceso,o=n.setReloadProductoRapido,s=n.setReloadAdministrador,l=n.setReloadCancelarVenta,d=n.setReloadVerPrecios,u=n.setReloadVerPreCorte,b=n.setReloadEliminarVentaEspera,p=n.setReloadCrearCotizacion,x=Object(j.useState)([]),h=Object(y.a)(x,2),_=h[0],f=h[1],A=Object(j.useState)(!1),I=Object(y.a)(A,2),k=I[0],w=I[1],N=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f([]),i(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(e){f(Object(m.a)(Object(m.a)({},_),{},Object(g.a)({},e.target.name,e.target.value)))},E={numero_usuario:parseInt(_.numero_usuario),password:_.password,departamento:c.departamento,subDepartamento:c.subDepartamento,tipo_acceso:c.tipo_acceso},D=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w(!0),e.next=4,t.query({query:W,variables:{input:E},fetchPolicy:"network-only"});case 4:n=e.sent,console.log(n),!0===n.data.obtenerAccesoPermiso.permiso_concedido&&(z(n.data.obtenerAccesoPermiso.subDepartamento),a({message:"Permiso Autorizado",status:"success",open:!0}),f([]),i(!1),w(!1)),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),w(!1),e.t0.message&&a({message:e.t0.message,status:"error",open:!0});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),z=function(e){switch(e){case"administrador":s(!0);break;case"producto_rapido":o(!0);break;case"cancelar_venta":l(!0);break;case"precios_productos":d(!0);break;case"pre_corte":u(!0);break;case"cotizaciones":p(!0);break;case"eliminar_ventas":b(!0);break;default:a({message:"Permiso no autorizado",status:"error",open:!0})}};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(qe.a,{maxWidth:"xs",open:r,onClose:N,TransitionComponent:zg,children:[Object(H.jsx)(st,{loading:k}),Object(H.jsxs)(O.a,{p:3,children:[Object(H.jsxs)(O.a,{display:"flex",p:1,children:[Object(H.jsx)(O.a,{flexGrow:1,children:Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Por favor autoriza con tu usuario y contrase\xf1a"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return N()},size:"medium",children:Object(H.jsx)(Ye.a,{})})})]}),Object(H.jsx)("div",{className:e.formInputFlex,children:Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Numero Usuario:"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,name:"numero_usuario",size:"small",variant:"outlined",onChange:P})})]})}),Object(H.jsx)("div",{className:e.formInputFlex,children:Object(H.jsxs)(O.a,{width:"100%",children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Contrasena:"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",type:"password",name:"password",variant:"outlined",onChange:P})})]})})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{color:"primary",size:"medium",variant:"contained",onClick:function(){return D()},children:"Guardar"})})]})})}var Wg=a.p+"static/media/tiempo-rapido.ed3208bb.svg",Rg=["children","value","index"];function Vg(e){var t=e.children,a=e.value,n=e.index,c=Object(De.a)(e,Rg);return Object(H.jsx)("div",Object(m.a)(Object(m.a)({role:"tabpanel",hidden:a!==n,id:"tabpanel-reg-product-".concat(n),"aria-labelledby":"reg-product-tab-".concat(n)},c),{},{children:a===n&&Object(H.jsx)(O.a,{p:3,height:"70vh",children:t})}))}function Mg(e){return{id:"reg-product-tab-".concat(e),"aria-controls":"tabpanel-reg-product-".concat(e)}}var Lg=Object(k.a)((function(e){return{formInputFlex:{display:"flex","& > *":{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")}},iconSizeDialogs:{width:80},formInput:{margin:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},root:{flexGrow:1,width:"100%",backgroundColor:e.palette.background.paper},iconSvg:{width:50},dialogContent:{padding:0},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},iconSizeSecondSuperior:{width:20}}})),Bg=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Ug(){var e=Lg(),t=Object(j.useState)(0),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useContext)(Pe),d=l.datos_generales,u=l.setDatosGenerales,b=l.precios,p=l.setPrecios,x=l.validacion,h=l.setValidacion,_=l.setPreciosP,f=l.preciosP,g=l.setUnidadesVenta,A=l.unidadVentaXDefecto,S=l.setUnidadVentaXDefecto,k=l.unidadVentaSecundaria,N=l.setUnidadVentaSecundaria,P=l.setCentroDeCostos,E=l.presentaciones,D=l.setPresentaciones,z=Object(j.useContext)(qf),T=z.setAlert,$=z.open,W=z.setOpen,R=z.updateTablaVentas,V=z.setUpdateTablaVentas,M=Object(j.useContext)(be),B=M.reloadProductoRapido,U=M.setReloadProductoRapido,q=M.setAbrirPanelAcceso,J=M.setDepartamentos,G=JSON.parse(localStorage.getItem("sesionCafi")),Y=JSON.parse(localStorage.getItem("turnoEnCurso")),Q=JSON.parse(localStorage.getItem("DatosVentas")),K=Object(w.a)(rc),X=Object(y.a)(K,1)[0],Z=Object(rt.b)(Xn,{variables:{empresa:G.empresa._id,sucursal:G.sucursal._id}}),ee=Z.data,te=Z.refetch,ae=Z.loading,ne=Z.error,ce=function(){u(Oe),p(xe),S(he),N(_e),_(fe),g([]),P({}),h({error:!1,message:""}),D([]),c(0)},re=Object(j.useState)(!1),ie=Object(y.a)(re,2),oe=ie[0],se=ie[1],le=Object(j.useState)(0),de=Object(y.a)(le,2),je=de[0],ue=de[1],pe=function(){W(!$),ce(),se(!1)},me=function(){!0===G.accesos.ventas.producto_rapido.ver?pe():(q(!0),J({departamento:"ventas",subDepartamento:"producto_rapido",tipo_acceso:"ver"}))};if(Object(j.useEffect)((function(){!0===B&&(pe(),U(!1))}),[B]),Object(j.useEffect)((function(){return function(){te()}}),[]),window.addEventListener("keydown",(function(e){e.altKey&&82===e.keyCode&&me()})),ae|!ee||ne)return Object(H.jsx)(F.a,{disabled:!0,value:"articulo-rapido",style:{textTransform:"none",height:"100%",width:"100%",pointerEvents:"none",opacity:.5},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Wg,alt:"icono caja2",className:e.iconSizeSecondSuperior})}),Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Producto Rapido"})}),Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + R"})})]})});var ge=ee.obtenerConsultasProducto,ve=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a,n,c;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(!0),!("OTROS"===d.tipo_producto&&je<1)){e.next=5;break}return e.abrupt("return",h(!0));case 5:if(d.clave_alterna&&d.tipo_producto&&d.nombre_generico&&d.nombre_comercial&&b.precio_de_compra.precio_con_impuesto&&b.precio_de_compra.precio_sin_impuesto&&b.unidad_de_compra.cantidad){e.next=7;break}return e.abrupt("return",h(!0));case 7:return t=[Object(m.a)({},A),Object(m.a)({},k)],b.precios_producto=f,"OTROS"===d.tipo_producto&&je<1&&(D(Ne),ue(0)),e.next=12,bo(d,"datos_generales");case 12:return e.t0=e.sent,e.t1=b,e.next=16,bo(t,"unidades_de_venta");case 16:return e.t2=e.sent,e.t3=E,e.t4=je,e.t5=G.empresa._id,e.t6=G.sucursal._id,e.t7=G._id,a={datos_generales:e.t0,precios:e.t1,unidades_de_venta:e.t2,presentaciones:e.t3,cantidad:e.t4,empresa:e.t5,sucursal:e.t6,usuario:e.t7},e.prev=23,n=qa(a),e.next=27,X({variables:{input:n}});case 27:c=e.sent,ce(),te(),V(!R),T({message:"\xa1Listo ".concat(c.data.crearProductoRapido.message,"!"),status:"success",open:!0}),s(!1),pe(),e.next=45;break;case 36:e.prev=36,e.t8=e.catch(23),ce(),te(),T({message:"Error: ".concat(e.t8.message),status:"error",open:!0}),s(!1),pe(),console.log(e.t8),e.t8.networkError?console.log(e.t8.networkError.result):e.t8.graphQLErrors&&console.log(e.t8.graphQLErrors);case 45:case"end":return e.stop()}}),e,null,[[23,36]])})));return function(){return e.apply(this,arguments)}}(),Ce=Object(H.jsx)(F.a,{variant:"contained",color:"primary",onClick:function(){return ve()},size:"large",startIcon:Object(H.jsx)(hn.a,{}),disabled:"OTROS"===d.tipo_producto?!(d.clave_alterna&&d.tipo_producto&&d.nombre_generico&&d.nombre_comercial&&je&&b.precio_de_compra.precio_con_impuesto&&b.precio_de_compra.precio_sin_impuesto&&b.unidad_de_compra.cantidad):!(d.clave_alterna&&d.tipo_producto&&d.nombre_generico&&d.nombre_comercial&&b.precio_de_compra.precio_con_impuesto&&b.precio_de_compra.precio_sin_impuesto&&b.unidad_de_compra.cantidad),children:"Guardar"}),ye=function(){return 1===n?Ce:"OTROS"!==d.tipo_producto&&d.tipo_producto?Object(H.jsx)(F.a,{variant:"contained",color:"primary",onClick:function(){return c(n+1)},size:"large",endIcon:Object(H.jsx)(jo.a,{}),disableElevation:!0,children:"Siguiente"}):Ce};return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)($g,{}),Object(H.jsx)(F.a,{onClick:function(){me()},value:"articulo-rapido",style:{textTransform:"none",height:"100%",width:"100%"},disabled:!Y||Q&&Q.nota_credito,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)("img",{src:Wg,alt:"icono caja2",className:e.iconSizeSecondSuperior})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Producto Rapido"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + R"})})})]})}),Object(H.jsxs)(qe.a,{maxWidth:"lg",open:$,onClose:function(e,t){"backdropClick"!==t&&pe()},TransitionComponent:Bg,children:[Object(H.jsx)(Re.a,{position:"static",color:"default",elevation:0,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(O.a,{display:"flex",flexGrow:1,justifyContent:"space-between",children:Object(H.jsxs)(Ve.a,{value:n,onChange:function(e,t){c(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary","aria-label":"scrollable force tabs example",children:[Object(H.jsx)(Me.a,Object(m.a)({label:"Datos generales",icon:Object(H.jsx)(Sc.a,{color:"secondary",badgeContent:Object(H.jsx)(L.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!x.error||!x.vista1,children:Object(H.jsx)("img",{src:po,alt:"icono registro",className:e.iconSvg})})},Mg(0))),!1===oe||"OTROS"===d.tipo_producto?null:Object(H.jsx)(Me.a,Object(m.a)({label:"Tallas y colores",icon:Object(H.jsx)(Sc.a,{color:"secondary",badgeContent:Object(H.jsx)(L.a,{variant:"h6",children:"!"}),anchorOrigin:{vertical:"bottom",horizontal:"right"},invisible:!x.error||!x.vista7,children:Object(H.jsx)("img",{src:ho,alt:"icono colores",className:e.iconSvg})})},Mg(6)))]})}),Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){pe(),ce()},size:"large",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsxs)(He.a,{className:e.dialogContent,children:[Object(H.jsx)(it.a,{className:e.backdrop,open:o,children:Object(H.jsx)(I.a,{color:"inherit"})}),Object(H.jsxs)("div",{className:e.root,children:[Object(H.jsxs)(Vg,{value:n,index:0,children:[Object(H.jsx)(Ag,{setAbrirTallaColor:se,setCantidad:ue,cantidad:je,obtenerConsultasProducto:ge,refetch:te}),Object(H.jsx)(un,{})]}),Object(H.jsx)(Vg,{value:n,index:1,children:Object(H.jsx)(Pg,{obtenerConsultasProducto:ge,refetch:te})})]})]}),Object(H.jsxs)(tt.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(H.jsx)(O.a,{p:1,children:Object(H.jsx)(F.a,{variant:"outlined",color:"primary",onClick:function(){return c(n-1)},size:"large",startIcon:Object(H.jsx)(uo.a,{}),disabled:0===n,children:"Anterior"})}),Object(H.jsx)(O.a,{p:1,children:Object(H.jsx)(ye,{})})]})]})]})}function qg(e){var t=e.handleClickOpen;return Object(H.jsx)(Ee,{children:Object(H.jsx)(Ug,{handleClickOpen:t})})}var Jg,Hg,Gg=a.p+"static/media/lista-de-espera.e4c7510d.svg",Yg=a(270),Qg=a.n(Yg),Kg=Object(P.d)(Jg||(Jg=Object(N.a)(["\n  mutation crearCotizacion(\n    $input: CrearVentasInput!\n    $empresa: ID!\n    $sucursal: ID!\n    $usuario: ID!\n    $caja: ID!\n  ) {\n    crearCotizacion(\n      input: $input\n      empresa: $empresa\n      sucursal: $sucursal\n      usuario: $usuario\n      caja: $caja\n    ) {\n      message\n    }\n  }\n"]))),Xg=Object(P.d)(Hg||(Hg=Object(N.a)(["\n  query obtenerCotizaciones($empresa: ID!, $sucursal: ID!) {\n    obtenerCotizaciones(empresa: $empresa, sucursal: $sucursal) {\n      _id\n      folio\n      descuento\n      ieps\n      impuestos\n      iva\n      monedero\n      subTotal\n      total\n      venta_cliente\n      credito\n      descuento_general {\n        cantidad_descontado\n        porciento\n        precio_con_descuento\n      }\n      descuento_general_activo\n      dias_de_credito_venta\n      fecha_de_vencimiento_credito\n      fecha_vencimiento_cotizacion\n      cliente {\n        _id\n        numero_cliente\n        clave_cliente\n        nombre_cliente\n        rfc\n        telefono\n        celular\n        email\n        razon_social\n      }\n      productos {\n        _id\n         inventario_general {\n            cantidad_existente\n            unidad_inventario\n            codigo_unidad\n            cantidad_existente_maxima\n            unidad_maxima\n            id_almacen_general\n          }\n        iva_total_producto\n        ieps_total_producto\n        impuestos_total_producto\n        subtotal_total_producto\n        total_total_producto  \n        id_producto {\n          _id\n          datos_generales {\n            codigo_barras\n            clave_alterna\n            tipo_producto\n            nombre_comercial\n            nombre_generico\n            descripcion\n            id_categoria\n            categoria\n            subcategoria\n            id_subcategoria\n            id_departamento\n            departamento\n            id_marca\n            marca\n            clave_producto_sat {\n              Name\n              Value\n            }\n            receta_farmacia\n          }\n         \n          precios {\n            ieps\n            ieps_activo\n            inventario {\n              inventario_minimo\n              inventario_maximo\n              unidad_de_inventario\n              codigo_unidad\n            }\n            iva\n            iva_activo\n            monedero\n            monedero_electronico\n            precio_de_compra {\n              precio_con_impuesto\n              precio_sin_impuesto\n              iva\n              ieps\n            }\n            precios_producto {\n              numero_precio\n              precio_neto\n              precio_venta\n              iva_precio\n              ieps_precio\n              unidad_mayoreo\n              utilidad\n              precio_general\n              cantidad_unidad\n              unidad_maxima\n            }\n            unidad_de_compra {\n              cantidad\n              precio_unitario_con_impuesto\n              precio_unitario_sin_impuesto\n              unidad\n              codigo_unidad\n            }\n           \n          }\n          imagenes {\n            url_imagen\n            location_imagen\n            key_imagen\n            extencion_imagen\n          }\n        \n         \n          \n         \n          \n        }\n        concepto\n        cantidad\n        medida {\n          _id\n          talla\n          tipo\n        }\n        color {\n          _id\n          nombre\n          hex\n        }\n        cantidad_venta\n        granel_producto {\n          granel\n          valor\n        }\n        precio\n        precio_a_vender\n        precio_actual_producto\n        default\n        unidad\n        codigo_unidad\n        \n        precio_unidad {\n          numero_precio\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          unidad_mayoreo\n          utilidad\n          precio_general\n          cantidad_unidad\n          unidad_maxima\n        }\n        precio_actual_object {\n          cantidad_unidad\n          numero_precio\n          unidad_maxima\n          unidad_mayoreo\n          precio_general\n          precio_neto\n          precio_venta\n          iva_precio\n          ieps_precio\n          utilidad\n          porciento\n          dinero_descontado\n        }\n      \n      }\n      id_caja{\n        _id\n        numero_caja\n        activa\n      }\n      usuario{\n        _id\n        numero_usuario\n        nombre\n      }\n      year_registro\n      numero_semana_year\n      numero_mes_year\n      fecha_registro\n  \n    }\n  }\n"]))),Zg=a(178),ev=a.n(Zg),tv=a(179),av=a.n(tv),nv=a(180),cv=a.n(nv),rv=a(485),iv=a.n(rv),ov=Object(k.a)((function(e){return{root:{zIndex:9999,position:"absolute",width:"250mm",minHeight:"210mm",backgroundPosition:"center",backgroundSize:"cover"},nombre:{marginTop:e.spacing(54),marginLeft:e.spacing(61)},textoSecundario:{marginTop:e.spacing(2),marginLeft:e.spacing(55),width:600},firma:{marginTop:e.spacing(12),marginLeft:e.spacing(76)},intructor:{marginTop:e.spacing(1),marginLeft:e.spacing(85)},codigo:{marginTop:e.spacing(1),marginLeft:e.spacing(126)}}}));function sv(e){var t=Object(j.useState)(e.cotizacion),a=Object(y.a)(t,2),n=a[0],c=(a[1],Object(j.useState)(!1)),r=Object(y.a)(c,2),i=r[0],o=r[1],s=ov();Object(j.useEffect)((function(){i&&l()}),[i]);var l=function(){var e=document.getElementById("divInformation");o(!1);var t=new S_.jsPDF("p","mm","letter");A_()(e).then((function(e){var a=e.toDataURL("image/png"),c=t.getImageProperties(a),r=t.internal.pageSize.getWidth()-5,i=c.height*r/c.width;t.addImage(a,"JPEG",2,5,r,i),t.addPage(),t.save("cotizacion"+n.folio+".pdf")}))};return Object(H.jsxs)(O.a,{mt:1,children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",m:1,mb:0,children:Object(H.jsx)(F.a,{variant:"outlined",color:"primary",onClick:function(){return o(!0)},startIcon:Object(H.jsx)(iv.a,{}),children:"Descargar PDF"})}),Object(H.jsx)(A.a,{children:i?Object(H.jsx)("div",{children:Object(H.jsx)(lv,{cotizacion:n,classes:s})}):Object(H.jsx)("div",{})})]})}var lv=function(e){var t=e.cotizacion,a=e.classes;return Object(H.jsxs)("div",{id:"divInformation",className:a.root,children:[Object(H.jsx)(O.a,{style:{display:"flex",justifyContent:"space-between"},children:Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{align:"right",children:[Object(H.jsx)("b",{children:"Folio:"})," ".concat(t.folio)]}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Fecha:"})," ".concat(Ba(t.fecha_registro))]})]})}),t.cliente?Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(ev.a,{size:12})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{size:18,children:"Cliente"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Numero de Cliente"}),Object(H.jsx)(Da.a,{children:"Nombre"}),Object(H.jsx)(Da.a,{children:"Clave"}),Object(H.jsx)(Da.a,{children:"Telefono"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.cliente.numero_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.nombre_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.clave_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.telefono})]})})]})})})})]}):null,Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(av.a,{size:12})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{size:18,children:"Venta"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Venta Cr\xe9dito"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Monedero"}),Object(H.jsx)(Da.a,{children:"IVA"}),Object(H.jsx)(Da.a,{children:"IEPS"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.credito?"SI":"NO"}),Object(H.jsxs)(Da.a,{children:["$",t.descuento?Ua(t.descuento):0]}),Object(H.jsxs)(Da.a,{children:["$",t.monedero?Ua(t.monedero):0]}),Object(H.jsxs)(Da.a,{children:["$",t.iva?Ua(t.iva):0]}),Object(H.jsxs)(Da.a,{children:["$",t.ieps?Ua(t.ieps):0]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.subTotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.impuestos)]}),Object(H.jsx)(Da.a,{children:Ua(t.total)})]})})]})})})})]}),Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(cv.a,{size:12})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{size:18,children:"Art\xedculos"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Producto"}),Object(H.jsx)(Da.a,{children:"Cant."}),Object(H.jsx)(Da.a,{children:"Precio"}),Object(H.jsx)(Da.a,{children:"Desc."}),Object(H.jsx)(Da.a,{children:"IVA"}),Object(H.jsx)(Da.a,{children:"IEPS"}),Object(H.jsx)(Da.a,{children:"SubTotal."}),Object(H.jsx)(Da.a,{children:"Impues."}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:t.productos.map((function(e,a){return Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:e.id_producto.datos_generales.nombre_comercial}),Object(H.jsx)(Da.a,{children:e.cantidad_venta}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.precio_a_vender)]}),Object(H.jsx)(dv,{producto:t}),Object(H.jsxs)(Da.a,{children:["$",e.iva_total_producto?Ua(e.iva_total_producto):"0.00"]}),Object(H.jsxs)(Da.a,{children:["$",e.ieps_total_producto?Ua(e.ieps_total_producto):"0.00"]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.subtotal_total_producto)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.impuestos_total_producto)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.total_total_producto)]})]},a)}))})]})})})})]})]})},dv=function(e){var t=e.producto;if(!0===t.descuento_general_activo){var a=t.descuento_general,n=a.dinero_descontado,c=a.porciento;return Object(H.jsx)(Da.a,{children:"$".concat(Ua(n)," - %").concat(c)})}return Object(H.jsx)(Da.a,{children:"$0.00"})},jv=Object(k.a)((function(e){return{colorContainer:{height:28,width:28,borderRadius:"15%",fontSize:18,display:"flex",justifyContent:"center",alignItems:"center"}}})),uv=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function bv(e){var t=e.venta,a=e.open,n=e.handleClose;e.refetch;return t?(console.log(t),Object(H.jsxs)(qe.a,{open:a,TransitionComponent:uv,keepMounted:!0,onClose:n,fullWidth:!0,maxWidth:"xl",children:[Object(H.jsxs)(Bt.a,{children:[Object(H.jsxs)(O.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Caja: "})," ".concat(t.id_caja.numero_caja)]}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Usuario en caja:"})," "," ".concat(t.usuario.nombre)]})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{align:"right",children:[Object(H.jsx)("b",{children:"Folio:"})," ".concat(t.folio)]}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Fecha:"})," ".concat(Ba(t.fecha_registro))]})]})]}),Object(H.jsx)(O.a,{style:{display:"flex",justifyContent:"flex-end"},children:Object(H.jsx)(sv,{isIcon:!1,cotizacion:t})})]}),Object(H.jsxs)(He.a,{children:[t.cliente?Object(H.jsxs)(O.a,{my:1,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(ev.a,{})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Cliente"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Numero de Cliente"}),Object(H.jsx)(Da.a,{children:"Nombre"}),Object(H.jsx)(Da.a,{children:"Clave"}),Object(H.jsx)(Da.a,{children:"Telefono"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.cliente.numero_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.nombre_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.clave_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.telefono})]})})]})})})})]}):null,Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(av.a,{})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Venta"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Venta Cr\xe9dito"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Monedero"}),Object(H.jsx)(Da.a,{children:"IVA"}),Object(H.jsx)(Da.a,{children:"IEPS"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.credito?"SI":"NO"}),Object(H.jsxs)(Da.a,{children:["$",t.descuento?Ua(t.descuento):0]}),Object(H.jsxs)(Da.a,{children:["$",t.monedero?Ua(t.monedero):0]}),Object(H.jsxs)(Da.a,{children:["$",t.iva?Ua(t.iva):0]}),Object(H.jsxs)(Da.a,{children:["$",t.ieps?Ua(t.ieps):0]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.subTotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.impuestos)]}),Object(H.jsx)(Da.a,{children:Ua(t.total)})]})})]})})})})]}),Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(cv.a,{})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Art\xedculos"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{children:"Producto"}),Object(H.jsx)(Da.a,{children:"Medida"}),Object(H.jsx)(Da.a,{children:"Unidad"}),Object(H.jsx)(Da.a,{children:"Cantidad"}),Object(H.jsx)(Da.a,{children:"Precio"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"IVA"}),Object(H.jsx)(Da.a,{children:"IEPS"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:t.productos.map((function(e,a){return Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:e.id_producto.datos_generales.codigo_barras}),Object(H.jsx)(Da.a,{children:e.id_producto.datos_generales.nombre_comercial}),Object(H.jsx)(pv,{producto:e}),Object(H.jsx)(Da.a,{children:e.unidad}),Object(H.jsx)(Da.a,{children:e.cantidad_venta}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.precio_a_vender)]}),Object(H.jsx)(mv,{producto:t}),Object(H.jsxs)(Da.a,{children:["$",e.iva_total_producto?Ua(e.iva_total_producto):"0.00"]}),Object(H.jsxs)(Da.a,{children:["$",e.ieps_total_producto?Ua(e.ieps_total_producto):"0.00"]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.subtotal_total_producto)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.impuestos_total_producto)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.total_total_producto)]})]},a)}))})]})})})})]})]})]})):null}var pv=function(e){var t=e.producto,a=jv(),n=Object($e.a)();return t.color.nombre&&t.medida.talla?Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(Ta.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(H.jsx)("div",{className:a.colorContainer,style:{backgroundColor:t.color.hex,color:n.palette.getContrastText(t.color.hex)},children:t.medida.talla})})}):Object(H.jsx)(Da.a,{align:"center",children:"N/A"})},mv=function(e){var t=e.producto;if(!0===t.descuento_general_activo){var a=t.descuento_general,n=a.dinero_descontado,c=a.porciento;return Object(H.jsx)(Da.a,{children:"$".concat(Ua(n)," - %").concat(c)})}return Object(H.jsx)(Da.a,{children:"$0.00"})},Ov=[{id:"folio",label:"Folio",minWidth:20,align:"center"},{id:"cliente",label:"Cliente",minWidth:100},{id:"fecha",label:"Fecha",minWidth:80,align:"center"},{id:"fechaVencimiento",label:"Fecha de vencimiento",minWidth:60,align:"center"},{id:"productos",label:"Productos",minWidth:50,align:"center"},{id:"total",label:"Total",minWidth:50,align:"center"}],xv=Object(k.a)({root:{width:"100%"},container:{height:"70vh"}});function hv(e){var t=e.setOpen,a=xv(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(""),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(rt.b)(Xg,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),p=b.data,m=b.refetch,x=b.loading;Object(j.useEffect)((function(){try{m()}catch(e){}}),[]);var h=[],_=function(){t(!1)};return p&&(h=p.obtenerCotizaciones),x?Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"70vh",children:Object(H.jsx)(I.a,{})}):Object(H.jsx)(fn.a,{className:a.root,children:Object(H.jsxs)(Na.a,{className:a.container,children:[Object(H.jsxs)($a.a,{stickyHeader:!0,size:"medium","aria-label":"enhanced table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Ov.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)})),Object(H.jsx)(Da.a,{align:"center",style:{width:35},children:"Retomar"})]})}),Object(H.jsx)(za.a,{children:h.map((function(e){return Object(H.jsx)(_v,{cotizacion:e,handleModalCotizacion:_,setView:o,setSelected:u})}))})]}),Object(H.jsx)(bv,{venta:d,open:i,handleClose:function(){o(!1)},refetch:m})]})})}var _v=function(e){var t=e.cotizacion,a=(e.index,e.handleModalCotizacion),n=e.setSelected,c=e.setView,r=Object(j.useState)({message:"",open:!1}),i=Object(y.a)(r,2),o=i[0],s=i[1],l=JSON.parse(localStorage.getItem("DatosVentas")),d=Object(j.useContext)(qf),u=d.updateTablaVentas,b=d.setUpdateTablaVentas,p=Object(j.useContext)(Po),m=p.updateClientVenta,O=p.setUpdateClientVenta,x=function(){b(!u),O(!m)};try{return Object(H.jsx)(H.Fragment,{children:Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(e){return function(e){try{2===e&&(console.log(t),n(t),c(!0))}catch(a){}}(e.detail)},children:[Object(H.jsx)(Da.a,{align:"center",children:t.folio}),Object(H.jsx)(Da.a,{children:t.cliente.nombre_cliente?t.cliente.nombre_cliente:"P\xfablico general"}),Object(H.jsx)(Da.a,{align:"center",children:t.fecha_registro}),Object(H.jsx)(Da.a,{align:"center",children:t.fecha_vencimiento_cotizacion}),Object(H.jsx)(Da.a,{align:"center",children:t.productos.length}),Object(H.jsx)(Da.a,{align:"center",children:t.total}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(fv,{AgregarVentaDeNuevo:function(){try{console.log(t.productos);var e=JSON.stringify({cliente:null===t.cliente.nombre_cliente?{}:t.cliente,descuento:t.descuento,ieps:t.ieps,impuestos:t.impuestos,iva:t.iva,monedero:t.monedero,productos:t.productos,subTotal:t.subTotal,total:t.total,venta_cliente:!1,tipo_emision:t.tipo_emision?t.tipo_emision:"TICKET"});if(null===l){if(Dt()(t.fecha_vencimiento_cotizacion).isBefore(Dt()().locale("es-mx").format("YYYY MM DD")))return void s({message:"La cotizaci\xf3n seleccionada ya tiene la fecha vencida.",open:!0});localStorage.setItem("DatosVentas",e),a(),x()}else s({message:"No puedes agregar una venta cuando ya est\xe1 una en curso.",open:!0})}catch(n){console.log("agregarVentaDeNuevo",n)}},openMessage:o,handleClickOpen:function(){try{s(!o.open)}catch(e){}}})})]},t.code)})}catch(h){}},fv=function(e){var t=e.openMessage,a=e.handleClickOpen,n=e.AgregarVentaDeNuevo;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{"aria-label":"regresar",color:"primary",size:"small",onClick:n,children:Object(H.jsx)(Qg.a,{fontSize:"medium"})}),Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t.open,autoHideDuration:5e3,onClose:a,message:t.message,action:Object(H.jsx)(ce.a,{size:"small","aria-label":"close",color:"inherit",onClick:a,children:Object(H.jsx)(Ye.a,{fontSize:"small"})})})]})},gv=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function vv(){var e=Object(j.useState)(!1),t=Object(y.a)(e,2),a=t[0],n=t[1],c=JSON.parse(localStorage.getItem("turnoEnCurso"));return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{onClick:function(){n(!a)},style:{textTransform:"none",height:"100%",width:"100%"},disabled:!c,children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(We.d,{style:{fontSize:25}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Cotizaciones"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + T"})})})]})}),Object(H.jsxs)(qe.a,{fullWidth:!0,open:a,maxWidth:"md",onClose:function(){return n(!1)},TransitionComponent:gv,children:[Object(H.jsx)(Re.a,{position:"static",color:"default",elevation:0,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsxs)(O.a,{display:"flex",flexGrow:1,children:[Object(H.jsx)(O.a,{p:2,display:"flex",alignItems:"center",children:Object(H.jsx)("img",{src:Gg,alt:"icono caja2",style:{width:38}})}),Object(H.jsx)(O.a,{p:1,display:"flex",alignItems:"center",children:Object(H.jsx)(L.a,{variant:"h6",children:"Cotizaciones pendientes"})})]}),Object(H.jsx)(O.a,{p:3,pb:0,pt:2,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return n(!a)},size:"medium",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsx)(He.a,{style:{padding:0},children:Object(H.jsx)(hv,{setOpen:n})})]})]})}var Cv=Object(f.f)((function(e){var t=Object(j.useContext)(qf),a=t.alert,n=t.setAlert,c=Object(j.useContext)(be),r=c.reloadAdministrador,i=c.setReloadAdministrador,o=c.setAbrirPanelAcceso,s=c.abrirPanelAcceso,l=c.setDepartamentos,d=ng(),u=Object(j.useState)("venta-general"),b=Object(y.a)(u,2),p=b[0],m=b[1],x=JSON.parse(localStorage.getItem("sesionCafi"));return Dt.a.locale("es"),Object(j.useEffect)((function(){!0===r&&(e.history.push("/admin"),i(!1))}),[r]),window.addEventListener("keydown",(function(t){112===t.keyCode&&(!0===x.accesos.ventas.administrador.ver?e.history.push("/admin"):(o(!s),l({departamento:"ventas",subDepartamento:"administrador",tipo_acceso:"ver"})))})),Object(H.jsxs)(O.a,{height:"100%",children:[Object(H.jsx)($g,{setReloadAdministrador:i}),Object(H.jsx)(Y,{alert:a,setAlert:n}),Object(H.jsxs)(ag.a,{value:p,onChange:function(e,t){m(t)},className:d.navigationTop,children:[Object(H.jsx)(qg,{}),Object(H.jsx)(et.a,{orientation:"vertical"}),Object(H.jsx)(vv,{}),Object(H.jsx)(et.a,{orientation:"vertical"}),Object(H.jsx)(bg,{}),Object(H.jsx)(et.a,{orientation:"vertical"}),Object(H.jsx)(hg,{}),Object(H.jsx)(et.a,{orientation:"vertical"}),Object(H.jsx)(gg,{}),Object(H.jsx)(et.a,{orientation:"vertical"}),Object(H.jsx)(Cg,{})]})]})}));function yv(){return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(Pp,{children:Object(H.jsx)(Fm,{fromVentas:!0})})})}var Av=[{id:"add",label:"",width:30,align:"center"},{id:"clave",label:"Clave",minWidth:40,align:"center"},{id:"codigo",label:"C. Barras",minWidth:40,align:"center"},{id:"descripcion",label:"Nombre/Descrip.",minWidth:330},{id:"medida-color",label:"Color y Talla",minWidth:200,align:"center"},{id:"existencia",label:"Exist.",minWidth:30,align:"center"},{id:"unidad",label:"Unidad",minWidth:30,align:"center"},{id:"precio",label:"Precio",minWidth:30,align:"center"}],Sv=Object(k.a)({root:{width:"100%",marginTop:15},container:{height:"42vh"},colorContainer:{height:28,width:28,borderRadius:"15%",fontSize:18,display:"flex",justifyContent:"center",alignItems:"center"}});function Fv(e){var t=e.productosBusqueda,a=e.setProductoSeleccionado,n=e.productoSeleccionado,c=e.loading,r=e.agregarProductos,i=e.page,o=e.setPage,s=e.limit,l=Sv();if(c)return Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:Object(H.jsx)(I.a,{})});var d=function(e,t){if(2===e.detail||"button"===e)return a(t),void r(t);a(t)};return Object(H.jsxs)(fn.a,{variant:"outlined",className:l.root,children:[Object(H.jsx)(Na.a,{className:l.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsx)(Ea.a,{children:Av.map((function(e){return Object(H.jsx)(Da.a,{align:e.align,style:{width:e.minWidth},children:e.label},e.id)}))})}),Object(H.jsx)(za.a,{children:t.docs.map((function(e,t){return Object(H.jsx)(Iv,{producto:e,handleTableSelect:d,productoSeleccionado:n},t)}))})]})}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:t.totalDocs,rowsPerPage:s,page:i,onPageChange:function(e,t){o(t)}})]})}function Iv(e){var t=e.producto,a=e.handleTableSelect,n=e.productoSeleccionado,c=Sv(),r=Object($e.a)();try{var i=function(){return t.color&&t.medida?Object(H.jsx)(Da.a,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"56px"},children:Object(H.jsx)(Ta.a,{title:"".concat(t.medida.talla," - ").concat(t.color.nombre),placement:"top",arrow:!0,children:Object(H.jsx)("div",{className:c.colorContainer,style:{backgroundColor:t.color.hex,color:r.palette.getContrastText(t.color.hex)},children:Object(H.jsx)(L.a,{noWrap:!0,children:t.medida.talla})})})}):Object(H.jsx)(Da.a,{align:"center",children:"N/A"})},o=function(){var e="";return e="OTROS"===t.id_producto.datos_generales.tipo_producto?"Costal"===t.unidad||"Caja"===t.unidad?t.inventario_general[0].cantidad_existente_maxima:t.inventario_general[0].cantidad_existente:t.cantidad,Object(H.jsx)(Da.a,{align:"center",children:e})};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Ea.a,{hover:!0,role:"checkbox",tabIndex:-1,onClick:function(e){return a(e,t)},selected:n._id===t._id,children:[Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(ce.a,{size:"small",color:"primary",onClick:function(e){return a("button",t)},children:Object(H.jsx)(Ut.a,{})})}),Object(H.jsx)(Da.a,{align:"center",children:t.id_producto.datos_generales.clave_alterna}),Object(H.jsx)(Da.a,{align:"center",children:t.codigo_barras?t.codigo_barras:"N/A"}),Object(H.jsx)(Da.a,{children:t.id_producto.datos_generales.nombre_comercial}),Object(H.jsx)(i,{}),Object(H.jsx)(o,{}),Object(H.jsx)(Da.a,{align:"center",children:t.unidad}),Object(H.jsxs)(Da.a,{align:"center",children:["$",t.precio?Ua(t.precio):0]})]},t._id)})}catch(s){console.log(s)}}var kv=a(486),wv=a.n(kv);function Nv(e){e.producto;var t,a,n,c,r=e.productoSeleccionado,i=ig();return Object(H.jsxs)(Qe.a,{container:!0,alignItems:"center",children:[Object(H.jsx)(Qe.a,{item:!0,md:2,style:{display:"flex",justifyContent:"center"},children:(null===r||void 0===r||null===(t=r.id_producto)||void 0===t?void 0:t.imagenes.length)>0?Object(H.jsx)(O.a,{className:i.containerImage,children:Object(H.jsx)("img",{alt:"Imagen producto",src:null===r||void 0===r||null===(a=r.id_producto)||void 0===a?void 0:a.imagenes[0].url_imagen,className:i.imagen})}):Object(H.jsx)(O.a,{p:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsx)(wv.a,{style:{fontSize:40}})})}),Object(H.jsx)(Qe.a,{item:!0,md:10,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Nombre:"})}),Object(H.jsx)(L.a,{children:r.id_producto?r.id_producto.datos_generales.nombre_comercial:"-"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Codigo Barras:"})}),Object(H.jsx)(L.a,{children:r.codigo_barras?r.codigo_barras:"N/A"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{align:"center",children:Object(H.jsx)("b",{children:"Cantidad:"})}),Object(H.jsx)(L.a,{align:"center",children:r.cantidad?r.cantidad:"-"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:1,xs:12,children:[Object(H.jsx)(L.a,{align:"center",children:Object(H.jsx)("b",{children:"Unidad:"})}),Object(H.jsx)(L.a,{align:"center",children:r.unidad?r.unidad:"-"})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{align:"center",children:Object(H.jsx)("b",{children:"Descuento:"})}),Object(H.jsx)(L.a,{align:"center",children:r.descuento?r.descuento.precio_neto:0})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{align:"center",children:Object(H.jsx)("b",{children:"% Descuento:"})}),Object(H.jsx)(L.a,{align:"center",children:r.descuento?r.descuento.precio_neto:0})]})]})}),Object(H.jsx)(Qe.a,{item:!0,md:12,lg:12,children:Object(H.jsx)(Pv,{precios:null===r||void 0===r||null===(n=r.id_producto)||void 0===n||null===(c=n.precios)||void 0===c?void 0:c.precios_producto})})]})}function Pv(e){var t=e.precios;return Object(H.jsx)(O.a,{children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{"aria-label":"simple table",size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Numero precio"}),[1,2,3,4,5,6].map((function(e,t){return Object(H.jsx)(Da.a,{style:{minWidth:100},children:e},t)}))]})}),Object(H.jsx)(za.a,{children:["Precios de venta"].map((function(e,a){return Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{style:{border:0},children:Object(H.jsx)("b",{children:e})}),null===t||void 0===t?void 0:t.map((function(e,t){return Object(H.jsxs)(Da.a,{style:{border:0},children:["$",null!==e&&void 0!==e&&e.precio_neto?Ua(e.precio_neto):0]},t)}))]},a)}))})]})})})}var Ev=["cantidad_venta"],Dv=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function zv(){var e=ig(),t=JSON.parse(localStorage.getItem("sesionCafi")),a=JSON.parse(localStorage.getItem("turnoEnCurso")),n=JSON.parse(localStorage.getItem("DatosVentas")),c=Object(j.useContext)(qf),r=c.updateTablaVentas,i=c.setUpdateTablaVentas,o=c.setDatosVentasActual,s=c.openBuscarProducto,l=c.setOpenBuscarProducto,d=Object(j.useState)(!1),b=Object(y.a)(d,2),p=b[0],x=b[1],h=Object(j.useState)({producto:""}),_=Object(y.a)(h,2),f=_[0],A=_[1],I=Object(j.useState)([]),k=Object(y.a)(I,2),w=k[0],N=k[1],P=Object(j.useState)(0),E=Object(y.a)(P,2),D=E[0],z=E[1],T=u.a.useRef(null),$=Object(an.useDebounce)(f,500),W=Object(y.a)($,1)[0],R=Object(rt.b)(Om,{variables:{empresa:t.empresa._id,sucursal:t.sucursal._id,input:{producto:W.producto?W.producto:""},limit:10,offset:D},fetchPolicy:"network-only"}),V=R.data,B=R.refetch,U=R.loading,q=[];V&&(q=V.obtenerProductosVentas);var J=function(){N([]),l(!s),A({producto:""})};window.addEventListener("keydown",(function(e){e.altKey&&80===e.keyCode&&J()})),Object(j.useEffect)((function(){B()}),[r]),Object(j.useMemo)((function(){z(0)}),[W]);var G=t.empresa.vender_sin_inventario,Y=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,s,l,d,j,u,b,p,O,h,_,f,g,C,y,A,S,F;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("medidas"!==t.concepto){e.next=6;break}if(G||0!==t.cantidad){e.next=4;break}return x(!0),e.abrupt("return");case 4:e.next=9;break;case 6:if(G||0!==t.inventario_general[0].cantidad_existente){e.next=9;break}return x(!0),e.abrupt("return");case 9:return a={granel:!1,valor:0},"Kg"!==t.unidad&&"Costal"!==t.unidad||(a={granel:!0,valor:1}),n=JSON.parse(localStorage.getItem("DatosVentas")),c=null===n?[]:n.productos,s=null===n?[]:n,l=null===n?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:n,d=c,j={subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0},e.next=19,Ja(t);case 19:if((u=e.sent).found||!t._id){e.next=36;break}return b=Object(m.a)({},t),p=b.descuento_activo?b.descuento.precio_neto:b.precio_unidad.precio_neto,e.next=25,Ha({newP:b,cantidad:0,granel:a,origen:"Ventas1",precio_boolean:!1});case 25:(O=e.sent).newP.precio_anterior=p,O.newP.iva_total_producto=parseFloat(O.ivaCalculo),O.newP.ieps_total_producto=parseFloat(O.iepsCalculo),O.newP.impuestos_total_producto=parseFloat(O.impuestoCalculo),O.newP.subtotal_total_producto=parseFloat(O.subtotalCalculo),O.newP.total_total_producto=parseFloat(O.totalCalculo),d.splice(0,0,O.newP),j={subTotal:parseFloat(l.subTotal)+parseFloat(O.subtotalCalculo),total:parseFloat(l.total)+parseFloat(O.totalCalculo),impuestos:parseFloat(l.impuestos)+parseFloat(O.impuestoCalculo),iva:parseFloat(l.iva)+parseFloat(O.ivaCalculo),ieps:parseFloat(l.ieps)+parseFloat(O.iepsCalculo),descuento:parseFloat(l.descuento)+parseFloat(O.descuentoCalculo),monedero:parseFloat(l.monedero)+parseFloat(O.monederoCalculo)},e.next=78;break;case 36:if(!u.found||!t._id){e.next=78;break}return h=u.producto_found.producto,_=h.cantidad_venta,f=Object(De.a)(h,Ev),a.granel&&(a={granel:!0,valor:f.granel_producto.valor+a.valor}),f.cantidad_venta=a.granel?1:parseInt(_)+1,e.next=42,Ya(f);case 42:if(!(g=e.sent).found){e.next=63;break}return e.next=46,Ha({newP:f,cantidad_venta:_,granel:1,origen:"",precio_boolean:!0,precio:f.precio_actual_object});case 46:return C=e.sent,e.next=49,Ha({newP:f,cantidad_venta:a.granel?1:parseInt(_)+1,granel:a,origen:"",precio_boolean:!0,precio:g.object_prising});case 49:y=e.sent,f.precio_a_vender=y.totalCalculo,f.precio_anterior=f.precio_actual_producto,f.precio_actual_producto=g.pricing,f.iva_total_producto=parseFloat(y.ivaCalculo),f.ieps_total_producto=parseFloat(y.iepsCalculo),f.impuestos_total_producto=parseFloat(y.impuestoCalculo),f.subtotal_total_producto=parseFloat(y.subtotalCalculo),f.total_total_producto=parseFloat(y.totalCalculo),f.precio_actual_object={cantidad_unidad:g.object_prising.cantidad_unidad?g.object_prising.cantidad_unidad:null,numero_precio:g.object_prising.numero_precio?g.object_prising.numero_precio:null,unidad_maxima:g.object_prising.unidad_maxima?g.object_prising.unidad_maxima:null,precio_general:g.object_prising.precio_general?g.object_prising.precio_general:null,precio_neto:g.object_prising.precio_neto?g.object_prising.precio_neto:null,precio_venta:g.object_prising.precio_venta?g.object_prising.precio_venta:null,iva_precio:g.object_prising.iva_precio?g.object_prising.iva_precio:null,ieps_precio:g.object_prising.ieps_precio?g.object_prising.ieps_precio:null,utilidad:g.object_prising.utilidad?g.object_prising.utilidad:null,porciento:g.object_prising.porciento?g.object_prising.porciento:null,dinero_descontado:g.object_prising.dinero_descontado?g.object_prising.dinero_descontado:null},d.splice(u.producto_found.index,1,f),j={subTotal:parseFloat(l.subTotal)-parseFloat(C.subtotalCalculo)+y.subtotalCalculo,total:parseFloat(l.total)-parseFloat(C.totalCalculo)+y.totalCalculo,impuestos:parseFloat(l.impuestos)-parseFloat(C.impuestoCalculo)+y.impuestoCalculo,iva:parseFloat(l.iva)-parseFloat(C.ivaCalculo)+y.ivaCalculo,ieps:parseFloat(l.ieps)-parseFloat(C.iepsCalculo)+y.iepsCalculo,descuento:parseFloat(l.descuento)-parseFloat(C.descuentoCalculo)+y.descuentoCalculo,monedero:parseFloat(l.monedero)-parseFloat(C.monederoCalculo)+y.monederoCalculo},e.next=78;break;case 63:return A=f.descuento_activo?f.descuento.precio_neto:f.precio_unidad.precio_neto,e.next=66,Ha({newP:f,cantidad:1,granel:f.granel_producto,origen:"Ventas2"});case 66:return S=e.sent,e.next=69,Ha({newP:f,cantidad:a.granel?1:parseInt(_)+1,granel:a,origen:"Ventas2"});case 69:(F=e.sent).newP.precio_actual_producto=A,F.newP.iva_total_producto=parseFloat(F.ivaCalculo),F.newP.ieps_total_producto=parseFloat(F.iepsCalculo),F.newP.impuestos_total_producto=parseFloat(F.impuestoCalculo),F.newP.subtotal_total_producto=parseFloat(F.subtotalCalculo),F.newP.total_total_producto=parseFloat(F.totalCalculo),d.splice(u.producto_found.index,1,F.newP),j={subTotal:parseFloat(l.subTotal)-parseFloat(S.subtotalCalculo)+F.subtotalCalculo,total:parseFloat(l.total)-parseFloat(S.totalCalculo)+F.totalCalculo,impuestos:parseFloat(l.impuestos)-parseFloat(S.impuestoCalculo)+F.impuestoCalculo,iva:parseFloat(l.iva)-parseFloat(S.ivaCalculo)+F.ivaCalculo,ieps:parseFloat(l.ieps)-parseFloat(S.iepsCalculo)+F.iepsCalculo,descuento:parseFloat(l.descuento)-parseFloat(S.descuentoCalculo)+F.descuentoCalculo,monedero:parseFloat(l.monedero)-parseFloat(S.monederoCalculo)+F.monederoCalculo};case 78:localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)({},j),{},{cliente:!0===s.venta_cliente?s.cliente:{},venta_cliente:!0===s.venta_cliente&&s.venta_cliente,productos:d,tipo_emision:s.tipo_emision?s.tipo_emision:"TICKET"}))),o(Object(m.a)({},j)),i(!r),T.current.focus();case 82:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{className:e.borderBotonChico,onClick:J,disabled:!a||n&&n.nota_credito,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(We.q,{style:{fontSize:45}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Productos"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + P"})})})]})}),Object(H.jsxs)(qe.a,{maxWidth:"md",fullWidth:!0,open:s,onClose:J,TransitionComponent:Dv,children:[Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:p,onClose:function(){return x(!1)},message:"Producto sin existencias",autoHideDuration:3e3}),Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(H.jsx)(L.a,{variant:"h6",children:"Buscar productos"}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:J,size:"large",children:Object(H.jsx)(Ye.a,{})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(S.a,{variant:"outlined",placeholder:"Buscar producto",name:"producto",size:"small",fullWidth:!0,value:f.producto,onChange:function(e){A(Object(m.a)(Object(m.a)({},f),{},Object(g.a)({},e.target.name,e.target.value)))},autoFocus:!0,inputRef:T,InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{children:Object(H.jsx)(Nc.a,{})})})}})}),Object(H.jsx)(Fv,{productosBusqueda:q,productoSeleccionado:w,setProductoSeleccionado:N,loading:U,agregarProductos:Y,page:D,setPage:z,limit:10}),Object(H.jsx)(O.a,{mb:2,children:Object(H.jsx)(Nv,{productoSeleccionado:w})})]})]})]})}var Tv=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),$v=Object(k.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},icon:{fontSize:100}}}));function Wv(){$v();var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=Object(j.useState)(""),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=function(){s(!o)};return window.addEventListener("keydown",(function(e){e.altKey&&67===e.keyCode&&l()})),Object(j.useEffect)((function(){e=JSON.parse(localStorage.getItem("turnoEnCurso"))}),[e]),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{style:{height:"100%",width:"100%",border:".6px solid #DBDBDB"},onClick:l,disabled:!e,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{style:e?null:{pointerEvents:"none",opacity:.5},children:Object(H.jsx)(We.b,{style:{fontSize:45}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Clientes"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"aLT + C"})})})]})}),Object(H.jsxs)(qe.a,{fullWidth:!0,maxWidth:"lg",open:o,onClose:l,TransitionComponent:Tv,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(We.b,{style:{fontSize:45}}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{variant:"h6",children:"Clientes"})]}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:l,size:"large",children:Object(H.jsx)(Ye.a,{style:{fontSize:30}})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:8,children:Object(H.jsx)(S.a,{fullWidth:!0,placeholder:"Buscar cliente...",onChange:function(e){return c(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&c(e.target.defaultValue)},value:n,size:"small",variant:"outlined",InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{onClick:function(){return c(n)},children:Object(H.jsx)(Nc.a,{})})})}})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:4,style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:Object(H.jsx)(ts,{tipo:"CLIENTE",accion:"registrar",ventas:!0,handleClickOpen:l})})]}),Object(H.jsx)(O.a,{mt:1,height:"70vh",children:Object(H.jsx)(Jl,{tipo:"CLIENTE",filtro:n,ventas:!0,handleClickOpen:l})})]})]})]})}function Rv(e){var t,a,n,c,r,i,o,s,l,d=e.setOpen,b=Object(j.useContext)(qf).setAlert,p=Object(w.a)(Kg),x=Object(y.a)(p,1)[0],h=JSON.parse(localStorage.getItem("DatosVentas")),_=JSON.parse(localStorage.getItem("turnoEnCurso")),f=JSON.parse(localStorage.getItem("sesionCafi")),A=Object(j.useContext)(qf),I=A.updateTablaVentas,k=A.setUpdateTablaVentas,N=A.setDatosVentasActual,P=Object(j.useState)([]),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(j.useState)(!1),$=Object(y.a)(T,2),W=$[0],R=$[1],V=Object(j.useState)({productos:null===h||void 0===h?void 0:h.productos,subTotal:null===h||void 0===h?void 0:h.subTotal,impuestos:null===h||void 0===h?void 0:h.impuestos,iva:null===h||void 0===h?void 0:h.iva,ieps:null===h||void 0===h?void 0:h.ieps,total:null===h||void 0===h?void 0:h.total}),M=Object(y.a)(V,2),B=M[0],U=M[1],q=Object(j.useState)(B?null===B||void 0===B||null===(t=B.descuento_general)||void 0===t?void 0:t.precio_con_descuento:null===h||void 0===h?void 0:h.total),J=Object(y.a)(q,2),G=J[0],Y=J[1],Q=Object(j.useState)(null!==B&&void 0!==B&&null!==(a=B.descuento_general)&&void 0!==a&&a.porciento?null===B||void 0===B||null===(n=B.descuento_general)||void 0===n?void 0:n.porciento:0),K=Object(y.a)(Q,2),X=K[0],Z=K[1],ee=[],te=h,ae=ig(),ce=function(e){z(Object(m.a)(Object(m.a)({},D),{},Object(g.a)({},e.target.name,e.target.value)))},re=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,D.fecha_vencimiento){e.next=6;break}return b({message:"Por favor completa los datos necesarios",status:"error",open:!0}),e.abrupt("return",null);case 6:return R(!0),e.next=9,x({variables:{input:{folio:Ma(8),descuento:B.descuento,ieps:B.ieps,impuestos:B.impuestos,iva:B.iva,monedero:h.monedero,subTotal:B.subTotal,total:B.total,venta_cliente:!!h.cliente,montos_en_caja:{},descuento_general_activo:X>0,descuento_general:{porciento:parseFloat(X),precio_con_descuento:B.total,cantidad_descontado:parseFloat(G)},dias_de_credito_venta:"",fecha_de_vencimiento_credito:"",fecha_vencimiento_cotizacion:D.fecha_vencimiento,cliente:h.cliente?h.cliente:{},productos:B.productos},empresa:f.empresa._id,sucursal:f.sucursal._id,usuario:f._id,caja:_.id_caja}});case 9:b({message:"La cotizaci\xf3n se realiz\xf3 correctamente.",status:"success",open:!0});case 10:d(!1),R(!1),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),k(!I),N({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(0),R(!1),b({message:"Algo sali\xf3 mal.",status:"error",open:!0}),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return u.a.useEffect((function(){try{!function(){for(var e=0,t=0,a=0,n=0,c=0,r=0,i=[],o=null===te||void 0===te?void 0:te.productos,s=0;s<o.length;s++){var l=o[s],d={},j=parseFloat(X),u=j>1?j>=10?parseFloat((l.precio_actual_object.precio_venta*parseFloat("0.".concat(j))).toFixed(2)):parseFloat((l.precio_actual_object.precio_venta*parseFloat("0.".concat(j))/10).toFixed(2)):parseFloat(l.precio_actual_object.precio_venta*j/100),b=parseFloat((l.precio_actual_object.precio_venta-u).toFixed(2)),p=parseFloat((b*parseFloat("0.".concat(l.id_producto.precios.iva<10?"0".concat(l.id_producto.precios.iva):l.id_producto.precios.iva))).toFixed(2)),O=parseFloat((b*parseFloat("0.".concat(l.id_producto.precios.ieps<10?"0".concat(l.id_producto.precios.ieps):l.id_producto.precios.ieps))).toFixed(2)),x=parseFloat((b+p+O).toFixed(2)),h=parseFloat(((b-l.id_producto.precios.precio_de_compra.precio_sin_impuesto)/l.id_producto.precios.precio_de_compra.precio_sin_impuesto*100).toFixed(2));d={cantidad_unidad:1,dinero_descontado:u,ieps_precio:O,iva_precio:p,numero_precio:l.precio_actual_object.numero_precio,porciento:l.precio_actual_object.porciento?parseFloat((parseFloat(l.precio_actual_object.porciento)+parseFloat(X)).toFixed(2)):parseFloat(X),precio_general:0,precio_neto:x,precio_venta:b,unidad_maxima:!1,utilidad:h},l.precio_actual_object.unidad_maxima&&(d.cantidad_unidad=l.precio_actual_object.cantidad_unidad,d.precio_general=x*parseFloat(l.precio_actual_object.cantidad_unidad),d.unidad_maxima=!0);var _=!0===l.granel_producto.granel?parseFloat(l.granel_producto.valor):1,f=parseFloat((d.ieps_precio*_*l.cantidad_venta).toFixed(2)),g=parseFloat(((d.ieps_precio+d.iva_precio)*_*l.cantidad_venta).toFixed(2)),v=parseFloat((d.iva_precio*_*l.cantidad_venta).toFixed(2)),C=parseFloat((d.precio_venta*_*l.cantidad_venta).toFixed(2)),y=parseFloat((d.precio_neto*_*l.cantidad_venta).toFixed(2)),A=parseFloat((parseFloat(d.dinero_descontado)*_*l.cantidad_venta).toFixed(2));i.push(Object(m.a)(Object(m.a)({},l),{},{precio_actual_object:d,ieps_total_producto:f,impuestos_total_producto:g,iva_total_producto:v,subtotal_total_producto:C,total_total_producto:y})),e+=y,t+=C,a+=g,n+=v,c+=f,r+=A}U(ee={productos:i,impuestos:a,subTotal:t,iva:n,ieps:c,total:e,descuento:r})}()}catch(e){}}),[X]),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Usuario:"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,variant:"outlined",onChange:ce,value:f?f.nombre:""})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:null!==h&&void 0!==h&&null!==(c=h.cliente)&&void 0!==c&&c.nombre_cliente?2:3,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Cliente:"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,onChange:ce,variant:"outlined",value:null!==h&&void 0!==h&&null!==(r=h.cliente)&&void 0!==r&&r.nombre_cliente?null===h||void 0===h||null===(i=h.cliente)||void 0===i?void 0:i.nombre_cliente:"P\xfablico General"})})]}),null!==h&&void 0!==h&&null!==(o=h.cliente)&&void 0!==o&&o.nombre_cliente?Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"No. Cliente:"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,onChange:ce,variant:"outlined",value:h?null===(s=h.cliente)||void 0===s?void 0:s.numero_cliente:""})})]}):null,Object(H.jsxs)(Qe.a,{item:!0,md:null!==h&&void 0!==h&&null!==(l=h.cliente)&&void 0!==l&&l.nombre_cliente?2:3,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Fecha:"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",disabled:!0,onChange:ce,variant:"outlined",value:Dt()().locale("es-mx").format("L")})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Fecha Vencimiento:"})}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,type:"date",onChange:ce,size:"small",name:"fecha_vencimiento",variant:"outlined"})})]})]}),Object(H.jsx)(st,{loading:W}),Object(H.jsxs)(Qe.a,{container:!0,spacing:3,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(O.a,{mt:4,children:Object(H.jsxs)(fn.a,{elevation:3,children:[Object(H.jsxs)(O.a,{textAlign:"center",children:[Object(H.jsx)(L.a,{style:{fontSize:17},children:Object(H.jsx)("b",{children:"Agregar descuento"})}),Object(H.jsxs)(Mt.a,{severity:"info",children:["El descuento se aplica apartir del ",Object(H.jsx)("b",{children:"SUBTOTAL"})]})]}),Object(H.jsxs)(O.a,{p:2,children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Porcentaje:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"descuento",id:"form-venta-porsentaje-descuento",variant:"outlined",value:X,onChange:function(e){return function(e){var t=e.target.value;if(Z(t),""!==e){var a=null===te||void 0===te?void 0:te.subTotal,n=t<10?parseFloat("0.0".concat(t.replace(".",""))):parseFloat("0.".concat(t.replace(".","")));Y((a*n).toFixed(2))}}(e)},type:"number",disabled:!1,InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"%"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Dinero a descontar"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",type:"number",name:"precioConDescuento",onChange:function(e){try{var t=""!==e.target.value?parseFloat(e.target.value):"",a=null===te||void 0===te?void 0:te.subTotal;Y(t);var n=""===t?0:parseFloat((t/a*100).toFixed(2)),c=""===t?0:parseFloat(n.toFixed(2));Z(c)}catch(r){console.log(r)}},value:G,className:ae.input,variant:"outlined"})]})]}),Object(H.jsx)(O.a,{mt:2,display:"flex",justifyContent:"flex-end",children:Object(H.jsx)(F.a,{variant:"text",color:"secondary",size:"medium",onClick:function(){try{ee={productos:null===h||void 0===h?void 0:h.productos,subTotal:null===h||void 0===h?void 0:h.subTotal,impuestos:null===h||void 0===h?void 0:h.impuestos,iva:null===h||void 0===h?void 0:h.iva,ieps:null===h||void 0===h?void 0:h.ieps,total:null===h||void 0===h?void 0:h.total},Z(0),Y(""),U(ee)}catch(e){console.log(e)}},startIcon:Object(H.jsx)(qp.a,{}),children:"Quitar descuento"})})]})]})})}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(O.a,{mt:3,width:"100%",children:[Object(H.jsx)(O.a,{m:1,children:Object(H.jsxs)(L.a,{style:{fontSize:17},children:[Object(H.jsx)("b",{children:"No. Productos: "})," ",null===h||void 0===h?void 0:h.productos.length]})}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsxs)(L.a,{style:{fontSize:17},children:[Object(H.jsx)("b",{children:"Subtotal:"})," $",B.subTotal?Ua(B.subTotal):0]})}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsxs)(L.a,{style:{fontSize:17},children:[Object(H.jsx)("b",{children:"Impuestos:"})," $",B.impuestos?Ua(B.impuestos):0]})}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsxs)(L.a,{style:{fontSize:16},children:[Object(H.jsx)("b",{children:"IVA:"})," $",B.iva?Ua(B.iva):0]})}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsxs)(L.a,{style:{fontSize:16},children:[Object(H.jsx)("b",{children:"IEPS:"})," $",B.ieps?Ua(B.ieps):0]})}),Object(H.jsx)(O.a,{m:1,children:Object(H.jsxs)(L.a,{style:{fontSize:17},children:[Object(H.jsx)("b",{children:"Descuento:"})," ",Object(H.jsxs)("b",{style:{color:"green"},children:["$",G?Ua(G):0]})]})})]}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsxs)(L.a,{style:{fontSize:27},children:["Total: ",Object(H.jsxs)("b",{children:["$",B.total?Ua(B.total):0]})]})})]})]})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{color:"primary",variant:"contained",size:"large",onClick:re,children:"Guardar"})})]})}var Vv=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Mv(e){var t=e.type;Dt.a.locale("es");var a=ig(),n=JSON.parse(localStorage.getItem("sesionCafi")),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=JSON.parse(localStorage.getItem("DatosVentas")),i=Object(j.useState)(t),o=Object(y.a)(i,2),s=o[0],l=o[1],d=Object(j.useContext)(be),u=d.reloadCrearCotizacion,b=d.setReloadCrearCotizacion,p=d.setAbrirPanelAcceso,m=d.abrirPanelAcceso,x=d.setDepartamentos,h=Object(j.useContext)(qf).setAlert,_=Object(j.useState)(!1),f=Object(y.a)(_,2),g=f[0],v=f[1],C=function(e){if(!r)return h({message:"Lo sentimos no hay productos que cotizar",status:"error",open:!0}),null;!0===(null===n||void 0===n?void 0:n.accesos.ventas.cotizaciones.ver)?v(!g):(console.log("pedir permiso"),p(!m),x({departamento:"ventas",subDepartamento:"cotizaciones",tipo_acceso:"ver"}))};return Object(j.useEffect)((function(){!0===u&&(b(!1),l("GENERAR"),v(!g))}),[u]),window.addEventListener("keydown",(function(e){e.altKey&&84===e.keyCode&&C(0)})),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{className:a.borderBotonChico,onClick:function(){return C()},disabled:!c||!r||r&&r.nota_credito,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(We.d,{style:{fontSize:50}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Generar cotizacion"})})})]})}),Object(H.jsxs)(qe.a,{fullWidth:!0,open:g,maxWidth:"GENERAR"===s?"md":"lg",onClose:function(){return v(!1)},TransitionComponent:Vv,children:[Object(H.jsx)(Re.a,{position:"static",color:"default",elevation:0,children:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsxs)(O.a,{display:"flex",flexGrow:1,children:[Object(H.jsx)(O.a,{p:2,display:"flex",alignItems:"center",children:Object(H.jsx)(We.d,{style:{fontSize:38}})}),Object(H.jsx)(O.a,{p:1,display:"flex",alignItems:"center",children:Object(H.jsx)(L.a,{style:{fontSize:18},children:"Nueva Cotizaci\xf3n"})})]}),Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return v(!g)},size:"medium",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsx)(Rv,{setOpen:v})]})]})}var Lv=a.p+"static/media/shopping-cart.e10aaa76.svg",Bv=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function Uv(){var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=JSON.parse(localStorage.getItem("DatosVentas")),a=ig(),n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useContext)(qf),s=o.updateTablaVentas,l=o.setUpdateTablaVentas,d=o.setDatosVentasActual,u=o.setVentaRetomada,b=o.setPrecioSelectProductoVenta,p=Object(j.useContext)(Po),m=p.updateClientVenta,x=p.setUpdateClientVenta,h=function(){i(!r)};window.addEventListener("keydown",(function(e){118===e.keyCode&&t&&h()}));return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{className:a.borderBotonChico,onClick:h,disabled:!e||!t,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:Lv,alt:"icono cancelarventa",style:{width:35}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:t&&t.nota_credito?"Cancelar Nota":"Cancelar Venta"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"F7"})})})]})}),Object(H.jsxs)(qe.a,{maxWidth:"lg",open:r,onClose:h,TransitionComponent:Bv,children:[Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,item:!0,lg:12,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"center",flexGrow:1,children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:Lv,alt:"icono caja",className:a.iconSizeDialogs})}),Object(H.jsx)(O.a,{m:2,children:Object(H.jsx)(et.a,{orientation:"vertical"})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h5",children:"Cancelar Venta"})})]}),Object(H.jsx)(O.a,{ml:10,mb:7,display:"flex",alignItems:"center",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return i(!r)},size:"large",children:Object(H.jsx)(Ye.a,{})})})]}),Object(H.jsx)(O.a,{p:2,children:Object(H.jsx)(L.a,{variant:"h5",children:"\xbfEsta seguro que desea cancelar?"})})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){return localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),l(!s),x(!m),d({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),b([]),u(t),void i(!r)},variant:"contained",color:"primary",size:"large",autoFocus:!0,children:"Aceptar"})})]})]})}var qv=a(487),Jv=a.n(qv),Hv=a.p+"static/media/money.c7672de2.svg",Gv=a.p+"static/media/tarjeta-de-credito.a640b329.svg",Yv=a.p+"static/media/transferencia-bancaria.76b9df2d.svg",Qv=a.p+"static/media/cheque.7fb9372b.png";function Kv(e){var t=e.montos,a=e.setMontos,n=e.totales,c=e.setTotales,r=e.venta_credito,i=e.montoEnCaja,o=e.setMontoEnCaja,s=e.datosCliente,l=ig(),d=Object(j.useState)(n.total),u=Object(y.a)(d,2),b=u[0],p=u[1],x=JSON.parse(localStorage.getItem("DatosVentas")),h=x?parseFloat(x.total.toFixed(2)):0,_=function(e,r){var i=e.target.value;switch(r){case"EFECTIVO":a(Object(m.a)(Object(m.a)({},t),{},{efectivo:i})),p(i);break;case"TARJETA":a(Object(m.a)(Object(m.a)({},t),{},{tarjeta:i}));break;case"PUNTOS":var o=""!==i?parseInt(i):0;o<=s.monedero_electronico&&(a(Object(m.a)(Object(m.a)({},t),{},{puntos:i,efectivo:b-o})),c(Object(m.a)(Object(m.a)({},n),{},{total:h-o})));break;case"TRANSFERENCIA":a(Object(m.a)(Object(m.a)({},t),{},{transferencia:i}));break;case"CHEQUE":a(Object(m.a)(Object(m.a)({},t),{},{cheque:i}));break;default:return alert("Error de pago")}};Object(j.useEffect)((function(){if(!r){var e,a=parseFloat(t.efectivo)+parseFloat(t.tarjeta)+parseFloat(t.puntos)+parseFloat(t.transferencia)+parseFloat(t.cheque),i=parseFloat(a)-h;e=parseFloat(t.efectivo-i),o(e),c(Object(m.a)(Object(m.a)({},n),{},{monto_pagado:a,cambio:a-n.total-t.puntos}))}}),[t]);var f=function(e){var n=e.target,c=n.name,r=n.value,i=parseFloat(r);switch(c){case"EFECTIVO":0===i&&(a(Object(m.a)(Object(m.a)({},t),{},{efectivo:0})),p(0));break;case"TARJETA":0===i&&a(Object(m.a)(Object(m.a)({},t),{},{tarjeta:0}));break;case"PUNTOS":0===i&&a(Object(m.a)(Object(m.a)({},t),{},{puntos:0}));break;case"TRANSFERENCIA":0===i&&a(Object(m.a)(Object(m.a)({},t),{},{transferencia:0}));break;case"CHEQUE":0===i&&a(Object(m.a)(Object(m.a)({},t),{},{cheque:0}))}},g=function(e){var n=e.target,c=n.name,r=n.value,o=parseFloat(i);switch(c){case"EFECTIVO":""===r&&(a(Object(m.a)(Object(m.a)({},t),{},{efectivo:0})),p(0));break;case"TARJETA":(""===r||o<0)&&a(Object(m.a)(Object(m.a)({},t),{},{tarjeta:0}));break;case"PUNTOS":(""===r||o<0&&parseFloat(t.puntos)!==parseFloat(h))&&a(Object(m.a)(Object(m.a)({},t),{},{puntos:0}));break;case"TRANSFERENCIA":(""===r||o<0)&&a(Object(m.a)(Object(m.a)({},t),{},{transferencia:0}));break;case"CHEQUE":(""===r||o<0)&&a(Object(m.a)(Object(m.a)({},t),{},{cheque:0}))}};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)("div",{className:l.formInputFlex,children:[Object(H.jsxs)(O.a,{width:"25%",textAlign:"center",children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:Hv,alt:"icono ventas",className:l.iconSizeDialogsPequeno})}),Object(H.jsx)(L.a,{variant:"caption",children:"Efectivo"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"EFECTIVO",id:"form-producto-efectivo",variant:"outlined",value:t.efectivo,onChange:function(e){return _(e,"EFECTIVO")},onBlur:g,onFocus:f,autoFocus:!0,disabled:r})})]}),Object(H.jsxs)(O.a,{width:"25%",textAlign:"center",children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:Gv,alt:"icono ventas",className:l.iconSizeDialogsPequeno})}),Object(H.jsx)(L.a,{variant:"caption",children:"Tarjeta"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"TARJETA",variant:"outlined",value:t.tarjeta,onChange:function(e){return _(e,"TARJETA")},onBlur:g,onFocus:f,disabled:r})})]}),Object(H.jsxs)(O.a,{width:"25%",textAlign:"center",children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(We.r,{style:{fontSize:50,cursor:"pointer"}})}),Object(H.jsx)(L.a,{variant:"caption",children:"Puntos"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"PUNTOS",variant:"outlined",value:t.puntos,onChange:function(e){return _(e,"PUNTOS")},onBlur:g,onFocus:f,disabled:r})})]}),Object(H.jsxs)(O.a,{width:"25%",textAlign:"center",children:[Object(H.jsx)(O.a,{p:0,children:Object(H.jsx)("img",{src:Yv,alt:"icono ventas",className:l.iconSizeDialogsPequeno})}),Object(H.jsx)(L.a,{variant:"caption",children:"Transferencia"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"TRANSFERENCIA",variant:"outlined",value:t.transferencia,onChange:function(e){return _(e,"TRANSFERENCIA")},onBlur:g,onFocus:f,disabled:r})})]}),Object(H.jsxs)(O.a,{width:"25%",textAlign:"center",children:[Object(H.jsx)(O.a,{p:0,children:Object(H.jsx)("img",{src:Qv,alt:"icono ventas",className:l.iconSizeDialogsPequeno})}),Object(H.jsx)(L.a,{variant:"caption",children:"Cheque"}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"CHEQUE",variant:"outlined",value:t.cheque,onChange:function(e){return _(e,"CHEQUE")},onBlur:g,onFocus:f,disabled:r})})]})]})})}function Xv(e){var t=e.montos,a=e.totales,n=e.datosCliente,c=e.monedero;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{variant:"subtitle1",children:Object(H.jsx)("b",{children:"Cliente:"})}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(L.a,{variant:"subtitle1",noWrap:!0,children:n.nombre_cliente?n.nombre_cliente:"P\xfablico General"})]}),Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(L.a,{variant:"subtitle1",children:Object(H.jsx)("b",{children:"Dinero disponible:"})}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["$",n.monedero_electronico?Ua(n.monedero_electronico-t.puntos):0]})]}),Object(H.jsx)(O.a,{display:"flex",children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:[Object(H.jsx)("b",{children:"Dinero elec. a generar:"})," ".concat(c?Ua(c):0)]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",children:[Object(H.jsx)(L.a,{style:{fontSize:"17px"},children:Object(H.jsx)("b",{children:"Descuento:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{variant:"h6",children:["$ ",a.descuento?Ua(a.descuento):0]})]}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",children:[Object(H.jsx)(L.a,{align:"left",style:{fontSize:"25px"},children:Object(H.jsx)("b",{children:1===Math.sign(a.cambio)?"Cambio:":"Faltante:"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{style:1===Math.sign(a.cambio)?{fontSize:25,color:"#4caf50"}:0===Math.sign(a.cambio)?{fontSize:25,color:"#000"}:{fontSize:25,color:"#f6685e"},children:Object(H.jsxs)("b",{children:["$ ",a.cambio?Ua(a.cambio):0]})})]})]})]})}function Zv(e){var t=e.montos,a=e.setMontos,n=e.totales,c=e.setTotales,r=e.venta_credito,i=e.setMontoEnCaja,o=e.datosCliente,s=e.setDatosCliente,l=(e.venta_base,e.fechaVencimientoDate),d=e.setfechaVencimientoDate,u=e.setAbonoMinimo,b=e.abono_minimo,p=JSON.parse(localStorage.getItem("DatosVentas")),O=p?parseFloat(p.total.toFixed(2)):0;return Object(j.useEffect)((function(){d(Dt()().add(o.dias_credito?parseInt(o.dias_credito):0,"days").format("YYYY-MM-DD"))}),[o,o.dias_credito]),Object(j.useEffect)((function(){r?(a({efectivo:0,tarjeta:0,puntos:0,transferencia:0,cheque:0}),c(Object(m.a)(Object(m.a)({},n),{},{cambio:0,monto_pagado:O})),i(0)):(a(Object(m.a)(Object(m.a)({},t),{},{efectivo:O})),i(O))}),[r]),Object(H.jsx)(j.Fragment,{children:Object(H.jsx)(Qe.a,{item:!0,xs:12,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:1,children:[Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsx)("b",{children:"Dias de Cr\xe9dito:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:null===o.dias_credito?0:o.dias_credito,onChange:function(e){return s(Object(m.a)(Object(m.a)({},o),{},{dias_credito:e.target.value}))},disabled:!0})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsx)("b",{children:"L\xedmite de Cr\xe9dito:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:null===o.limite_credito?0:o.limite_credito,disabled:!0})]}),Object(H.jsxs)(Qe.a,{item:!0,md:4,xs:12,children:[Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsx)("b",{children:"Cr\xe9dito Disponible:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",value:null===o.credito_disponible?0:o.credito_disponible,disabled:!0})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsx)("b",{children:"Abono m\xednimo:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"abono_minimo",id:"form-abono_minim",variant:"outlined",onChange:function(e){return u(e.target.value)},value:b})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{variant:"caption",children:Object(H.jsx)("b",{children:"Fecha de Vencimiento:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"codigo_barras",id:"form-producto-codigo-barras",variant:"outlined",type:"date",value:l,onChange:function(e){var t=Dt()(e.target.value).add(1,"days"),a=Dt()(),n=t.diff(a,"days");d(e.target.value),s(Object(m.a)(Object(m.a)({},o),{},{dias_credito:n}))},disabled:!0})]})]})})})}var eC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function tC(e){var t=e.venta_base,a=e.setVentaBase,n=e.totales,c=e.setTotales,r=e.montos,i=e.setMontos,o=Object(j.useState)(!1),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(0),b=Object(y.a)(u,2),p=b[0],x=b[1],h=Object(j.useState)(0),_=Object(y.a)(h,2),f=_[0],g=_[1],v=Object(j.useState)({productos:t.productos,total:n.total,subTotal:n.subtotal,impuestos:n.impuestos,iva:t.iva,ieps:t.ieps,descuento:n.descuento,descuento_general_activo:!1,descuento_general:{cantidad_descontado:0,porciento:0,precio_con_descuento:0}}),C=Object(y.a)(v,2),A=C[0],I=C[1],k=JSON.parse(localStorage.getItem("DatosVentas")),w=k?parseFloat(k.subTotal.toFixed(2)):0,N=function(){return d(!1)},P=function(e,t){for(var a=Object(m.a)({},k).productos,n=0,c=0,r=0,i=0,o=0,s=0,l=[],d=0;d<a.length;d++){var j=a[d],u={},b=parseFloat(e),p=parseFloat(t),O=parseFloat((j.precio_actual_object.precio_venta*j.cantidad_venta-p).toFixed(2)),x=parseFloat((O*parseFloat("0.".concat(j.id_producto.precios.iva<10?"0".concat(j.id_producto.precios.iva):j.id_producto.precios.iva))).toFixed(2)),h=parseFloat((O*parseFloat("0.".concat(j.id_producto.precios.ieps<10?"0".concat(j.id_producto.precios.ieps):j.id_producto.precios.ieps))).toFixed(2)),_=parseFloat((O+x+h).toFixed(2)),g=parseFloat(((O-j.id_producto.precios.precio_de_compra.precio_sin_impuesto)/j.id_producto.precios.precio_de_compra.precio_sin_impuesto*100).toFixed(2));u={cantidad_unidad:1,dinero_descontado:p,ieps_precio:h,iva_precio:x,numero_precio:j.precio_actual_object.numero_precio,porciento:j.precio_actual_object.porciento?parseFloat((parseFloat(j.precio_actual_object.porciento)+parseFloat(f)).toFixed(2)):parseFloat(f),precio_general:0,precio_neto:_,precio_venta:O,unidad_maxima:!1,utilidad:g},j.precio_actual_object.unidad_maxima&&(u.cantidad_unidad=j.precio_actual_object.cantidad_unidad,u.precio_general=_*parseFloat(j.precio_actual_object.cantidad_unidad),u.unidad_maxima=!0);var v=!0===j.granel_producto.granel?parseFloat(j.granel_producto.valor):1,C=parseFloat((u.ieps_precio*v).toFixed(2)),y=parseFloat(((u.ieps_precio+u.iva_precio)*v).toFixed(2)),A=parseFloat((u.iva_precio*v).toFixed(2)),S=parseFloat((u.precio_venta*v).toFixed(2)),F=parseFloat((u.precio_neto*v).toFixed(2)),w=parseFloat((parseFloat(u.dinero_descontado)*v).toFixed(2));l.push(Object(m.a)(Object(m.a)({},j),{},{precio_actual_object:u,ieps_total_producto:C,impuestos_total_producto:y,iva_total_producto:A,subtotal_total_producto:S,total_total_producto:F,descuento_activo:!0,descuento:{cantidad_unidad:j.precio_actual_object.cantidad_unidad,numero_precio:j.precio_actual_object.numero_precio,unidad_maxima:j.precio_actual_object.unidad_maxima,precio_general:j.precio_actual_object.precio_general,precio_neto:_,precio_venta:O,iva_precio:x,ieps_precio:h,utilidad:g,dinero_descontado:w,porciento:j.precio_actual_object.porciento?parseFloat((parseFloat(j.precio_actual_object.porciento)+parseFloat(b)).toFixed(2)):parseFloat(b)}})),n+=F,c+=S,r+=y,i+=A,o+=C,s+=w}I({productos:l,total:n,subTotal:c,impuestos:r,iva:i,ieps:o,descuento:s,descuento_general_activo:!0,descuento_general:{cantidad_descontado:s,porciento:parseFloat(f),precio_con_descuento:n}})},E=function(e){var t=e.target.value;t&&"0"!==t&&0!==parseFloat(t)||(I({productos:k.productos,total:k.total,subTotal:k.subTotal,impuestos:k.impuestos,iva:k.iva,ieps:k.ieps,descuento:k.descuento,descuento_general_activo:!1,descuento_general:{cantidad_descontado:0,porciento:0,precio_con_descuento:0}}),x(0),g(0))},D=Object(j.useState)(0),z=Object(y.a)(D,2),T=z[0],$=z[1],W=Object(j.useState)(0),R=Object(y.a)(W,2),V=R[0],M=R[1],B=Object(Lc.a)(T,700),U=Object(y.a)(B,1)[0],q=Object(Lc.a)(V,700),J=Object(y.a)(q,1)[0];return Object(j.useEffect)((function(){!function(e){var t=e.toString();if(t&&"0"!==t){var a=100*(w-parseFloat(t))/w-100,n=Math.abs(a),c=parseFloat(n.toFixed(2));return g(c),void P(c,t)}I({productos:k.productos,total:k.total,subTotal:k.subTotal,impuestos:k.impuestos,iva:k.iva,ieps:k.ieps,descuento:k.descuento,descuento_general_activo:!1,descuento_general:{cantidad_descontado:0,porciento:0,precio_con_descuento:0}})}(p)}),[U]),Object(j.useEffect)((function(){!function(e){var t=e.toString();if(t&&"0"!==t){var a=w*(t<10?parseFloat("0.0".concat(t.replace(".",""))):100===parseFloat(t)?1:parseFloat("0.".concat(t.replace(".",""))));return x(a.toFixed(2)),void P(t,a.toFixed(2))}I({productos:k.productos,total:k.total,subTotal:k.subTotal,impuestos:k.impuestos,iva:k.iva,ieps:k.ieps,descuento:k.descuento,descuento_general_activo:!1,descuento_general:{cantidad_descontado:0,porciento:0,precio_con_descuento:0}})}(f)}),[J]),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{size:"large",variant:"outlined",color:"primary",startIcon:Object(H.jsx)(L.a,{variant:"h4",children:Object(H.jsx)("b",{children:"%"})}),onClick:function(){return d(!0)},disabled:!t,children:"Descuento"}),Object(H.jsxs)(qe.a,{fullWidth:!0,maxWidth:"sm",open:l,onClose:N,TransitionComponent:eC,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{textAlign:"center",display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h5",children:"Descuento"}),Object(H.jsx)(F.a,{color:"secondary",variant:"contained",size:"small",onClick:N,children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Mt.a,{severity:"info",children:["El descuento se aplica en el ",Object(H.jsx)("b",{children:"SUBTOTAL"})," de la venta."]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,justifyContent:"center",children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Dinero a descontar:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"dinero-descuento",id:"form-venta-dinero-descuento",value:p,onChange:function(e){x(e.target.value),$(e.target.value)},variant:"outlined",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})},onBlur:E})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,xs:12,children:[Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Porcentaje:"})}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",id:"form-venta-porsentaje-descuento",variant:"outlined",value:f,onChange:function(e){g(e.target.value),M(e.target.value)},type:"number",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"%"})},onBlur:E})]})]})}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:"IVA"}),Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:Object(H.jsxs)("b",{children:["$",Ua(A.iva)]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:"IEPS"}),Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:Object(H.jsxs)("b",{children:["$",Ua(A.ieps)]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:"Subtotal"}),Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:Object(H.jsxs)("b",{children:["$",Ua(A.subTotal)]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:2,xs:12,children:[Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:"Impuestos"}),Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:Object(H.jsxs)("b",{children:["$",Ua(A.impuestos)]})})]}),Object(H.jsxs)(Qe.a,{item:!0,md:3,xs:12,children:[Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:"Total"}),Object(H.jsx)(L.a,{variant:"subtitle2",align:"center",children:Object(H.jsxs)("b",{children:["$",Ua(A.total)]})})]})]})})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){return function(){var e=Object(m.a)({},k),t=A.productos,o=A.total,s=A.subTotal,l=A.impuestos,d=A.iva,j=A.ieps,u=A.descuento,b=A.descuento_general_activo,p=A.descuento_general;a(Object(m.a)(Object(m.a)({},e),{},{productos:t,total:o,subTotal:s,impuestos:l,iva:d,ieps:j,descuento:u,descuento_general_activo:b,descuento_general:p})),c(Object(m.a)(Object(m.a)({},n),{},{total:o,subtotal:s,impuestos:l,descuento:u})),i(Object(m.a)(Object(m.a)({},r),{},{efectivo:o})),N()}()},variant:"contained",size:"large",color:"primary",autoFocus:!0,startIcon:Object(H.jsx)(Yt.a,{}),children:"Guardar"})})]})]})}var aC=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n,c,r,i,o,s,l,d,j,u,b,p,m;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.ventaFinal,n=t.monto_pagado,c=t.turno,r=t.sesion,i="",Wt.forEach((function(e){a.forma_pago===e.Value&&(i=e.Name)})),o="",s="",l="",(d=r.empresa.direccionFiscal)&&d.calle&&d.no_ext&&d.municipio&&d.estado&&d.pais&&(o="".concat(d.calle," #").concat(d.no_ext),s="".concat(d.municipio,", ").concat(d.estado),l=d.pais),j=sf()([["Articulo      ","Cantidad","Precio","Importe"]],{align:["l","r"]}),u=[{align:["l","r"]}],b=sf()([["SUBTOTAL:  ","".concat(Ua(a.subTotal))],["IMPUESTOS:  ","".concat(Ua(a.impuestos))],["TOTAL:  ","".concat(Ua(a.total))]],{align:["l","r"]}),p=sf()([["Pago con: ".concat(i),"".concat(Ua(n))],["Su cambio:  ","".concat(Ua(a.cambio))]],{align:["l","r"]}),a.productos.forEach((function(e){var t=e.id_producto.datos_generales.nombre_comercial;u.push(["".concat(t),"".concat(e.cantidad_venta," ").concat(e.unidad)," ".concat(Ua(e.precio_actual_object.precio_neto)),"".concat(Ua(e.precio_a_vender))])})),u=sf()(u),(m=new rf("http://localhost:8000")).cutPartial(),m.setFontSize(1,1),m.setEmphasize(0),m.write("Punto de venta CAFI\n"),m.write("RFC ".concat(r.empresa.rfc,"\n")),m.write("Regimen fiscal ".concat(r.empresa.regimen_fiscal,"\n")),m.write("Domicilio: ".concat(o,"\n")),m.write("".concat(s,"\n")),m.write("".concat(l,"\n")),m.feed(1),m.write("****Ticket de venta****\n"),m.write("Caja ".concat(c.numero_caja,"\n")),m.write("Folio: ".concat(a.folio,"\n")),m.write("Fecha: ".concat(Dt()().locale("es-mx").format("DD/MM/YYYY")," Hora: ").concat(Dt()().locale("es-mx").format("LTS"),"\n")),m.feed(1),m.write("=======================================\n"),m.setAlign("right"),m.write("".concat(j,"\n")),m.write("_______________________________________\n"),m.write("".concat(u,"\n")),m.write("----------------------------------------\n"),m.write("".concat(b,"\n")),m.write("----------------------------------------\n"),m.write("".concat(p,"\n")),m.write("========================================\n"),m.feed(1),m.setAlign("center"),m.write("***Gracias por su compra***"),m.feed(3),m.cut(),e.next=48,m.end();case 48:e.next=53;break;case 50:e.prev=50,e.t0=e.catch(0),console.log(e.t0);case 53:case"end":return e.stop()}}),e,null,[[0,50]])})));return function(t){return e.apply(this,arguments)}}(),nC=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a,n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:".concat("8080","/?impresora=").concat(t));case 3:return a=e.sent,e.next=6,a.json();case 6:if(n=e.sent,200!==a.status){e.next=11;break}return e.abrupt("return",{success:!0,message:"Cajon abierto"});case 11:return e.abrupt("return",{success:!1,message:n});case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",{success:!1,message:"Error al abrir cajon, No se detecto impresora"});case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),cC=a.p+"static/media/cart.20c27a2c.svg",rC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),iC={efectivo:0,tarjeta:0,puntos:0,transferencia:0,cheque:0},oC={subtotal:0,impuestos:0,total:0,descuento:0,cambio:0,monto_pagado:0};function sC(){var e=ig(),t=Object(j.useState)(!1),a=Object(y.a)(t,2),n=a[0],c=a[1],r=JSON.parse(localStorage.getItem("sesionCafi")),i=JSON.parse(localStorage.getItem("turnoEnCurso")),o=JSON.parse(localStorage.getItem("DatosVentas")),s=localStorage.getItem("cafiTicketPrint"),l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useContext)(qf),x=p.updateTablaVentas,h=p.setUpdateTablaVentas,_=p.setDatosVentasActual,f=p.setOpenBackDrop,g=p.setVentaRetomada,A=Object(j.useContext)(Po),I=A.updateClientVenta,k=A.setUpdateClientVenta,N=Object(j.useContext)(be),P=N.isOnline,E=N.saveVentasToCloud,D=Object(j.useState)(iC),z=Object(y.a)(D,2),T=z[0],$=z[1],W=Object(j.useState)(oC),R=Object(y.a)(W,2),V=R[0],B=R[1],U=Object(j.useState)(!1),q=Object(y.a)(U,2),J=q[0],G=q[1],Q=Object(j.useState)(!1),K=Object(y.a)(Q,2),X=K[0],Z=K[1],ee=Object(j.useState)(""),te=Object(y.a)(ee,2),ae=te[0],ne=te[1],re=Object(j.useState)(!1),ie=Object(y.a)(re,2),oe=ie[0],se=ie[1],le=Object(j.useState)(0),de=Object(y.a)(le,2),je=de[0],ue=de[1],pe=Object(j.useState)(0),me=Object(y.a)(pe,2),Oe=me[0],xe=me[1],he=Object(j.useState)(0),_e=Object(y.a)(he,2),fe=_e[0],ge=_e[1],ve=Object(j.useState)(!1),Ce=Object(y.a)(ve,2),ye=Ce[0],Ae=Ce[1],Se=Object(j.useState)({}),Fe=Object(y.a)(Se,2),Ie=Fe[0],ke=Fe[1],we=Object(j.useState)(0),Ne=Object(y.a)(we,2),Pe=Ne[0],Ee=Ne[1],De=Object(j.useState)({message:"",status:"",open:!1}),ze=Object(y.a)(De,2),Te=ze[0],$e=ze[1],We=Object(j.useState)(0),Re=Object(y.a)(We,2),Ve=Re[0],Me=Re[1],Le=Object(j.useState)(""),Be=Object(y.a)(Le,2),Ue=Be[0],Je=Be[1],Ge=Object(w.a)(hm),Ke=Object(y.a)(Ge,1)[0],Xe=function(){if(!u){var e=JSON.parse(localStorage.getItem("DatosVentas"));ge(e);var t=e.cliente,a=e.subTotal,n=e.impuestos,c=e.total,r=e&&t?t:{};r.credito_disponible?Z(!0):Z(!1),ke(r),xe(null===e?0:parseFloat(c.toFixed(2))),B({subtotal:null===e?0:parseFloat(a.toFixed(2)),impuestos:null===e?0:parseFloat(n.toFixed(2)),total:null===e?0:parseFloat(c.toFixed(2)),descuento:0,cambio:0,monto_pagado:null===e?0:parseFloat(c.toFixed(2))}),$({efectivo:null===e?0:parseFloat(c.toFixed(2)),tarjeta:0,puntos:0,transferencia:0,cheque:0});var i=function(e){var t=0;return e&&e.productos.forEach((function(e){if(e.id_producto.precios.monedero){var a=e.id_producto.precios.monedero_electronico*e.precio_a_vender;t+=a}})),t}(e);Ee(parseFloat(i)),ue(t.monedero_electronico?parseFloat(t.monedero_electronico)+parseFloat(i):parseFloat(i))}b(!u)},Ze=function(){c(!1),et()},et=function(){ke({}),Ee(0),ne(""),ue(0),ge(0),Ae(!1),G(!1),xe(0),B(oC),$(iC),g(null),Me(0),Je("")};var at=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a,n,i,o,l,d,j,u,p,O;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(J&&fe.total>Ie.credito_disponible)){e.next=3;break}return se(!0),e.abrupt("return");case 3:if(!(V.cambio<0)){e.next=5;break}return e.abrupt("return");case 5:return se(!1),e.prev=6,f(!0),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=JSON.parse(localStorage.getItem("sesionCafi")),n=Object(m.a)({},fe),i=Va(1e11,999999999999),n.folio="".concat(i),o={monto_efectivo:{monto:parseFloat(T.efectivo),metodo_pago:Wt[0].Value},monto_tarjeta_debito:{monto:parseFloat(T.tarjeta),metodo_pago:Wt[3].Value},monto_tarjeta_credito:{monto:0,metodo_pago:Wt[3].Value},monto_creditos:{monto:J?n.total:0,metodo_pago:"99"},monto_monedero:{monto:parseFloat(T.puntos),metodo_pago:Wt[4].Value},monto_transferencia:{monto:parseFloat(T.transferencia),metodo_pago:Wt[2].Value},monto_cheques:{monto:parseFloat(T.cheque),metodo_pago:Wt[1].Value},monto_vales_despensa:{monto:0,metodo_pago:Wt[6].Value}},l=parseFloat(Ve),n.montos_en_caja=o,n.credito=J,n.abono_minimo=J&&l?l:0,n.descuento_general_activo=!!n.descuento_general_activo&&n.descuento_general_activo,n.descuento_general=n.descuento_general?n.descuento_general:null,n.dias_de_credito_venta=Ie?Ie.dias_credito:null,n.fecha_de_vencimiento_credito=ae,n.fecha_vencimiento_cotizacion=null,n.cambio=V.cambio,n.editar_cliente=ye,n.puntos_totales_venta=parseFloat(T.puntos)>0?je-Pe:je,n.metodo_pago=J?"PPD":"PUE",d=0,J?j="99":Object.keys(o).forEach((function(e){o[e].monto>d&&(d=o[e].monto,j=o[e].metodo_pago)})),Ue&&(n.fecha_venta=Ue),n.forma_pago=j,n.turno=t.horario_en_turno,e.next=34,Ke({variables:{input:n,empresa:t.empresa,sucursal:t.sucursal,usuario:a._id,caja:t.id_caja,isOnline:P}});case 34:if(u=e.sent,P||(E(Object(m.a)(Object(m.a)({},u.data.createVenta.datos_to_save_storage),{},{empresa:t.empresa,sucursal:t.sucursal,cliente:n.cliente,productos:n.productos,puntos_totales_venta:n.puntos_totales_venta,usuario:a._id,caja:n.caja,credito:n.credito,forma_pago:n.forma_pago,tipo_venta:n.tipo_venta,montos_en_caja:n.montos_en_caja})),f(!1),b(!1)),"TICKET"!==n.tipo_emision){e.next=40;break}return p={ventaFinal:n,monto_pagado:d,turno:t,sesion:r},e.next=40,aC(p);case 40:return e.next=42,nC(s);case 42:!0===(O=e.sent).success?$e({message:"Cajon abierto",status:"success",open:!0}):$e({message:"Error al abrir cajon: ".concat(O.message),status:"error",open:!0}),f(!1),b(!1),c(!0),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),h(!x),k(!I),_({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),e.next=55;break;case 49:e.prev=49,e.t0=e.catch(6),f(!1),$e({message:"Hubo un error",status:"error",open:!0}),console.log(e.t0),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message);case 55:case"end":return e.stop()}}),e,null,[[6,49]])})));return function(){return e.apply(this,arguments)}}();return window.onkeydown=function(e){var t=e.keyCode;27===t&&o?Xe():13===t&&n&&!u&&Ze()},Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{className:e.borderBotonChico,onClick:function(){return Xe()},disabled:!i||!o,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:cC,alt:"icono ventas",style:{width:38}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Pagar"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"ESC"})})})]})}),Object(H.jsxs)(qe.a,{fullWidth:!0,maxWidth:"sm",open:u,onClose:function(){return Xe()},TransitionComponent:rC,children:[Object(H.jsx)(Y,{alert:Te,setAlert:$e}),Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:oe,autoHideDuration:5e3,onClose:function(){return se(!1)},message:"La cantidad total de la venta supera el cr\xe9dito disponible del cliente",action:Object(H.jsx)(ce.a,{size:"small","aria-label":"close",color:"inherit",onClick:function(){return se(!1)},children:Object(H.jsx)(Gt.a,{fontSize:"small"})})}),Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:cC,alt:"icono ventas",style:{width:40}})}),Object(H.jsx)(O.a,{mx:2,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h5",children:"Terminar Venta"})}),Object(H.jsx)(O.a,{mx:2,children:Object(H.jsx)(S.a,{size:"small",variant:"outlined",type:"date",defaultValue:Dt()().locale("es-mx").format("YYYY-MM-DD"),InputProps:{inputProps:{max:Dt()().locale("es-mx").format("YYYY-MM-DD")}},onChange:function(e){return Je(e.target.value)},disabled:!r.accesos.ventas.administrador.ver})}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return Xe()},size:"large",children:Object(H.jsx)(Ye.a,{})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[Object(H.jsx)(L.a,{style:{fontSize:"18px"},children:Object(H.jsx)("b",{children:J?"Total a cr\xe9dito":"Total a pagar"})}),Object(H.jsx)(L.a,{variant:"h2",style:{color:"#4caf50"},children:Object(H.jsxs)("b",{children:["$ ",Ua(V.total)]})}),Object(H.jsx)(L.a,{style:{color:"#4caf50"},children:Object(H.jsx)("b",{children:Qa(V.total)})})]}),Object(H.jsx)(Kv,{montos:T,setMontos:$,totales:V,setTotales:B,venta_credito:J,montoEnCaja:Oe,setMontoEnCaja:xe,datosCliente:Ie}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,justifyContent:"space-between",children:[Object(H.jsx)(Xv,{montos:T,totales:V,datosCliente:Ie,monedero:Pe,monederoTotal:je}),Object(H.jsx)(O.a,{display:J?"flex":"none",children:Object(H.jsx)(Zv,{montos:T,setMontos:$,totales:V,setTotales:B,venta_credito:J,venta_base:fe,setMontoEnCaja:xe,datosCliente:Ie,setDatosCliente:ke,editarCliente:ye,setEditarCliente:Ae,fechaVencimientoDate:ae,setfechaVencimientoDate:ne,setAbonoMinimo:Me,abono_minimo:Ve})})]})})]}),Object(H.jsxs)(tt.a,{style:{justifyContent:"space-between"},children:[Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-start",children:[Object(H.jsx)(O.a,{pr:1,children:J?Object(H.jsx)(F.a,{size:"large",variant:"contained",color:"secondary",onClick:function(){G(!1),Ae(!1)},startIcon:Object(H.jsx)(Jv.a,{}),children:"Cancelar"}):Object(H.jsx)(F.a,{size:"large",variant:"outlined",color:"primary",onClick:function(){G(!0)},startIcon:Object(H.jsx)(L.a,{variant:"h4",children:Object(H.jsx)("b",{children:"$"})}),disabled:!X||!fe,children:"Credito"})}),Object(H.jsx)(tC,{venta_base:fe,setVentaBase:ge,montos:T,setMontos:$,totales:V,setTotales:B})]}),Object(H.jsx)(F.a,{onClick:function(){at()},size:"large",variant:"contained",color:"primary",autoFocus:!0,disabled:!fe||V.cambio<0,startIcon:Object(H.jsx)(Yt.a,{}),children:"Terminar"})]})]}),Object(H.jsxs)(qe.a,{open:n,onClose:function(){return Ze()},TransitionComponent:rC,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{style:{textAlign:"center"},children:Object(H.jsx)(Mt.a,{severity:"success",action:Object(H.jsx)(ce.a,{onClick:function(){return Ze()},size:"small",color:"inherit",autoFocus:!0,children:Object(H.jsx)(Gt.a,{style:{fontSize:"25px"}})}),children:"Venta finalizada"})}),Object(H.jsx)(He.a,{children:Object(H.jsxs)(O.a,{mb:2,children:[Object(H.jsx)(L.a,{variant:"h6",align:"center",children:"Su c\xe1mbio"}),Object(H.jsxs)(L.a,{variant:"h3",align:"center",children:["$",Ua(V.cambio)]})]})})]})]})}var lC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function dC(){var e,t,a,n,c,r=ig(),i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=JSON.parse(localStorage.getItem("sesionCafi")),u=JSON.parse(localStorage.getItem("turnoEnCurso")),b=JSON.parse(localStorage.getItem("DatosVentas")),p=Object(j.useState)({}),x=Object(y.a)(p,2),h=x[0],_=x[1],f=Object(j.useContext)(qf),g=f.productoCambioPrecio,A=f.precioSelectProductoVenta,S=f.setPrecioSelectProductoVenta,I=f.setUpdateTablaVentas,k=f.updateTablaVentas,w=Object(j.useContext)(be),N=w.reloadVerPrecios,P=w.setReloadVerPrecios,E=w.setAbrirPanelAcceso,D=w.abrirPanelAcceso,z=w.setDepartamentos,T=Object(j.useState)(A.length>0?A[0]:{}),$=Object(y.a)(T,2),W=$[0],R=$[1],V=Object(j.useState)({message:"",status:"",open:!1}),M=Object(y.a)(V,2),B=M[0],U=M[1],q=function(){!0===d.accesos.ventas.precios_productos.ver?l(!s):(E(!D),z({departamento:"ventas",subDepartamento:"precios_productos",tipo_acceso:"ver"}))};Object(j.useEffect)((function(){_(g)}),[g]),Object(j.useEffect)((function(){!0===N&&(l(!s),P(!1))}),[N]);var J=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,a,n,c,r,i,o,s,l,d,j;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(localStorage.getItem("DatosVentas")),a=null===t?[]:t.productos,n=null===t?[]:t,c=null===t?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:t,r=a,!(W.precio_neto>0||A.length>0)){e.next=40;break}return i=Object(m.a)({},g),o=Object(m.a)({},g),e.next=10,Ja(g);case 10:if(!(s=e.sent).found){e.next=37;break}return e.next=14,Ha({newP:i,cantidad:i.cantidad_venta,precio_boolean:!0,precio:i.precio_actual_object,granel:i.granel_producto,origen:""});case 14:return l=e.sent,e.next=17,Ha({newP:o,cantidad:o.cantidad_venta,precio_boolean:!0,precio:A[0],granel:o.granel_producto,origen:"Tabla"});case 17:d=e.sent,o.precio_a_vender=A[0].precio_neto,o.precio_seleccionado=!0,o.precio_actual_producto=parseFloat(A[0].precio_neto.toFixed(2)),o.precio_actual_object=A[0],o.iva_total_producto=parseFloat(d.ivaCalculo),o.ieps_total_producto=parseFloat(d.iepsCalculo),o.impuestos_total_producto=parseFloat(d.impuestoCalculo),o.subtotal_total_producto=parseFloat(d.subtotalCalculo),o.total_total_producto=parseFloat(d.totalCalculo),o.precio_actual_object={cantidad_unidad:A[0].cantidad_unidad?A[0].cantidad_unidad:null,numero_precio:A[0].numero_precio?A[0].numero_precio:null,unidad_maxima:A[0].unidad_maxima?A[0].unidad_maxima:null,precio_general:A[0].precio_general?A[0].precio_general:null,precio_neto:A[0].precio_neto?A[0].precio_neto:null,precio_venta:A[0].precio_venta?A[0].precio_venta:null,iva_precio:A[0].iva_precio?A[0].iva_precio:null,ieps_precio:A[0].ieps_precio?A[0].ieps_precio:null,utilidad:A[0].utilidad?A[0].utilidad:null,porciento:A[0].porciento?A[0].porciento:null,dinero_descontado:A[0].dinero_descontado?A[0].dinero_descontado:null},r.splice(s.producto_found.index,1,o),j={subTotal:parseFloat(c.subTotal)-parseFloat(l.subtotalCalculo)+d.subtotalCalculo,total:parseFloat(c.total)-parseFloat(l.totalCalculo)+d.totalCalculo,impuestos:parseFloat(c.impuestos)-parseFloat(l.impuestoCalculo)+d.impuestoCalculo,iva:parseFloat(c.iva)-parseFloat(l.ivaCalculo)+d.ivaCalculo,ieps:parseFloat(c.ieps)-parseFloat(l.iepsCalculo)+d.iepsCalculo,descuento:parseFloat(c.descuento)-parseFloat(l.descuentoCalculo)+d.descuentoCalculo,monedero:parseFloat(c.monedero)-parseFloat(l.monederoCalculo)+d.monederoCalculo},localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)({},j),{},{cliente:!0===n.venta_cliente?n.cliente:{},venta_cliente:!0===n.venta_cliente&&n.venta_cliente,productos:r,tipo_emision:n.tipo_emision?n.tipo_emision:"TICKET"}))),I(!k),S([]),_({}),q(),e.next=38;break;case 37:console.log("Producto no encontrado");case 38:e.next=41;break;case 40:U({message:"Este precio no es valido.",status:"error",open:!0});case 41:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(e){var t=[];t=t.concat([],e),R(e),S(t)};return window.addEventListener("keydown",(function(e){114===e.keyCode&&q()})),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(Y,{alert:B,setAlert:U}),Object(H.jsx)(F.a,{className:r.borderBotonChico,onClick:q,disabled:!u||!A.length||b&&b.nota_credito,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{style:!u||!A.length||b&&b.nota_credito?{pointerEvents:"none",opacity:.5}:null,children:Object(H.jsx)("img",{src:Hv,alt:"icono money",style:{fontSize:25}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Precios"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"F3"})})})]})}),Object(H.jsxs)(qe.a,{maxWidth:"lg",open:s,onClose:function(){return l(!s)},TransitionComponent:lC,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:"Precios de Producto"}),Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return l(!s)},size:"large",children:Object(H.jsx)(Ye.a,{})})})]})}),Object(H.jsxs)(He.a,{children:[Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(L.a,{variant:"h6",align:"center",children:g?null===g||void 0===g||null===(e=g.id_producto)||void 0===e||null===(t=e.datos_generales)||void 0===t?void 0:t.nombre_comercial:""})}),Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{padding:"checkbox"}),Object(H.jsx)(Da.a,{children:"No. Precio"}),Object(H.jsx)(Da.a,{children:"Precio neto"}),Object(H.jsx)(Da.a,{children:"Unidad mayoreo"}),Object(H.jsx)(Da.a,{children:"Utilidad"})]})}),Object(H.jsx)(za.a,{children:null===h||void 0===h||null===(a=h.id_producto)||void 0===a||null===(n=a.precios)||void 0===n||null===(c=n.precios_producto)||void 0===c?void 0:c.map((function(e,t){var a,n=(a=e,-1!==A.indexOf(a)),c="enhanced-table-checkbox-".concat(t);return Object(H.jsx)(jC,{precio:e,isItemSelected:n,labelId:c,handleClick:G},t)}))})]})})})]}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(F.a,{onClick:function(){return J()},variant:"contained",color:"primary",size:"large",children:"Guardar"})})]})]})}var jC=function(e){var t=e.precio,a=e.isItemSelected,n=e.labelId,c=e.handleClick;return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Ea.a,{role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,hover:!0,onClick:function(e){return function(e){if(!(t.precio_neto<=0))try{2===e.detail&&c(t)}catch(a){console.log(a)}}(e)},children:[Object(H.jsx)(Da.a,{padding:"checkbox",children:Object(H.jsx)(Ze.a,{disabled:t.precio_neto<=0,onClick:function(e){c(t)},checked:a,inputProps:{"aria-labelledby":n}})}),Object(H.jsx)(Da.a,{align:"center",children:t.numero_precio}),Object(H.jsx)(Da.a,{align:"center",children:t.precio_neto>0?Ua(t.precio_neto):0}),Object(H.jsx)(Da.a,{align:"center",children:t.unidad_mayoreo}),Object(H.jsxs)(Da.a,{align:"center",children:[t.utilidad," %"]})]},t.numero_precio)})},uC=[{id:"fecha",label:"Fecha",minWidth:20,align:"center"},{id:"cliente",label:"Cliente",minWidth:330,align:"center"},{id:"productos",label:"Productos",minWidth:20,align:"center"},{id:"total",label:"Total",minWidth:200,align:"center"}],bC=Object(k.a)({root:{width:"100%"},container:{height:"45vh","& ::-webkit-scrollbar":{display:"none"}}});function pC(e){var t=e.handleModalEspera,a=bC(),n=JSON.parse(localStorage.getItem("ListaEnEspera"));return Object(H.jsx)(fn.a,{className:a.root,children:Object(H.jsx)(Na.a,{className:a.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[uC.map((function(e,t){return Object(H.jsx)(Da.a,{align:e.align,style:{width:e.minWidth},children:e.label},t)})),Object(H.jsx)(Da.a,{align:"center",style:{width:35},children:"Regresar"}),Object(H.jsx)(Da.a,{align:"center",style:{width:35},children:"Eliminar"})]})}),Object(H.jsx)(za.a,{children:null===n||void 0===n?void 0:n.map((function(e,a){return Object(H.jsx)(mC,{venta:e,index:a,handleModalEspera:t},a)}))})]})})})}var mC=function(e){var t=e.venta,a=e.index,n=e.handleModalEspera,c=Object(j.useContext)(be),r=c.reloadEliminarVentaEspera,i=c.setReloadEliminarVentaEspera,o=c.setAbrirPanelAcceso,s=c.abrirPanelAcceso,l=c.setDepartamentos,d=Object(j.useContext)(qf),u=d.updateTablaVentas,b=d.setUpdateTablaVentas,p=Object(j.useContext)(Po),m=p.updateClientVenta,O=p.setUpdateClientVenta,x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=JSON.parse(localStorage.getItem("sesionCafi")),v=JSON.parse(localStorage.getItem("ListaEnEspera")),C=JSON.parse(localStorage.getItem("DatosVentas"));function A(){if(!0!==g.accesos.ventas.eliminar_ventas.ver)return null;var e=Object(Ia.a)(v);e.splice(a,1),0===e.length?localStorage.removeItem("ListaEnEspera"):localStorage.setItem("ListaEnEspera",JSON.stringify(e)),b(!u)}var S=function(){b(!u),O(!m)};return Object(j.useEffect)((function(){!0===r&&(A(),i(!1))}),[r]),Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Ea.a,{hover:!0,tabIndex:-1,children:[Object(H.jsx)(Da.a,{align:"center",children:t.fecha?t.fecha:""}),Object(H.jsx)(Da.a,{align:"center",children:t.datosVenta.cliente&&t.datosVenta.cliente.nombre_cliente?t.datosVenta.cliente.nombre_cliente:"Pub. General"}),Object(H.jsx)(Da.a,{align:"center",children:t.datosVenta.productos.length}),Object(H.jsxs)(Da.a,{align:"center",children:["$ ",Ua(t.datosVenta.total)]}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(OC,{AgregarVentaDeNuevo:function(){if(null===C){var e=Object(Ia.a)(v);if(localStorage.setItem("DatosVentas",JSON.stringify(t.datosVenta)),e.splice(a,1),0===e.length)return localStorage.removeItem("ListaEnEspera"),S(),void n();localStorage.setItem("ListaEnEspera",JSON.stringify(e)),S(),n()}else f(!_)},open:_,handleClickOpen:function(){f(!_)}})}),Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(xC,{verificarPermisos:function(){!0===g.accesos.ventas.eliminar_ventas.ver?A():(o(!s),l({departamento:"ventas",subDepartamento:"eliminar_ventas",tipo_acceso:"ver"}))}})})]})})},OC=function(e){var t=e.open,a=e.handleClickOpen,n=e.AgregarVentaDeNuevo;return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{"aria-label":"regresar",color:"primary",size:"small",onClick:function(){return n()},children:Object(H.jsx)(Qg.a,{fontSize:"medium"})}),Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t,autoHideDuration:5e3,onClose:a,message:"No puedes agregar una venta cuando ya est\xe1 una en curso.",action:Object(H.jsx)(ce.a,{size:"small","aria-label":"close",color:"inherit",onClick:a,children:Object(H.jsx)(Ye.a,{fontSize:"small"})})})]})},xC=function(e){var t=e.verificarPermisos,a=Object(j.useState)(!1),n=Object(y.a)(a,2),c=n[0],r=n[1],i=function(){return r(!1)};return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{"aria-label":"delete",size:"small",onClick:function(){return r(!0)},children:Object(H.jsx)(hO.a,{fontSize:"medium"})}),Object(H.jsxs)(qe.a,{onClose:function(){return i()},open:c,children:[Object(H.jsx)(Bt.a,{children:"Se eliminara esta venta en espera"}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{color:"inherit",size:"small",onClick:function(){return i()},children:"Cancelar"}),Object(H.jsx)(F.a,{color:"secondary",size:"small",onClick:function(){return t()},children:"Eliminar"})]})]})]})},hC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function _C(){var e=JSON.parse(localStorage.getItem("ListaEnEspera")),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=JSON.parse(localStorage.getItem("DatosVentas")),n=Object(j.useContext)(qf).updateTablaVentas,c=ig(),r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=function(){s(!o)};return window.addEventListener("keydown",(function(e){e.altKey&&76===e.keyCode&&l()})),Object(j.useEffect)((function(){e&&(e=JSON.parse(localStorage.getItem("ListaEnEspera")))}),[n]),Object(j.useEffect)((function(){t=JSON.parse(localStorage.getItem("turnoEnCurso"))}),[n,t]),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{className:c.borderBotonChico,onClick:l,disabled:!t||a&&a.nota_credito,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(Sc.a,{badgeContent:e?e.length:0,color:"primary",style:{fontSize:45},children:Object(H.jsx)("img",{src:Gg,alt:"icono caja2",style:{width:38}})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Ventas en Espera"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + L"})})})]})}),Object(H.jsx)(qe.a,{maxWidth:"lg",open:o,onClose:l,TransitionComponent:hC,children:Object(H.jsxs)(He.a,{children:[Object(H.jsxs)(Qe.a,{container:!0,item:!0,lg:12,children:[Object(H.jsxs)(O.a,{display:"flex",flexGrow:1,children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:Gg,alt:"icono caja",className:c.iconSizeDialogs})}),Object(H.jsx)(O.a,{m:2,children:Object(H.jsx)(et.a,{orientation:"vertical"})}),Object(H.jsx)(O.a,{mt:3,children:Object(H.jsx)(L.a,{variant:"h6",children:"Ventas en espera"})})]}),Object(H.jsx)(O.a,{children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:l,size:"large",children:Object(H.jsx)(Ye.a,{})})})]}),Object(H.jsx)(Qe.a,{children:Object(H.jsx)(pC,{handleModalEspera:l})})]})})]})}var fC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function gC(e){var t=e.venta,a=e.handleCloseInfoVenta,n=e.refetch,c=e.dinero_disponible,r=e.selected,i=e.view,o=Object(j.useContext)(be),s=o.reloadCancelarVenta,l=o.setReloadCancelarVenta,d=o.setAbrirPanelAcceso,u=o.abrirPanelAcceso,b=o.setDepartamentos,p=Object(j.useState)(!1),x=Object(y.a)(p,2),h=x[0],_=x[1],f=Object(j.useState)(!1),k=Object(y.a)(f,2),N=k[0],P=k[1],E=Object(j.useState)({message:"",status:"",open:!1}),D=Object(y.a)(E,2),z=D[0],T=D[1],$=Object(j.useState)({observaciones:"",devolucion_efectivo:!1,devolucion_credito:!1}),W=Object(y.a)($,2),R=W[0],V=W[1],M=JSON.parse(localStorage.getItem("turnoEnCurso")),B=JSON.parse(localStorage.getItem("sesionCafi")),U=Object(w.a)(Cm),q=Object(y.a)(U,1)[0],J=function(){if(!0===B.accesos.ventas.cancelar_venta.editar)_(!0);else{if(!s)return;_(!0)}},G=function(){_(!1)},Q=function(e){var t=e.target,a=t.name,n=t.checked;V(Object(m.a)(Object(m.a)({},R),{},Object(g.a)({},a,n)))},K=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.prev=1,R.turno={horario_en_turno:M.horario_en_turno,numero_caja:parseInt(M.numero_caja),id_caja:M.id_caja,usuario_en_turno:{nombre:M.usuario_en_turno.nombre,numero_usuario:M.usuario_en_turno.numero_usuario,_id:B._id},empresa:M.empresa,sucursal:M.sucursal},e.next=5,q({variables:{input:R,empresa:t.empresa,sucursal:t.sucursal,folio:t.folio}});case 5:a=e.sent,T({message:"\xa1Listo! ".concat(a.data.cancelarVentasSucursal.message),status:"success",open:!0}),P(!1),V({devolucion_efectivo:!1,observaciones:"",devolucion_credito:!1}),n(),G(),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0),P(!1),e.t0.message?T({message:e.t0.message,status:"error",open:!0}):T({message:"Hubo un error",status:"error",open:!0}),e.t0.networkError?console.log(e.t0.networkError.result):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors);case 19:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),X=function(){!0===B.accesos.ventas.cancelar_venta.editar?J():(d(!u),b({departamento:"ventas",subDepartamento:"cancelar_venta",tipo_acceso:"editar"}))},Z="";return"table"===i&&(Z=r),Object(j.useEffect)((function(){!0===s&&Z._id===t._id&&(J(),l(!1))}),[s]),Object(H.jsxs)("div",{children:[a?Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return X()},startIcon:Object(H.jsx)(Gt.a,{}),disabled:!("CANCELADO"!==t.status&&!t.factura.length),children:"Cancelar venta"}):Object(H.jsx)(ce.a,{size:"small",color:"secondary",onClick:function(){return X()},disabled:"CANCELADO"===t.status,children:Object(H.jsx)(zr.a,{})}),Object(H.jsx)(Y,{alert:z,setAlert:T}),Object(H.jsxs)(qe.a,{open:h,TransitionComponent:fC,keepMounted:!0,onClose:G,fullWidth:!0,maxWidth:"xs",children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:"Cancelar venta"}),Object(H.jsx)(F.a,{size:"small",variant:"contained",color:"secondary",onClick:function(){return G()},children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsxs)(He.a,{children:[t.factura.length?Object(H.jsx)(Mt.a,{severity:"info",children:"Una venta facturada no se puede hacer devolucion de dinero"}):null,Object(H.jsxs)(O.a,{children:[Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:R.devolucion_credito,onChange:Q,name:"devolucion_credito",disabled:!(t.credito&&!t.factura.length)}),label:"Realizar devolucion de cr\xe9dito"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:R.devolucion_efectivo,onChange:Q,name:"devolucion_efectivo",disabled:!!(t.montos_en_caja.monto_efectivo.monto>c||t.factura.length)}),label:"Realizar devolucion de dinero"}),Object(H.jsx)(O.a,{my:2,children:Object(H.jsxs)(A.a,{maxWidth:"xs",children:[Object(H.jsx)(O.a,{mb:1,children:Object(H.jsx)(L.a,{children:"Devoluci\xf3n en:"})}),Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(H.jsx)(L.a,{style:{width:"120px"},children:"Efectivo"}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_efectivo.monto,style:{width:"150px"},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(H.jsx)(L.a,{style:{width:"120px"},children:"T. Cr\xe9dito"}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_tarjeta_credito.monto,style:{width:"150px"},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(H.jsx)(L.a,{style:{width:"120px"},children:"M. Electr\xf3nico"}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_monedero.monto,style:{width:"150px"},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(H.jsx)(L.a,{style:{width:"120px"},children:"Transferencia"}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_transferencia.monto,style:{width:"150px"},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(H.jsx)(L.a,{style:{width:"120px"},children:"Cheques"}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:!0,value:t.montos_en_caja.monto_cheques.monto,style:{width:"150px"},InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]})]})]})}),Object(H.jsx)(S.a,{label:"Observaciones",variant:"outlined",fullWidth:!0,multiline:!0,rows:3,value:R.observaciones,onChange:function(e){return V(Object(m.a)(Object(m.a)({},R),{},{observaciones:e.target.value}))}})]})]}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:G,color:"inherit",disabled:N,children:"Salir"}),Object(H.jsx)(F.a,{onClick:K,color:"secondary",disabled:N,startIcon:N?Object(H.jsx)(I.a,{size:20,color:"inherit"}):null,children:"Cancelar Venta"})]})]})]})}var vC=Object(k.a)((function(e){return{colorContainer:{height:28,width:28,borderRadius:"15%",fontSize:18,display:"flex",justifyContent:"center",alignItems:"center"}}})),CC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function yC(e){var t=e.venta,a=e.open,n=e.handleClose,c=e.refetch,r=e.handleCloseListaVentas,i=u.a.useState(!1),o=Object(y.a)(i,2),s=o[0],l=o[1],d=u.a.useContext(Po),j=d.updateClientVenta,b=d.setUpdateClientVenta,p=u.a.useContext(qf),m=p.updateTablaVentas,x=p.setUpdateTablaVentas,h=function(){if(!t.nota_credito.length)if(null===JSON.parse(localStorage.getItem("DatosVentas"))){var e=[];t.productos.forEach((function(t){e.push({cantidad:t.cantidad,cantidad_venta:t.cantidad_venta,cantidad_venta_original:t.cantidad_venta,codigo_barras:t.id_producto.datos_generales.codigo_barras,codigo_unidad:t.codigo_unidad,color:t.color,concepto:t.concepto,default:t.default,descuento:t.id_unidad_venta.descuento,descuento_activo:t.id_unidad_venta.descuento_activo,granel_producto:t.granel_producto,id_producto:t.id_producto,id_unidad_venta:t.id_unidad_venta,ieps_total_producto:t.ieps_total,impuestos_total_producto:t.impuestos,inventario_general:t.inventario_general,iva_total_producto:t.iva_total,medida:t.medida,precio:t.precio,precio_a_vender:t.precio_a_vender,precio_actual_object:t.precio_actual_object,precio_actual_producto:t.precio_actual_producto,precio_anterior:t.precio_actual_producto,precio_unidad:t.precio_unidad,subtotal_total_producto:t.subtotal,total_total_producto:t.total,unidad:t.unidad,unidad_principal:t.id_unidad_venta.unidad_principal,_id:t.id_unidad_venta._id})}));var a={_id:t._id,cliente:t.cliente,descuento:t.descuento,ieps:t.ieps,impuestos:t.impuestos,iva:t.iva,monedero:t.monedero,productos:e,subTotal:t.subTotal,total:t.total,venta_cliente:t.venta_cliente,usuario:t.usuario,tipo_emision:t.tipo_emision,folio:t.folio,montos_en_caja:t.montos_en_caja,credito:t.credito,abono_minimo:t.abono_minimo,descuento_general_activo:t.descuento_general_activo,dias_de_credito_venta:t.dias_de_credito_venta,fecha_de_vencimiento_credito:t.fecha_de_vencimiento_credito,cambio:t.cambio,metodo_pago:t.metodo_pago,id_caja:t.id_caja,forma_pago:t.forma_pago,factura:t.factura,empresa:t.empresa,sucursal:t.sucursal,fecha_registro:t.fecha_registro,status:t.status,nota_credito:!0,total_original:t.total,saldo_favor:0};localStorage.setItem("DatosVentas",JSON.stringify(a)),x(!m),b(!j),n(),r()}else l(!0)};return t?Object(H.jsxs)(qe.a,{open:a,TransitionComponent:CC,keepMounted:!0,onClose:n,fullWidth:!0,maxWidth:"lg",children:[Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:s,autoHideDuration:5e3,onClose:function(){l(!1)},message:"No pudes realizar esta acci\xf3n, tienes una venta en curso."}),Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Caja: "})," ".concat(t.id_caja.numero_caja)]}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Usuario en caja:"})," "," ".concat(t.usuario.nombre)]})]}),Object(H.jsxs)(O.a,{children:[Object(H.jsxs)(L.a,{align:"right",children:[Object(H.jsx)("b",{children:"Folio:"})," ".concat(t.folio)]}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsxs)(L.a,{children:[Object(H.jsx)("b",{children:"Fecha:"})," ".concat(Ba(t.fecha_registro))]})]})]})}),Object(H.jsxs)(He.a,{children:[null!==t.cliente?Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(ev.a,{})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Cliente"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Numero de Cliente"}),Object(H.jsx)(Da.a,{children:"Nombre"}),Object(H.jsx)(Da.a,{children:"Clave"}),Object(H.jsx)(Da.a,{children:"Telefono"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.cliente.numero_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.nombre_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.clave_cliente}),Object(H.jsx)(Da.a,{children:t.cliente.telefono})]})})]})})})})]}):null,Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(av.a,{})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Venta"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Venta Cr\xe9dito"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Monedero"}),Object(H.jsx)(Da.a,{children:"IVA"}),Object(H.jsx)(Da.a,{children:"IEPS"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:t.credito?"SI":"NO"}),Object(H.jsxs)(Da.a,{children:["$",t.descuento?Ua(t.descuento):0]}),Object(H.jsxs)(Da.a,{children:["$",t.monedero?Ua(t.monedero):0]}),Object(H.jsxs)(Da.a,{children:["$",t.iva?Ua(t.iva):0]}),Object(H.jsxs)(Da.a,{children:["$",t.ieps?Ua(t.ieps):0]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.subTotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(t.impuestos)]}),Object(H.jsx)(Da.a,{children:Ua(t.total)})]})})]})})})})]}),Object(H.jsxs)(O.a,{my:2,children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(Ke.a,{children:Object(H.jsx)(cv.a,{})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"h6",children:"Art\xedculos"})})]}),Object(H.jsx)(O.a,{my:1,children:Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsx)(Na.a,{children:Object(H.jsxs)($a.a,{size:"small",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"C\xf3digo de barras"}),Object(H.jsx)(Da.a,{children:"Producto"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Medida"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Unidad"}),Object(H.jsx)(Da.a,{padding:"checkbox",children:"Cant"}),Object(H.jsx)(Da.a,{children:"Precio"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"})]})}),Object(H.jsx)(za.a,{children:t.productos.map((function(e,t){return Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:e.id_unidad_venta.codigo_barras}),Object(H.jsx)(Da.a,{children:e.id_producto.datos_generales.nombre_comercial}),Object(H.jsx)(AC,{producto:e}),Object(H.jsx)(Da.a,{children:e.unidad}),Object(H.jsx)(Da.a,{children:e.cantidad_venta}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.precio_a_vender)]}),Object(H.jsx)(SC,{producto:e}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.subtotal)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.impuestos)]}),Object(H.jsxs)(Da.a,{children:["$",Ua(e.total)]})]},t)}))})]})})})})]})]}),Object(H.jsxs)(tt.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(gC,{venta:t,handleCloseInfoVenta:n,refetch:c,selected:t}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(F.a,{color:"primary",variant:"outlined",startIcon:t.nota_credito.length?null:Object(H.jsx)(yn.a,{}),onClick:function(){return h()},disableRipple:!!t.nota_credito.length,disableFocusRipple:!!t.nota_credito.length,children:t.nota_credito.length?"Ya se realizo nota de cr\xe9dito":"Nota de cr\xe9dito"})]}),Object(H.jsx)(F.a,{onClick:n,color:"primary",variant:"contained",children:"Cerrar"})]})]}):null}var AC=function(e){var t=e.producto,a=vC(),n=Object($e.a)();return t.color.color&&t.medida.medida?Object(H.jsx)(Da.a,{align:"center",children:Object(H.jsx)(Ta.a,{title:t.color.color,placement:"top",arrow:!0,children:Object(H.jsx)("div",{className:a.colorContainer,style:{backgroundColor:t.color.hex,color:n.palette.getContrastText(t.color.hex)},children:t.medida.medida})})}):Object(H.jsx)(Da.a,{align:"center",children:"N/A"})},SC=function(e){var t=e.producto;if(!0===t.id_unidad_venta.descuento_activo){var a=t.id_unidad_venta.descuento,n=a.dinero_descontado,c=a.porciento;return Object(H.jsx)(Da.a,{children:"$".concat(Ua(n)," - %").concat(c)})}return Object(H.jsx)(Da.a,{children:"$0.00"})},FC=Object(k.a)((function(e){return{container:{height:"55vh"}}}));function IC(e){var t=e.handleClose,a=Object(j.useState)(""),n=Object(y.a)(a,2),c=n[0],r=n[1],i=Object(j.useState)("TODAS"),o=Object(y.a)(i,2),s=o[0],l=o[1],d=JSON.parse(localStorage.getItem("sesionCafi")),u=JSON.parse(localStorage.getItem("turnoEnCurso")),b=Object(an.useDebounce)(c,500),p=Object(y.a)(b,1)[0],m=Object(j.useState)(0),x=Object(y.a)(m,2),h=x[0],_=x[1],f=d.accesos.ventas.cancelar_venta.editar,g=u.fecha_movimiento,v={horario_en_turno:"ABRIR TURNO",id_caja:u?u.id_caja:"",id_usuario:d._id,token_turno_user:u?u.token_turno_user:""},C=Dt()(p).isValid(),A=Object(rt.b)(fm,{variables:{empresa:d.empresa._id,sucursal:d.sucursal._id,filtros:{isDate:C,busqueda:p,filtro:s,vista:"VENTAS",turno:{id_caja:u.id_caja,fecha_entrada:g},admin:f},limit:20,offset:h},fetchPolicy:"network-only"}),F=Object(rt.b)(Sj,{variables:{empresa:d.empresa._id,sucursal:d.sucursal._id,input:v}});return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{mb:2,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,sm:6,xs:12,children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",placeholder:"Buscar por: Folio, cliente, clave o nombre",variant:"outlined",onChange:function(e){return r(e.target.value)},value:c})}),Object(H.jsx)(Qe.a,{item:!0,sm:3,xs:12,children:Object(H.jsx)(ee.a,{variant:"outlined",size:"small",fullWidth:!0,children:Object(H.jsxs)(Nt.a,{value:s,onChange:function(e){return l(e.target.value)},children:[Object(H.jsx)(Pt.a,{value:"TODAS",children:Object(H.jsx)("em",{children:"Todas"})}),Object(H.jsx)(Pt.a,{value:"HOY",children:"Ventas de hoy"}),Object(H.jsx)(Pt.a,{value:"REALIZADAS",children:"Ventas realizadas"}),Object(H.jsx)(Pt.a,{value:"CANCELADAS",children:"Ventas canceladas"})]})})}),Object(H.jsx)(Qe.a,{item:!0,sm:3,xs:12,children:Object(H.jsx)(S.a,{fullWidth:!0,size:"small",variant:"outlined",type:"date",onChange:function(e){return r(e.target.value)}})})]})}),Object(H.jsxs)(O.a,{my:1,display:"flex",children:[f?Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(O.a,{border:1,borderColor:"#58ff8f",bgcolor:"#EDFFF3",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"- Ventas de hoy"})}),Object(H.jsx)(O.a,{mx:2})]}):null,Object(H.jsx)(O.a,{border:1,borderColor:"#FF8A8A",bgcolor:"#FFF4F4",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"- Ventas canceladas"})}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(O.a,{border:1,borderColor:"#FFA91C",bgcolor:"#FFEAAD",height:"24px",width:"24px"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"- Notas de cr\xe9dito"})})]}),Object(H.jsx)(kC,{resultado_ventas:A,res_precorte:F,handleClose:t,admin:f,page:h,setPage:_,limit:20})]})}var kC=function(e){var t=e.resultado_ventas,a=e.res_precorte,n=e.handleClose,c=e.admin,r=e.page,i=e.setPage,o=e.limit,s=Object(j.useContext)(qf),l=(s.updateTablaVentas,s.setUpdateTablaVentas,s.setVentaRetomada,Object(j.useContext)(Po)),d=(l.updateClientVenta,l.setUpdateClientVenta,FC()),u=Object(j.useState)(""),b=Object(y.a)(u,2),p=b[0],m=b[1],x=Object(j.useState)(!1),h=Object(y.a)(x,2),_=h[0],f=h[1],g=t.loading,v=t.data,C=t.error,A=t.refetch,S=Object(j.useState)(!1),F=Object(y.a)(S,2),k=F[0],w=F[1];if(g)return Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",children:Object(H.jsx)(I.a,{})});if(C)return Object(H.jsx)(bt,{});var N=v.obtenerVentasSucursal,P=a.data,E=P.obtenerPreCorteCaja?P.obtenerPreCorteCaja.monto_efectivo_precorte:0,D=function(e,t){m(t);2===e&&w(!0)},z=function(){f(!_)};return Object(H.jsxs)(fn.a,{variant:"outlined",children:[Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:_,autoHideDuration:5e3,onClose:z,message:"No puedes agregar una venta cuando ya est\xe1 una en curso.",action:Object(H.jsx)(ce.a,{size:"small","aria-label":"close",color:"inherit",onClick:z,children:Object(H.jsx)(Gt.a,{fontSize:"small"})})}),Object(H.jsxs)(Na.a,{className:d.container,children:[Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{children:"Folio"}),Object(H.jsx)(Da.a,{children:"Fecha"}),Object(H.jsx)(Da.a,{children:"Cliente"}),Object(H.jsx)(Da.a,{children:"Usuario"}),Object(H.jsx)(Da.a,{children:"Caja"}),Object(H.jsx)(Da.a,{children:"Descuento"}),Object(H.jsx)(Da.a,{children:"Subtotal"}),Object(H.jsx)(Da.a,{children:"Impuestos"}),Object(H.jsx)(Da.a,{children:"Total"}),Object(H.jsx)(Da.a,{children:"Cancelar Venta"})]})}),Object(H.jsx)(za.a,{children:N.docs.map((function(e,t){return Object(H.jsx)(NC,{data:e,selected:p,obtenerVenta:D,refetch:A,admin:c,pre_corte:E},t)}))})]}),Object(H.jsx)(yC,{venta:p,open:k,handleClose:function(){w(!1)},handleCloseListaVentas:n,refetch:A})]}),Object(H.jsx)(Ls.a,{rowsPerPageOptions:[],component:"div",count:N.totalDocs,rowsPerPage:o,page:r,onPageChange:function(e,t){i(t)}})]})},wC=Object(k.a)((function(e){return{today_color:{backgroundColor:"#EDFFF3","&:hover":{backgroundColor:"#D8FFE5"}},normal_color:{backgroundColor:"#FFF","&:hover":{backgroundColor:"#F5F5F5"}},root:{"&$root":{backgroundColor:"#FFF4F4",color:"#FF8A8A"},"&$root:hover":{backgroundColor:"#FFE0E0"}},notas_credito:{borderLeft:" 6px solid #FFEAAD"},selected:{"&$selected, &$selected:hover":{backgroundColor:"#E8F4FD"}}}})),NC=function(e){var t=e.data,a=e.selected,n=e.obtenerVenta,c=e.refetch,r=e.admin,i=e.pre_corte,o=wC(),s=Dt()(t.fecha_registro).format("YYYY-MM-DD")===Dt()().locale("es-mx").format("YYYY-MM-DD");return Object(H.jsxs)(Ea.a,{role:"checkbox",tabIndex:-1,selected:t.folio===a.folio,onClick:function(e){return n(e.detail,t)},classes:{selected:o.selected,root:"CANCELADO"===t.status?o.root:null},className:s&&r?o.today_color:o.normal_color,children:[Object(H.jsx)(Da.a,{className:t.nota_credito.length?o.notas_credito+" delete-color":" delete-color",children:t.folio}),Object(H.jsx)(Da.a,{className:"delete-color",children:Dt()(t.fecha_registro).format("DD/MM/YYYY")}),Object(H.jsx)(Da.a,{className:"delete-color",children:Object(H.jsx)("div",{className:"noWrap2",children:null!==t.cliente?t.cliente.nombre_cliente:"Publico General"})}),Object(H.jsx)(Da.a,{className:"delete-color",children:Object(H.jsx)("div",{className:"noWrap2",children:t.usuario.nombre})}),Object(H.jsx)(Da.a,{className:"delete-color",children:t.id_caja.numero_caja}),Object(H.jsxs)(Da.a,{className:"delete-color",children:["$",t.descuento?Ua(t.descuento):0]}),Object(H.jsxs)(Da.a,{className:"delete-color",children:["$",Ua(t.subTotal)]}),Object(H.jsxs)(Da.a,{className:"delete-color",children:["$",Ua(t.impuestos)]}),Object(H.jsxs)(Da.a,{className:"delete-color",children:["$",Ua(t.total)]}),Object(H.jsx)(Da.a,{className:"delete-color",align:"center",children:Object(H.jsx)(gC,{venta:t,refetch:c,dinero_disponible:i,selected:a,view:"table"})})]})},PC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function EC(){var e=ig(),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=JSON.parse(localStorage.getItem("DatosVentas")),n=u.a.useContext(qf).updateTablaVentas,c=Object(j.useState)(!1),r=Object(y.a)(c,2),i=r[0],o=r[1],s=function(){o(!i)};return window.addEventListener("keydown",(function(e){e.altKey&&86===e.keyCode&&s()})),Object(j.useEffect)((function(){a=JSON.parse(localStorage.getItem("DatosVentas"))}),[n]),Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{className:e.borderBotonChico,onClick:s,disabled:!t||a&&a.nota_credito,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)(We.q,{style:{fontSize:45}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Buscar Folio"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"Alt + V"})})})]})}),Object(H.jsxs)(qe.a,{fullWidth:!0,maxWidth:"lg",open:i,onClose:s,TransitionComponent:PC,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)("img",{src:Gg,alt:"icono caja",className:e.iconSizeDialogs}),Object(H.jsx)(O.a,{mx:2}),Object(H.jsx)(L.a,{variant:"h6",children:"Ventas Realizadas"})]}),Object(H.jsx)(F.a,{size:"small",color:"secondary",variant:"contained",onClick:function(){return s()},children:Object(H.jsx)(Gt.a,{})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(IC,{handleClose:s})})]})]})}var DC=a.p+"static/media/cajon.b3560654.svg";function zC(){var e=ig(),t=Object(j.useState)({message:"",status:"",open:!1}),a=Object(y.a)(t,2),n=a[0],c=a[1],r=localStorage.getItem("cafiTicketPrint"),i=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nC(r);case 2:!0===(t=e.sent).success?c({message:"Cajon abierto",status:"success",open:!0}):c({message:"Error al abrir cajon: ".concat(t.message),status:"error",open:!0});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return window.addEventListener("keydown",(function(e){119===e.keyCode&&i()})),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(F.a,{className:e.borderBotonChico,onClick:i,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:DC,alt:"icono ventas",style:{width:38}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Cajon"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"F8"})})})]})}),Object(H.jsx)(Y,{alert:n,setAlert:c})]})}var TC=a.p+"static/media/notacredito.cfa5a2d0.png",$C=["granel","litros","centro_de_costos","precio_plazos","unidades_de_venta","imagenes","inventario_general","medidas_producto"],WC=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))})),RC=function(e){var t=e.open,a=e.handleClose,n=ig(),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=JSON.parse(localStorage.getItem("sesionCafi")),i=JSON.parse(localStorage.getItem("DatosVentas")),o=Object(j.useState)({tipo:"monto_efectivo-01",cambio:i.saldo_favor}),s=Object(y.a)(o,2),l=s[0],d=s[1],u=Object(j.useState)(""),b=Object(y.a)(u,2),p=b[0],x=b[1],h=Object(j.useState)(!1),_=Object(y.a)(h,2),f=_[0],g=_[1],k=Object(j.useContext)(qf),N=k.updateTablaVentas,P=k.setUpdateTablaVentas,E=k.setDatosVentasActual,D=k.setAlert,z=Object(j.useContext)(Po),T=z.updateClientVenta,$=z.setUpdateClientVenta,W=Object(w.a)(_m),R=Object(y.a)(W,1)[0];Object(j.useEffect)((function(){d({tipo:"monto_efectivo-01",cambio:i.saldo_favor})}),[t]);var V=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,n,o,s,d,j;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(!0),t=Object(m.a)({},i),n=[],t.productos.forEach((function(e){var t=e.cantidad_venta_original-e.cantidad_venta,a=e.id_producto,c=(a.granel,a.litros,a.centro_de_costos,a.precio_plazos,a.unidades_de_venta,a.imagenes,a.inventario_general,a.medidas_producto,Object(De.a)(a,$C));delete c.precios.granel,delete c.precios.litros,n.push({cantidad_venta:e.cantidad_venta,cantidad_venta_original:e.cantidad_venta_original,cantidad_regresada:t,codigo_barras:e.codigo_barras,codigo_unidad:e.codigo_unidad,id_producto:c,id_unidad_venta:e.id_unidad_venta,ieps_total_producto:e.ieps_total_producto,impuestos_total_producto:e.impuestos_total_producto,iva_total_producto:e.iva_total_producto,precio_unidad:e.precio_unidad,precio:e.precio,precio_a_vender:e.precio_a_vender,subtotal_total_producto:e.subtotal_total_producto,total_total_producto:e.total_total_producto,unidad:e.unidad,unidad_principal:e.unidad_principal})})),o={horario_en_turno:c.horario_en_turno,numero_caja:parseInt(c.numero_caja),id_caja:c.id_caja,usuario_en_turno:{nombre:c.usuario_en_turno.nombre,numero_usuario:parseInt(c.usuario_en_turno.numero_usuario),_id:r._id},empresa:c.empresa,sucursal:c.sucursal},null!==(s=t.cliente)&&(delete s.imagen,delete s.eliminado,delete s.direccion),d=l.tipo.split("-"),j={cliente:t.cliente,productos:n,descuento:t.descuento,generar_cfdi:!!t.factura.length,ieps:parseFloat(t.ieps.toFixed(2)),impuestos:parseFloat(t.impuestos.toFixed(2)),iva:parseFloat(t.iva.toFixed(2)),subTotal:t.subTotal,total:t.total,observaciones:p,usuario:t.usuario,venta:t._id,folio:t.folio,cambio:t.saldo_favor,devolucion_en:d[0],payment_form:d[1],payment_method:"PUE"},e.next=12,R({variables:{input:j,empresa:c.empresa,sucursal:c.sucursal,turno:o}});case 12:g(!1),D({message:"Listo",status:"success",open:!0}),a(),x(""),localStorage.removeItem("DatosVentas"),P(!N),$(!T),E({subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(0),console.log(e.t0),g(!1),D({message:"Hubo un error",status:"error",open:!0});case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsx)("div",{children:Object(H.jsxs)(qe.a,{fullWidth:!0,maxWidth:"xs",open:t,onClose:function(){return a()},TransitionComponent:WC,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:TC,alt:"icono ventas",className:n.iconSizeDialogsPequeno})}),Object(H.jsx)(O.a,{mx:2,flexGrow:1,children:Object(H.jsx)(L.a,{variant:"h5",children:"Crear nota de cr\xe9dito"})}),Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:function(){return a()},size:"large",children:Object(H.jsx)(Ye.a,{})})]})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(O.a,{children:Object(H.jsxs)(A.a,{maxWidth:"xs",children:[Object(H.jsx)(S.a,{label:"Observaciones o comentarios",onChange:function(e){return x(e.target.value)},variant:"outlined",size:"small",fullWidth:!0,multiline:!0,rows:2}),Object(H.jsx)(O.a,{mb:2}),Object(H.jsxs)(O.a,{mb:1,display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(H.jsx)(L.a,{children:"Devoluci\xf3n en:"}),Object(H.jsx)(Xe.a,{control:Object(H.jsx)(Ze.a,{checked:!!i.factura.length}),label:"Generar CFDI"})]}),Object(H.jsx)(ee.a,{component:"fieldset",children:Object(H.jsxs)(cg.a,{value:l.tipo,onChange:function(e){var t=e.target.value;d(Object(m.a)(Object(m.a)({},l),{},{tipo:t}))},children:[Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(H.jsx)(Xe.a,{value:"monto_efectivo-01",control:Object(H.jsx)(rg.a,{}),label:"Efectivo"}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:"monto_efectivo-01"!==l.tipo,value:"monto_efectivo-01"===l.tipo?l.cambio:"0",style:{width:"150px"},InputProps:{readOnly:!0,startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(H.jsx)(Xe.a,{value:"monto_tarjeta_credito-04",control:Object(H.jsx)(rg.a,{}),label:"T. cr\xe9bito"}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:"monto_tarjeta_credito-04"!==l.tipo,value:"monto_tarjeta_credito-04"===l.tipo?l.cambio:"0",style:{width:"150px"},InputProps:{readOnly:!0,startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(H.jsx)(Xe.a,{value:"monto_monedero-05",control:Object(H.jsx)(rg.a,{}),label:"M. electr\xf3nico",disabled:!i.cliente}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:"monto_monedero-05"!==l.tipo,value:"monto_monedero-05"===l.tipo?l.cambio:"0",style:{width:"150px"},InputProps:{readOnly:!0,startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(H.jsx)(Xe.a,{value:"monto_transferencia-03",control:Object(H.jsx)(rg.a,{}),label:"Transferencia"}),Object(H.jsx)(S.a,{variant:"standard",disabled:"monto_transferencia-03"!==l.tipo,size:"small",value:"monto_transferencia-03"===l.tipo?l.cambio:"0",style:{width:"150px"},InputProps:{readOnly:!0,startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(H.jsx)(Xe.a,{value:"monto_cheques-02",control:Object(H.jsx)(rg.a,{}),label:"Cheques"}),Object(H.jsx)(S.a,{variant:"standard",size:"small",disabled:"monto_cheques-02"!==l.tipo,value:"monto_cheques-02"===l.tipo?l.cambio:"0",style:{width:"150px"},InputProps:{readOnly:!0,startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]})]})}),Object(H.jsxs)(O.a,{mt:2,children:[Object(H.jsx)(L.a,{children:"Subtotal: $".concat(Ua(i.subTotal))}),Object(H.jsx)(L.a,{children:"Impuestos: $".concat(Ua(i.impuestos))}),Object(H.jsx)(L.a,{children:Object(H.jsx)("b",{children:"Total anterior: $".concat(Ua(i.total_original))})}),Object(H.jsx)(et.a,{}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"space-between",children:[Object(H.jsx)(L.a,{variant:"h6",children:"Total: $".concat(Ua(i.total))}),Object(H.jsx)(L.a,{variant:"h6",children:"Cambio: $".concat(Ua(i.saldo_favor))})]})]})]})})}),Object(H.jsxs)(tt.a,{children:[Object(H.jsx)(F.a,{onClick:a,children:"Cancelar"}),Object(H.jsx)(F.a,{color:"primary",variant:"contained",onClick:function(){return V()},startIcon:f?Object(H.jsx)(I.a,{size:20,color:"inherit"}):Object(H.jsx)(Ut.a,{}),disabled:!i.saldo_favor,children:"Crear"})]})]})})};function VC(){var e=ig(),t=JSON.parse(localStorage.getItem("turnoEnCurso")),a=JSON.parse(localStorage.getItem("DatosVentas")),n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=function(){i(!0)};return window.onkeydown=function(e){27===e.keyCode&&a&&o()},Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(F.a,{className:e.borderBotonChico,onClick:function(){return o()},disabled:!t||!a,children:Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{children:Object(H.jsx)("img",{src:TC,alt:"icono ventas",style:{width:38}})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"body2",children:Object(H.jsx)("b",{children:"Crear Nota"})})}),Object(H.jsx)(O.a,{children:Object(H.jsx)(L.a,{variant:"caption",style:{color:"#808080"},children:Object(H.jsx)("b",{children:"ESC"})})})]})}),Object(H.jsx)(RC,{open:r,handleClose:function(){i(!1)}})]})}function MC(){var e=ng(),t=JSON.parse(localStorage.getItem("DatosVentas")),a=u.a.useContext(qf).updateTablaVentas;return Object(j.useEffect)((function(){t=JSON.parse(localStorage.getItem("DatosVentas"))}),[a]),Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Qe.a,{container:!0,className:e.drawerColor,children:[Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:t&&t.nota_credito?Object(H.jsx)(VC,{}):Object(H.jsx)(sC,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(Uv,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(zv,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(zC,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(Mv,{type:"GENERAR"})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(dC,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(_C,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(Wv,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(EC,{})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,md:6,xs:6,children:Object(H.jsx)(yv,{})})]})})}var LC=["cantidad_venta"],BC=Object(j.forwardRef)((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function UC(e){var t=e.producto,a=e.setDatosVentasActual,n=Object(j.useState)(!1),c=Object(y.a)(n,2),r=c[0],i=c[1],o=Object(j.useContext)(qf),s=o.updateTablaVentas,l=o.setUpdateTablaVentas,d=JSON.parse(localStorage.getItem("DatosVentas")),u=function(){d.nota_credito||i(!r)},b=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var n,c,r,i,o,d,j,u,b,p,O;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(localStorage.getItem("DatosVentas")),c=null===n?[]:n.productos,r=null===n?[]:n,i=c,o=null===n?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:n,e.next=7,Ja(t);case 7:if(!(d=e.sent).found){e.next=20;break}return j=t.cantidad_venta,u=Object(De.a)(t,LC),e.next=12,Ha({newP:u,cantidad:j,precio_boolean:!0,precio:u.precio_actual_object,granel:u.granel_producto,origen:""});case 12:b=e.sent,i.splice(d.producto_found.index,1),p={subTotal:parseFloat(o.subTotal)-parseFloat(b.subtotalCalculo),total:parseFloat(o.total)-parseFloat(b.totalCalculo),impuestos:parseFloat(o.impuestos)-parseFloat(b.impuestoCalculo),iva:parseFloat(o.iva)-parseFloat(b.ivaCalculo),ieps:parseFloat(o.ieps)-parseFloat(b.iepsCalculo),descuento:parseFloat(o.descuento)-parseFloat(b.descuentoCalculo),monedero:parseFloat(o.monedero)-parseFloat(b.monederoCalculo)},O=0,n.nota_credito&&(O=n.total_original-p.total),0!==i.length||n.cliente.nombre_cliente?localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)(Object(m.a)({},n),p),{},{saldo_favor:O,cliente:!0===r.venta_cliente?r.cliente:{},venta_cliente:!0===r.venta_cliente&&r.venta_cliente,productos:i,tipo_emision:r.tipo_emision?r.tipo_emision:"TICKET"}))):(localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal")),a(p),l(!s);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(ce.a,{size:"small",onClick:function(){return u()},disabled:d&&d.nota_credito,children:Object(H.jsx)(zr.a,{size:"small",color:d&&d.nota_credito?"disabled":"error"})}),Object(H.jsxs)(qe.a,{open:r,TransitionComponent:BC,keepMounted:!0,onClose:function(){return u()},"aria-labelledby":"alert-dialog-delete-producto",children:[Object(H.jsx)(Bt.a,{id:"alert-dialog-delete-producto",children:"\xbfEst\xe1s seguro de eliminar este producto?"}),Object(H.jsxs)(tt.a,{style:{display:"flex",justifyContent:"center"},children:[Object(H.jsx)(F.a,{onClick:function(){return u()},color:"inherit",children:"Cancelar"}),Object(H.jsx)(F.a,{onClick:function(){return b()},color:"secondary",children:"Eliminar"})]})]})]})}a(822);var qC=["cantidad_venta"];function JC(e){var t=e.producto,a=e.setDatosVentasActual,n=e.index,c=Object(j.useContext)(qf),r=c.updateTablaVentas,i=c.setUpdateTablaVentas,o=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c,o,s,l,d,j,u,b,p;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(m.a)({},t),o=JSON.parse(localStorage.getItem("DatosVentas")),s=null===o?[]:o.productos,l=null===o?[]:o,d=Object(Ia.a)(s),j=null===o?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:o,e.next=8,Ja(c);case 8:if(!e.sent.found){e.next=26;break}return e.next=12,Ga({newP:c,cantidad:c.cantidad_venta,precio_boolean:!1,precio:c.precio_actual_object,granel:c.granel_producto,origen:""});case 12:u=e.sent,c.cantidad_regresada=c.cantidad_venta_original,c.cantidad_venta=0,c.eliminado=!0,c.impuestos_total_producto=0,c.subtotal_total_producto=0,c.total_total_producto=0,b={subTotal:parseFloat(j.subTotal)-parseFloat(u.subtotalCalculo),total:parseFloat(j.total)-parseFloat(u.totalCalculo),impuestos:parseFloat(j.impuestos)-parseFloat(u.impuestoCalculo),iva:parseFloat(j.iva)-parseFloat(u.ivaCalculo),ieps:parseFloat(j.ieps)-parseFloat(u.iepsCalculo),descuento:parseFloat(j.descuento)-parseFloat(u.descuentoCalculo),monedero:parseFloat(j.monedero)-parseFloat(u.monederoCalculo)},d.splice(n,1,c),p=0,o.nota_credito&&(p=o.total_original-b.total),0!==d.length||o.cliente.nombre_cliente?localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)(Object(m.a)({},o),b),{},{saldo_favor:p,cliente:!0===l.venta_cliente?l.cliente:{},venta_cliente:!0===l.venta_cliente&&l.venta_cliente,productos:d,tipo_emision:l.tipo_emision?l.tipo_emision:"TICKET"}))):(localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal")),a(b),i(!r);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var c,o,s,l,d,j,u,b,p,O;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(m.a)({},t),o=JSON.parse(localStorage.getItem("DatosVentas")),s=null===o?[]:o.productos,l=null===o?[]:o,d=Object(Ia.a)(s),j=null===o?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:o,e.next=8,Ja(c);case 8:if(!e.sent.found){e.next=27;break}return c.cantidad_venta,u=Object(De.a)(c,qC),e.next=13,Ga({newP:u,cantidad:c.cantidad_venta_original,precio_boolean:!0,precio:u.precio_actual_object,granel:u.granel_producto,origen:"",add:!0});case 13:b=e.sent,c.cantidad_regresada=0,c.cantidad_venta=c.cantidad_venta_original,c.eliminado=!1,c.impuestos_total_producto=c.ieps_total_producto+c.iva_total_producto,c.subtotal_total_producto=c.precio_a_vender-c.impuestos_total_producto,c.total_total_producto=c.precio_a_vender,d.splice(n,1,c),p={subTotal:parseFloat(j.subTotal)+parseFloat(b.subtotalCalculo),total:parseFloat(j.total)+parseFloat(b.totalCalculo),impuestos:parseFloat(j.impuestos)+parseFloat(b.impuestoCalculo),iva:parseFloat(j.iva)+parseFloat(b.ivaCalculo),ieps:parseFloat(j.ieps)+parseFloat(b.iepsCalculo),descuento:parseFloat(j.descuento)+parseFloat(b.descuentoCalculo),monedero:parseFloat(j.monedero)+parseFloat(b.monederoCalculo)},O=0,o.nota_credito&&(O=o.total_original-p.total),0!==d.length||o.cliente.nombre_cliente?localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)(Object(m.a)({},o),p),{},{saldo_favor:O,cliente:!0===l.venta_cliente?l.cliente:{},venta_cliente:!0===l.venta_cliente&&l.venta_cliente,productos:d,tipo_emision:l.tipo_emision?l.tipo_emision:"TICKET"}))):(localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal")),a(p),i(!r);case 27:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(H.jsx)(j.Fragment,{children:t.eliminado?Object(H.jsx)(ce.a,{size:"small",onClick:function(){return s()},children:Object(H.jsx)(Ut.a,{size:"small",color:"primary"})}):Object(H.jsx)(ce.a,{size:"small",onClick:function(){return o()},children:Object(H.jsx)(Gt.a,{size:"small",color:"error"})})})}var HC=["cantidad_venta"],GC=Object(k.a)((function(e){return{root:{width:"100%"},container:Object(g.a)({height:"100%",maxHeight:"61vh","& ::-webkit-scrollbar":{display:"none"}},e.breakpoints.up("xl"),{maxHeight:"65vh"})}}));function YC(e){var t=e.setDatosVentasActual,a=GC(),n=Object(j.useState)([]),c=Object(y.a)(n,2),r=c[0],i=c[1],o=JSON.parse(localStorage.getItem("DatosVentas")),s=Object(j.useContext)(qf),l=s.setProductoCambioPrecio,d=s.setPrecioSelectProductoVenta,u=s.updateTablaVentas,b=s.setUpdateTablaVentas,p=Object(j.useState)([]),m=Object(y.a)(p,2),O=m[0],x=m[1];Object(j.useEffect)((function(){o=JSON.parse(localStorage.getItem("DatosVentas")),x(null===o?[]:o.productos)}),[u]);var h=function(e){if("Caja"!==e.unidad&&"Costal"!==e.unidad){var t=[];if(-1!==r.indexOf(e))return t=[],d([]),l({}),void i(t);t=t.concat([],e);var a=e.id_producto.precios.precios_producto.filter((function(t){return t.precio_neto===e.precio_actual_producto}));a.length>0&&d(a),l(e),i(t)}},_=function(e,t){try{2===e.detail&&h(t)}catch(a){console.log(a)}};return Object(H.jsx)("div",{className:a.root,children:Object(H.jsx)(fn.a,{children:Object(H.jsx)(Na.a,{className:a.container,children:Object(H.jsxs)($a.a,{stickyHeader:!0,size:"small","aria-labelledby":"tableTitle","aria-label":"a dense table",children:[Object(H.jsx)(Pa.a,{style:{padding:0},children:Object(H.jsxs)(Ea.a,{children:[Object(H.jsx)(Da.a,{padding:"checkbox"}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:"0 8px 0 8px"},children:"Granel"}),o&&o.nota_credito?Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:"0 8px 0 8px"},padding:"checkbox",children:"Cant. Vendida"}):null,Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:"0 8px 0 8px"},padding:"checkbox",children:"Cantidad"}),Object(H.jsx)(Da.a,{children:"Art\xedculo"}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:"0 8px 0 8px"},padding:"checkbox",children:"Exist."}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:"0 8px 0 8px"},padding:"checkbox",children:"Desc."}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:"0 8px 0 8px"},padding:"checkbox",children:"Receta"}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:"0 8px 0 8px"},padding:"checkbox",children:"U."}),Object(H.jsx)(Da.a,{style:{width:130,textAlign:"center",padding:"0 8px 0 8px"},children:"Precio Unit."}),Object(H.jsx)(Da.a,{style:{width:130,textAlign:"center",padding:"0 8px 0 8px"},children:"Total"}),Object(H.jsx)(Da.a,{padding:"checkbox"})]})}),Object(H.jsx)(za.a,{children:O.map((function(e,a){var n,c=(n=e,-1!==r.indexOf(n)),o="enhanced-table-checkbox-".concat(a);return Object(H.jsx)(QC,{producto:e,setUpdateTablaVentas:b,updateTablaVentas:u,setDatosVentasActual:t,isItemSelected:c,labelId:o,handleClick:h,selected:r,TwoClickInRowTableBuy:_,setSelected:i,index:a},a)}))})]})})})})}var QC=function(e){var t=e.producto,a=e.setUpdateTablaVentas,n=e.updateTablaVentas,c=e.setDatosVentasActual,r=e.TwoClickInRowTableBuy,i=e.handleClick,o=e.isItemSelected,s=e.labelId,l=e.setSelected,d=e.selected,u=e.index,b=Object(j.useState)(t.cantidad_venta),p=Object(y.a)(b,2),O=p[0],x=p[1],h=Object(j.useState)(t.cantidad_venta),_=Object(y.a)(h,2),f=_[0],g=_[1],A=JSON.parse(localStorage.getItem("DatosVentas")),S=Object(j.useRef)(null),F=Object(Lc.a)(O,500),I=Object(y.a)(F,1)[0];Object(j.useEffect)((function(){g(t.cantidad_venta)}),[t.cantidad_venta]);var k=Object(j.useState)(!1),w=Object(y.a)(k,2),N=w[0],P=w[1];Object(j.useEffect)((function(){N&&E(I)}),[I]);var E=function(){var e=Object(C.a)(Object(v.a)().mark((function e(r){var i,o,s,l,d,j,u,b,p,O,x,h,_,f,C;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==r&&0!==r){e.next=4;break}g(t.cantidad_venta),e.next=43;break;case 4:return i=JSON.parse(localStorage.getItem("DatosVentas")),o=null===i?[]:i.productos,s=null===i?[]:i,l=o,d=null===i?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:i,j={},e.next=12,Ja(t);case 12:if(!(u=e.sent).found){e.next=37;break}return b=u.producto_found.producto,p=b.cantidad_venta,(O=Object(De.a)(b,HC)).cantidad_venta=parseFloat(r),e.next=18,Ya(O);case 18:return x=e.sent,h=x.found?x.object_prising:O.precio_actual_object,e.next=22,Ha({newP:O,cantidad:O.granel_producto.granel?1:p,precio_boolean:!0,precio:O.precio_actual_object,granel:O.granel_producto,origen:"Tabla"});case 22:return _=e.sent,O.granel_producto.granel&&(O.granel_producto={granel:!0,valor:parseFloat(r)}),e.next=26,Ha({newP:O,cantidad:O.granel_producto.granel?1:parseFloat(r),precio_boolean:!0,precio:h,granel:O.granel_producto,origen:"Tabla"});case 26:f=e.sent,O.iva_total_producto=parseFloat(f.ivaCalculo),O.ieps_total_producto=parseFloat(f.iepsCalculo),O.impuestos_total_producto=parseFloat(f.impuestoCalculo),O.subtotal_total_producto=parseFloat(f.subtotalCalculo),O.total_total_producto=parseFloat(f.totalCalculo),x.found?(O.precio_a_vender=f.totalCalculo,O.precio_anterior=O.precio_actual_porducto,O.precio_actual_producto=x.pricing,O.precio_actual_object=x.object_prising,O.precio_actual_object={cantidad_unidad:x.object_prising.cantidad_unidad?x.object_prising.cantidad_unidad:null,numero_precio:x.object_prising.numero_precio?x.object_prising.numero_precio:null,unidad_maxima:x.object_prising.unidad_maxima?x.object_prising.unidad_maxima:null,precio_general:x.object_prising.precio_general?x.object_prising.precio_general:null,precio_neto:x.object_prising.precio_neto?x.object_prising.precio_neto:null,precio_venta:x.object_prising.precio_venta?x.object_prising.precio_venta:null,iva_precio:x.object_prising.iva_precio?x.object_prising.iva_precio:null,ieps_precio:x.object_prising.ieps_precio?x.object_prising.ieps_precio:null,utilidad:x.object_prising.utilidad?x.object_prising.utilidad:null,porciento:x.object_prising.porciento?x.object_prising.porciento:null,dinero_descontado:x.object_prising.dinero_descontado?x.object_prising.dinero_descontado:null}):(O.cantidad_venta=parseFloat(r),O.precio_anterior=O.precio_actual_producto,O.precio_a_vender=f.totalCalculo),l.splice(u.producto_found.index,1,O),j={subTotal:parseFloat(d.subTotal)-parseFloat(_.subtotalCalculo)+f.subtotalCalculo,total:parseFloat(d.total)-parseFloat(_.totalCalculo)+f.totalCalculo,impuestos:parseFloat(d.impuestos)-parseFloat(_.impuestoCalculo)+f.impuestoCalculo,iva:parseFloat(d.iva)-parseFloat(_.ivaCalculo)+f.ivaCalculo,ieps:parseFloat(d.ieps)-parseFloat(_.iepsCalculo)+f.iepsCalculo,descuento:parseFloat(d.descuento)-parseFloat(_.descuentoCalculo)+f.descuentoCalculo,monedero:parseFloat(d.monedero)-parseFloat(_.monederoCalculo)+f.monederoCalculo},e.next=38;break;case 37:console.log("El producto no existe");case 38:C=0,i.nota_credito&&(C=i.total_original-j.total),localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)(Object(m.a)({},i),j),{},{saldo_favor:C,cliente:!0===s.venta_cliente?s.cliente:{},venta_cliente:!0===s.venta_cliente&&s.venta_cliente,productos:l,tipo_emision:s.tipo_emision?s.tipo_emision:"TICKET"}))),c(j),a(!n);case 43:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(Ea.a,{role:"checkbox",style:{padding:0,margin:0},"aria-checked":o,tabIndex:-1,selected:o,onClick:function(e){return A&&A.nota_credito?null:r(e,t)},children:[Object(H.jsx)(Da.a,{padding:"checkbox",style:{padding:"0 0 0 5px"},children:Object(H.jsx)(Ze.a,{onClick:function(e){d.length>0&&l([]),i(t)},disabled:A&&A.nota_credito,checked:o,inputProps:{"aria-labelledby":s}})}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:0},padding:"checkbox",children:t.granel_producto.granel?"".concat(t.granel_producto.valor," ").concat(t.unidad):"N/A"}),A&&A.nota_credito?Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:0},children:t.cantidad_venta_original}):null,Object(H.jsx)(Da.a,{style:{padding:0},children:Object(H.jsx)(_n.a,{inputRef:S,onClick:function(e){return e.stopPropagation()},onChange:function(e){return function(e){if(P(!0),!(A&&A.nota_credito&&e>t.cantidad_venta_original||"0"===e)){if("medidas"===t.concepto){if(e>t.cantidad)return}else if(e>t.inventario_general[0].cantidad_existente)return;try{g(e),x(e)}catch(a){return!1}}}(e.target.value)},value:f,type:"number",name:"cantidad_venta",inputProps:{min:1,max:A&&A.nota_credito?t.cantidad_venta_original:"medidas"===t.concepto?t.cantidad:t.inventario_general.map((function(e){return"".concat(e.cantidad_existente)}))}})}),Object(H.jsx)(Da.a,{style:{padding:0},children:Object(H.jsx)(L.a,{noWrap:!0,variant:"body2",children:t.id_producto.datos_generales.nombre_comercial})}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:0},children:"OTROS"===t.id_producto.datos_generales.tipo_producto?"Costal"===t.unidad||"Caja"===t.unidad?t.inventario_general[0].cantidad_existente_maxima:t.inventario_general[0].cantidad_existente:t.cantidad}),Object(H.jsxs)(Da.a,{style:{textAlign:"center",padding:0},children:["%"," ",null!==t.precio_actual_object.porciento?t.precio_actual_object.porciento:0]}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:0},children:!0===t.id_producto.datos_generales.receta_farmacia?"Si":"No"}),Object(H.jsx)(Da.a,{style:{textAlign:"center",padding:0},children:t.unidad}),Object(H.jsxs)(Da.a,{style:{textAlign:"center",padding:0},children:["$"," ",t.precio_actual_object.precio_neto?Ua(t.precio_actual_object.precio_neto):0]}),Object(H.jsxs)(Da.a,{style:{textAlign:"center",padding:0},children:["$"," ",t.total_total_producto?Ua(t.total_total_producto):0]}),Object(H.jsx)(Da.a,{style:{padding:"0 5px 0 0"},children:A&&A.nota_credito?Object(H.jsx)(JC,{producto:t,setDatosVentasActual:c,index:u}):Object(H.jsx)(UC,{producto:t,setDatosVentasActual:c})})]},t._id)})},KC=a.p+"static/media/publicalo.3dac1d84.svg";function XC(){var e=ig(),t=Object(j.useContext)(qf),a=t.updateTablaVentas,n=t.setUpdateTablaVentas,c=JSON.parse(localStorage.getItem("DatosVentas")),r=Object(j.useState)("TICKET"),i=Object(y.a)(r,2),o=i[0],s=i[1];return Object(H.jsxs)(O.a,{width:"100%",display:"flex",children:[Object(H.jsx)(O.a,{mr:1,children:Object(H.jsx)("img",{src:KC,alt:"iconoBander",className:e.iconSize})}),Object(H.jsx)(O.a,{width:"100%",children:Object(H.jsx)(ee.a,{variant:"outlined",fullWidth:!0,size:"small",children:Object(H.jsxs)(Nt.a,{id:"tipo_documento",value:o,name:"tipo_documento",onChange:function(e){var t=e.target.value;c&&null!==c&&(s(t),localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)({},c),{},{tipo_emision:t}))),n(!a))},disabled:!c||null===c,children:[Object(H.jsx)(Pt.a,{value:"SIN TICKET",children:Object(H.jsx)("em",{children:"SIN TICKET"})}),Object(H.jsx)(Pt.a,{value:"TICKET",children:"TICKET"}),Object(H.jsx)(Pt.a,{value:"FACTURA",children:"FACTURA"}),Object(H.jsx)(Pt.a,{value:"NOTA REMISION",children:"NOTA REMISION"})]})})})]})}function ZC(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=JSON.parse(localStorage.getItem("DatosVentas")),a=Object(j.useContext)(Po),n=a.setUpdateClientVenta,c=a.updateClientVenta,r=a.setClientes,i=Object(j.useContext)(qf).setClientesVentas,o=Object(Fo.a)(),s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],b=l[1],p=Object(j.useState)(""),O=Object(y.a)(p,2),x=O[0],h=O[1],_=Object(j.useState)([]),f=Object(y.a)(_,2),g=f[0],A=f[1],F=Object(j.useState)(0),k=Object(y.a)(F,2),w=k[0],N=k[1],P=Object(j.useState)(0),E=Object(y.a)(P,2),D=E[0],z=E[1],T=Object(j.useState)(0),$=Object(y.a)(T,2),W=$[0],R=$[1],V=Object(j.useState)({}),M=Object(y.a)(V,2),L=M[0],B=M[1],U=Object(an.useDebounce)(x,500),q=Object(y.a)(U,1)[0],J=Object(j.useRef)(null),G=function(){var t=Object(C.a)(Object(v.a)().mark((function t(){var a,n,c,r,i=arguments;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.length>0&&void 0!==i[0]?i[0]:"",n=i.length>1&&void 0!==i[1]?i[1]:0,c=i.length>2&&void 0!==i[2]&&i[2],R(!0),t.prev=4,b(!0),t.next=8,o.query({query:xm,variables:{empresa:e.empresa._id,sucursal:e.sucursal._id,filtro:a,limit:10,offset:n},fetchPolicy:"network-only"});case 8:r=t.sent,b(!1),r.data&&(A(a||c?r.data.obtenerClientesVentas.docs:[].concat(Object(Ia.a)(g),Object(Ia.a)(r.data.obtenerClientesVentas.docs))),N(r.data.obtenerClientesVentas.totalDocs)),W&&J.current.focus(),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),b(!1);case 17:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(){return t.apply(this,arguments)}}();Object(j.useEffect)((function(){try{r(g)}catch(e){}}),[g]),Object(j.useEffect)((function(){z(0),G(q,0,!0)}),[q]),Object(j.useEffect)((function(){t&&t.cliente&&t.cliente.nombre_cliente?(B(t.cliente),i(t.cliente)):(B(null),i([]))}),[c]);return d?Object(H.jsx)(ka.a,{size:"small",fullWidth:!0,loading:!0,disabled:!0,renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{variant:"outlined",InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsxs)(u.a.Fragment,{children:[d?Object(H.jsx)(I.a,{color:"primary",size:20}):null,e.InputProps.endAdornment]})})}))}}):Object(H.jsx)("div",{children:Object(H.jsx)(ka.a,{id:"combo-box-producto-codigo",size:"small",fullWidth:!0,openOnFocus:!0,options:g,loading:d,getOptionLabel:function(e){return e.nombre_cliente?e.nombre_cliente:x||"P\xfablico general"},renderInput:function(e){return Object(H.jsx)(S.a,Object(m.a)(Object(m.a)({},e),{},{variant:"outlined",inputRef:J,onChange:function(e){return h(e.target.value)},value:x,InputProps:Object(m.a)(Object(m.a)({},e.InputProps),{},{endAdornment:Object(H.jsxs)(u.a.Fragment,{children:[d?Object(H.jsx)(I.a,{color:"primary",size:20}):null,e.InputProps.endAdornment]})})}))},onChange:function(e,t){return function(e){h(""),e||(z(0),G("",0,!0));try{var t,a=JSON.parse(localStorage.getItem("DatosVentas")),r=null===a?{}:a;if(B(e),!e&&0===a.productos.length)return localStorage.removeItem("DatosVentas"),void n(!c);var i=Object(m.a)(Object(m.a)({},r),{},{subTotal:void 0===r.subTotal?0:r.subTotal,total:void 0===r.total?0:r.total,impuestos:void 0===r.impuestos?0:r.impuestos,iva:void 0===r.iva?0:r.iva,ieps:void 0===r.ieps?0:r.ieps,descuento:void 0===r.descuento?0:r.descuento,monedero:void 0===r.monedero?0:r.monedero,venta_cliente:null!==e,productos:(null===(t=r.productos)||void 0===t?void 0:t.length)>0?r.productos:[],tipo_emision:r.tipo_emision?r.tipo_emision:"TICKET"});i=Object(m.a)(Object(m.a)({},i),{},{cliente:e||{}}),localStorage.setItem("DatosVentas",JSON.stringify(i)),n(!c)}catch(o){console.log(o)}}(t)},getOptionSelected:function(e,t){return e.nombre_cliente===t.nombre_cliente},value:L||(x||"P\xfablico general"),ListboxProps:{styles:{height:300},onScroll:function(e){var t=e.target,a=t.scrollHeight,n=t.scrollTop,c=t.clientHeight;if(a-parseInt(n+1)===c&&g.length<w){var r=D+1;z(r),G("",r,!1)}}}})})}function ey(){var e=JSON.parse(localStorage.getItem("sesionCafi")),t=ig();return Object(H.jsxs)(O.a,{width:"100%",display:"flex",justifyItems:"center",alignSelf:"center",justifySelf:"center",alignItems:"center",children:[Object(H.jsx)(O.a,{mt:1,mr:1,children:Object(H.jsx)("img",{src:Qj,alt:"iconoBander",className:t.iconSize})}),Object(H.jsx)(O.a,{width:"100%",alignItems:"center",children:Object(H.jsx)(ZC,{sesion:e})})]})}var ty=a.p+"static/media/busqueda-de-codigos-de-barras.a9100680.svg",ay=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function ny(e){var t=e.agregarProductos,a=e.open,n=e.setOpen,c=e.productos,r=function(){n(!a)};return Object(H.jsx)(j.Fragment,{children:Object(H.jsxs)(qe.a,{open:a,onClose:r,TransitionComponent:ay,children:[Object(H.jsx)(Bt.a,{children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",children:Object(H.jsx)(F.a,{variant:"contained",color:"secondary",onClick:r,children:Object(H.jsx)(Ye.a,{})})})}),Object(H.jsx)(He.a,{children:Object(H.jsx)(cy,{productos:c,agregarProductos:t})})]})})}var cy=function(e){var t,a=e.productos,n=e.agregarProductos;return a?a&&0===a.length?Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"40vh",children:"NO HAY UNIDADES"}):Object(H.jsx)(O.a,{children:Object(H.jsxs)(O.a,{mb:5,children:[Object(H.jsx)(O.a,{width:"100%",my:3,children:Object(H.jsx)(L.a,{variant:"h6",align:"center",children:Object(H.jsx)("b",{children:null===(t=a[0])||void 0===t?void 0:t.id_producto.datos_generales.nombre_comercial})})}),Object(H.jsx)(Qe.a,{container:!0,spacing:4,justifyContent:"center",children:a.map((function(e,t){return Object(H.jsx)(iy,{producto:e,agregarProductos:n},t)}))})]})}):Object(H.jsx)(O.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"53vh",children:Object(H.jsx)(I.a,{})})},ry=Object(k.a)({medida:{height:64,width:74,fontSize:28},badge:{"& .MuiBadge-badge":{height:30,width:30,borderRadius:"100%",fontSize:18}}}),iy=function(e){var t=e.producto,a=e.agregarProductos,n=ry(),c=Object($e.a)();return Object(H.jsx)(Qe.a,{item:!0,className:n.badge,children:Object(H.jsx)(Ta.a,{title:t.color.nombre,placement:"top",arrow:!0,children:Object(H.jsx)(Sc.a,{badgeContent:t.cantidad,color:"primary",showZero:!0,children:Object(H.jsx)(F.a,{disableElevation:!0,variant:"contained",className:n.medida,style:{backgroundColor:t.color.hex,color:c.palette.getContrastText(t.color.hex)},onClick:function(){return a(t)},children:t.medida.talla})})})})},oy=["cantidad_venta"];function sy(e){var t=e.loading,a=e.setLoading,n=JSON.parse(localStorage.getItem("sesionCafi")),c=ig(),r=Object(j.useContext)(qf),i=r.updateTablaVentas,o=r.setUpdateTablaVentas,s=r.setDatosVentasActual,l=r.openBuscarProducto,d=r.setOpenBuscarProducto,b=Object(j.useState)(!1),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useState)({message:"",status:"",open:!1}),f=Object(y.a)(_,2),g=f[0],A=f[1],F=Object(j.useState)(""),k=Object(y.a)(F,2),w=k[0],N=k[1],P=Object(Fo.a)(),E=Object(j.useState)(!1),D=Object(y.a)(E,2),z=D[0],T=D[1],$=Object(j.useState)([]),W=Object(y.a)($,2),R=W[0],V=W[1],L=JSON.parse(localStorage.getItem("DatosVentas")),B=u.a.useRef(null),U=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t){var a;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.query({query:mm,variables:{datosProductos:t.toUpperCase(),empresa:n.empresa._id,sucursal:n.sucursal._id},fetchPolicy:"network-only"});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=Object(j.useState)(!1),J=Object(y.a)(q,2),G=J[0],Q=J[1];Object(j.useEffect)((function(){var e=JSON.parse(localStorage.getItem("DatosVentas"));null!==e&&s({subTotal:parseFloat(e.subTotal),total:parseFloat(e.total),impuestos:parseFloat(e.impuestos),iva:parseFloat(e.iva),ieps:parseFloat(e.ieps),descuento:parseFloat(e.descuento),monedero:parseFloat(e.monedero)}),B.current.focus()}),[i]);var K=function(){var e=Object(C.a)(Object(v.a)().mark((function e(n){var c,r,i,o,s,l,d,j;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:if(w){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,"Enter"!==n.code&&"NumpadEnter"!==n.code&&"click"!==n.type){e.next=60;break}if(a(!0),r=(c=w).split("*"),i={data:void 0,loading:!1,error:void 0},o={granel:!1,valor:0},!(r.length>1)){e.next=28;break}if(s=isNaN(r[0])?r[1]:r[0],l=isNaN(r[0])?r[0]:r[1],s){e.next=21;break}return e.next=17,U(l);case 17:i=e.sent,Q(!G),e.next=26;break;case 21:return o={granel:!0,valor:parseFloat(s)},e.next=24,U(l);case 24:i=e.sent,Q(!G);case 26:e.next=32;break;case 28:return e.next=30,U(c);case 30:i=e.sent,Q(!G);case 32:if(!i.error){e.next=36;break}return i.error.networkError?A({message:"Error de servidor",status:"error",open:!0}):i.error.graphQLErrors&&A({message:"".concat(null===(d=i.error.graphQLErrors[0])||void 0===d?void 0:d.message),status:"error",open:!0}),a(!1),e.abrupt("return");case 36:if(!i.data){e.next=57;break}if(null===(j=i.data.obtenerUnProductoVentas)){e.next=57;break}if(1!==j.length){e.next=56;break}if(null===j[0].cantidad){e.next=53;break}if(o.granel||"Kg"!==j[0].unidad){e.next=45;break}o={granel:!0,valor:1},e.next=50;break;case 45:if(!o.granel){e.next=50;break}if(!(o.valor>j[0].inventario_general[0].cantidad_existente)){e.next=50;break}return A({message:"Esta cantidad es mayor a la que existe en Almacen",status:"error",open:!0}),a(!1),e.abrupt("return");case 50:Z(j[0],o),e.next=54;break;case 53:A({message:"Este producto no existe",status:"error",open:!0});case 54:e.next=57;break;case 56:j.length>0?(T(!0),V(j)):A({message:"Este producto no existe",status:"error",open:!0});case 57:a(!1),N(""),B.current.focus();case 60:e.next=66;break;case 62:e.prev=62,e.t0=e.catch(4),console.log(e.t0),a(!1);case 66:case"end":return e.stop()}}),e,null,[[4,62]])})));return function(t){return e.apply(this,arguments)}}(),X=n.empresa.vender_sin_inventario,Z=function(){var e=Object(C.a)(Object(v.a)().mark((function e(t,a){var n,c,r,l,d,j,u,b,p,O,x,_,f,g,C,y,A,S,F,I;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("medidas"!==t.concepto){e.next=6;break}if(X||0!==t.cantidad){e.next=4;break}return h(!0),e.abrupt("return");case 4:e.next=9;break;case 6:if(X||0!==t.inventario_general[0].cantidad_existente){e.next=9;break}return h(!0),e.abrupt("return");case 9:return n=a||{granel:!1,valor:0},c=JSON.parse(localStorage.getItem("DatosVentas")),r=null===c?[]:c.productos,l=null===c?[]:c,d=null===c?{subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0}:c,j=r,u={subTotal:0,total:0,impuestos:0,iva:0,ieps:0,descuento:0,monedero:0},e.next=18,Ja(t);case 18:if((b=e.sent).found||!t._id){e.next=35;break}return p=Object(m.a)({},t),O=p.descuento_activo?p.descuento.precio_neto:p.precio_unidad.precio_neto,e.next=24,Ha({newP:p,cantidad:0,granel:n,origen:"Ventas1",precio_boolean:!1});case 24:(x=e.sent).newP.precio_anterior=O,x.newP.iva_total_producto=parseFloat(x.ivaCalculo),x.newP.ieps_total_producto=parseFloat(x.iepsCalculo),x.newP.impuestos_total_producto=parseFloat(x.impuestoCalculo),x.newP.subtotal_total_producto=parseFloat(x.subtotalCalculo),x.newP.total_total_producto=parseFloat(x.totalCalculo),j.splice(0,0,x.newP),u={subTotal:parseFloat(d.subTotal)+parseFloat(x.subtotalCalculo),total:parseFloat(d.total)+parseFloat(x.totalCalculo),impuestos:parseFloat(d.impuestos)+parseFloat(x.impuestoCalculo),iva:parseFloat(d.iva)+parseFloat(x.ivaCalculo),ieps:parseFloat(d.ieps)+parseFloat(x.iepsCalculo),descuento:parseFloat(d.descuento)+parseFloat(x.descuentoCalculo),monedero:parseFloat(d.monedero)+parseFloat(x.monederoCalculo)},e.next=77;break;case 35:if(!b.found||!t._id){e.next=77;break}return _=b.producto_found.producto,f=_.cantidad_venta,g=Object(De.a)(_,oy),n.granel&&(n={granel:!0,valor:g.granel_producto.valor+n.valor}),g.cantidad_venta=n.granel?1:parseInt(f)+1,e.next=41,Ya(g);case 41:if(!(C=e.sent).found){e.next=62;break}return e.next=45,Ha({newP:g,cantidad:1,granel:g.granel_producto,origen:"",precio_boolean:!0,precio:g.precio_actual_object});case 45:return y=e.sent,e.next=48,Ha({newP:g,cantidad_venta:n.granel?1:parseInt(f)+1,granel:n,origen:"",precio_boolean:!0,precio:C.object_prising});case 48:A=e.sent,g.precio_a_vender=A.totalCalculo,g.precio_anterior=g.precio_actual_producto,g.precio_actual_producto=C.pricing,g.iva_total_producto=parseFloat(A.ivaCalculo),g.ieps_total_producto=parseFloat(A.iepsCalculo),g.impuestos_total_producto=parseFloat(A.impuestoCalculo),g.subtotal_total_producto=parseFloat(A.subtotalCalculo),g.total_total_producto=parseFloat(A.totalCalculo),g.precio_actual_object={cantidad_unidad:C.object_prising.cantidad_unidad?C.object_prising.cantidad_unidad:null,numero_precio:C.object_prising.numero_precio?C.object_prising.numero_precio:null,unidad_maxima:C.object_prising.unidad_maxima?C.object_prising.unidad_maxima:null,precio_general:C.object_prising.precio_general?C.object_prising.precio_general:null,precio_neto:C.object_prising.precio_neto?C.object_prising.precio_neto:null,precio_venta:C.object_prising.precio_venta?C.object_prising.precio_venta:null,iva_precio:C.object_prising.iva_precio?C.object_prising.iva_precio:null,ieps_precio:C.object_prising.ieps_precio?C.object_prising.ieps_precio:null,utilidad:C.object_prising.utilidad?C.object_prising.utilidad:null,porciento:C.object_prising.porciento?C.object_prising.porciento:null,dinero_descontado:C.object_prising.dinero_descontado?C.object_prising.dinero_descontado:null},j.splice(b.producto_found.index,1,g),u={subTotal:parseFloat(d.subTotal)-parseFloat(y.subtotalCalculo)+A.subtotalCalculo,total:parseFloat(d.total)-parseFloat(y.totalCalculo)+A.totalCalculo,impuestos:parseFloat(d.impuestos)-parseFloat(y.impuestoCalculo)+A.impuestoCalculo,iva:parseFloat(d.iva)-parseFloat(y.ivaCalculo)+A.ivaCalculo,ieps:parseFloat(d.ieps)-parseFloat(y.iepsCalculo)+A.iepsCalculo,descuento:parseFloat(d.descuento)-parseFloat(y.descuentoCalculo)+A.descuentoCalculo,monedero:parseFloat(d.monedero)-parseFloat(y.monederoCalculo)+A.monederoCalculo},e.next=77;break;case 62:return S=g.descuento_activo?g.descuento.precio_neto:g.precio_unidad.precio_neto,e.next=65,Ha({newP:g,cantidad:1,granel:g.granel_producto,origen:"Ventas2"});case 65:return F=e.sent,e.next=68,Ha({newP:g,cantidad:n.granel?1:parseInt(f)+1,granel:n,origen:"Ventas2"});case 68:(I=e.sent).newP.precio_actual_producto=S,I.newP.iva_total_producto=parseFloat(I.ivaCalculo),I.newP.ieps_total_producto=parseFloat(I.iepsCalculo),I.newP.impuestos_total_producto=parseFloat(I.impuestoCalculo),I.newP.subtotal_total_producto=parseFloat(I.subtotalCalculo),I.newP.total_total_producto=parseFloat(I.totalCalculo),j.splice(b.producto_found.index,1,I.newP),u={subTotal:parseFloat(d.subTotal)-parseFloat(F.subtotalCalculo)+I.subtotalCalculo,total:parseFloat(d.total)-parseFloat(F.totalCalculo)+I.totalCalculo,impuestos:parseFloat(d.impuestos)-parseFloat(F.impuestoCalculo)+I.impuestoCalculo,iva:parseFloat(d.iva)-parseFloat(F.ivaCalculo)+I.ivaCalculo,ieps:parseFloat(d.ieps)-parseFloat(F.iepsCalculo)+I.iepsCalculo,descuento:parseFloat(d.descuento)-parseFloat(F.descuentoCalculo)+I.descuentoCalculo,monedero:parseFloat(d.monedero)-parseFloat(F.monederoCalculo)+I.monederoCalculo};case 77:localStorage.setItem("DatosVentas",JSON.stringify(Object(m.a)(Object(m.a)({},u),{},{cliente:!0===l.venta_cliente?l.cliente:{},venta_cliente:!0===l.venta_cliente&&l.venta_cliente,productos:j,tipo_emision:l.tipo_emision?l.tipo_emision:"TICKET"}))),s(Object(m.a)({},u)),o(!i),V([]),T(!1),N(""),B.current.focus();case 84:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(H.jsxs)(j.Fragment,{children:[Object(H.jsx)(Y,{alert:g,setAlert:A}),Object(H.jsx)(M.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:x,onClose:function(){return h(!1)},message:"Producto sin existencias",autoHideDuration:3e3}),Object(H.jsx)(ny,{agregarProductos:Z,open:z,setOpen:T,productos:R}),Object(H.jsxs)(O.a,{width:"100%",display:"flex",justifyItems:"center",alignSelf:"center",justifySelf:"center",alignItems:"center",children:[Object(H.jsx)(O.a,{mt:1,mx:1,children:Object(H.jsx)("img",{src:ty,alt:"iconoBander",className:c.iconSize})}),Object(H.jsx)(S.a,{fullWidth:!0,placeholder:"Producto...",variant:"outlined",size:"small",onKeyUp:function(e){return K(e)},onChange:function(e){return N(e.target.value)},value:w,disabled:t||L&&L.nota_credito,inputRef:B,InputProps:{endAdornment:Object(H.jsx)(ne.a,{position:"end",children:t?Object(H.jsx)(ce.a,{disabled:t,children:Object(H.jsx)(I.a,{size:20,color:"primary"})}):Object(H.jsx)(j.Fragment,{children:Object(H.jsx)(ce.a,{onClick:function(e){return K(e)},disabled:t||L&&L.nota_credito,color:"primary",children:Object(H.jsx)(Ut.a,{})})})})},inputProps:{style:{textTransform:"uppercase"}}}),Object(H.jsx)(ce.a,{onClick:function(){return d(!l)},disabled:t||L&&L.nota_credito,children:Object(H.jsx)(Nc.a,{})})]})]})}function ly(e){var t=e.loading,a=e.setLoading;return Object(H.jsx)(j.Fragment,{children:Object(H.jsx)(fn.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:3,style:{padding:2},children:[Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsx)(sy,{loading:t,setLoading:a})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsx)(ey,{})}),Object(H.jsx)(Qe.a,{item:!0,md:4,xs:12,children:Object(H.jsx)(XC,{})})]})})})}var dy=function(){var e=u.a.useContext(qf),t=e.clientesVentas,a=e.DatosVentasActual,n=JSON.parse(localStorage.getItem("DatosVentas"));return Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,md:7,sm:7,xs:12,children:Object(H.jsx)(O.a,{mx:2,children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(We.b,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Cliente:"," ",Object(H.jsx)("b",{style:{fontSize:16},children:t&&t.nombre_cliente?t.nombre_cliente:"P\xfablico en general"})]})]})})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(IO.a,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Clave Cliente:"," ",Object(H.jsx)("b",{style:{fontSize:16},children:t?t.clave_cliente:""})]})]})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(We.c,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Dias Credito:"," ",Object(H.jsx)("b",{style:{fontSize:16},children:t&&t.dias_credito?t.dias_credito:0})]})]})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(IO.b,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Limite Credito:"," ",Object(H.jsxs)("b",{style:{fontSize:16},children:["$",t&&t.limite_credito?Ua(t.limite_credito):0]})]})]})}),Object(H.jsx)(Qe.a,{item:!0,lg:7,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(We.p,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Monedero electr\xf3nico:"," ",Object(H.jsxs)("b",{style:{fontSize:16},children:["$",a&&a.monedero?Ua(a.monedero):0]})]})]})})]})})}),Object(H.jsx)(Qe.a,{item:!0,md:5,sm:5,xs:12,children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,lg:6,xs:12,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Descuento:"," ",Object(H.jsxs)("b",{style:{fontSize:17},children:["$"," ",a&&a.descuento?Ua(a.descuento):0]})]})})}),Object(H.jsxs)(Qe.a,{item:!0,lg:6,xs:12,children:[Object(H.jsx)(O.a,{flexDirection:"row-reverse",display:"flex",mr:1,children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Subtotal:"," ",Object(H.jsxs)("b",{style:{fontSize:17},children:["$"," ",null!==a&&void 0!==a&&a.subTotal?Ua(a.subTotal):0]})]})}),Object(H.jsx)(O.a,{display:"flex",flexDirection:"row-reverse",mr:1,children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Impuestos:"," ",Object(H.jsxs)("b",{style:{fontSize:17},children:["$"," ",null!==a&&void 0!==a&&a.impuestos?Ua(a.impuestos):0]})]})})]})]})}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",p:1,width:"100%",children:[Object(H.jsxs)(L.a,{variant:"h4",children:["Total:"," ",Object(H.jsxs)("b",{style:{color:"green"},children:["$",null!==a&&void 0!==a&&a.total?Ua(a.total):0]})]}),Object(H.jsx)(O.a,{mx:2}),Object(H.jsxs)(L.a,{variant:"h4",children:["Cambio:"," ",Object(H.jsxs)("b",{style:{color:"green"},children:["$",n.saldo_favor?Ua(n.saldo_favor):0]})]})]})]})})};function jy(){var e=Object(j.useContext)(qf),t=e.clientesVentas,a=e.openBackDrop,n=e.DatosVentasActual,c=e.setDatosVentasActual,r=(e.updateTablaVentas,JSON.parse(localStorage.getItem("DatosVentas"))),i=Object(j.useState)(!1),o=Object(y.a)(i,2),s=o[0],l=o[1];return Object(H.jsxs)(O.a,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",children:[Object(H.jsx)(ly,{loading:s,setLoading:l}),Object(H.jsx)(O.a,{height:"100%",style:s?{pointerEvents:"none",opacity:.6}:null,children:Object(H.jsx)(YC,{setDatosVentasActual:c})}),Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",flexDirection:"column",children:r&&r.nota_credito?Object(H.jsx)(dy,{}):Object(H.jsx)(fn.a,{variant:"outlined",children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,md:7,sm:7,xs:12,children:Object(H.jsx)(O.a,{mx:2,children:Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(We.b,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Cliente:"," ",Object(H.jsx)("b",{style:{fontSize:16},children:t&&t.nombre_cliente?t.nombre_cliente:"P\xfablico en general"})]})]})})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(IO.a,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Clave Cliente:"," ",Object(H.jsx)("b",{style:{fontSize:16},children:t?t.clave_cliente:""})]})]})}),Object(H.jsx)(Qe.a,{item:!0,md:6,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(We.c,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Dias Credito:"," ",Object(H.jsx)("b",{style:{fontSize:16},children:t&&t.dias_credito?t.dias_credito:0})]})]})}),Object(H.jsx)(Qe.a,{item:!0,lg:6,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(IO.b,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Limite Credito:"," ",Object(H.jsxs)("b",{style:{fontSize:16},children:["$",t&&t.limite_credito?Ua(t.limite_credito):0]})]})]})}),Object(H.jsx)(Qe.a,{item:!0,lg:7,xs:12,children:Object(H.jsxs)(O.a,{display:"flex",alignItems:"center",children:[Object(H.jsx)(We.p,{style:{fontSize:19}}),Object(H.jsx)(O.a,{mr:1}),Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Monedero electr\xf3nico:"," ",Object(H.jsxs)("b",{style:{fontSize:16},children:["$",n&&n.monedero?Ua(n.monedero):0]})]})]})})]})})}),Object(H.jsxs)(Qe.a,{item:!0,md:5,sm:5,xs:12,children:[Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsx)(Qe.a,{item:!0,lg:6,xs:12,children:Object(H.jsx)(O.a,{display:"flex",justifyContent:"flex-end",children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Descuento:"," ",Object(H.jsxs)("b",{style:{fontSize:17},children:["$"," ",n&&n.descuento?Ua(n.descuento):0]})]})})}),Object(H.jsxs)(Qe.a,{item:!0,lg:6,xs:12,children:[Object(H.jsx)(O.a,{flexDirection:"row-reverse",display:"flex",mr:1,children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Subtotal:"," ",Object(H.jsxs)("b",{style:{fontSize:17},children:["$"," ",null!==n&&void 0!==n&&n.subTotal?Ua(n.subTotal):0]})]})}),Object(H.jsx)(O.a,{display:"flex",flexDirection:"row-reverse",mr:1,children:Object(H.jsxs)(L.a,{variant:"subtitle1",children:["Impuestos:"," ",Object(H.jsxs)("b",{style:{fontSize:17},children:["$"," ",null!==n&&void 0!==n&&n.impuestos?Ua(n.impuestos):0]})]})})]})]}),Object(H.jsx)(O.a,{display:"flex",flexDirection:"row-reverse",p:1,children:Object(H.jsxs)(L.a,{variant:"h4",children:["Total:"," ",Object(H.jsxs)("b",{style:{color:"green"},children:["$",null!==n&&void 0!==n&&n.total?Ua(n.total):0]})]})})]})]})})}),Object(H.jsx)(V.a,{children:Object(H.jsx)(it.a,{style:{zIndex:"99999"},open:a,children:Object(H.jsx)(I.a,{color:"inherit"})})})]})}function uy(e){e.handleClickOpen;var t=e.loading,a=(e.type,e.setLoading),n=JSON.parse(localStorage.getItem("sesionCafi")),c=JSON.parse(localStorage.getItem("turnoEnCurso")),r=Object(w.a)(de),i=Object(y.a)(r,1)[0],o=Object(j.useContext)(qf).setAlert,s=Object(j.useContext)(be).isOnline,l=Object(j.useState)(!1),d=Object(y.a)(l,2),u=d[0],b=d[1],p=Object(j.useState)([]),x=Object(y.a)(p,2),h=x[0],_=x[1],f=Object(j.useState)(""),A=Object(y.a)(f,2),k=A[0],N=A[1],P=n.accesos.tesoreria.caja_principal.ver,E=ig(),D=[],z=Object(rt.b)(vj,{variables:{empresa:n.empresa._id,sucursal:n.sucursal._id}}),T=function(e){_(Object(m.a)(Object(m.a)({},h),{},Object(g.a)({},e.target.name,e.target.value)))};z.data&&(D=z.data.obtenerCajasSucursal);var $={accesos:n.accesos,email:n.email,empresa:n.empresa,estado:n.estado,exp:n.exp,iat:n.iat,imagen:n.imagen,nombre:n.nombre,numero_usuario:n.numero_usuario,sucursal:n.sucursal,telefono:n.telefono,turno_en_caja_activo:!0,_id:n._id},W=function(){var e=Object(C.a)(Object(v.a)().mark((function e(){var t,c,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(!0),e.prev=1,h.turno_en_curso&&h.caja_elegida&&h.monto_abrir){e.next=9;break}return b(!0),a(!1),o({message:"Por favor complete los datos obligatorios",status:"error",open:!0}),e.abrupt("return");case 9:return t={horario_en_turno:h.turno_en_curso,concepto:"ABRIR TURNO",numero_caja:k.toString(),comentarios:h.comentarios,id_caja:h.caja_elegida,empresa:n.empresa._id,sucursal:n.sucursal._id,id_usuario:n._id,usuario_en_turno:{nombre:n.nombre,telefono:n.telefono,numero_usuario:n.numero_usuario,email:n.email},hora_entrada:{hora:Dt()().locale("es-mx").format("hh"),minutos:Dt()().locale("es-mx").format("mm"),segundos:Dt()().locale("es-mx").format("ss"),completa:Dt()().locale("es-mx").format("HH:mm:ss")},hora_salida:{hora:"",minutos:"",segundos:"",completa:""},fecha_entrada:{year:Dt()().locale("es-mx").format("YYYY"),mes:Dt()().locale("es-mx").locale("es-mx").format("MM"),dia:Dt()().locale("es-mx").format("DD"),no_semana_year:Dt()().locale("es-mx").week().toString(),no_dia_year:Dt()().locale("es-mx").dayOfYear().toString(),completa:Dt()().locale("es-mx").format("YYYY-MM-DD")},fecha_salida:{year:"",mes:"",dia:"",no_semana_year:"",no_dia_year:"",completa:""},fecha_movimiento:Dt()().locale("es-mx").format(),montos_en_caja:{monto_efectivo:{monto:parseFloat(h.monto_abrir),metodo_pago:"01"},monto_tarjeta_debito:{monto:0,metodo_pago:"28"},monto_tarjeta_credito:{monto:0,metodo_pago:"04"},monto_creditos:{monto:0,metodo_pago:"99"},monto_monedero:{monto:0,metodo_pago:"05"},monto_transferencia:{monto:0,metodo_pago:"03"},monto_cheques:{monto:0,metodo_pago:"02"},monto_vales_despensa:{monto:0,metodo_pago:"08"}}},e.next=12,i({variables:{activa:!0,input:t,isOnline:s}});case 12:null===(c=e.sent).data.crearRegistroDeTurno?(a(!1),o({message:"Lo sentimos esta caja ya esta en uso",status:"error",open:!0})):(r=Object(m.a)(Object(m.a)({},c.data.crearRegistroDeTurno),{},{onCloud:s}),console.log("TURNO:",r),localStorage.setItem("turnoEnCurso",JSON.stringify(r)),localStorage.setItem("sesionCafi",JSON.stringify($)),o({message:"Turno abierto",status:"success",open:!0}),window.location.reload());case 14:e.next=22;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0.networkError.result.errors),a(!1),e.t0.networkError.result?console.log(e.t0.networkError.result.errors):e.t0.graphQLErrors&&console.log(e.t0.graphQLErrors.message),o({message:"Error: ".concat(e.t0.message),status:"error",open:!0});case 22:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return Object(H.jsxs)("div",{children:[Object(H.jsx)(He.a,{children:Object(H.jsxs)(Qe.a,{container:!0,spacing:2,children:[Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:6,children:[Object(H.jsx)(L.a,{className:E.titulos,children:" Empleado:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"nombre_usuario",onChange:T,disabled:!0,value:n?n.nombre:"",id:"form-producto-codigo-barras",variant:"outlined"})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:6,children:[Object(H.jsxs)(L.a,{className:E.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Turno:"]}),Object(H.jsx)(ee.a,{variant:"outlined",disabled:!!c,fullWidth:!0,size:"small",error:u&&!h.turno_en_curso,children:Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"turno_en_curso",onChange:T,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),Object(H.jsx)(Pt.a,{value:"MATUTINO",children:"Matutino"}),Object(H.jsx)(Pt.a,{value:"VESPERTINO",children:"Vespertino"})]})})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:6,children:[Object(H.jsxs)(L.a,{className:E.titulos,children:[Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Caja:"]}),Object(H.jsx)(ee.a,{variant:"outlined",disabled:!!c,fullWidth:!0,size:"small",error:u&&!h.caja_elegida,children:Object(H.jsxs)(Nt.a,{id:"form-producto-tipo",name:"caja_elegida",onChange:T,children:[Object(H.jsx)(Pt.a,{value:"",children:Object(H.jsx)("em",{children:"Selecciona uno"})}),D.map((function(e){return!0===e.activa||!0===e.principal&&!P?null:Object(H.jsxs)(Pt.a,{value:e._id,onClick:function(){return N(e.numero_caja)},children:["Caja ",e.numero_caja]},e.numero_caja)}))]})})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,md:6,children:[Object(H.jsxs)(L.a,{className:E.titulos,children:[" ",Object(H.jsx)("span",{className:"obligatorio",children:"* "}),"Monto para abrir:"]}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"monto_abrir",inputProps:{min:0},type:"number",onChange:T,id:"form-producto-codigo-barras",variant:"outlined",error:u&&!h.monto_abrir,placeholder:"0.00",InputProps:{startAdornment:Object(H.jsx)(ne.a,{position:"start",children:"$"})}})]}),Object(H.jsxs)(Qe.a,{item:!0,xs:12,children:[Object(H.jsx)(L.a,{className:E.titulos,children:" Comentarios:"}),Object(H.jsx)(S.a,{fullWidth:!0,size:"small",name:"comentarios",multiline:!0,rows:5,onChange:T,id:"form-producto-codigo-barras",variant:"outlined"})]})]})}),Object(H.jsx)(tt.a,{children:Object(H.jsx)(O.a,{display:"flex",alignItems:"flex-end",children:Object(H.jsx)(F.a,{onClick:W,variant:"contained",color:"primary",size:"large",startIcon:t||z.loading?Object(H.jsx)(I.a,{color:"inherit",size:20}):null,disabled:t||z.loading,children:"Guardar"})})})]})}Dt.a.locale("es");var by=u.a.forwardRef((function(e,t){return Object(H.jsx)(Ue.a,Object(m.a)({direction:"up",ref:t},e))}));function py(){var e=JSON.parse(localStorage.getItem("turnoEnCurso")),t=JSON.parse(localStorage.getItem("sesionCafi"));return Object(H.jsx)(O.a,{height:"100%",children:t.turno_en_caja_activo&&e?Object(H.jsx)(jy,{}):Object(H.jsx)(my,{})})}function my(){var e=Object(j.useState)(!1),t=Object(y.a)(e,2),a=t[0],n=t[1];return Object(H.jsxs)(qe.a,{open:!0,maxWidth:"sm",fullWidth:!0,keepMounted:!0,TransitionComponent:by,disableEscapeKeyDown:!1,children:[Object(H.jsx)(Bt.a,{children:"Si deseas realizar ventas inicia tu turno primeramente."}),Object(H.jsx)(uy,{type:"FRENTE",setLoading:n,loading:a})]})}var Oy=a(981),xy=a(982);var hy=function(e){var t=e.props;return Object(H.jsxs)(O.a,{children:[Object(H.jsx)(O.a,{height:"5vh",children:Object(H.jsx)(_y,{props:t})}),Object(H.jsxs)(Qe.a,{container:!0,children:[Object(H.jsxs)(Qe.a,{item:!0,lg:9,md:8,children:[Object(H.jsx)(O.a,{height:"10vh",children:Object(H.jsx)(Cv,{})}),Object(H.jsx)(O.a,{height:"85vh",children:Object(H.jsx)(py,{})})]}),Object(H.jsx)(Qe.a,{item:!0,lg:3,md:4,children:Object(H.jsx)(MC,{})})]})]})},_y=function(e){var t=e.props,a=ng(),n=JSON.parse(localStorage.getItem("turnoEnCurso")),c=JSON.parse(localStorage.getItem("sesionCafi")),r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1],l=Object(j.useContext)(qf),d=l.abrirTurnosDialog,u=l.setAbrirTurnosDialog,b=l.setUbicacionTurno,p=Object(j.useContext)(be),m=p.setAbrirPanelAcceso,x=p.abrirPanelAcceso,h=p.setDepartamentos,_=p.isOnline,f=p.ventasToCloud;Dt.a.locale("es");function g(){!0===c.accesos.ventas.administrador.ver?t.history.push("/admin"):(m(!x),h({departamento:"ventas",subDepartamento:"administrador",tipo_acceso:"ver"}))}window.onkeydown=function(e){112===e.keyCode&&g()};return Object(H.jsxs)(Qe.a,{container:!0,alignItems:"center",children:[Object(H.jsxs)(Qe.a,{item:!0,md:6,style:{display:"flex"},children:[Object(H.jsx)(Ke.a,{alt:"Remy Sharp",srsc:"/static/images/avatar/1.jpg",className:a.avatar}),Object(H.jsx)(L.a,{color:"textSecondary",children:null===c||void 0===c?void 0:c.nombre}),Object(H.jsx)(O.a,{mx:1}),null!==n&&void 0!==n&&n.numero_caja?Object(H.jsxs)(L.a,{color:"textSecondary",children:[Object(H.jsx)("b",{children:"Caja: "}),null===n||void 0===n?void 0:n.numero_caja]}):"",Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{color:"textSecondary",children:Dt()().locale("es-mx").format("ll")})]}),Object(H.jsxs)(Qe.a,{item:!0,md:6,style:n?{display:"flex",justifyContent:"flex-end"}:{display:"flex",justifyContent:"flex-end",zIndex:99999},children:[Object(H.jsx)(Kf,{isOnline:_,classes:a,ventasToCloud:f,sesion:c,fromVentas:!0}),Object(H.jsx)(O.a,{display:"flex",alignItems:"center",children:Object(H.jsx)(F.a,{onClick:function(){return s(!0),void window.location.reload()},className:a.buttonIcon,style:n?null:{color:"white",borderColor:"white"},children:o?Object(H.jsx)(I.a,{color:"inherit",size:20}):Object(H.jsx)(Ra.a,{})})}),Object(H.jsx)(Cf,{turnoEnCurso:n}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(F.a,{onClick:function(){return g()},startIcon:Object(H.jsx)(Oy.a,{}),style:n?null:{color:"white",borderColor:"white"},children:"F1 Admin"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(F.a,{color:"secondary",onClick:function(){!0===c.turno_en_caja_activo&&n?(u(!d),b("SESION")):(localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),localStorage.removeItem("DatosVentas"),localStorage.removeItem("VentaOriginal"),localStorage.removeItem("turnoEnCurso"),localStorage.removeItem("ListaEnEspera"),t.history.push("/"))},startIcon:Object(H.jsx)(xy.a,{}),style:n?null:{color:"white",borderColor:"white"},children:"Salir"}),Object(H.jsx)(O.a,{mr:2})]})]})},fy=a.p+"static/media/logochafa.744b44f9.PNG",gy=a.p+"static/media/admin.cecfcd64.svg",vy=a(488),Cy=a.n(vy),yy=Object(k.a)((function(e){return{icon:{width:150,fontSize:150}}}));var Ay=[{path:"/",component:function(e){var t=me(),a=localStorage.getItem("sesionCafi"),n=Object(j.useContext)(be).isOnline,c=Object(j.useState)([]),r=Object(y.a)(c,2),i=r[0],o=r[1],s=Object(j.useState)(!1),l=Object(y.a)(s,2),d=l[0],u=l[1],b=Object(j.useState)({message:"",status:"",open:!1}),p=Object(y.a)(b,2),x=p[0],h=p[1],_=Object(j.useState)(!1),f=Object(y.a)(_,2),k=f[0],N=f[1];a&&e.history.push("/ventas/venta-general");var P=Object(w.a)($),E=Object(y.a)(P,1)[0],D=function(){var t=Object(C.a)(Object(v.a)().mark((function t(a){var c,r,o;return Object(v.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),i.numero_usuario&&i.password){t.next=4;break}return h({message:"Los campos estan vac\xedos",status:"error",open:!0}),t.abrupt("return");case 4:return u(!0),t.prev=5,t.next=8,E({variables:{input:{numero_usuario:i.numero_usuario,password:i.password,isOnline:n}}});case 8:c=t.sent,r=c.data.logearUsuario.token,o=Object(Z.a)(r),u(!1),localStorage.setItem("sesionCafi",JSON.stringify(o)),localStorage.setItem("tokenCafi",JSON.stringify(r)),e.history.push("/ventas/venta-general"),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),h({message:t.t0.message,status:"error",open:!0}),u(!1);case 21:case"end":return t.stop()}}),t,null,[[5,17]])})));return function(e){return t.apply(this,arguments)}}(),z=function(e){o(Object(m.a)(Object(m.a)({},i),{},Object(g.a)({},e.target.name,e.target.value)))};return Object(H.jsxs)(A.a,{maxWidth:"sm",children:[Object(H.jsx)(Y,{alert:x,setAlert:h}),Object(H.jsx)(O.a,{height:"90vh",display:"flex",justifyContent:"center",alignItems:"center",children:Object(H.jsxs)(O.a,{width:"80%",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",justifyItems:"center",children:Object(H.jsx)(O.a,{className:t.containerImagen,textAlign:"center",children:Object(H.jsx)("img",{className:t.imagen,src:le,alt:"imagen no disponible"})})}),Object(H.jsxs)("form",{autocomplete:"on",onSubmit:D,children:[Object(H.jsx)(S.a,{label:"Numero de usuario o Username",variant:"outlined",name:"numero_usuario",fullWidth:!0,className:t.margin,onChange:z,autoComplete:"new-password"}),Object(H.jsxs)(ee.a,{variant:"outlined",name:"password",className:t.margin,fullWidth:!0,children:[Object(H.jsx)(te.a,{htmlFor:"usuario-password",children:"Contrase\xf1a"}),Object(H.jsx)(ae.a,{autoComplete:"new-password",name:"password",id:"usuario-password",type:k?"text":"password",onChange:z,endAdornment:Object(H.jsx)(ne.a,{position:"end",children:Object(H.jsx)(ce.a,{onClick:function(){N(!k)},onMouseDown:function(e){e.preventDefault()},edge:"end",children:k?Object(H.jsx)(ie.a,{}):Object(H.jsx)(se.a,{})})}),labelWidth:70})]}),Object(H.jsx)(F.a,{fullWidth:!0,size:"large",variant:"contained",disableElevation:!0,className:t.margin,color:"primary",type:"submit",endIcon:d?Object(H.jsx)(I.a,{size:25,color:"inherit"}):null,children:"Entrar"})]})]})})]})},exact:!0},{path:"/home",component:function(e){var t=yy();return JSON.parse(localStorage.getItem("sesionCafi"))||e.history.push("/"),Object(H.jsx)(A.a,{maxWidth:"md",children:Object(H.jsxs)(O.a,{height:"90vh",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",children:Object(H.jsx)("img",{alt:"logo ab",src:fy})}),Object(H.jsxs)(O.a,{display:"flex",justifyContent:"center",my:6,children:[Object(H.jsx)(F.a,{component:_.b,to:"/admin/inicio",children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",children:Object(H.jsx)("img",{src:gy,alt:"icono numero calzado",className:t.icon})}),"Admin"]})}),Object(H.jsx)(F.a,{component:_.b,to:"/ventas/venta-general",children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",children:Object(H.jsx)("img",{src:Ii,alt:"icono numero calzado",className:t.icon})}),"Ventas"]})}),Object(H.jsx)(F.a,{color:"secondary",onClick:function(){localStorage.removeItem("sesionCafi"),localStorage.removeItem("tokenCafi"),e.history.push("/")},children:Object(H.jsxs)(O.a,{display:"flex",flexDirection:"column",textAlign:"center",children:[Object(H.jsx)(O.a,{display:"flex",justifyContent:"center",children:Object(H.jsx)(Cy.a,{className:t.icon})}),"Cerrar sesion"]})})]})]})})},exact:!0},{path:"/admin",component:function(e){return localStorage.getItem("sesionCafi")||e.history.push("/"),Object(H.jsx)("div",{children:Object(H.jsxs)(Ee,{children:[Object(H.jsx)(tg,{}),Object(H.jsx)($f,{})]})})},exact:!1,routes:[{path:"/admin/inicio",component:$f,exact:!0}]},{path:"/ventas/venta-general",component:function(e){return localStorage.getItem("sesionCafi")||e.history.push("/"),Object(H.jsx)(O.a,{height:"100%",children:Object(H.jsx)(Jf,{children:Object(H.jsx)(hy,{props:e})})})},exact:!1}],Sy=Ay,Fy=a(493),Iy=Object(Fy.a)({palette:{navbar:Vf.a[50],primary:{main:"#2222a8"},secondary:{main:"#f50057"},secondaryCafi:"#3f3f3f"}}),ky=a(489);function wy(){var e=Object(j.useContext)(be).setIsOnline,t=Object(j.useState)(!0),a=Object(y.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(!1),i=Object(y.a)(r,2),o=i[0],s=i[1];return Object(j.useEffect)((function(){e(o)}),[o]),Object(H.jsx)(O.a,{children:Object(H.jsx)(ky.Detector,{render:function(e){var t=e.online;return t?(s(t),n?null:Object(H.jsx)(Ny,{})):(s(t),c(!1),Object(H.jsx)(Py,{}))}})})}var Ny=function(){var e=Object(j.useState)(!0),t=Object(y.a)(e,2),a=t[0],n=t[1];return Object(H.jsx)(M.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a,autoHideDuration:6e3,TransitionComponent:Ue.a,onClose:function(){return n(!1)},message:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(Lf.a,{htmlColor:"#81c784"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:"Est\xe1s conectado"})]}),action:Object(H.jsx)(u.a.Fragment,{children:Object(H.jsx)(ce.a,{size:"small","aria-label":"close",color:"inherit",onClick:function(){return n(!1)},children:Object(H.jsx)(Gt.a,{fontSize:"small"})})})})},Py=function(){return Object(H.jsx)(M.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!0,TransitionComponent:Ue.a,message:Object(H.jsxs)(O.a,{display:"flex",children:[Object(H.jsx)(Bf.a,{htmlColor:"#bdbdbd"}),Object(H.jsx)(O.a,{mx:1}),Object(H.jsx)(L.a,{children:"Sin Conexi\xf3n"})]})})},Ey=a(460),Dy=a(989),zy=a(983),Ty=a.n(zy)()({uri:"http://localhost:4000/"}),$y=new Ey.a({connectToDevTools:!0,cache:new Dy.a({addTypename:!1}),link:Ty}),Wy=a(986);function Ry(e){return Object(H.jsx)(f.a,{path:e.path,exact:e.exact,render:function(t){return Object(H.jsx)(e.component,Object(m.a)({routes:e.routes},t))}})}var Vy=function(){return Object(H.jsxs)(O.a,{height:"100vh",className:"App",children:[Object(H.jsx)(x.a,{}),Object(H.jsx)(Wy.a,{client:$y,children:Object(H.jsx)(pe,{children:Object(H.jsx)(Eo,{children:Object(H.jsxs)(h.a,{theme:Iy,children:[Object(H.jsx)(wy,{}),Object(H.jsx)(_.a,{children:Object(H.jsx)(f.c,{children:Sy.map((function(e,t){return Object(H.jsx)(Ry,Object(m.a)({},e),t)}))})})]})})})})]})},My=function(e){e&&e instanceof Function&&a.e(5).then(a.bind(null,1179)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),r(e),i(e)}))};a(838);p.a.render(Object(H.jsx)(Vy,{}),document.getElementById("root")),My()}},[[839,1,2]]]);
//# sourceMappingURL=main.dad28cf6.chunk.js.map